(window.webpackJsonp=window.webpackJsonp||[]).push([["common"],{"+YbT":function(e,t){var n={obj:null,highlight:!1,start:function(e){e.touches&&1==e.touches.length&&(n.clear(),n.end(e),n.obj=this||null,n.obj&&(n.highlight=!0,addClass("hover",n.obj),addClass("_thover",n.obj)))},cancel:function(e){n.obj&&(n.highlight=!1,n.end(e))},end:function(){n.obj&&(removeClass("hover",n.obj),n.highlight&&(n.clear(),addClass("active",n.obj)),n.obj=null,n.highlight=!1)},clear:function(){removeClass("active",geByClass1("active","vk_wrap")),removeClass("active",$(".Popup .active._thover"))}};window.thover=n},"+qVl":function(e,t,n){"use strict";n.r(t),n.d(t,"DeliveryPointListItem",(function(){return r}));var i=n("UWnA");function a(e){return{class:"DeliveryPointListItem__subway",style:e.color?"background-color: #"+e.color:"",tag:"div"}}function r(e){return Object(i.default)({inner:[{inner:[a({color:e.metro}),{inner:[e.title],tag:"div"}],class:"DeliveryPointListItem__titleWrap",tag:"div"},{inner:[e.address],class:"DeliveryPointListItem__address",tag:"div"},{class:"DeliveryPointListItem__link",href:"?act=cart_delivery_point_info&delivery_point_id="+e.id,"aria-label":e.title,tag:"a"}],class:"DeliveryPointListItem"})}},"/88W":function(e,t,n){"use strict";n.r(t),n.d(t,"TooltipHelpHints",(function(){return o})),n.d(t,"toggleLock",(function(){return l})),n.d(t,"getHelpHint",(function(){return u})),n.d(t,"setHelpHintShown",(function(){return d})),n.d(t,"canShow",(function(){return p})),n.d(t,"close",(function(){return f})),n.d(t,"initShownHelpHints",(function(){return c})),n.d(t,"initHelpHints",(function(){return s}));var i=n("UxAg"),a=(n("G0UO"),n("OcsD")),r=n("Xrg9"),o={ACCOUNT_HINT_MVK_VIDEO_FILTERS:"mvk:video_filters",ACCOUNT_HINT_TEXTLIVE_HIDE:"feed:textlive_hide",ACCOUNT_HINT_COMMUNITY_TEXTLIVES_COUNTER:"community:textlives_counter",ACCOUNT_HINT_NARRATIVES_ADD_TOOLTIP:"narratives:add_tooltip",ACCOUNT_HINT_FEED_POST_REACTION:"feed:post_reaction",ACCOUNT_HINT_MVK_STORIES_ARCHIVE_PRIVACY_HINT:"mvk:stories_archive:privacy_hint",ACCOUNT_HINT_MVK_STORIES_ARCHIVE_ACTIONS_HINT:"mvk:stories_archive:actions_hint"};function s(e){window.store.helpHints.all=e}function c(){window.store.helpHints.shown=r.default.get("shown_tooltips")||{}}function l(e,t){void 0===t&&(t=null),null===t&&(t=!window.store.helpHints.locked[e]),window.store.helpHints.locked[e]=Boolean(t)}function u(e){return e?Object(i.$)('.Tooltip[tooltip-id="'+e+'"]'):null}function d(e){if(!e)return!1;if(!p(e))return!1;var t,n,i=(t=e,null===(n=window.store.helpHints.all[t])||void 0===n?void 0:n.hash),a=f(e),o=r.default.get("shown_tooltips")||{};o[e]=!0,r.default.set("shown_tooltips",o),window.store.helpHints.shown[e]=!0,window.store.helpHints.all[e].active=!1,a&&window.ajax.post("/",{act:"help_hints_hide",hint_id:e,hash:i})}function _(e){return!!e&&(Object(a.re)(e),!0)}function f(e){return _(u(e))}function p(e){return!(!e||window.store.helpHints.locked[e])&&(c(),Object(a.isUndefined)(window.store.helpHints.all[e])?!window.store.helpHints.shown[e]:!window.store.helpHints.shown[e]&&window.store.helpHints.all[e].active)}c(),Object(a.addEvent)(window,"click touchend touchcancel",(function(e){var t=e.target&&e.target.classList.contains("Tooltip")?e.target:e.target.closest(".Tooltip");if(t&&(e.preventDefault(),e.stopPropagation(),t.classList.contains("Tooltip_onboarding"))){var n=t.getAttribute("tooltip-id");d(n),f(n)}}),{capture:!0}),Object(a.addEvent)(window,"touchstart mousedown click",(function(){var e=Object(i.$$)(".Tooltip_closeOnOverlayClick[tooltip-id]");null==e||e.forEach(_)}),{passive:!0,capture:!0})},"/8IX":function(e,t){function n(e,t){if(!e)throw new Error(t||"AssertionError")}n.notEqual=function(e,t,i){n(e!=t,i)},n.notOk=function(e,t){n(!e,t)},n.equal=function(e,t,i){n(e==t,i)},n.ok=n,e.exports=n},"/Id8":function(e,t,n){"use strict";n.r(t),n.d(t,"Msg__restoreInner",(function(){return U})),n.d(t,"Msg__reply",(function(){return q})),n.d(t,"Msg__authorName",(function(){return Z})),n.d(t,"Msg__replyAttach",(function(){return K})),n.d(t,"Msg__replyLink",(function(){return Q})),n.d(t,"Msg__textPreview",(function(){return z})),n.d(t,"Msg__attachPreview",(function(){return Y})),n.d(t,"Msg_makeReplyLink",(function(){return W})),n.d(t,"Msg_makePinnedReplyLink",(function(){return V})),n.d(t,"Msg_detailed",(function(){return F}));var i=n("MUpH"),a=n("bZ/P"),r=n("TYsd"),o=n("9y81"),s=n("KMpi"),c=n("u33z"),l=n("B+U2"),u=n("BoyB"),d=n("A6le"),_=n("SNk7"),f=n("Y6JH"),p=n("fdw3"),h=n("TjCR"),m=n("vy0q");function v(){var e=Object(i.default)(["\n    ","\n  "]);return v=function(){return e},e}function g(){var e=Object(i.default)(['\n    <div class="msg__keyboard">\n      ',"\n    </div>\n  "]);return g=function(){return e},e}function A(){var e=Object(i.default)(['\n    <a class="','"\n      href="','"\n      ',"\n      ",'\n      style="width: ',"px; height: ",'px;"\n    >\n      <img class="msg__stickerImg sticker_img" height="','" src="','">\n    </a>\n  ']);return A=function(){return e},e}function b(){var e=Object(i.default)(['\n      <div class="','"\n        ',"\n        ",'\n        style="width: ',"px; height: ",'px;"\n      >\n        <img class="msg__stickerImg sticker_img" height="','" src="','">\n      </div>\n    ']);return b=function(){return e},e}function w(){var e=Object(i.default)(['\n    <div class="msg__stickerWrap">\n      ',"\n    </div>\n  "]);return w=function(){return e},e}function y(){var e=Object(i.default)(['\n    <a href="','" class="msg__replyLink" ',">\n      ","\n    </a>\n  "]);return y=function(){return e},e}function O(){var e=Object(i.default)(['\n    <div class="msg__replyAttach">',"</div>\n  "]);return O=function(){return e},e}function S(){var e=Object(i.default)(['\n    <div class="msg__bodyPreview">\n      ',"\n      ","\n    </div>\n  "]);return S=function(){return e},e}function k(){var e=Object(i.default)(['\n    <div class="msg__reply">\n      ','\n      <div class="msg__replyInner">\n        <div class="msg__replyHead">\n          <div class="msg__replyHeadRow">\n            <div class="msg__replyName">','</div>\n            <div class="msg__replyDate">','</div>\n          </div>\n        </div>\n        <div class="msg__replyBody">\n          ',"\n        </div>\n      </div>\n    </div>\n  "]);return k=function(){return e},e}function C(){var e=Object(i.default)(['\n    <div class="msg__info msg__restoreText msg__restoreText_remove">\n      ','\n      <span class="msg__restoreText msg__infoLink" ',">\n        ",'\n      </span>\n    </div>\n    <div class="msg__info msg__restoreText msg__restoreText_spam">\n      ','\n      <span class="msg__restoreText msg__infoLink" ',">\n        ","\n      </span>\n    </div>\n  "]);return C=function(){return e},e}function j(){var e=Object(i.default)(['\n    <span class="msg__edited">\n      <span class="msg__editedMiddot">&middot;</span><span class="msg__editedText">',"</span>\n    </span>\n  "]);return j=function(){return e},e}function E(){var e=Object(i.default)(['\n    <div class="msg__admin">\n      (<a class="msg__adminLink" href="','">',"</a>)\n    </div>\n  "]);return E=function(){return e},e}function T(){var e=Object(i.default)(['\n    <div class="msg__actions">\n      ',"\n    </div>\n  "]);return T=function(){return e},e}function I(){var e=Object(i.default)(['\n    <div class="msg_item','">\n      <div class="mi_header">\n        ','\n        <a class="msg__author" href="','">','</a>\n        <div class="msg__date">',"</div>\n        ","\n      </div>\n      ","\n      ","\n      ","\n      ","\n    </div>\n  "]);return I=function(){return e},e}function M(){var e=Object(i.default)(['\n    <div class="msg__detailed">\n      <div class="msg__detailedHead">\n        ','\n        <div class="msg__detailedInfo">\n          <div class="msg__detailedRow">\n            <a class="msg__detailedAuthor" href="','">','</a>\n            <span class="msg__detailedPeer">','</span>\n          </div>\n          <div class="msg__detailedRow">\n            <div class="msg__date">','</div>\n          </div>\n        </div>\n      </div>\n      <div class="msg__content">\n        <div class="msg__text">\n          ',"\n        </div>\n        ","\n      </div>\n      ","\n    </div>\n  "]);return M=function(){return e},e}function P(){var e=Object(i.default)(['\n    <div class="msg_item _msg single_msg_item msg__text">\n      <div class="msg__giftMedia">',"</div>\n      ","\n    </div>\n  "]);return P=function(){return e},e}function D(){var e=Object(i.default)(['\n    <div class="msg_item _msg single_msg_item msg__text">\n      <div class="mi_cont">\n        <div class="mi_body">\n          ',"\n          ","\n          ","\n          ","\n        </div>\n      </div>\n    </div>\n  "]);return D=function(){return e},e}function x(){var e=Object(i.default)(["\n    ",'\n    <div class="msg__content">\n      <div class="msg__head">\n        <a class="msg__author" href="','">',"</a>\n        ","\n        ","\n        ","\n        ","\n        ","\n        ","\n        ","\n        ","\n        ","\n      </div>\n      ",'\n      <div class="msg__text">\n        ',"\n      </div>\n      ",'\n    </div>\n    <div class="msg__restore">\n      ',"\n    </div>\n  "]);return x=function(){return e},e}function L(){var e=Object(i.default)(['\n    <div class="','" ',">\n      ","\n      ","\n    </div>\n  "]);return L=function(){return e},e}function B(){var e=Object(i.default)(['\n      <div class="','" ',">\n        ","\n      </div>\n    "]);return B=function(){return e},e}var R=function(e){var t=e.id,n=e.removed,i=e.isExpired,l=i||e.service,u=function(e){var t=window.lang,n=e.isDefaultCasperTimerShown;if(e.service)return e.text;var i,l=r.default.html(Object(s.Avatar)({mix:"msg__avatar",url:e.authorUrl,src:e.authorPhoto,size:40})),u=Object(o.default)({mix:"msg__check",icon:"check"}),_=r.default.html({class:"msg__star"}),m=!!e.attaches.gift,v=store.mail.msgs[e.id];v&&v.authorId===v.peerId&&(i=store.mail.peers[v.peerId]);var g=e.admin?(I=e.admin,a.default.html(E(),I.url,I.name)):"",A=e.removed?U(e.id):"",b=e.edited?H():"",w=e.pending||e.failed?"":'<div class="msg__date">'+e.date+"</div>",y=e.pending?r.default.html({inner:[Object(f.default)({icon:Object(h.getRecent16Icon)()})],class:"msg__pending",tag:"div"}):"",O=e.failed?'<div class="msg__error">'+t.mobile_mail_send_error+"</div>":"",S=e.channel?function(e){var t=Object(c.default)({class:"msg__actionForward",onClick:a.default.onClick("Msg._onActionClick","event","forward",e)});return a.default.html(T(),t)}(e.id):"",k=m&&i?'<div class="msg__giftHead">'+langSex(i.sex,t.mobile_mail_sent_gift)+"</div>":"",C=Object(p.timestamp)(),j=null;var I;e.ttl&&(j=Math.round(e.ts+e.ttl-C));var M,D=j?r.default.render(Object(d.default)({durationInSeconds:j,isDefaultCasperTimerShown:n})):"";M=m?function(e){var t=e.text,n=e.attachesHTML;t&&(t='<div class="msg__giftText">'+t+"</div>");return a.default.html(P(),n,t)}(e):N(e);var L=e.keyboard?X(e):"";return a.default.html(x(),l,e.authorUrl,e.authorName,k,w,y,O,b,g,D,u,_,S,M,L,A)}(e),m=!l&&!(!e.attaches||!e.attaches.gift),v=!(!e.attaches||!e.attaches.group_call_in_progress),g=a.default.class("msg",{id:t,service:l,unread:e.unread&&!e.failed,important:e.important,removed:!!n,spam:"spam"===n,pending:e.pending,failed:e.failed,gift:m,call:v,hasTemplate:!!e.template}),A="";l||v||(A=e.pending||e.failed?a.default.onClick("Msg._onPendingClick","event","this",t,e.sendId||"",!!e.failed):a.default.onClick("Msg._onClick","event","this",t));if(i){var b=r.default.render(Object(_.default)());return a.default.html(B(),g,A,b)}var w=e.template?J(e):"";return a.default.html(L(),g,A,u,w)};function N(e){var t,n,i=window.lang,o=Object(p.mailWrapMention)(e.text),c=0;e.attachesHTML?t=e.attachesHTML:e.attaches.sticker&&e.sticker?(n=function(e,t,n,i,r,o,s){void 0===i&&(i=""),void 0===r&&(r=!0),void 0===o&&(o=""),void 0===s&&(s="");var c=Date.now(),l=Math.random(),u=""+c+l,d="msg__sticker",_="";s&&(d+=" sticker_animation",_='\n      data-animation-path="'+s+'"\n      data-uniq-id="'+u+'"\n      data-sticker-id="'+e+'"\n      data-loop-count="3"\n      ontouchstart="StickersAnimation.touchStartSticker(this);"\n      ontouchend="StickersAnimation.touchEndSticker(this);"\n    ');var f=a.default.onClick("Msg._onStickerClick","event","this",r,i);return Object(p.isSAKIntegration)()?a.default.html(b(),d,_,f,t,t,t,n):a.default.html(A(),d,o,f,_,t,t,t,n)}(e.sticker.id,e.sticker.height,e.sticker.url),t=a.default.html(w(),n)):te(e)&&Object.keys(e.attaches).length&&(c+=1,t=G(Y(e),!e.failed&&1===c));var l,u=e.forwards;u.length&&(te(e)&&ee(u)?(c+=1,l=G(langNumeric(u.length,i.mobile_mail_N_forwards),!e.failed&&1===c)):l=(l=u.map((function(t){return function e(t,n,i){var o=window.lang,c=store.mail,l=c.forwards[t]||c.msgs[t];if(!l)return"";var u,d=c.members[l.authorId],_=l.peerId,f=(c.peers[_],Z(d,_,c.cur.userId)),h=l.edited,m=d.avatar,v=d.url,g=f,A=l.date,b=Object(p.mailWrapMention)(l.text),w=l.attachesHTML,y=l.forwards,O=l.reply,S=r.default.html(Object(s.Avatar)({mix:"mi_author_photo",src:m,size:36})),k=h?H():"";if(i>0){for(var C=[],j=y.length,E=0;E<j;E++){var T=e(y[E],n,i-1);C.push(T)}u=C.join("")}else if(y.length){var M=langNumeric(y.length,o.mobile_mail_N_forwards);u='<a href="/mail?act=msg&id='+n+'" class="msg__fwdsLink">'+M+"</a>"}w&&(w='<div class="mi_medias">'+(w=w.replace(/%top_msg_id%/g,n))+"</div>");u&&(u='<div class="mi_forwarded">'+u+"</div>");b&&(b='<div class="mi_text">'+b+"</div>");var P=O?$(O,n,{}):"",D=l.attaches.gift?" msg__forwardGift":"";return a.default.html(I(),D,S,v,g,A,k,P,b,w,u)}(t,e.id,e.maxDepth-1)}))).join(""));var d,_=e.reply;_&&(te(e)&&(ee([_])||!function(e){var t=store.mail;return Object(p.isForwardedMessageId)(e)?!!t.replies[e]:!!t.pendingReplies[e]}(_))?(c+=1,d=G(i.mobile_mail_in_reply_to,!e.failed&&1===c)):d=$(_,e.id,{isPinned:e.isPinned,chatId:e.chatId}));return t&&(t='<div class="mi_medias">'+t+"</div>"),l&&(l='<div class="mi_forwarded">'+l+"</div>"),o&&(o='<div class="mi_text">'+o+"</div>"),a.default.html(D(),d,o,t,l)}function F(e){var t=N(e),n=e.keyboard?X(e):"",i=e.template?J(e):"",o=r.default.html(Object(s.Avatar)({mix:"msg__avatar",url:e.authorUrl,src:e.authorPhoto,size:40})),c=function(e){var t=window.lang,n=store.mail,i=n.msgs[e.id],a=n.peers[i.peerId],r="";if(Object(p.isChatPeer)(i.peerId)){var o='<a href="'+Object(p.wrapCommunityMailUrl)("/mail?act=show&peer="+i.peerId)+'">'+a.title+"</a>";r=t.mobile_mail_message_to_chat.replace("{chat}",o)}return r}(e);return a.default.html(M(),o,e.authorUrl,e.authorName,c,e.date,t,n,i)}function H(){var e=window.lang;return a.default.html(j(),e.mobile_mail_edited_short)}function U(e){var t=window.lang,n=a.default.onClick("Msg._onRestoreClick","event",e);return a.default.html(C(),t.mobile_msg_mail_message_deleted,n,t.mobile_restore,t.mobile_msg_mail_message_marked_as_spam,n,t.mobile_restore)}function V(e,t){var n="/mail?act=msg";return n=Object(p.concatValues)(n,"&id=pinned&chat="+e),t&&(n=Object(p.concatValues)(n,"&reply_id="+t+"&reply=true")),Object(p.wrapCommunityMailUrl)(n)}function W(e,t,n){var i="/mail?act=msg";return t?(i=Object(p.concatValues)(i,"&id="+t+"&reply=true"),n&&(i=Object(p.concatValues)(i,"&reply_id="+n))):i=Object(p.concatValues)(i,"&id="+e),Object(p.wrapCommunityMailUrl)(i)}function $(e,t,n){var i=store.mail.forwards[e]||store.mail.msgs[e],a=store.mail.replies[e]||store.mail.pendingReplies[e];return Q(q(i,Z(store.mail.members[i.authorId],i.peerId,store.mail.cur.userId),a.preview_url),a.msg_id,t,e,n)}function q(e,t,n){var i="";i=e.isExpired?'<span class="msg__replyDisappeared">'+Object(p.getLang)("mobile_casper_chat_message_disappeared")+"</span>":e.body?z(e.body):K(e);var r="";return(e.attaches.photo||e.attaches.video||e.attaches.doc)&&(r=n?'<div class="msg__replyPreview"\n        style="background-image: url('+n+')"></div>':e.attaches.doc?'<div class="msg__replyPreview msg__replyPreview_icon">\n        <div class="msg__replyPreviewDoc"></div>\n      </div>':'<div class="msg__replyPreview msg__replyPreview_empty"></div>'),a.default.html(k(),r,t,e.date,i)}function z(e){return e=e.replace(/<br>/g,"\n"),e=Object(p.mailReplaceDomainMentions)(e,"@$3"),e=Object(p.mailReplaceMentions)(e,"$3"),e=Object(p.emojiToHTML)(e)}function Y(e){var t,n=window.lang,i=Object.keys(e.attaches),a=i.length;if(a>1){for(var r=0,o=i.length,s=0;s<o;s++)r+=0|e.attaches[i[s]];t=langNumeric(r,n.mobile_mail_attachments)}else if(1===a){var c=i[0],l=e.attaches[c];if(1===l)switch(c){case"poll":t=n.mobile_mail_added_poll;break;case"article":t=n.global_article;break;case"artist":t=n.mobile_mail_added_artist;break;case"curator":t=n.mobile_mail_added_curator;break;case"photo":t=n.mobile_mail_added_photo;break;case"video":t=n.mobile_mail_added_video;break;case"audio":t=n.mobile_mail_added_audio;break;case"audio_playlist":t=n.mobile_mail_added_audio_playlist;break;case"money_transfer":t=n.mobile_mail_added_money_transfer;break;case"podcast":t=n.mobile_mail_added_podcast;break;case"money_request":t=n.mobile_mail_added_money_request;break;case"vkpay":t=n.mobile_mail_added_vkpay;break;case"story":t=n.mobile_mail_added_story;break;case"narrative":t=n.mobile_mail_added_narrative;break;case"graffiti":t=n.mobile_mail_added_graffiti;break;case"audiomsg":t=n.mobile_mail_added_audiomsg;break;case"doc":t=n.mobile_mail_added_doc;break;case"geo":case"map":t=n.mobile_mail_added_geo;break;case"wall":t=n.mobile_mail_added_wall;break;case"wall_reply":t=n.mobile_mail_added_wall_reply;break;case"gift":t=n.mobile_mail_added_gift;break;case"link":t=n.mobile_mail_added_link;break;case"sticker":t=n.mobile_mail_added_sticker;break;case"market":t=n.mobile_mail_added_market_item;break;case"call":case"group_call_in_progress":t=n.mobile_mail_added_call;break;case"donut_link":t=n.mobile_mail_added_donut_link}else if(l>1)switch(c){case"photo":t=langNumeric(l,n.mobile_mail_added_photos);break;case"video":t=langNumeric(l,n.mobile_mail_added_videos);break;case"audio":t=langNumeric(l,n.mobile_mail_added_audios);break;case"doc":t=langNumeric(l,n.mobile_mail_added_docs)}}var u=e.forwards&&e.forwards.length||e.hasReply;return!t&&u&&(t=e.hasReply?langNumeric(1,n.mobile_mail_messages):langNumeric(e.forwards.length,n.mobile_mail_N_forwards)),t||""}function G(e,t){var n;return t&&(n='<div class="msg__loading">'+(n=Object(u.default)({large:!0}))+"</div>"),a.default.html(S(),e,n)}function K(e){var t=Y(e);return a.default.html(O(),t)}function Q(e,t,n,i,r){var o="";o=r.isPinned&&r.chatId?V(r.chatId,i):W(t,n,i);var s=a.default.onClick("Msg._onReplyClick","event",t,n,i);return a.default.html(y(),o,s,e)}function X(e){var t=ne(e.id),n=r.default.render(Object(l.default)({msgId:e.id,pressed:t,keyboard:e.keyboard}));return a.default.html(g(),n)}function J(e){switch(e.template.type){case"carousel":return function(e){for(var t=[],n=0;n<e.template.elements.length;n++){var i=e.template.elements[n];t[n]=Object(p.extend)(i,{pressed:ne(e.id,"carousel"+n)})}var o=r.default.render(Object(m.default)({msgId:e.id,authorId:e.authorId,elements:e.template.elements,pressed:t}));return a.default.html(v(),o)}(e)}return""}function Z(e,t,n){return t>2e9?e.name:t>-2e9&&t<0?e.id===n?e.firstName:e.name:e.firstName}function ee(e){for(var t=store.mail.msgs,n=store.mail.members,i=store.mail.forwards,a=e.length,r=0;r<a;r++){var o=e[r];if(Object(p.isForwardedMessageId)(o)){var s=i[o];if(!s)return!0;if(!s.authorId||!n[s.authorId])return!0}else{var c=t[o];if(!c)return!0;if(!c.authorId||!n[c.authorId])return!0}}return!1}function te(e){return e.pending||e.failed||e.waiting}function ne(e,t){void 0===t&&(t="");var n=window.store,i="";return t&&(i=t+"|"),n.mail&&n.mail.cur&&n.mail.cur.pressedButtons?n.mail.cur.pressedButtons.msgs[i+e]:{}}var ie=n("UxAg"),ae=n("+cqQ"),re=n("Gzds"),oe=n("OcsD"),se=need("Voting");Object.assign(R,{class:"msg",onClick:Object(ae.default)(),onPendingClick:Object(ae.default)(),onRestoreClick:Object(ae.default)(),onReplyClick:Object(ae.default)(),onForward:Object(ae.default)(),onLoadAgain:Object(ae.default)(),getElem:function(e){return Object(ie.$)(".msg_id_"+e)},remove:function(e,t){void 0===t&&(t=!1);t?Object(ie.$$)(".msg_id_"+e).forEach((function(e){return e.remove()})):fe(e,!1)},spam:function(e){fe(e,!0)},restore:function(e){Object(ie.$$)(".msg_id_"+e).forEach((function(e){e.classList.remove("msg_removed"),e.classList.remove("msg_spam")}))},unselectAll:function(){Object(ie.$$)(".msg_selected").forEach((function(e){return e.classList.remove("msg_selected")}))},getReplyDataFromHTML:function(e){var t=e&&R.getElem(e),n="";if(t){var i=Object(ie.$)(".thumbs_map .thumb_map_img_as_div",t);return(n=i&&i.style.backgroundImage)&&(n=n.replace(/^url\((['"])?/,"").replace(/(['"])?\)$/,"")),{msg_id:e,parent_id:null,preview_url:n}}return null},toggleImportant:function(e,t){[].concat(e).forEach((function(e){var n=Object(ie.$)(".msg_id_"+e);n&&n.classList.toggle("msg_important",t)}))},markAsRead:function(e){Object(ie.$$)(".msg_id_"+e).forEach((function(e){return e.classList.remove("msg_unread")}))},getId:function(e){var t=a.default.parseClass(le,e.className);return Number(t.id)},getTextHtml:function(e){return e.$(ue).innerHTML}}),R._onClick=pe,R._onPendingClick=he,R._onTouchStart=ve,R._onRestoreClick=_e,R._onActionClick=ge,R._onReplyClick=be,R._onStickerClick=we,R.onStickerTouchStart=ye;var ce,le="msg",ue=".msg__text",de=!1;function _e(e,t){e.stopPropagation(),t=parseInt(t,10),R.onRestoreClick(t)}function fe(e,t){void 0===t&&(t=!1);var n=U(e);Object(ie.$$)(".msg_id_"+e).forEach((function(e){e.$(".msg__restore").innerHTML=n,e.classList.remove("msg_selected"),e.classList.add("msg_removed"),e.classList.toggle("msg_spam",t)}))}function pe(e,t,n){me(e.target,t,(function(){t.classList.toggle("msg_selected"),R.onClick(n)}))}function he(e,t,n,i,a){me(e.target,t,(function(){R.onPendingClick(n,i,a)}))}function me(e,t,n){for(var i,a,r=t.classList.contains("msg_pending")||t.classList.contains("msg_failed");e!==t;)if(r&&-1!==e.className.indexOf("msg__sticker"))e=e.parentElement;else{if("A"===e.tagName||"BUTTON"===e.tagName||e.getAttribute("onclick")||e.classList.contains("im_msg_audiomsg")||e.classList.contains("articleSnippet__block")||e.classList.contains("MailButton")||e.closest("."+se.cls))return;e=e.parentElement}de?de=!1:Ae()||t.classList.contains("msg_removed")||t.classList.contains("msg_spam")||store.mail.cur.editing||(null==(i=window.Speech)||null==(a=i.recorder)?void 0:a.isRecording)||Object(ie.$)(".VoiceRecordControls")||n()}function ve(){Ae()&&(de=!0)}function ge(e,t,n){switch(t){case"forward":R.onForward(n)}}function Ae(){return window.getSelection().toString().length>0}function be(e,t,n,i){e.preventDefault(),R.onReplyClick(t,n,i)}function we(e,t,n,i){n&&(e.preventDefault(),i&&re.default.stickersClick(t,i))}function ye(e,t){if(clearTimeout(ce),!!t.getAttribute("data-animation-path")){var n=e.touches[0].clientX,i=e.touches[0].clientY;Object(oe.addEvent)(t,"contextmenu",Oe),Object(oe.addEvent)(t,"touchmove",a,{passive:!0}),Object(oe.addEvent)(t,"touchend",r,{passive:!0}),Object(oe.addEvent)(t,"touchcancel",r,{passive:!0}),ce=setTimeout((function(){!function(e){StickersAnimation.loadAndPlaySticker(e)}(t),r()}),500)}function a(e){(Math.abs(e.touches[0].clientX-n)>=10||Math.abs(e.touches[0].clientY-i)>=10)&&r()}function r(){clearTimeout(ce),Object(oe.removeEvent)(t,"contextmenu",Oe),Object(oe.removeEvent)(t,"touchmove",a,{passive:!0}),Object(oe.removeEvent)(t,"touchend",r,{passive:!0}),Object(oe.removeEvent)(t,"touchcancel",r,{passive:!0})}}function Oe(e){event.preventDefault(),event.stopPropagation()}t.default=R;window.Msg=R},"03kU":function(e,t,n){"use strict";n.r(t);var i=n("OmnB"),a=n.n(i),r=n("jE6c"),o=100,s=101,c=102,l=103,u=105,d=106,_=107,f=108,p=109,h=110,m=112,v=113,g=[s,l,c,d,_,f,p,h],A="click_on_video",b="click_on_audio",w="click_on_photo",y="external_link_click",O="click_on_carousel_next",S="click_on_carousel_prev",k="click_on_mentions",C="night_mod_on",j="night_mod_off",E="close";function T(e,t,n){var i=[];if(Object(r.each)(e,(function(e,t){n&&!["w","z","y","x","m","s"].includes(e)||i.push(t)})),!i.length)return[!1];i.sort((function(e,t){return e[1]-t[1]})),t*=window.devicePixelRatio>=2?2:1;var a=i[i.length-1];return Object(r.each)(i,(function(e,n){if(n[1]>=t)return a=n,!1})),a}var I={};function M(e,t){if(Object(r.isObject)(t)&&!Object(r.isEmpty)(t)){var n="https://vk-callback.go.mail.ru/longread_pxl?action="+e;Object(r.each)(t,(function(e,t){n+="&"+e+"="+t})),(new Image).src=n}}function P(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t||location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))}function D(e){if(/^https?:\/\/([\w-]+\.)*(instagram\.com|instagr\.am)$/.test(e.origin)){var t=function(e){for(var t,n=document.getElementsByTagName("iframe"),i=n.length-1;i>=0;i--){var a=n[i];if(a.contentWindow===e.source){t=a;break}}return t}(e);if(t){try{e=JSON.parse(e.data)}catch(e){}"object"==typeof e&&"string"==typeof e.type&&"object"==typeof e.details&&setTimeout((function(){if("MEASURE"===e.type){var n=e.details.height;t.setAttribute("height",n)}}),100)}}}function x(e,t){var n=domQuery1("[data-sizes]",e),i=JSON.parse(domData(n,"sizes"));(domData(n,"media-links")||"").split(",");if(!(i.length<=1||domData(e,"carousel-inited"))){if(domData(e,"carousel-inited",1),t.mobile)return function(e,t,n){void 0===n&&(n={});var i,a,o,s=geByClass1("article_photo_carousel__controls",t),c=geByClass1("article_photo_carousel__counter",t),l=domData(c,"counter-lang")||getLang("global_article_carousel_counter"),u=getSize(geByClass1("article_figure_content",t)),d=geByClass1("article_photo_carousel_inner",t),_=n.onClick,f=0,p=0,h=!1,m=0,v=0,g=!1,A=!1;s.addEventListener("touchstart",(function(e){a=e.touches[0].pageX,i=e.touches[0].pageY,addClass(d,"--no_trans"),h=!0,clearTimeout(o)}));var b,w=!1;function y(n,i,a,s,p){if(void 0===s&&(s=!1),void 0===p&&(p=!0),!i||!h){if(h=!0,i)return d.style.transform="translateX(-50px)",void(o=setTimeout((function(){d.style.transform="translateX(0px)"}),700));clearTimeout(o),f=void 0===f?Math.min(e.length-1,Math.max(0,f+n)):a,s&&Object(r.isFunction)(_)&&v!==f&&_(v<f?O:S),domData(t,"photo-carousel-index",f),L(f,t),c.innerHTML=l.replace("{counter}",f+1).replace("{total}",e.length),p||addClass(d,"--no_trans"),d.style.transform="translateX(-"+f*u[0]+"px)",p||(d.offsetWidth,removeClass(d,"--no_trans"))}}return s.addEventListener("touchmove",(function(t){if(A||!(Math.abs(t.touches[0].pageY-i)>5||g)){if(p=t.touches[0].pageX-a,!(Math.abs(p)<10)||w){A||window.addEventListener("touchmove",b=function(e){return cancelEvent(e)},{passive:!1}),A=!0,w=!0;var n=Math.min(e.length-1,Math.max(0,f+(p<0?1:-1))),r=0===n&&0===f,o=n===e.length-1&&f===e.length-1;m=n;var s=-f*u[0];s+=r||o?.2*p:p,d.style.transform="translateX("+s+"px)"}}else g=!0})),s.addEventListener("touchend",(function(){w=!1,g=!1,A=!1,v=f,removeClass(d,"--no_trans"),b&&window.removeEventListener("touchmove",b),Math.abs(p)<50||(f=m),y(0,!1,m,!0)})),function(e,t,n,i,a){void 0===i&&(i=!1),void 0===a&&(a=!0),t||(m=n),v=f,y(e,t,n,i,a)}}(i,e,t);var a=function(e,t,n,i){var a,r=0,o=geByClass1("article_photo_carousel__controls",t),s=geByClass1("article_photo_carousel__counter",t),c=domData(s,"counter-lang")||getLang("global_article_carousel_counter"),l=getSize(geByClass1("article_figure_content",t)),u=geByClass1("article_photo_carousel_inner",t),d=geByClass1("article_photo_carousel__left",t),_=geByClass1("article_photo_carousel__right",t),f=n.onClick,p=!1;function h(n,i){if(!i||!p){if(p=!0,i)return u.style.transform="translateX(-50px)",void(a=setTimeout((function(){u.style.transform="translateX(0px)"}),700));clearTimeout(a),r=Math.min(e.length-1,Math.max(0,r+n)),u.style.transform="translateX(-"+r*l[0]+"px)",s.innerHTML=c.replace("{counter}",r+1).replace("{total}",e.length),toggle(d,r>0),toggle(_,r<e.length-1),domData(t,"photo-carousel-index",r),L(r,t)}}return _.addEventListener("click",(function(e){return h(1),f&&f(O),cancelEvent(e)})),d.addEventListener("click",(function(e){return h(-1),f&&f(S),cancelEvent(e)})),t.addEventListener("mousemove",(function(){o.style.opacity=1})),t.addEventListener("mouseleave",(function(){o.style.opacity=0})),h}(i,e,t);return window.data(e,"changePhotoFunction",a),a}}function L(e,t){var n=geByTag1("figcaption",t),i=[];n&&((i=domData(n,"captions"))&&(i=JSON.parse(i)),n.innerHTML=i[e]||"")}var B,R,N=n("lkNA"),F={};window._articleCarouselGlobalId=window._articleCarouselGlobalId||1;var H,U=function(){function e(e,t,n){var i=this;this._handleClick=function(e){if(e.target.href)try{var t=new URL(e.target.href);window.location.pathname===t.pathname&&t.search.match(/\?|&anchor=/)&&(e.preventDefault(),i.scrollToAnchor(null,t.search),window.history.replaceState({},document.title,""+t.pathname+t.search))}catch(e){console.error(e)}},this._article=e,this._options=t,this._readTO=null,this._scrollStatEvent=!1,this._openTime=0,this._els={view:ge("article_view_"+e.raw_id)},window.cur&&cur.destroy&&cur.destroy.push((function(){i.deinit()})),n&&this.ready()}var t=e.prototype;return t.getEl=function(){return this._els.view},t.getArticle=function(){return this._article},t.getScrollNode=function(){return this._options.getScrollNode?this._options.getScrollNode():document},t._getScrollTop=function(){return this._options.getScrollTop?this._options.getScrollTop():window.scrollNode?window.scrollNode.scrollTop:window.document.documentElement.scrollTop},t.getTimeSpent=function(){return Math.round((Date.now()-this._openTime)/1e3)},t.changeCarouselPosition=function(e,t,n,i){void 0===n&&(n=!1),void 0===i&&(i=!0);var a=F[e];Object(r.isFunction)(a)&&a(0,!1,t,n,i)},t.deinit=function(){this._scrollEvent&&(this.getScrollNode().removeEventListener("scroll",this._scrollEvent),this._scrollEvent=!1),this._scrollStatEvent&&(this.getScrollNode().removeEventListener("scroll",this._scrollStatEvent),this._scrollStatEvent=!1),document.removeEventListener("click",this._handleClick),clearTimeout(this._readTO)},t._onViewScroll=function(){var e=this,t=scrollGetY(),n=window.innerHeight;Object(r.each)(geByTag("figure",this._els.view),(function(i,a){var o=Object(r.intval)(domData(a,"done"));if(!o){var s=getH(a),c=getXY(a)[1],l=Object(r.intval)(domData(a,"type")),u=101==l?-200:100,d=c<=t+n-u&&t+u<=c+s;(o=e._onObjectView(d,l,a))&&domData(a,"done",1)}})),Object(r.each)(geByTag("figure",this._els.view),(function(i,a){var o,s=getH(a),c=getXY(a)[1],l=Object(r.intval)(domData(a,"type")),u=c,d=c+s,_=t,f=t+n;if(u>f||_>d)o=!1;else{var p=Math.max(u,_);o=(Math.min(d,f)-p)/s>.7}e._onObjectPartialView(o,l,a)}))},t._initObjects=function(){var e=this;this._initedObjects=this._initedObjects||{},Object(r.each)(geByClass("_article_unmute_button",this._els.view),(function(t,n){e._initedObjects[t]||(e._initedObjects[t]=!0,n.addEventListener("click",(function(){var e=n.parentNode,t=geByTag1("video",e);t.muted=!t.muted,toggleClass(e,"article_object_unmuted",!t.muted)})))})),Object(r.each)(geByTag("figure",this._els.view),(function(t,n){if(!e._initedObjects[t])switch(e._initedObjects[t]=!0,parseInt(domData(n,"type"))){case s:var i=x(n,{mobile:e._options.mobile,moderDeletePhoto:e._options.moderDeletePhoto,onClick:function(t){e.sendStats({type:t})}});if(e._initPhoto(n),i){var a=window._articleCarouselGlobalId++;n.setAttribute("data-carousel-id",a),F[a]=i}break;case u:case o:geByClass1("article_figure_content",n).addEventListener("click",(function(){e.sendStats({type:b})}),!0);break;case m:case v:break;case l:case c:if(e._options.mobile){var r=geByTag1("video",n);r&&(r.addEventListener("play",(function(){e.sendStats({type:A})})),r.addEventListener("pause",(function(){e.sendStats({type:A})})))}else{geByClass1("article_figure_content",n).addEventListener("click",(function(){e.sendStats({type:A})}),!0)}}})),this._els.view&&this._els.view.addEventListener("click",(function(t){var n=t.target;if(matchesSelector(n,'a[href^="/away"]')){var i=decodeURIComponent(unescape(n.href)).split("vk.com/away.php?to=")[1];i&&e.sendStats({type:y,domain:encodeURIComponent(e._getUrlDomain(i))})}}))},t._initPhoto=function(e){var t=this;geByClass1("article_figure_content",e).addEventListener("click",(function(){var n=domQuery1("[data-sizes]",e),i=JSON.parse(domData(n,"sizes")),a=Object(r.intval)(domData(e,"photo-carousel-index"));t._options.onImageOpen&&t._options.onImageOpen.call(t,i,e,a),t.sendStats({type:w})}))},t._initStats=function(){if(this._statsInited)this._scrollStatEvent&&this._scrollStatEvent();else{this._statsInited=!0,this._openTime=Date.now();var e,t=-1,n=[];this._scrollStatEvent&&this.getScrollNode().removeEventListener("scroll",this._scrollStatEvent),clearTimeout(this._readTO);var i=this;this.getScrollNode().addEventListener("scroll",this._scrollStatEvent=function(){var r=i.getCurrentScrollRatio();if(!(r<0)){var o=1;r>=.95?o=4:r>.66?o=3:r>.33&&(o=2),function(r){if(i._isReady&&(i._article.has_more&&(r=Math.min(r,1)),!(t>=r))){for(var o=t+1;o<=r;o++)n.push(o);if(t=r,clearTimeout(e),e=setTimeout(a,300),3==r&&i._article.ttr){var s=i._article.ttr-i.getTimeSpent();s>0&&(i._readTO=setTimeout((function(){if(!document.hidden){var e=i.getCurrentScrollRatio();if(!(e<0||e>1.3)){var r=4==t;n=[t=4],a(r)}}}),1e3*s))}}}(o),4!=o||i._article.has_more||(i.getScrollNode().removeEventListener("scroll",i._scrollStatEvent),i._scrollStatEvent=!1)}},{passive:!0}),this._scrollStatEvent&&this._scrollStatEvent()}function a(e){if(n.length){var t=i._article,a=i._options,o="";if(t.ref)o=t.ref;else if(window.cur){if("feed"===(o=window.cur.module)&&cur.articlePrevLoc&&!a.mobile)"search"===nav.fromStr(cur.articlePrevLoc).section&&(o="feed_search")}var s={act:"stats",scroll:n.join(","),spent:i.getTimeSpent(),hash:t.access_hash,article_owner_id:t.owner_id,article_id:t.id,is_web_view:a.isWebView?1:0,post_id:a.sourcePostId,is_widget:a.isWidget,is_delayed_scroll_4:Object(r.intval)(e),track_code:a.trackCode,ref:o};ajax.post(a.mobile?"article.php":"al_articles.php",s),t.mailru_stats_data&&n.forEach((function(e){M("scroll_"+e,t.mailru_stats_data)})),n=[]}}},t._initGoogleAnalytics=function(){var e=this._options.googleAnalyticsId;if(e)if(window.dataLayer=window.dataLayer||[],window.gtag)window.gtag("config",e,{page_location:window.location.href});else{var t=document.createElement("script");t.setAttribute("src","https://www.googletagmanager.com/gtag/js?id="+e),t.setAttribute("async","true"),document.head.appendChild(t),window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date),window.gtag("config",e)}},t._onObjectPartialView=function(e,t,n){var i=domQuery1("[data-sizes]",n),a=Boolean(Number(domData(i,"should-disable-carousel-animation")));if(t==s&&!a&&JSON.parse(domData(i,"sizes")).length>1){var r=n.getAttribute("data-carousel-id");e?R!=r&&(clearTimeout(B),B=setTimeout((function(){var e=F[r];e&&e(1,!0)}),400),R=r):r==R&&(R=-1,clearTimeout(B))}},t._onObjectView=function(e,t,n){var i=!1;switch(t){case s:if(e){var a=geByTag1("img",n),o=getW(a)||this._options.width,c=domQuery1("[data-sizes]",n),u=JSON.parse(domData(c,"sizes")),m=geByTag("img",n);u.forEach((function(e,t){var n=T(u[t],o,!0)[0];!function(e,t){if(!0===I[e])return t&&t(),!0;if(Array.isArray(I[e]))return I[e].push(t),!1;I[e]=[t];var n=new Image;n.onload=function(){var t=I[e];I[e]=!0,Object(r.each)(t,(function(e,t){t&&t()}))},n.src=e}(n,(function(){var e=m[t];removeClass(e,"article_object_photo__image_blur"),e.src=n}))})),i=!0}break;case l:if(!this._options.mobile){var v=geByTag1("video",n);if(v)if(e){if(v.hasAttribute("autoplay")){var g=v.play();g&&g.catch((function(){}))}}else v.pause();else i=!0}break;case d:case _:case f:case p:case h:this.initEmbed(t,n),i=!0}return i},t.initEmbed=function(e,t){var n=this;switch(e){case d:var i=domQuery1("[data-tweet-id]",t),a=domData(i,"tweet-id");Object(N.loadScript)("https://platform.twitter.com/widgets.js",{onLoad:function(){window.twttr.widgets.createTweet(a,i,{align:"center",lang:window.vk&&0==window.vk.lang?"ru":"en",dnt:!0})}});break;case _:var r=window.vk&&0==window.vk.lang?"ru_RU":"en_US";Object(N.loadScript)("https://connect.facebook.net/"+r+"/all.js#xfbml=1&amp;version=v2.8",{onLoad:function(){window.FB.XFBML.parse()}});break;case f:Object(N.loadScript)("https://www.instagram.com/embed.js",{onLoad:function(){window.instgrm.Embeds.process(),addEvent(window,"message",D)}});break;case p:var o=domQuery1("[data-raw-id]",t),s=domData(o,"raw-id"),c=domData(o,"index"),l=s.split(";"),u=l[0],m=l[1];Object(N.loadScript)("/js/api/openapi.js",{onLoad:function(){ajax.post("dev.php",{act:"a_get_post_hash",post:u+"_"+m},{onDone:function(e){e&&window.VK&&window.VK.Widgets&&window.VK.Widgets.Post("vk_post_"+s+"_"+c,u,m,e,{from:n._options.isWebView?"article_webview":""})}})}});break;case h:Object(N.loadScript)("https://telegram.org/js/telegram-widget.js?5",{})}},t.getCurrentScrollRatio=function(){var e=getH(this._els.view),t=getXY(this._els.view)[1]-getXY(this.getScrollNode().firstElementChild)[1];return(this._getScrollTop()+window.innerHeight-t)/e},t.getScreenVisibilityRatio=function(){var e=getH(this._els.view),t=getXY(this._els.view)[1]-getXY(this.getScrollNode().firstElementChild)[1],n=this._getScrollTop(),i=window.innerHeight,a=t,r=t+e,o=n,s=n+i;if(o>r||a>s)return 0;var c=Math.max(a,o);return(Math.min(r,s)-c)/i},t.update=function(){this._initObjects(),this._initStats(),this._options.onScroll&&this._options.onScroll.call(this,this.getCurrentScrollRatio())},t.ready=function(){var e=this;(this._isReady=!0,this._initObjects(),this._initStats(),this._initGoogleAnalytics(),setTimeout((function(){var t=P("anchor");if(t){e._options.isWebView||e.scrollToAnchor(t);var n=e.getScrollNode();n===document&&(n=document.scrollingElement||window.scrollNode||document.body),n.click&&n.click(),n.focus()}}),0),!this._options.mobile&&window.AudioPlaylist)&&(this._article.audios_list&&this._article.audios_list.length>0&&new AudioPlaylist(AudioPlaylist.TYPE_TEMP,this._article.owner_id,"article_"+this._article.id).mergeWith({list:this._article.audios_list}));this.getScrollNode().addEventListener("scroll",this._scrollEvent=function(){e._onViewScroll(),e._options.onScroll&&e._options.onScroll.call(e,e.getCurrentScrollRatio())}),document.addEventListener("click",this._handleClick),setTimeout((function(){e._scrollEvent()}),this._options.objectsInitDelay||0)},t.scrollToAnchor=function(e,t){e=e||P("anchor",t);var n=this._options,i=this.getScrollNode();i===document&&(i=document.scrollingElement||window.scrollNode||document.body);e&&function(){var t=document.getElementById(e);if(t){"scrollRestoration"in history&&(history.scrollRestoration="manual");var a=n.isWebView?0:25,r=t.parentNode.offsetTop-a;window.setTimeout((function(){i.scrollTo?i.scrollTo(0,r):i.scrollTop=r}),10)}}()},t.sendStats=function(e){var t=this._article,n=this._options,i={act:"stats",spent:this.getTimeSpent(),article_id:t.id,article_owner_id:t.owner_id,hash:t.access_hash,is_web_view:n.isWebView?1:0};Object.assign(i,e),ajax.post(n.mobile?"article.php":"al_articles.php",i)},t._getUrlDomain=function(e){var t=document.createElement("a");return t.href=e,t.hostname},e}(),V=[],W=!1,$=function(){function e(){}return e.init=function(e,t,n,i){if(void 0===n&&(n=0),void 0===i&&(i={}),W=i.mobile||i.isWebView,t&&e.ads&&!isEmpty(e.ads)&&!(e.has_more||isArray(e.ads)&&0==e.ads.length)){var a=ce("ins");addClass(a,"mrg-tag"),addClass(a,"article_adsblock"),i.mobile&&addClass(a,"article_adsblock_mobile"),setStyle(a,{display:"block","text-decoration":"none"});var r="";if(isObject(i.deviceInfo))for(var o in i.deviceInfo)i.deviceInfo.hasOwnProperty(o)&&(r+="&"+o+"="+i.deviceInfo[o]);for(var s in e.ads.data["ad-query"]=e.ads.data["ad-query"].replace("%device_info%",r),e.ads.data["ad-query"]+="&place="+n,e.ads.data)e.ads.data.hasOwnProperty(s)&&domData(a,s,""+e.ads.data[s]);t.appendChild(a),window.MRGtag||(window.MRGtag=[]);var c=i.isWebView?{iframeMode:!0}:{},l=e.ads.eventsHash;if(q(e,i,"requested",l),c.onNoAds=function(){q(e,i,"no_ads",l)},c.onAdsLoaded=function(){q(e,i,"ads_loaded",l)},c.onAdsClosed=function(){q(e,i,"ads_closed",l)},c.onAdsSuccess=function(){q(e,i,"ads_success",l)},c.onAdsClicked=function(){q(e,i,"ads_clicked",l)},c.onScriptError=function(){q(e,i,"script_error",l)},window.MRGtagOnAdsImpression=function(){q(e,i,"ads_impression",l)},window.MRGtag.push(c),!window.mailRuSdsScriptLoaded){var u=document.createElement("script");u.setAttribute("src",e.ads.script),u.setAttribute("async","true"),document.head.appendChild(u),window.mailRuSdsScriptLoaded=!0}}},e.wasShown=function(){return!1},e}();function q(e,t,n,i){V.push(n+"/"+e.owner_id+"_"+e.id+"/"+i),clearTimeout(H),H=setTimeout((function(){var e=W?"article.php":"al_articles.php";ajax.post(e,{act:"ads_event",events:V.join(","),is_web_view:intval(t.isWebView)}),V=[]}),200)}var z,Y,G,K,Q,X,J=n("aJgW");window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach);var Z,ee,te,ne=!1,ie=[],ae=[],re=1,oe=2,se={},le={};function ue(e,t){e=e.split("_");for(var n=0;n<t.length;n++){var i=t[n].split("_");if(i[0]==e[0]&&i[1]==e[1])return n}return-1}function de(){return document}function _e(){return(document.scrollingElement||window.scrollNode||document.body).scrollTop}function fe(e){return domQuery('.articleView__social_buttons[data-article-id="'+e+'"] .articleView__footer_btn_bookmark')}function pe(e){if(X!=e.raw_id)if(X=e.raw_id,Y.isWebView)!function(e){a.a.send("articleUpdate",{article:Oe(e),isSubscribedToOwner:e.is_subscribed_to_owner})}(e);else{var t=geByClass1("articleView__owner"),n=geByTag1("img",t);t&&n&&(n.src=e.owner_photo);var i=geByTag1("a",t);t&&i&&(i.href=e.owner_href);var o=geByClass1("articleView__ownerName"),s=geByTag1("a",o);o&&s&&(s.href=e.owner_href,s.innerHTML=e.owner_name);var c=geByClass1("articleView__footer"),l=geByClass1("articleView__footer_views");l&&(l.innerHTML=e.views_formatted);var u=geByClass1("articleView__social_buttons",c);c&&u&&!e.is_blog&&u.setAttribute("data-article-id",e.raw_id);var d=[domQuery1('.articleView__content_misc_block[data-article-id="'+e.raw_id+'"] .articleView__footer_btn_share'),c&&domQuery1(".articleView__footer_btn_share",c)];Object(r.each)(d,(function(t,n){n&&!e.is_blog&&(n.href="/like?act=publish&object=article"+e.raw_id+"&list="+e.access_hash)}));var _=fe(e.raw_id),f=JSON.stringify(e.mailru_stats_data);Object(r.each)(_,(function(t,n){n&&(n.setAttribute("onclick","Article.fave(this, '"+e.url+"', '"+e.fave_hash+"', "+f+", '"+e.raw_id+"')"),toggleClass(n,"_active",e.is_faved))}));var p=geByClass1("Unfold__item_name_noted");p&&(p.href="/feed?section=search&q=url:https://vk.com"+e.url);var h=geByClass1("Unfold__item_name_report");h&&(h.href="/reports?act=add&object=article"+e.raw_id+"_"+e.access_hash+"&refrom=feed")}}function he(e,t){void 0===t&&(t=!1),e.has_more||(ie=ie.concat(e.audios_list));var n=new U(e,{notFull:!!Y.preloadMoreHash,isWebView:Y.isWebView,mobile:!0,width:Y.width,getScrollTop:_e,getScrollNode:de,trackCode:Y.trackCode,onScroll:function(t){if(!e.has_more){var n=ae[ae.length-1],i=gpeByClass("articleView__content",n.getEl());t>.6&&e.next_article_url&&(ae.length<20&&(ve(e.next_article_url),addClass(i,"articleView_waitNextArticle")),function(){var e=ae[ae.length-1];if(e){var t=gpeByClass("articleView__content",e.getEl()),n=geByClass1("articleView__social_buttons",t);n&&show(n)}}()),t>.99&&e.next_article_url&&ae.length<20&&ve(e.next_article_url,(function(e,t){if(e){for(var n=0;n<ae.length;n++)if(ae[n].getArticle().raw_id==t.raw_id)return;te||(te=setTimeout((function(){var n=domCreate(e);Q.appendChild(n),removeClass(i,"articleView_waitNextArticle"),addClass(n,"articleView_nextPrepared"),requestAnimationFrame((function(){removeClass(n,"articleView_nextPrepared")})),he(t),te=null}),400))}})),this.getScreenVisibilityRatio()>.5&&pe(e)}},onImageOpen:function(e,t,i){if(Y.isWebView){for(var r=[],o=0;o<e.length;o++){var s=e[o],c=[];for(var l in s)s.hasOwnProperty(l)&&c.push({type:l,src:s[l][0],width:s[l][1],height:s[l][2]});r.push(c)}Z=t,ee=n,a.a.send("articlePhotoView",{photos:r,index:i})}}});if(t||n.ready(),ae.push(n),me(e),Object(r.each)(geByTag("video"),(function(e,t){domData(t,"auto-pause-inited")||(domData(t,"auto-pause-inited",1),t.addEventListener("play",(function(){Object(r.each)(geByTag("video"),(function(e,n){n!=t&&n.pause()}))})))})),Y.isWebView){Object(r.each)(geByTag("figure",n._els.view),(function(e,t){var i=Object(r.intval)(domData(t,"type"));n._onObjectView(!1,i,t)&&domData(t,"done",1)}));var i=document.getElementsByClassName("articleView__educationCloseButton")[0];i&&i.addEventListener("click",(function(e){var t=e.target,n=Object(r.intval)(domData(t,"article-id")),i=Object(r.intval)(domData(t,"course-id")),o=Object(r.intval)(domData(t,"step-id")),s=t.href;a.a.send("articleClose",{fallback_url:s,payload:{status:"read",data:{author_id:n,course_id:i,step_id:o}}}),e.preventDefault()}))}}function me(e){var t=gpeByClass("articleView__content",ge("article_view_"+e.raw_id)),n=geByClass1("articleView__ads_block",t);$.init(e,n,ae.length,Y)}function ve(e,t){var n=le[e];n!==oe?Object(r.isArray)(n)?t&&t(n[0],n[1]):(se[e]=se[e]||[],t&&se[e].push(t),n!=re&&(le[e]=re,ajax.post("article.php",{act:"view",url:e,scroll_load:1,wall_owner_id:Y.wallOwnerId,audio_bridge:Object(r.intval)(Y.audioBridge),can_infinite_scroll:Object(r.intval)(Y.canInfiniteScroll),web_view:Y.isWebView,context:Y.context,ref:"scroll",v:Y.clientVersion},{onDone:function(t,n){for(var i=se[e],a=0;a<i.length;a++)i[a](t,n);le[e]=[t,n]}}))):t&&t()}function Ae(e,t){var n=fe(e);Object(r.each)(n,(function(e,n){toggleClass(n,"_active",t)}))}function be(){var e=P("anchor");e&&function(){var t=document.getElementById(e);if(t){"scrollRestoration"in history&&(history.scrollRestoration="manual");var n=Y.isWebView?0:25,i=t.parentNode.offsetTop-n;window.setTimeout((function(){var e;e=i,(document.scrollingElement||window.scrollNode||document.body).scrollTop=e}),0)}}()}function we(e){if(void 0===e&&(e={}),ne)be();else{Y.deviceInfo=e.deviceInfo;var t=ae[0],n=t.getArticle();t.ready(),n.has_more?ajax.post("article.php",{act:"load_more",rev:n.rev,hash:n.has_more_hash,article_owner_id:n.owner_id,article_id:n.id,audio_bridge:Object(r.intval)(Y.audioBridge),no_lazy_images:Object(r.intval)(Y.noLazyImages),can_infinite_scroll:Object(r.intval)(Y.canInfiniteScroll),wall_owner_id:Y.wallOwnerId,context:Y.context,client_version:Y.clientVersion},{onFail:function(){Y.failTries>0&&(Y.failTries--,setTimeout((function(){we(e)}),2e3))},onDone:function(e,i){ne=!0,n.audios_list=i.audios_list,n.next_article_url=i.next_article_url,n.has_more=!1,n.audios_list&&n.audios_list.length&&(ie=ie.concat(n.audios_list));var a=domCreate(e),r=geByClass1("article_view",a),o=geByClass1("article_view");"figure"!==o.lastElementChild.tagName.toLowerCase()&&o.lastChild.remove();for(var s=o.children.length,c=r.children;s<c.length;)o.appendChild(c[s]);var l=geByClass1("article_preload_spinner");l&&l.parentNode.removeChild(l);var u=geByClass1("articleView__content_misc_block",a);o.parentNode.appendChild(u),function(){for(var e=geByClass1("article").children,t=0;t<e.length;t++){var n=t>0&&e[t-1],i=e[t],a=t+1<e.length&&e[t+1],r=n?n.tagName+"_"+domData(n,"type"):"",o=i?i.tagName+"_"+domData(i,"type"):"",s=a?a.tagName+"_"+domData(a,"type"):"",c=!1,l=!1,u=!1;r&&o==r||(c=!0),s&&o==s||(l=!0),(g.includes(+s.type)||s.sep)&&(u=!0),toggleClass(i,"article_decoration_first",c),toggleClass(i,"article_decoration_last",l),toggleClass(i,"article_decoration_before",u)}}(),me(n),be(),t.update()}}):ajax.post("article.php",{act:"next_url",access_hash:n.access_hash,article_owner_id:n.owner_id,article_id:n.id,wall_owner_id:Y.wallOwnerId,context:Y.context},{onDone:function(e){e&&(n.next_article_url=e,t.update())}});var i=t.getEl();e.paddingTop&&setStyle(i,"marginTop",Object(r.intval)(e.paddingTop)),e.paddingBottom&&setStyle(i,"marginBottom",Object(r.intval)(e.paddingBottom)),e.noDarkModeTransition&&addClass(i,"article_dark_no_transition")}}function ye(e){var t=null;return Object(r.each)(ae,(function(n,i){var a=i.getArticle();if(a.raw_id==e)return t=a,!1})),t}function Oe(e){var t="https://"+Y.devHost+"vk.com"+e.url,n={id:e.id,owner_id:e.owner_id,owner_name:e.owner_name,state:"available",can_report:e.can_report,title:e.title,subtitle:"",views:e.views,shares:e.shares,is_favorite:e.is_faved,url:t,view_url:t,access_key:e.access_hash,published_date:e.published_date,no_footer:e.no_footer};return e.owner_photo&&0!=e.owner_photo.indexOf("/images/")&&(n.owner_photo=e.owner_photo),n}function Se(e,t){void 0===t&&(t="");var n=ae[ae.length-1];if(t)for(var i=0;i<ae.length;i++)if(ae[i]._article.raw_id===t){n=ae[i];break}n.sendStats({type:e})}window.ArticleView=U,window.Article={init:function(e,t){if((Y=t).mobile=!0,Y.failTries=50,window.cur&&(window.cur.lang=window.cur.lang||{},extend(window.cur.lang,t.lang||{})),Q=geByClass1("articleView__content_list"),!Y.isWebView){var n,i=_e(),o=geByClass1("articleView__header"),s=geByClass1("articleView__footer"),c=geByClass1("articleView__layout");de().addEventListener("scroll",n=function(){var e=c.clientHeight,t=Math.max(0,_e()),n=t-i>0,a=t+window.innerHeight+20>e;toggleClass(o,"articleView__header--narrow",n),s&&toggleClass(s,"articleView__footer--hidden",!a&&n),i=t},{passive:!0});var l=geByClass1("articleView__close"),u=geByClass1("articleView__close_mini");l.addEventListener("click",Se.bind(window,E)),u.addEventListener("click",Se.bind(window,E)),window.cur&&cur.destroy.push((function(){document.removeEventListener("scroll",n),removeClass(document.body,"article_body_with_transition")})),Y.isStandalone&&(window.al=!1);var d=Object(r.intval)(c.classList.contains("article_dark")),_=document.querySelector(".basis");_&&J.colorScheme.applyScheme(_,d?J.ColorSchemeName.Dark:J.ColorSchemeName.Light)}if(Y.preloadMoreHash||show(geByClass1("article_layer_prev_next")),Y.isWebView){var f=geByClass1("article");addClass(f,"article_webview")}Y.isWebView&&Y.audioBridge&&(window.audioplayer={playPause:function(e,t){var n=gpeByClass("audio_item",e.target);if(G&&G!=n&&(removeClass(G,"ai_playing"),G=!1),K&&(removeClass(K,"article_object_audioplaylist_playing"),K=!1),hasClass(n,"ai_playing"))a.a.send("audioPause",{}),removeClass(n,"ai_playing");else{var i=ue(t,ie),r=ie;-1==i&&(r.unshift(t),i=0),a.a.send("audioPlay",{audioIds:r,pos:i}),addClass(n,"ai_playing"),G=n}return cancelEvent(e),!1}}),Y.isWebView?(a.a.send("articleReady"),window.addEventListener("VKWebAppEvent",(function(e){var t=e.detail||{};switch(t.type){case"articleOwnerSubscribed":var n=t.ownerId,i=t.isSubscribed;Object(r.each)(ae,(function(e,t){var a=t.getArticle();if(a.owner_id==n)return a.is_subscribed_to_owner=i,!1}));break;case"articleBookmarked":var a=t.articleOwnerId+"_"+t.articleId,o=ye(a);o&&(o.is_faved=t.isBookmarked);var s=fe(a);Object(r.each)(s,(function(e,n){toggleClass(n,"_active",!!t.isBookmarked)}));break;case"articleWebViewShow":we(t);break;case"articleWebViewClose":Se(E);break;case"didShareArticle":var c=t.articleRawId,l=t.shareType;if(!l)break;Se(l,c);break;case"articleMentionClick":var u=t.articleRawId;Se(k,u);break;case"articlePhotoCarouselPositionChanged":default:var d=t.index;if(void 0===d)return;ee&&Z&&ee.changeCarouselPosition(domData(Z,"carousel-id"),d,!0,!1)}})),he(e,!0)):he(e,!1)},fave:function(e,t,n,i,o){var s=!hasClass(e,"_active");ajax.post("article.php",{act:"fave",url:t,add:Object(r.intval)(s),hash:n}),ae.forEach((function(e){var n=e.getArticle();n.url==t&&(n.is_faved=s)})),M(s?"fave":"unfave",i),Ae(o,s),Y.isWebView?function(e){var t=ye(e);t&&(JSON.stringify({article:Oe(t)}),a.a.send("articleBookmarked",{article:Oe(t)}))}(o):Share&&Share.setBookmarkState(o,s)},toggleButton:Ae,share:function(e,t,n){return function(e){var t=ye(e),n=Y.clientVersion;if(t)if(n){var i={type:"article",data:Oe(t)};a.a.send("share",i)}else{var r={article:Oe(t)};a.a.send("articleShare",r)}}(t),!1},subscribe:function(e,t,n){ajax.post("article.php",{act:"subscribe",owner_id:t,hash:n},{onDone:function(t,n){toggleClass(e,"articleView__subscribed",t),e.innerHTML=n}})},toggleDarkMode:function(e){z||(z=setTimeout((function(){var t=geByClass1("articleView__layout");toggleClass(t,"article_dark",e),toggleClass(document.body,"article_dark",e);var n=Object(r.intval)(hasClass(t,"article_dark"));z=!1,void 0!==e||Y.isWebView||ajax.post("article.php",{act:"set_dark_mode",dark:n});var i=geByClass1("articleMenu");i&&Unfold.setTitle(i,"dark_mode",n?getLang("mobile_articles_menu_dark_disable"):getLang("mobile_articles_menu_dark")),Se(n?C:j);var a=document.querySelector(".basis");a&&!Y.isWebView&&J.colorScheme.applyScheme(a,n?J.ColorSchemeName.Dark:J.ColorSchemeName.Light)}),e?0:10))},onWebViewShow:we,sendStats:Se,audioPlayPlaylist:function(e,t,n){var i=gpeByClass("article_object_audioplaylist_webview",e);if(G&&(removeClass(G,"ai_playing"),G=!1),K){var r=K;if(removeClass(r,"article_object_audioplaylist_playing"),K=!1,r==i)return a.a.send("audioPause",{}),cancelEvent(n)}var o=ue(t,ie),s=ie;return-1==o&&(s.unshift(t),o=0),a.a.send("audioPlay",{audioIds:s,pos:o}),addClass(i,"article_object_audioplaylist_playing"),K=i,cancelEvent(n)},onAudioStateChanged:function(e,t){G&&(removeClass(G,"ai_playing"),G=!1),K&&(removeClass(K,"article_object_audioplaylist_playing"),K=!1),e=(e=e.split("_"))[0]+"_"+e[1];var n=ge("audio"+e);n&&toggleClass(n,"ai_playing","play"==t);for(var i=geByClass("_article_object_audioplaylist_webview"),a=0;a<i.length;a++){if((domData(i[a],"ids")||"").split(",").indexOf(e)>=0&&"play"==t){addClass(i[a],"article_object_audioplaylist_playing"),K=i[a];break}}}}},"0hva":function(e,t,n){"use strict";n.r(t),n.d(t,"initAlbumPage",(function(){return h}));var i=n("vOib"),a=n("1VZq"),r=n("z1UI"),o=n("O5lf"),s=n("z9sQ");var c,l,u,d,_=function(e){void 0===e&&(e={});var t=window.lang,n=e.title||"",c=e.description||"",l=e.pretag,u=e.buttons||{},d=(e.photos||[]).map((function(e){return Object(a.default)({photo:e})})),_=null;if(e.is_loading)_=Wd.wrap(Object(o.default)({mix:"al_loading",type:"pageLoader"}));else{if(!d.length)return Object(r.default)({separator:!0,more_text:e.add_url&&e.is_owner?t.mobile_photos_placeholder_album_action:null,more_type:"primary",more_url:e.add_url,text:t.mobile_photos_placeholder_album_text});_={inner:[d],class:"AlbumPage__photos photos_page",tag:"div"}}var f=s.default.class("AlbumPage",{withoutDescription:!c});return{inner:[Object(i.default)({inner:[{inner:[{inner:[n],class:"AlbumPage__title",tag:"h2"},c&&{inner:[c],class:"AlbumPage__description",tag:"span"}],class:"AlbumPage__info",tag:"div"},u.prev,_,u.more,l]})],class:f,tag:"div"}},f=n("OcsD"),p=n("UxAg");function h(){Object(p.$)(".AlbumPage")&&(c=!1,l=!1,u=!1,d=!1,Object(f.onBodyScroll)(m),Object(f.onBodyScroll)(!0))}function m(){if(c||(c=Object(p.$)(".AlbumPage__title"),l=Object(f.getH)(c)),u||(u=Object(p.$)(".header__title",Object(p.$)("#mhead"))),!u)return Object(f.onBodyScroll)("__clear",m);d||(d=Object(p.$)(".header__text",u));var e=Math.min(40,Math.max(0,Object(f.getY)(c)-l-Object(f.scrollTop)()));f.setStyle.transform(d,1,[0,e]),u.classList.toggle("header__title--initial-position",0===e)}var v=n("Cbap");v.default.getRouter().addRoute(/\/(?:album|tag)(-?\d+(?:_\d+)?)/,h),v.default.getRouter().addRoute(/\/(?:attachments\?act=choose_photo).*(?:album|tag)=(-?\d+(?:_\d+)?)/,h);t.default=_},"1By4":function(e,t,n){"use strict";n.r(t);var i=n("2mXy"),a=n("fdw3"),r=n("OcsD");t.default={html:_,render:function(e){if(O(e))return e;return _(e)},preactRender:i.render,createElement:i.createElement,wrap:function(e){return e?{__raw__:e}:null},handle:function(){var e=E(arguments[0]),t=Array.prototype.slice.call(arguments,1),n=e[0];if(!n)return;O(n)||console.warn('Invalid handler "'+n+'"');var i=M(window,n);if(!C(i))return void console.warn("`"+n+"` is not a function");return i.apply(null,e.slice(1).concat(t))},handle2:function(e,t){var n=Array.prototype.slice.call(arguments,2),i=e[0];if(!i)return;O(i)||console.warn('Invalid handler "'+i+'"');var a=M(window,i);if(!C(a))return void console.warn("`"+i+"` is not a function");for(var r=e.slice(1),o=0,s=r.length;o<s;o++)if("event"===r[o]){r[o]=t;break}a.apply(null,r.concat(n))},elem:function(e){return e?Object(r.ceFromString)(_(e)):""},preactElem:l,preact:d,hydrate:function(e,t,n){return Object(i.hydrate)(Object(i.createElement)(e,t),n)},class:h,style:m,getInternalData:function(){return{__is_wd_internal_data:!0}},innerItemToString:p,toFlatArray:I,prepareHandler:v,isAttrHandler:f,mountPreactComponent:function(e,t,n){if(!n)return;n.innerHTML="",Object(i.render)(Object(i.createElement)(e,t),n)},mountPreactTemplate:u,preactElemFromTemplate:function(e){return l((function(){return e}),{})}};var o=["tag","inner","attrs","innerHTML","outerHTML","_"],s=["area","base","br","col","command","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"],c=["abort","auxclick","beforecopy","beforecut","beforepaste","blur","cancel","canplay","canplaythrough","change","click","close","contextmenu","copy","cuechange","cut","dblclick","drag","dragend","dragenter","dragleave","dragover","dragstart","drop","durationchange","emptied","ended","error","focus","gotpointercapture","input","invalid","keydown","keypress","keyup","load","loadeddata","loadedmetadata","loadstart","lostpointercapture","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","mousewheel","paste","pause","play","playing","pointercancel","pointerdown","pointerenter","pointerleave","pointermove","pointerout","pointerover","pointerup","progress","ratechange","reset","resize","scroll","search","seeked","seeking","select","selectstart","stalled","submit","suspend","timeupdate","toggle","touchcancel","touchend","touchmove","touchstart","volumechange","waiting","wheel"].map((function(e){return"on"+e}));function l(e,t){var n=document.createElement("div");return u(e,t,n),n.children[0]}function u(e,t,n){Object(i.render)(d(e,t),n)}function d(e,t){return function e(t,n){return function(n){var o=C(t)?t(n):t;if(!o)return null;if("string"==typeof o||"number"==typeof o)return o;if(S(o))return o.map((function(t){return e(t)(t&&t.props)}));o.children=o.inner?S(o.inner)?o.inner:[o.inner]:null,delete o.inner,o.attrs=o.attrs||{},S(o.children)&&(o.children=Object(r.flatArray)(o.children),o.children=o.children.map((function(t){return t&&t.__raw__?Object(i.createElement)("div",{dangerouslySetInnerHTML:{__html:t.__raw__}}):e(t)(t&&t.props)})));var s=Object(r.flatArray)([o.class,o.className]).reduce((function(e,t){return t&&e.push.apply(e,t.split(" ").map((function(e){return e.trim()})).filter((function(e){return!!e}))),e}),[]),c=Object.assign({},o,{className:s.length?s.join(" "):null},o.attrs);return delete c.class,delete c.tag,delete c.attrs,Object.keys(c).forEach((function(e){var t=c[e];w(e)&&(c[e]=Object(a.preactCallback)(t),c["preacted-"+e.toLowerCase()]=!0),null!==t&&"object"==typeof t&&t.__raw__&&(c[e]=t.__raw__)})),Object(i.createElement)(o.tag||"div",c,o.children)}}((function(t){return e(t)}))(t)}function _(e){if(O(e))return e?{__raw__:e}:null;if(S(e))return e.map(_).join("");if(!k(e))throw"Invalid input, object is expected";if("outerHTML"in e){var t=e.outerHTML;if(O(t))return t;if(y(t))return t.toString();if(t)throw"Invalid outerHTML";return""}var n=function(e){if("tag"in e){var t=e.tag;if(O(t)&&/^[\w-]+$/.test(t))return t;throw"Invalid tag name"}if(j(e.href))return"a";return"div"}(e),i=function(e){if("innerHTML"in e){var t=e.innerHTML;if(O(t))return t;if(y(t))return t.toString();if(t)throw"Invalid innerHTML";return""}if("inner"in e)return I(e.inner).map(p).join("");return""}(e),a=function(e){var t="";k(e.attrs)&&Object.assign(e,e.attrs);var n={className:"class",htmlFor:"for"};for(var i in e)if(e.hasOwnProperty(i)&&(n[i]&&(i=n[i]),!b(i))){var a=e[i];"class"===i?a=h(a):f(i,a)?a=v(a):a&&(a=A(a)),"style"===i&&(a=m(a));var r=T(i);!0===a?t+=" "+r:y(a)?t+=" "+r+'="'+a+'"':O(a)?t+=" "+r+'="'+T(a)+'"':a&&(a=a.__raw__?a.__raw__:A(a))&&(t+=" "+r+'="'+a+'"')}O(e.attrs)&&(t+=" "+e.attrs.replace(/</g,"&lt;").replace(/>/g,"&gt;"));return t}(e);return function(e){return s.includes(e.toLowerCase())}(n)?"<"+n+a+" />":"<"+n+a+">"+i+"</"+n+">"}function f(e,t){return w(e)&&(S(t)||O(n=t)&&/^[\w.]+$/.test(n));var n}function p(e){return y(e)?e.toString():O(e)?T(e):k(e)?e.__raw__?e.__raw__:_(e):""}function h(e){return I(e).filter(j).join(" ").trim().replace(/\s+/g," ")}function m(e){return k(e)?Object.entries(e).map((function(e){var t=e[0],n=e[1];return(t=t.replace(/[A-Z]/g,(function(e){return"-"+e.toLowerCase()})))+":"+n})).join(";"):e}function v(e){var t=E(e);if(!t.length)return null;var n=t[0];return O(n)?n+"("+t.slice(1).map(g).join(", ")+")":e}function g(e){return y(e)||"this"===e||"event"===e||void 0===e?e:T(JSON.stringify(e),!0)}function A(e){return void 0===e&&(e=""),e="boolean"==typeof e||y(e)?e:O(e)?T(e,!0):k(e)?e.__raw__:T(JSON.stringify(e),!0)}function b(e){return o.includes(e)}function w(e){return c.includes(e.toLowerCase())}function y(e){return"number"==typeof e&&!isNaN(e)}function O(e){return"string"==typeof e}function S(e){return Array.isArray(e)}function k(e){return"[object Object]"===Object.prototype.toString.call(e)}function C(e){return"[object Function]"===Object.prototype.toString.call(e)}function j(e){return O(e)&&e}function E(e){return S(e)?e:[e]}function T(e,t){return void 0===e&&(e=""),t?e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):(e=e.replace(/&(?!(#\d{0,4};|quot;|lt;|gt;|amp;))/g,"&amp;",e)).replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function I(e){return S(e)?function e(t){var n=[];return t.forEach((function(t){S(t)?n=n.concat(e(t)):n.push(t)})),n}(e):[e]}function M(e,t){for(var n=t.split("."),i=n.length,a=e,r=0;r<i;r++)try{a=a[n[r]]}catch(e){return}return a}},"1KAK":function(e,t,n){"use strict";n.r(t);var i=n("MUpH"),a=n("bZ/P"),r=n("/Id8"),o=n("fdw3");function s(){var e=Object(i.default)(['\n    <div class="msg__newMsgsDivider">\n      <span class="msg__newMsgDividerText">',"</span>\n    </div>\n  "]);return s=function(){return e},e}function c(){var e=Object(i.default)(["\n    ","\n    ","\n  "]);return c=function(){return e},e}var l=function(e){var t=e.msgId,n=e.withDivider?function(){var e=window.lang;return a.default.html(s(),e.mobile_mail_new_msgs)}():"",i=store.mail,l=Object(o.isForwardedMessageId)(t)?i.forwards[t]:i.msgs[t];if(!l)return null;var u,d=l.authorId,_=i.members[d],f=l.peerId,p=i.peers[f];if(!e.detailed){var h=store.mail.presend,m=(h=h&&h.msgs)&&h["edit"+t];m&&(l=m)}p&&(p.isIncomingMR||p.isRejectedMR)&&(n="");if(l.isService)u=Object(r.default)({id:t,text:l.service,service:!0,unread:l.isUnread});else{var v=Object(r.Msg__authorName)(_,f,i.cur.userId),g={id:t,text:l.text,important:l.isImportant,unread:l.isUnread,authorId:d,authorPhoto:_.avatar,authorName:v,authorUrl:_.url,date:l.date,removed:i.cur.msgRemoved[t],admin:l.adminName?{name:l.adminName,url:l.adminUrl}:null,edited:l.edited,channel:p.isChannel&&p.ownerId!==i.cur.viewerId,attaches:l.attaches,attachesHTML:l.attachesHTML,attachesLoading:l.attachesLoading,forwards:l.forwards,reply:l.reply,pending:l.pending,waiting:l.waiting,failed:l.failed,sendId:l.sendId,sticker:l.sticker,keyboard:l.keyboard,maxDepth:e.detailed?i.cur.maxDetailedMsgDepth:i.cur.maxMsgDepth,ttl:l.ttl,ts:l.ts,isExpired:l.isExpired,template:l.template,isDefaultCasperTimerShown:!p.isCasper,isPinned:e.isPinned,chatId:e.chatId};u=e.detailed?Object(r.Msg_detailed)(g):Object(r.default)(g)}return a.default.html(c(),n,u)};t.default=l;window.uMsg=l},"1UEa":function(e,t,n){"use strict";n.r(t),n.d(t,"NarrativeAnalyticEventType",(function(){return i})),n.d(t,"NarrativeAnalyticNavScreen",(function(){return a})),n.d(t,"sendNarrativeAnalytic",(function(){return s}));var i,a,r=n("DM2o"),o=n("W9Tc");function s(e,t,n,i){void 0===t&&(t=0),void 0===n&&(n=0),void 0===i&&(i=a.other);var s={event_type:e,narrative_id:n,narrative_owner_id:t,nav_screen:i};Object(r.statlogsValueEvent)("narrative_product_analytic",s),Object(o.partConfigEnabled)("narratives_web_analytic_debug")&&console.log("-- narrative analytic",s)}!function(e){e.clickToAddToNarrative="click_to_add_to_narrative",e.addStoryToNarrative="add_story_to_narrative",e.openNarrativeList="open_narrative_list",e.close="close",e.changeSort="change_sort",e.publishNarrative="publish_narrative",e.createNarrative="create_narrative",e.deleteNarrative="delete_narrative",e.editNarrative="edit_narrative",e.addToBookmarks="add_to_bookmarks",e.shareNarrative="share_narrative",e.seeMore="see_more",e.addToNarrativeFromActionSheet="add_to_narrative_from_action_sheet"}(i||(i={})),function(e){e.storyArchive="story_archive",e.storyViewer="story_viewer",e.profile="profile",e.club="club",e.other="other"}(a||(a={}))},"1VZq":function(e,t,n){"use strict";n.r(t);var i=n("Y6JH"),a=n("z9sQ"),r=n("HaOv"),o=n("xTMR");var s=function(e){var t,n=e.photo,s=n.restriction;if(s&&"block"===s.type)t={inner:[{inner:[Object(i.default)({icon:Object(r.getDoNotDisturbOutline56Icon)()})],class:"PhotosPhotoItem__restriction",tag:"div"}],class:"_image PhotosPhotoItem__photo",tag:"div"};else{var c=["_image",a.default.class("PhotosPhotoItem__photo",{blur:s&&"blur"===s.type})];t={inner:[s&&s.type?{inner:[Object(i.default)({icon:Object(o.getHideOutline56Icon)()})],class:"PhotosPhotoItem__restriction",tag:"div"}:null],style:"background-image: url("+n.src+")",attrs:n.attrs,class:c,tag:"div"}}return{inner:[t],href:n.href,class:"PhotosPhotoItem "+n.class,onclick:n.onclick,tag:"a"}};t.default=s},"29dZ":function(e,t,n){"use strict";n.r(t);var i=n("UvyM"),a=n("myok");n.d(t,"setDisabled",(function(){return a.setDisabled})),n.d(t,"setLoading",(function(){return a.setLoading})),Object.assign(i.default,a.default),window.Btn=i.default,t.default=i.default},"2IoG":function(e,t,n){"use strict";n.r(t);var i=n("MUpH"),a=n("bZ/P");function r(){var e=Object(i.default)(["\n    <",' class="','" '," ",">\n      ","\n    </",">\n  "]);return r=function(){return e},e}t.default=function(e){void 0===e&&(e={});var t,n,i=a.default.list(e.inner);e.url?(t="a",n=a.default.attr("href",e.url)):(t=e.tag||"div",n="");return a.default.html(r(),t,e.mix,n,e.attrs,i,t)}},"3pHe":function(e,t,n){"use strict";n.r(t),n.d(t,"Messenger",(function(){return fe}));var i={};n.r(i),n.d(i,"showCaptcha",(function(){return qe})),n.d(i,"renderBody",(function(){return ze}));var a=n("MUpH"),r=n("bZ/P"),o=n("z9sQ"),s=n("TYsd"),c=n("Mc5h"),l=(n("9y81"),n("O5lf")),u=n("AgBx"),d=n("QBkA"),_=n("rKp0"),f=n("u33z"),p=n("PUg3"),h=n("CkGd"),m=n("drfJ"),v=n("+cqQ"),g=n("DkIl");var A,b=n("k9Tg");function w(e){return!!e.settings.show_only_not_muted_messages}function y(){var e=window.store.mail.cur;return e?w(e)?e.unreadCounters.countNotMuted:e.unreadCounters.count:0}function O(e,t){void 0===t&&(t=!1),function(e,t){var n=window.store.mail.cur;n&&((void 0!==t?t:w(n))&&(n.unreadCounters.countNotMuted=e),n.unreadCounters.count=e)}(Math.max(0,y()+e),!t)}function S(){store.mail&&store.mail.cur&&(store.mail.cur.peerId&&k())}function k(){var e=store.mail.cur;(e?e.peerId:null)?A=setTimeout((function(){E(),k()}),3e4):C()}function C(){A&&clearTimeout(A)}function j(){$$(".mailHat").forEach((function(e){return e.outerHTML=Object(m.default)()}))}function E(){var e=window.lang,t=store.mail,n=t.cur,i=t.peers,a=n?n.peerId:null;if(a){var r=i[a];if(r.lastActionTime&&!r.isOnline){var o=n.timeShift,s=function(e,t){var n=window.lang,i="";e+=t;var a=parseInt(Date.now()/1e3)-e;if(a>7776e3)return"";if(a<60)i=n.mobile_profile_status_just_now;else if(a<3600){var r=intval(a/60);i=langWordNumeric(r,n.mobile_profile_status_word_mins_ago,n.mobile_profile_status_mins_ago)}else if(a<14400){var o=intval(a/3600);i=langWordNumeric(o,n.mobile_profile_status_word_hours_ago,n.mobile_profile_status_hours_ago)}else i=function(e){var t=1e3*e,n=new Date(t),i=new Date,a=window.lang;return n.getFullYear()!=i.getFullYear()&&n.getTime()<i.getTime()-1728e5||Math.abs(n.getTime()-i.getTime())>157248e5?langDate(t,a.mobile_mail_date,0,a.months_sm_of,!1):langDate(t,a.mobile_mail_short_date_time,0,a.months_sm_of,!1)}(e);return i}(r.lastActionTime,o);r.offlineText=s?langSex(r.sex,e.mobile_mail_last_activity_tip).replace("{time}",s):""}else r.canSeeOnline||(r.offlineText=function(e,t){var n;switch(e){case"recently":n=getLang("global_online_was_recently","raw");break;case"last_week":n=getLang("global_online_was_week","raw");break;case"last_month":n=getLang("global_online_this_month","raw");break;case"long_ago":n=getLang("global_online_long_ago","raw");break;default:return""}return langSex(t,n)}(r.onlineStatus,r.sex));j()}}Object.assign(m.default,{onUnreadClick:Object(v.default)(),onBackClick:Object(v.default)(),onBackToDialogClick:Object(v.default)(),onCancelEditing:Object(v.default)(),setModifiers:g.MailHat_convo.setModifiers,redrawCounter:function(){var e=y();if(!nav.getQuery("community")){var t=geBySel1(".mmi_mail .mm_counter2");t&&(e>0?(t.innerText=e,attr(t,"style","display: inline")):hide(t))}navigator.setAppBadge&&navigator.setAppBadge(Math.max(0,Math.min(9999,e||0)));Tabbar.setCounter(Tabbar.TAB_ID_MESSAGES,e)},redrawOnline:E,redrawActions:function(){var e=store.mail.cur.peerId,t=Object(b.MailHat__actions)(Object(m.uMailHat_getPeerActions)(e));$$(".mailHat__actions").forEach((function(e){return e.outerHTML=t}))},redraw:j,startStatusUpdate:k,cancelStatusUpdate:C}),g.MailHat_main.onUnreadClick(m.default.onUnreadClick),g.MailHat_main.onBurgerClick(menu.open),g.MailHat_main.onCancelForwardTap(m.default.onBackToDialogClick),g.MailHat_convo.onBackTap(m.default.onBackClick),g.MailHat_convo.onCancelEditingTap(m.default.onCancelEditing),uVK.onReady(S);var T=m.default;window.uMailHat=m.default;var I=n("29dZ"),M=function(e){var t=window.lang;return s.default.html({class:"MessageRequestBox",inner:[{class:"MessageRequestBox__info",inner:t.mobile_mail_mrs_confirm_info},{class:"MessageRequestBox__buttons",inner:[Object(I.default)({theme:"negative",size:"normal",type:"button",inner:t.mobile_mail_mrs_button_reject,attrs:q.onClick("MessageRequestBox.reject","event","this",e)}),Object(I.default)({theme:"secondary",size:"normal",type:"button",inner:t.mobile_mail_mrs_button_accept,attrs:q.onClick("MessageRequestBox.accept","event","this",e)})]}]})};Object.assign(M,{accept:function(e,t,n){I.default.setLoading(t,!0),ajaxRequest("/mail",{act:"mrs_accept",peer_id:n,hash:store.mail.hash.mrs},(function(e){e.error&&I.default.setLoading(t,!1)}),(function(){I.default.setLoading(t,!1)}))},reject:function(e,t,n){I.default.setLoading(t,!0),ajaxRequest("/mail",{act:"mrs_reject",peer_id:n,hash:store.mail.hash.mrs},(function(e){e.error&&I.default.setLoading(t,!1)}),(function(){I.default.setLoading(t,!1)}))}});var P=M;var D=P;window.MessageRequestBox=P;var x=n("Y6JH"),L=n("fdw3"),B=n("k0dR"),R=function(e){var t=e.tagsData,n=[];e.tags&&t.peerTags&&(n=e.tags.filter((function(e){return t.peerTags.indexOf(e.id)>-1})));var i=N({fromAd:t.fromAd,peerTags:n,urls:e.data.urls}),a=H(e.data),r=(c=e.data,l=c.likesCount||c.repliesCount,{inner:[{inner:[Object(L.getLang)("mobile_mail_peer_profile_activity_label")],class:"PeerProfile__blockLabel",tag:"div"},{inner:[l?[c.likesCount?{inner:[c.likesCount],class:"PeerProfile__blockItem",tag:"span"}:"",c.repliesCount?{inner:[c.repliesCount],class:"PeerProfile__blockItem",tag:"span"}:""]:{inner:[Object(L.getLang)("mobile_mail_peer_profile_info_empty")],tag:"span"}],class:"PeerProfile__blockContent",tag:"div"}],class:"PeerProfile__block",tag:"div"}),o=function(e){return{inner:[{inner:[Object(L.getLang)("mobile_mail_peer_profile_note_label")],class:"PeerProfile__blockLabel",tag:"div"},{inner:[e.note?{inner:[e.note],tag:"span"}:"",{inner:[Object(L.getLang)(e.note?"mobile_mail_peer_profile_edit_note_link":"mobile_mail_peer_profile_add_note_link")],href:e.urls.editNote,class:e.note?"PeerProfile__editNoteLink":"PeerProfile__blockLink",tag:"a"}],class:"PeerProfile__blockContent",tag:"div"}],class:"PeerProfile__block",tag:"div"}}(e.data),s=U(e.data);var c,l;return[i,a,r,o,s]};function N(e){for(var t=e.fromAd?1:0,n=3-t,i=[],a=e.fromAd?{inner:[Object(x.default)({icon:Object(B.getAdTag10Icon)()}),{inner:[Object(L.getLang)("mobile_mail_ad_tag_no_access_text")],tag:"span"}],class:"PeerProfile__adTag",tag:"div"}:"",r=e.peerTags,o=0,s=0;s<r.length;s++)e.fromMessenger&&s>=n?o++:i.push(r[s]);var c=window.lang,l=i.length+t;return{inner:[{inner:[Object(L.getLang)("mobile_mail_peer_profile_tags_label")],class:"PeerProfile__blockLabel",tag:"div"},l>0?{inner:[a,F(i),o>0?{inner:["+"+langNumeric(o,c.mobile_mail_peer_profile_extra_tags)],href:e.urls.showPeerProfile,class:"PeerProfile__extraTag",tag:"a"}:"",e.fromMessenger?"":{inner:[Object(L.getLang)("mobile_mail_peer_profile_edit_tags_link")],href:e.urls.toggleTags,class:"PeerProfile__editTag",tag:"a"}],class:"PeerProfile__blockContent PeerProfile__tagsList",tag:"div"}:{inner:[{inner:[Object(L.getLang)("mobile_mail_peer_profile_add_tags_link")],href:e.urls.toggleTags,tag:"a"}],class:"PeerProfile__blockContent",tag:"div"}],class:"PeerProfile__block",tag:"div"}}function F(e){return[e.map((function(e){return{inner:[e.name],class:"PeerProfile__peerTag",style:"background-color: "+e.color,tag:"div"}}))]}function H(e){var t=e.city||e.age;return{inner:[{inner:[Object(L.getLang)("mobile_mail_peer_profile_info_label")],class:"PeerProfile__blockLabel",tag:"div"},{inner:[t?[e.city?{inner:[e.city],class:"PeerProfile__blockItem",tag:"span"}:"",e.age?{inner:[e.age],class:"PeerProfile__blockItem",tag:"span"}:""]:{inner:[Object(L.getLang)("mobile_mail_peer_profile_info_empty")],tag:"span"}],class:"PeerProfile__blockContent",tag:"div"}],class:"PeerProfile__block",tag:"div"}}function U(e){return{inner:[{inner:[Object(L.getLang)("mobile_mail_peer_profile_join_date_label")],class:"PeerProfile__blockLabel",tag:"div"},{inner:[e.joinDate?e.joinDate:Object(L.getLang)("mobile_mail_peer_profile_join_date_empty_text")],class:"PeerProfile__blockContent",tag:"div"}],class:"PeerProfile__block",tag:"div"}}n("wCFN");var V=n("UxAg"),W=n("OcsD"),z=n("p5n7"),Y=n("7ADY");function G(e){var t=e.index+"_";return{inner:[Object(z.default)({name:"tags["+t+"id]",type:"hidden",value:e.id}),Object(z.default)({name:"tags["+t+"state]",type:"hidden",value:e.state||"",class:"PeerProfileManageTags__stateLabel"}),Object(z.default)({name:"tags["+t+"color]",type:"hidden",value:e.color,class:"PeerProfileManageTags__colorLabel"}),Object(z.default)({name:"tags["+t+"name]",class:"PeerProfileManageTags__label",placeholder:Object(L.getLang)("mobile_mail_peer_profile_manage_tags_placeholder"),value:e.name,maxlength:20,on_change:["PeerProfile.onTagNameChange","this"]}),{class:"PeerProfileManageTags__color",style:"background-color: "+e.color,tag:"span"},{inner:[Object(x.default)({icon:Object(Y.getCancel24Icon)()})],class:"PeerProfileManageTags__remove",onClick:["PeerProfile.onRemoveTagClick","this"],tag:"div"}],class:"PeerProfileManageTags__field",tag:"div"}}Object.assign(R,{onMessengerBlockClick:function(e,t){if(Object(W.gpeByClass)("PeerProfile__adTag",e.target))return;nav.go(t)},toggleTag:function(e,t,n,i){ajaxRequest("/mail",{act:"toggle_peer_profile_tag",tag_id:e,action:i.checked?"bind":"unbind",peer_id:t,hash:n})},onAddTagClick:function(e){var t=e.$btn,n=t.parentElement,i=Object(V.$$)(X,n),a=Object(V.$$)("."+ne(),n);if(i.length-a.length>=20)return;var r=s.default.elem(G({id:"",name:"",color:Z(n),state:"new",index:i.length}));n.insertBefore(r,t),te()},onRemoveTagClick:function(e){var t=e.parentElement,n=Object(V.$)(".PeerProfileManageTags__stateLabel",t),i=Object(V.$)(".TextInput__native",n);"new"===i.value?t.remove():(Object(W.addClass)(ne(),t),i.value="deleted",ee());te()},onTagNameChange:function(e){var t=e.closest(".PeerProfileManageTags__field"),n=Object(V.$)(".PeerProfileManageTags__stateLabel",t),i=Object(V.$)(".TextInput__native",n);"new"!==i.value&&(i.value="changed");ee()}});var K=["#4bb34b","#5c9ce6","#e64646","#792ec0","#63b9ba","#ffa000","#ffc107","#76787a","#9e8d6b","#45678f","#539b9c","#454647","#7a6c4f","#6bc76b","#5181b8","#ff5c5c","#a162de","#7ececf","#aaaeb3","#bbaa84"],Q="PeerProfileManageTags__field",X="."+Q,J="PeerProfileManageTags__addLink";function Z(e){var t=Object(V.$$)(X,e),n=Array.from(t).reduce((function(e,t){var n=Object(V.$)(".PeerProfileManageTags__stateLabel",t);if("deleted"!==Object(V.$)(".TextInput__native",n).value){var i=Object(V.$)(".PeerProfileManageTags__colorLabel",t);e[Object(V.$)(".TextInput__native",i).value]=!0}return e}),{});return K.find((function(e){return!n[e]}))}function ee(){var e=Object(V.$)(".HeaderBtn"),t=o.default.class("HeaderBtn",{hidden:!0}).replace("HeaderBtn ","");Object(W.removeClass)(t,e)}function te(){var e=Object(V.$)(".PeerProfileManageTags__addLink"),t=e.parentElement,n=Object(V.$$)(X,t),i=Object(V.$$)("."+ne(),t),a=n.length-i.length,r=o.default.class(J,{hidden:!0}).replace(J+" ","");Object(W.toggleClass)(r,e,a>=20)}function ne(){return o.default.class(Q,{removed:!0}).replace(Q+" ","")}window.PeerProfile=R;var ie=n("l4rn");function ae(){var e=Object(a.default)(['\n    <a href="/mail?act=mrs" class="messenger__mrsHintBox _touched">\n      ',"\n    </a>\n  "]);return ae=function(){return e},e}function re(){var e=Object(a.default)(["\n    ",'\n    <div class="messenger__banner_content">\n      <div class="messenger__banner_text" ',">\n        ",'\n      </div>\n      <div class="messenger__banner_buttons">\n        ',"\n      </div>\n    </div>\n    ","\n  "]);return re=function(){return e},e}function oe(){var e=Object(a.default)(['\n      <div class="messenger__banner_icon">\n        <img class="messenger__banner_icon_img" src="','">\n      </div>\n    ']);return oe=function(){return e},e}function se(){var e=Object(a.default)(['\n    <div class="messenger__spinner">\n      ',"\n    </div>\n  "]);return se=function(){return e},e}function ce(){var e=Object(a.default)(['\n    <div class="messenger__header">\n      ',"\n    </div>\n    ","\n  "]);return ce=function(){return e},e}function le(){var e=Object(a.default)(['\n    <div class="messenger__convoListNotice">\n      ',"\n    </div>\n  "]);return le=function(){return e},e}function ue(){var e=Object(a.default)(['\n    <div class="messenger__header">\n      ','\n    </div>\n    <div class="messenger__content">\n      <div class="','">','</div>\n      <div class="messenger__pinned">','</div>\n      <div class="messenger__peerProfile">',"</div>\n      ",'\n      <div class="','">\n        <div class="messenger__mrbox">','</div>\n        <div class="messenger__write">','</div>\n        <div class="messenger__acts">',"</div>\n      </div>\n    </div>\n  "]);return ue=function(){return e},e}function de(){var e=Object(a.default)(['\n    <div class="','">\n      <div class="messenger__layer messenger__layer_main">\n        <div class="messenger__header">','</div>\n        <div class="messenger__content">\n          ','\n        </div>\n      </div>\n      <div class="messenger__layer messenger__layer_convo">\n        ','\n      </div>\n      <div class="messenger__layer messenger__layer_page">','</div>\n      <div class="messenger__dialog"></div>\n    </div>\n  ']);return de=function(){return e},e}var _e=function(e){void 0===e&&(e={});var t=store.mail.cur,n=t.query,i=Object(_.default)({scrap:"folder"}),a=Object(_.default)({scrap:"search"}),r=e.page,o="all"!==t.folder||t.query||t.forwardFromId?0:t.countMR;return fe({mix:be(),mailHat:T(),convo:pe(),page:r,mrs:o,query:n,createChatUrl:"/mail?act=new_chat",scrapFolder:i,scrapSearch:a})};function fe(e){var t=window.lang.mobile_mail_search_only_messages,n=Object(d.default)({query:e.query,createUrl:e.createChatUrl}),i=e.mrs?ye(e.mrs):"",a=r.default.onClick("Messenger._onSearchMsgsClick"),o=Object(u.default)({mix:"messenger__body",attrs:r.default.onScroll("Messenger._onMainScroll","this"),inner:[Object(c.default)({mix:"messenger__filter",inner:n}),Object(c.default)({mix:r.default.class("messenger__mrsHint",{hidden:!e.mrs}),inner:i}),Object(c.default)({mix:"messenger__searchMsgs",attrs:a,inner:t}),Object(c.default)({mix:"messenger__loadable",inner:[Object(c.default)({mix:"messenger__folderList",inner:e.scrapFolder}),Object(c.default)({mix:"messenger__searchList",inner:e.scrapSearch}),he()]})]});return r.default.html(de(),e.mix,e.mailHat,o,e.convo,e.page)}function pe(){var e=store.mail,t=e.cur,n=e.peers[t.peerId],i=T(),a=me(),o=ve(),s=Object(p.default)(),l=n&&n.canPin,d=Object(h.default)({canPin:l,isChannel:n.isChannel}),f=n.isCasper,m=Object(_.default)({scrap:"peer",isCasper:f}),v=n.isIncomingMR?D(t.peerId):"",g=n.isRejectedMR?function(){var e=window.lang;return r.default.html(le(),e.mobile_mail_mrs_rejected_info)}():"",A=t.peerId>0&&t.peerId<2e9,b=e.flags.isPeerProfileEnabled&&A?Oe({tags:e.peerProfileTags,tagsData:n.peerProfileTagsData,data:n.peerProfileData}):"",w=Object(u.default)({mix:"messenger__body",attrs:r.default.onScroll("Messenger._onConvoScroll","this"),inner:[Object(c.default)({mix:"messenger__spacer"}),Object(c.default)({mix:"messenger__convoList",inner:[m,g]}),he()]}),y="messenger__banner";o&&(y+=" messenger__bannerVisible");var O=r.default.class("messenger__footer",{actionsOpen:we(),isIncomingMR:n.isIncomingMR});return r.default.html(ue(),i,y,o,a,b,w,O,v,s,d)}function he(){var e=Object(l.default)({mix:""});return r.default.html(se(),e)}function me(){var e=store.mail,t=e.cur.peerId;return t&&e.peers[t].pinnedMsg}function ve(){var e=store.mail,t=e.cur.peerId,n=t&&e.peers[t],i=n&&n.banner;if(Object(L.isSAKIntegration)()||!i)return"";var a="";i.icon&&(a=r.default.html(oe(),i.icon));for(var o=i.buttons,s=o.length,c=[],l=0;l<s;l++)c.push(Ae(o[l],l));c=r.default.list(c);var u=Object(f.default)({class:"messenger__banner_close",onClick:r.default.onClick("uMessenger.onBannerButtonClick","event")}),d=r.default.onClick("uMessenger.onBannerTextClick","event");return r.default.html(re(),a,d,i.text,c,u)}function Ae(e,t){var n={};"secondary"===e.layout?n.secondary=!0:"tertiary"===e.layout?n.tertiary=!0:n.primary=!0;var i,a=r.default.class("messenger__banner_button",n),o=e.type;return"gifts_link"===e.type&&(o="link",i="_self"),Object(f.default)({class:a,text:e.text,type:"link"===o?"link":"button",link:"link"===o?{href:e.link,target:i}:null,onClick:r.default.onClick("uMessenger.onBannerButtonClick","event",t)})}function be(){var e,t,n=store.mail.cur;t=n.page?"view_page":n.peerId?"view_dialog":n.query&&"msgs"===n.tab?"view_searchMsgs":n.query?"view_searchPeers":"folder_"+n.folder;var i=n.peerId?store.mail.peers[n.peerId]:null;return r.default.class("e","messenger",{isIncomingMR:!!i&&i.isIncomingMR,isRejectedMR:!!i&&i.isRejectedMR},"uMessenger",((e={})[t]=!0,e.community=!!n.groupId,e))}function we(){var e=store.mail.cur.msgSelected;return Object.keys(e).length>0}function ye(e){var t=window.lang,n=langNumeric(e,t.mobile_mail_mrs_request_count);return r.default.html(ae(),n)}function Oe(e){var t=e.tags,n=e.tagsData,i=e.data;if(!i)return"";var a=[];t&&n.peerTags&&(a=t.filter((function(e){return n.peerTags.indexOf(e.id)>-1})));var r,c=a.length;return r=n.fromAd||c?N({fromAd:n.fromAd,peerTags:a,fromMessenger:!0,urls:e.data.urls}):i.city||i.age?H(i):U(i),s.default.html({class:"PeerProfile__wrapper",inner:[{class:o.default.class("PeerProfile",{messenger:!0}),inner:r},{class:"PeerProfile__link",inner:Object(x.default)(Object(ie.getChevronCompactRight24Icon)())}],onClick:["PeerProfile.onMessengerBlockClick","event",i.urls.showPeerProfile]})}var Se=n("jk6M"),ke=n("Qz23"),Ce=n("rudk");function je(){Object(ke.cleanScrollView)(fe.getConvoBody()),removeEvent(fe.getConvoBody(),"touchstart",Ee,{passive:!0})}function Ee(e){var t=e.target.closest(".msg__sticker");t&&Msg.onStickerTouchStart(e,t),(t||e.target.closest(".msg"))&&Msg._onTouchStart()}function Te(e,t){$$(".messenger__layer_"+e).forEach((function(e){e.classList.toggle("messenger__layer_loading",t)}))}function Ie(e){return $(".messenger__layer_"+e+" .messenger__body")}function Me(e){fe.onMainScroll(e)}function Pe(e){fe.onConvoScroll(e),e._isScrolling=!0,function(e){void 0===e&&(e=null);return!window._preventedCheckTop&&(e&&function(e){return e.scrollHeight&&e.scrollTop<=2.5*window.innerHeight}(e))}(e)&&fe.onConvoAtTop(),function(e){void 0===e&&(e=null);return e&&function(e){return e.scrollHeight&&e.scrollHeight-e.scrollTop-e.offsetHeight<=1.5*window.innerHeight}(e)}(e)&&fe.onConvoAtBottom(),e._scrollingTimer&&clearTimeout(e._scrollingTimer),e._scrollingTimer=setTimeout((function(){e._isScrolling=!1}),100)}function De(){var e,t;if(null==(e=window.Speech)||null==(t=e.recorder)?void 0:t.isRecording)setTimeout(De,2e3);else{var n,i,a=fe.getConvoBody();if(a)a.prevHeight&&a.prevHeight!==a.offsetHeight&&(n=a,i=a.scrollBottom,n.scrollTop=n.scrollHeight-n.offsetHeight-i),a.prevHeight=a.offsetHeight,a.scrollBottom=function(e){return e.scrollHeight-e.scrollTop-e.offsetHeight}(a),xe&&requestAnimationFrame(De)}}Object.assign(fe,{scrollMainBodyToTop:function(){$(".messenger__layer_main .messenger__body").scrollTop=0},onMainScroll:Object(v.default)("scrollElem"),onQueryChange:d.default.onChange,onQueryClear:d.default.onClear,onSearchMsgsClick:Object(v.default)(),setQuery:d.default.setQuery,setQuerySilently:d.default.setQuerySilently,getMainBody:function(e){return Ie("main")},setMainLoading:function(e){return Te("main",e)},onConvoAtTop:Object(v.default)(),onConvoAtBottom:Object(v.default)(),onConvoScroll:Object(v.default)("scrollElem"),setConvoLoading:function(e){return Te("convo",e)},getConvoBody:function(){return Ie("convo")},scrollConvoToBottom:function(){var e=fe.getConvoBody();e&&(e.scrollTop=e.scrollHeight)},redrawConvoLayer:function(){var e=pe();je(),$$(".messenger__layer_convo").forEach((function(t){t.innerHTML=e}))},cleanConvoBody:je,setupConvoBody:function(){Object(ke.setScrollView)(fe.getConvoBody(),{topBanner:!1}),addEvent(fe.getConvoBody(),"touchstart",Ee,{passive:!0})},getPageLayer:function(){return $(".messenger__layer_page")},renderMessengerPeerProfile:function(e){$(".messenger__peerProfile").innerHTML=Oe(e)}}),fe._onMainScroll=Me,fe._onConvoScroll=Pe,fe._onSearchMsgsClick=fe.onSearchMsgsClick;var xe=!1;if(_e.startPolling=function(){xe=!0,De()},_e.stopPolling=function(){xe=!1},Object.assign(_e,{redraw:function(){$$(".uMessenger").forEach((function(e){return e.outerHTML=_e()}))},redrawView:function(){$$(".uMessenger").forEach((function(e){return e.className=be()}));var e=store.mail,t=e.cur,n=e.peers;t.peerId&&(Ne(),Re(),h.default.togglePin(n[t.peerId].canPin));AudioMessagePlayer.redrawWaves(),Fe()},redrawMailActions:function(){var e=we();$$(".messenger__layer_convo").forEach((function(t){t.$(".messenger__footer").classList.toggle("messenger__footer_actionsOpen",e),h.default.update();var n=store.mail,i=n.cur,a=n.peers;if(!i.peerId||!a[i.peerId].isIncomingMR){var r=t.$(".messenger__write").offsetHeight,o=t.$(".messenger__acts").offsetHeight-r,s=t.$(".messenger__body");requestAnimationFrame((function(){!s._fixed&&o&&(s.style.paddingBottom=o+"px",s._fixed=!0),o<=0&&(s.style.paddingBottom=0,s._fixed=!1)}))}}))},redrawPinnedMsg:Re,setPinnedVisibility:function(e){var t=store.mail,n=t.peers,i=t.cur,a=n[i.peerId].hasPinnedMsg;$$(".messenger").forEach((function(t){t.classList.toggle("messenger_pinnedVisible",a&&e),t.classList.toggle("messenger_pinnedHidden",a&&!e)}))},redrawBanner:function(){var e=ve();$$(".messenger__banner").forEach((function(t){t.innerHTML=e,t.classList.toggle("messenger__bannerVisible",!!e)}))},redrawMRsHint:Fe,expandPeerBefore:function(){if(!$(".load_before_closed"))return;var e=fe.getConvoBody();if(Se.default.safari_mobile){var t=function(){var t=$$(".load_before_closed"),n=e.scrollHeight-e.scrollTop-e.offsetHeight;setStyle(e,"overflow","hidden"),t.forEach((function(e){return e.classList.remove("load_before_closed")}));var i=e.scrollHeight-n-e.offsetHeight;setStyle(e,"overflow","auto"),e.scrollTop=i,AudioMessagePlayer.redrawWaves()};e.isScrolling?(Be&&clearInterval(Be),Be=setInterval((function(){e.isScrolling||(clearInterval(Be),t())}),10)):t()}else if(e.scrollTop<=184){var n=$$(".load_before_closed"),i=e.scrollHeight-e.scrollTop-e.offsetHeight;n.forEach((function(e){return e.classList.remove("load_before_closed")}));var a=e.scrollHeight-i-e.offsetHeight;e.scrollTop=a,AudioMessagePlayer.redrawWaves()}},pinActionToggle:Ne,scrollToMsg:function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0);var i=Msg.getElem(e);if(!i)return!1;var a=fe.getConvoBody();if($(".mailScrap__loading_before"),t)a.scrollTop=i.offsetTop-.18*a.offsetHeight;else{var r=$(".typing_id_curConvo").offsetHeight;a.scrollTop=i.offsetTop-.5*(a.offsetHeight+2)+(i.offsetHeight+r)/2,i.offsetHeight>a.offsetHeight&&(a.scrollTop=i.offsetTop)}return n&&(addClass("msg_highlight",i),setTimeout((function(){removeClass("msg_highlight",i)}),1500)),!0},loadMailPage:Object(v.default)()}),Se.default.safari_mobile){var Le=null;fe.onConvoScroll((function(e){e.isScrolling=!0,Le&&clearTimeout(Le),Le=setTimeout((function(){return e.isScrolling=!1}),50)}))}var Be=null;function Re(){var e=store.mail,t=e.peers,n=e.cur,i=me(),a=t[n.peerId].hasPinnedMsg;$(".messenger__pinned").innerHTML=i,MailHat_convo.setHasPinnedMsg(a)}function Ne(){var e=store.mail,t=e.peers,n=e.cur;if(n.peerId){var i=t[n.peerId].majorSortId,a=Object(Ce.isPinnedSortId)(i);$$(".messenger").forEach((function(e){e.classList.toggle("messenger_pinnedDialog",a)}))}}function Fe(){var e=store.mail.cur,t=e.countMR,n=t&&"all"===e.folder&&!e.query&&!e.forwardFromId,i=$(".messenger__mrsHint");if(n){var a=t?ye(t):"";i.innerHTML=a}i.classList.toggle("messenger__mrsHint_hidden",!n)}var He=n("cq4b"),Ue=n("/Id8"),Ve=n("fWqt"),We=n("qHA9"),$e=n("iS9e");function qe(e,t){$e.default.open({body:ze(e),title:lang.mobile_captcha_enter_code,confirmText:lang.mobile_captcha_send_btn,cancelText:lang.mobile_cancel,class:"MailCaptcha__dialog",onConfirm:function(n,i){var a,r=Object(V.$)('[name="'+e.key+'"]',i);r=r&&r.value||"",$e.default.close(),Object(We.mailRequest)(e.location,Object.assign({},e.post,(a={},a[e.key]=r,a))).then((function(e){t(Promise.resolve(e))}),(function(e){t(Promise.reject(e))}))},onClose:function(){$e.default.close(),t(null)}})}function ze(e){return s.default.html({inner:[{class:"captcha_img",src:e.img,tag:"img"},{inner:[Object(z.default)({name:e.key})],class:"MailCaptcha__input",tag:"div"}],class:"MailCaptcha__box",tag:"div"})}var Ye=i,Ge=n("V4qE"),Ke=n("cZev"),Qe=n("GYWy"),Xe=n.n(Qe),Je=n("eWFs"),Ze=n("wMVj"),et={onTemplateInput:function(e,t,n,i){var a=$("."+n),r=i-t.value.length;a.textContent=r,a.className=o.default.class(n,{error:r<=0},"_")},onButtonMouseDown:function(e,t){Se.default.safari_mobile||e.preventDefault()},onButtonClick:function(e,t,n){var i=$(".MailTemplatePage__TextTextarea"),a=i.value,r=i.selectionStart,o=i.selectionEnd;i.value=a.slice(0,r)+n+a.slice(o);var s=r+n.length;i.selectionStart=i.selectionEnd=s},onSave:function(e,t,n,i,a){var r=$(".MailTemplatePage__NameInput .TextInput__native"),o=$(".MailTemplatePage__TextTextarea");I.default.setLoading(t,!0),Object(W.ajaxRequest)("/mail",{act:"save_template",name:r.value,text:o.value,hash:i,id:n},(function(e){if(e){if(e.error){var i=$(".MailTemplatePage__ErrorRow"),r=$(".MailTemplatePage__ErrorText");return I.default.setLoading(t,!1),i.hidden=!1,void(r.textContent=e.message)}if(store.mail.cur&&store.mail.cur.templates){var o=store.mail.cur.templates,s=n?o.findIndex((function(e){return e.id===n})):-1;-1!==s?o.splice(s,1,e.result):o.push(e.result)}Ze.default.go(a)}}),(function(){I.default.setLoading(t,!1)}))},onSubmit:function(e){e.preventDefault()}};window.MailTemplatePage=et;var tt=n("9b/I"),nt=function(e){var t=window.lang,n=Object(g.MailHat)({type:"page",left:s.default.html({class:"mailHat__back",inner:Object(x.default)(Object(tt.getBackOutline28Icon)()),href:"/mail"}),center:Object(g.MailHat__Title)({title:t.mobile_mail_mrs_page_title})}),i=[{class:"MessageRequestsPage__content ScrollView",inner:[{class:"MessageRequestsPage__info",inner:t.mobile_mail_mrs_page_info},s.default.wrap(Object(_.default)({scrap:"mrs"}))]},e.count?{class:"MessageRequestsPage__footer",inner:[Object(I.default)({theme:"negative",size:"large",type:"button",inner:t.mobile_mail_mrs_button_reject_all,attrs:r.default.onClick("MessageRequestsPage.rejectAll","event","this")})]}:null];return{class:"messenger__page MessageRequestsPage",inner:[{class:"messenger__header",inner:s.default.wrap(n)},{class:"messenger__content",inner:[{class:"messenger__body",inner:i}]}]}};Object.assign(nt,{rejectAll:function(e,t){I.default.setLoading(t,!0),nt.onRejectAll(t)},onRejectAll:befall()});var it=nt;var at=it;window.MessageRequestsPage=it;var rt,ot,st=n("V2dH"),ct=n("iWgD"),lt=n("HGMY"),ut=n("zq7H"),dt=n("9M99"),_t=n("hw56"),ft=n("H5mD"),pt=n("aiw/"),ht=n("W38l"),mt=n("HdGT"),vt=n("gF8j"),gt=Object(v.default)();function At(){ot=null,rt&&rt.stop()}function bt(e,t){rt&&(rt.is_idle?ot[e]=t:setTimeout(t,0))}function wt(){var e=ot;ot={},Object.keys(e).forEach((function(t){(0,e[t])()}))}var yt=null,Ot=null;function St(e){if(Ot&&(clearTimeout(Ot),Ot=null),yt&&(yt=Object.assign({},yt,{fails:0})),"online"===e.type&&yt){var t=yt;yt=null,kt(t)}}function kt(e){if(!1!==navigator.onLine)return Object(We.mailRequest)("/mail",{act:"message",message_id:e.msgId,forcePinned:e.forcePinned}).then((function(t){e.onResult(t)})).catch((function(t){if(e.onTryError&&e.onTryError(t),!1!==navigator.onLine){var n=Math.min(1+(0|e.fails),6),i=Math.pow(2,Math.max(n-2,0));yt=Object.assign({},e,{fails:n}),Ot=setTimeout((function(){Ot=null,kt(yt)}),1e3*i)}else yt=Object.assign({},e,{fails:0})}));yt=Object.assign({},e,{fails:0})}window.addEventListener("online",St),window.addEventListener("offline",St);var Ct=n("UlUB"),jt=n("ZMWW"),Et=n("BZzM"),Tt=n("N4ZS"),It=n("r/ag"),Mt=n("j80l"),Pt=n("vk58"),Dt=n("j1wj"),xt=n("zvhO"),Lt=n("Gyo5"),Bt=n("hC3G"),Rt=n("y/eL"),Nt=!1;uVK.onReady(Cn),fe.onQueryChange(Tn),fe.onQueryClear(In),Je.default.onTap(nn),T.onUnreadClick($t),T.onBackClick(Xn),T.onBackToDialogClick(Jn),T.onCancelEditing($i),p.default.onAttachedMsgsRemove(tn),p.default.onToBottomClick($n),p.default.onMessage(Qt),mt.onMessage(Kt),mt.onStopped(Xt),mt.onMessageRemove(Jt),mt.onCaptcha(la),Ue.default.onClick(yi),Ue.default.onRestoreClick(ki),Ue.default.onReplyClick(ji),Ue.default.onForward(Ti),Voting.onHtmlUpdate(Yi),fe.onMainScroll(Wn),fe.onConvoScroll(qn),fe.onSearchMsgsClick(En),fe.onConvoScroll(_e.expandPeerBefore),fe.onConvoAtTop(Hn),fe.onConvoAtBottom(Un),h.default.onCloseClick(_i),h.default.onRemoveClick(fi),h.default.onImportantClick(gi),h.default.onReplyClick(bi),h.default.onForwardClick(wi),h.default.onSpamClick(vi),h.default.onPinClick(ui),h.default.onEditClick(di),Ve.default.onConfirmDelete(hi),PinnedMsg.onHideClick(Di),at.onRejectAll(Ji),im.onNewMsg(Zt),im.onEditMsg(en),im.onMultiTyping(ei),im.onRecordingAudio(ni),im.onOnlineChange(ii),im.onMsgReadByMe(ai),im.onMsgReadByOther(ri),im.onMsgImportantRemove(rn),im.onMsgImportantAdd(an),im.onMsgRemove(on),im.onMsgListen(sn),im.onConvoMinorIdChanged(ln),im.onConvoMajorIdChanged(cn),im.onPeerKeyboard(dn),im.onPeerBanner(An),im.onPeerConvert(bn),im.onPeerAdmin(wn),im.onMsgRequestChange(yn),im.onCallInProgress(On),im.onDialogImportant(_n),im.onDialogMarkedUnread(pn),im.onDialogAdTag(fn),im.onUnreadCount(hn),im.onIncomingCall(mn),im.onKeyboardCallback(gn),im.onResync(vn),gt(ia),AudioMessagePlayer.events.on("listened",aa),AudioMessagePlayer.events.on("transcription_toggle",ca),nav.onPopState(oi),nav.onBeforeGo(si),nav.onBeforeGo2(ci),page.onChange(li),uVK.onReady(Fi),page.onChange(Fi),uVK.onReady(Hi),page.onChange(Hi),uVK.onReady(Ui),page.onChange(Ui),page.onChange(Gt),page.onChange(zi),uVK.onReady(Gt),uVK.onReady(Mi),uVK.onReady(zi),uVK.onOrientationChange(Yt),_e.loadMailPage(Gi),_e.onShowPinnedMsgClick=Pi,_e.onHidePinnedMsgClick=Di,_e.onMarkDialogAsUnreadClick=xi,_e.onPinDialogClick=Li,_e.onUnpinDialogClick=Bi,_e.onBannerButtonClick=Ri,_e.onBannerTextClick=Ni,_e.onCall=ma,_e.goToMsg=Ci,_e.cacheAudioMessageWaves=Si;var Ft=!1,Ht=0,Ut=[],Vt=[],Wt=Object(Ct.throttle)((function(){if(!Ut.length)return;var e=store.mail,t=e.members,n=e.cur,i=Ut,a=Vt;Ut=[],Vt=[],ajaxRequest("/mail",{act:"get_members",members:i},(function(e){Object.assign(t,e),a.forEach((function(e){e===n.peerId&&st.default.redraw(),Je.default.redrawTyping(e)}))}))}),3e3);function $t(){fe.scrollMainBodyToTop()}function qt(){Object(ke.preventDocumentScroll)();var e=fe.getMainBody();e&&Object(ke.setScrollView)(e);var t=Object(V.$)(".leftMenu__searchItems");t&&Object(ke.setScrollView)(t,{topBanner:!1,overscrollY:!1})}function zt(){Object(ke.preventDocumentScroll)({topBanner:!1}),fe.setupConvoBody()}function Yt(){Se.default.safari_mobile&&document.activeElement.blur()}function Gt(){var e=nav.getQuery("msg")||nav.getQuery("id")||nav.getQuery("edit_msg_id");e?requestAnimationFrame((function(){_e.scrollToMsg(e)})):requestAnimationFrame(fe.scrollConvoToBottom)}function Kt(e){var t=store.mail.cur;Object(_t.addPendingMsg)(e),t.peerId&&(0===e.sendId.indexOf("edit")?Gn(e):(lt.removeMsg(e),lt.addMsg(e),ta()),AudioMessagePlayer.redrawWaves())}function Qt(e){store.mail.cur.peerId&&0===e.sendId.indexOf("edit")&&Gn(e)}function Xt(){Object(_t.failAllPendingMsgs)();var e=store.mail,t=e.cur,n=e.presend;if(t)if(t.peerId){if(n.failed[t.peerId]){var i=[];n.failed[t.peerId].map((function(e){var t=n.msgs[e];t&&(0===t.sendId.indexOf("edit")?Gn(t):i.push(t))})),lt.setMsgs(i)}}else Object.keys(n.failed).forEach((function(e){Je.default.redrawLastMsg(e)}))}function Jt(e){var t=store.mail.presend.msgs[e];t&&(Object(_t.removePendingMsg)(t),Object(_t.removeFailedMsg)(t),0===e.indexOf("edit")?store.mail.cur.peerId&&_.default.peerReplaceItems([t.id]):(store.mail.cur.peerId&&lt.removeMsg(t),ta()))}function Zt(e,t){Yn(e,t)}function en(e){Yn(e)}function tn(){var e=store.mail,t=e.cur;e.peers;Object(_t.setPeerDraft)(t.viewerId,t.peerId,{msgs:void 0},t.editing),t.msgAttached[t.peerId]=[],p.default.uiRedrawAttachments(t.peerId)}function nn(e){var t=store.mail,n=(t.cur,t.rolls),i=t.msgs;if(n){var a=Number(qs2obj(e.split("?")[1]).peer);i[last(n.peer[a]||[])];return jn(e)}}function an(e){var t=store.mail,n=t.cur,i=t.msgs,a=t.scraps,r=t.rolls,o=i[e];if(o&&(o.isImportant=!0,r.folder.important=r.folder.important.concat(e).filter(unique).sort(desc),Ue.default.toggleImportant(e,!0),"important"===n.folder)){var s=a.folder.slice();a.folder=a.folder.concat(e).filter(unique).sort(desc),_.default.redrawFolder(s)}}function rn(e,t){void 0===t&&(t=!0);var n=store.mail,i=n.cur,a=n.msgs,r=n.scraps,o=n.rolls,s=a[e];if(s&&(s.isImportant=!t,Object(He.arrayRemove)(o.folder.important,e),Ue.default.toggleImportant(e,!1),"important"===i.folder)){var c=r.folder.slice();Object(He.arrayRemove)(r.folder,e),_.default.redrawFolder(c)}}function on(e,t){void 0===t&&(t=Promise.resolve());var n=store.mail,i=n.cur,a=n.msgs,r=n.scraps,o=n.rolls,s=n.peers,c=a[e];if(jt.SAKIntegration.isIntegrated&&jt.SAKIntegration.sendMessage("remove_msg",{msg:c}),c&&!i.msgRemoved[e]){delete a[e],Object(He.arrayRemove)(o.peer[c.peerId],e),i.peerId===c.peerId&&(Object(He.arrayRemove)(r.peer,e),Ue.default.remove(e,!0),i.msgSelected[e]&&(delete i.msgSelected[e],h.default.setCount(Object.keys(i.msgSelected).length),_e.redrawMailActions()),r.peer.length?_.default.checkDivider():_.default.redrawPeer()),c.isImportant&&i.countImportant--;var l=s[c.peerId];l.groupCall&&l.groupCall.msgId===e&&(l.groupCall=void 0);var u=l.isIncomingMR,d=l.isRejectedMR;c.isUnread&&c.authorId!==i.viewerId&&(l.countUnread=l.countUnread-1,u||d||l.countUnread<=0&&O(-1,l.isMuted),p.default.redrawToBottom(),T.redrawCounter()),o.peer[c.peerId].length?un(c.peerId,e):(i.peerId===c.peerId&&T.redrawActions(),t.then((function(){ajaxRequest("/mail",{act:"get_last_msg",peer_id:c.peerId,user_id:i.userId},(function(t,n){n&&(storeMethods.injectMail(t),o.peer[c.peerId].push(n)),un(c.peerId,e)}),(function(){un(c.peerId,e)}))})))}}function sn(e){var t=store.mail.msgs,n=t&&t[e];if(n){n.listened=!0,n.attachesHTML=n.attachesHTML.replace(/class="(im_msg_audiomsg(?:\w?\s?)*)"/g,'class="im_msg_audiomsg im_msg_audiomsg_listened"');var i=$$('.audio-msg-track[data-msg="'+e+'"]');i&&i.forEach((function(e){e.closest(".im_msg_audiomsg").classList.add("im_msg_audiomsg_listened")}))}}function cn(e,t){var n=t.majorSortId,i=store.mail,a=i.peers,r=i.cur,o=i.scraps,s=i.rolls,c=a[e];if(c){c.majorSortId=n,r.peerId===e&&_e.pinActionToggle();var l=r.folder,u="all"===l||"unread"===l&&c.countUnread;n&&u&&(s.folder[l]=s.folder[l].concat(e).filter(unique).sort(Ii),o.folder=o.folder.concat(e).filter(unique).sort(Ii),_.default.redrawFolder()),n||un(e,void 0)}else n&&ajaxRequest("/mail",{act:"get_dialog",peer_id:e},(function(t){storeMethods.injectMail(t);var i=t.peers[e],a=Object.keys(t.msgs)[0];i.isCasper&&!a||!i||(Object(_t.addPeer)(e,{msgs:[a]}),cn(e,{majorSortId:n}))}))}function ln(e,t){var n=t.minorSortId,i=store.mail,a=i.peers,r=i.scraps,o=i.cur;if(a[e].minorSortId=n,!o.peerId){var s=r.folder.slice();r.folder=r.folder.sort(Ii),_.default.redrawFolder(s)}}function un(e,t){var n=store.mail,i=n.cur,a=(n.msgs,n.scraps),r=n.rolls,o=n.peers,s=o[e],c=s.isIncomingMR,l=s.isRejectedMR;r.peer[e].length||(c||l?Object(He.arrayRemove)(r.mrs,e):(Object(He.arrayRemove)(r.folder.all,e),Object(He.arrayRemove)(r.folder.unread,e),Object(He.arrayRemove)(r.folder.unrespond,e)),"mrs"===i.page?Object(He.arrayRemove)(a.mrs,e):"important"!==i.folder&&Object(He.arrayRemove)(a.folder,e)),r.peer[e]=r.peer[e].filter(unique).sort(asc),c||l?r.mrs=r.mrs.filter(unique).sort(Ii):(0===s.countUnread&&(r.folder.unread=r.folder.unread.filter((function(t){return t!==e}))),r.folder.all=r.folder.all.filter(unique).sort(Ii),r.folder.unread=r.folder.unread.filter(unique).sort(Ii),i.groupId&&(r.folder.unrespond=r.folder.unrespond.filter(unique).sort(Ii))),"mrs"===i.page?(a.mrs=a.mrs.filter(unique).sort(Ii),_.default.redrawMRs()):"important"===i.folder?(Object(He.arrayRemove)(a.folder,t),_.default.redrawFolder()):"all"===i.folder?(a.folder=a.folder.filter(unique).sort(Ii),_.default.redrawFolder()):"unread"===i.folder?(0===o[e].countUnread&&Object(He.arrayRemove)(a.folder,e),a.folder=a.folder.filter(unique).sort(Ii),_.default.redrawFolder()):"unrespond"===i.folder&&(a.folder=a.folder.filter(unique).sort(Ii),_.default.redrawFolder())}function dn(e){var t=store.mail,n=t.peers,i=t.cur;if(n[e]){var a=Object(_t.getKeyboardState)(e);if(!(Date.now()-a.updateTime<=500)){var r=a.updateTime;ajaxRequest("/mail",{act:"get_peers",peer_ids:[e]},(function(t){r===a.updateTime&&(storeMethods.injectMail(t),e==i.peerId&&p.default.renderKeyboardIfNeeded({update:!0}))}))}}}function _n(e,t){var n=store.mail.peers[e];n&&(n.isImportant=t),Je.default.redrawImportant(e,t)}function fn(e){ajaxRequest("/mail",{act:"get_peers",peer_ids:[e]},(function(t){storeMethods.injectMail(t),Je.default.updateAdTag(e)}))}function pn(e,t){var n=store.mail,i=n.rolls,a=n.peers,r=n.scraps,o=n.cur,s=a[e];if(s){s.isMarkedUnread=t;var c=function(n){return t?n.concat(e):n.filter((function(t){return t!==e}))};if(i.folder.unread=c(i.folder.unread).filter(unique).sort(Ii),"unread"===o.folder){var l=r.folder.slice();r.folder=c(r.folder).filter(unique).sort(Ii),_.default.redrawFolder(l)}Je.default.redrawUnread(e)}}function hn(e){var t,n=e.showOnlyNotMuted?e.countNotMuted:e.count;nav.getQuery("community")||(t=n,setNotify(t),menu.refreshSingleCounter(ut.COUNTERS_POS_MESSAGES,t)),function(e){var t=window.store.mail.cur;if(t){var n=e.showOnlyNotMuted,i=e.countNotMuted,a=e.count;t.unreadCounters={countNotMuted:i,count:a},t.settings.show_only_not_muted_messages=n}}(e),T.redrawCounter(),pa(n),navigator.setAppBadge&&navigator.setAppBadge(n)}function mn(e){jt.SAKIntegration.isIntegrated&&jt.SAKIntegration.sendMessage("incoming_call",e)}function vn(){im.pause(),kn((function(){im.resume()}))}function gn(e,t,n,i){void 0===i&&(i={}),function(e,t,n){void 0===n&&(n={});if(store.mail&&store.mail.cur&&"msg"!==store.mail.cur.page&&store.mail.cur.peerId!==e)return;switch(n.type){case"show_snackbar":if(n.text){var i=store.mail.members[t],a=(store.mail.peers[e],!1);e>2e9&&i&&(a=i.avatar),Snackbar.init({position:Ge.SNACKBAR_POSITION_MAIL,text:Object(dt.emojiToHTML)(htsc(n.text)),avatar:a,avatar_position:"left"})}break;case"open_app":var r=makeUrl("/app"+n.app_id,{from:nav.cur.slice(1)});nav.hard_go(r+"#"+n.hash);break;case"open_link":var o=Object(Tt.wrapAwayIfExternal)(n.link,!0),c=store.mail.members[t],l=Object(Mt.parseURL)(n.link),u=l.host||l.hostname||o;u.startsWith("xn--")&&(u=Xe.a.toUnicode(u));var d=s.default.elem(Object(It.default)({scrollable:!0,header:{title:lang.mobile_mail_callback_popup_title},content:[s.default.wrap(lang.mobile_mail_callback_popup_text.replace("{name}",c.name).replace("{domain}",u)),{class:"Popup__buttons",inner:Object(Pt.BtnStack)({inner:[Object(I.default)({inner:[lang.mobile_open],on_click:"Popup.close(this);",use_native_onclick:!0,theme:"regular",url:o,open_in_new_tab:!0}),Object(I.default)({inner:[lang.mobile_cancel],on_click:"Popup.close(this);",use_native_onclick:!0,theme:"secondary"})]})}]}));It.default.open(d,!0)}}(t,n,i),Object(_t.stopCallbackButtonWaiting)(e)}function An(e){Date.now()-Ht<=500||ajaxRequest("/mail",{act:"get_peers",peer_ids:[e]},(function(t){var n=store.mail.cur;storeMethods.injectMail(t),e==n.peerId&&_e.redrawBanner()}))}function bn(e,t){im.pause(),ajaxRequest("/mail",{act:"get_peers",peer_ids:[t]},(function(n){Object(_t.replacePeer)(e,t),storeMethods.injectMail(n);var i=store.mail.cur;e===i.peerId?(_.default.redrawFolder(),t===i.peerId?xn(t):jn("/mail?act=show&peer="+t,{replace:!0})):i.folder&&_.default.redrawFolder(),im.resume()}))}function wn(e,t,n){var i=store.mail,a=i.cur,r=i.peers;if(a){var o=r[e];o&&(t===a.userId&&(o.isAdmin=n),n&&!Object(He.arrayContains)(o.adminIds,t)?o.adminIds.push(t):!n&&Object(He.arrayContains)(o.adminIds,t)&&Object(He.arrayRemove)(o.adminIds,t))}}function yn(e,t){var n=store.mail,i=n.cur,a=n.rolls,r=n.scraps;i&&("created"!==t&&Nt||("created"===t&&Nt&&(Nt=!1),"created"===t?Sn(e,(function(t,n){Object(_t.removePeer)(e),storeMethods.injectMail(t),i.countMR=n,store.mail.mrs&&(a.mrs=a.mrs.concat(e).filter(unique).sort(Ii)),i.folder&&(_.default.redrawFolder(),_e.redrawMRsHint()),i.peerId===e&&xn(e)})):"canceled"===t||"rejected"===t?Sn(e,(function(t,n){Object(_t.removePeer)(e),storeMethods.injectMail(t),i.countMR=n,store.mail.mrs&&Object(He.arrayRemove)(a.mrs,e),i.folder&&(_.default.redrawFolder(),_e.redrawMRsHint()),i.peerId===e?xn(e):"mrs"===i.page&&(Object(He.arrayRemove)(r.mrs,e),_.default.redrawMRs())})):"accepted"===t&&Sn(e,(function(t,n){Object(_t.addPeer)(e),storeMethods.injectMail(t),i.countMR=n,store.mail.mrs&&Object(He.arrayRemove)(a.mrs,e),i.folder&&(_.default.redrawFolder(),_e.redrawMRsHint()),i.peerId===e?xn(e):"mrs"===i.page&&(Object(He.arrayRemove)(r.mrs,e),_.default.redrawMRs())}))))}function On(e,t){var n=store.mail.peers[e];if(t){var i=n&&n.groupCall,a=i&&i.updateTime||0,r=Date.now()-a<=500;i&&r||ajaxRequest("/mail",{act:"get_peers",peer_ids:[e]},(function(e){storeMethods.injectMail(e)}))}else n&&(n.groupCall=void 0)}function Sn(e,t){im.pause(),ajaxRequest("/mail",{act:"mrs_get_peer",peer_id:e},(function(e,n){t(e,n),im.resume()}))}function kn(e){var t=store.mail,n=t.cur,i=t.msgs,a=t.scraps,r=t.rolls;r.folder[n.folder]=[],a.folder=[],fe.setMainLoading(!0),ajaxRequest("/mail",{act:"all"===n.folder?null:n.folder,offset:0},(function(t,o){if(store.mail.cur){storeMethods.injectMail(t),"all"!==n.folder&&"unread"!==n.folder||Object.keys(t.msgs).forEach((function(e){e=toInt(e);var n=t.msgs[e].peerId;r.peer[n]=(r.peer[n]||[]).concat(e).filter((function(e){return!!i[e]})).filter(unique).sort(asc)}));var s="important"===n.folder,c=s?desc:Ii,l=Object.keys(s?t.msgs:t.peers).map(toInt).sort(c).filter((function(e){return-1===a.folder.indexOf(e)})),u=[].concat(l).filter(unique).sort(c);r.folder[n.folder]=u,a.folder=first(20,u),store.mail.reached.folder[n.folder]=o,_.default.redrawFolder(),T.redrawCounter(),fe.setMainLoading(!1),e&&e()}}))}function Cn(){"/mail"!==location.pathname&&0!==location.pathname.indexOf("/write")||Ki()}function jn(e,t){void 0===t&&(t={});var n=Mn(e);return e=makeUrl(e),n&&location.pathname+location.search!==e&&nav.go(e,!1,{push_only:!0,replace:!0===t.replace}),n}function En(){jn("/mail?q="+store.mail.cur.query+"&tab=messages")}function Tn(e){var t=Tn;if(t.timer&&clearTimeout(t.timer),store.mail.cur){var n=store.mail.cur,i=!n.query;if(e){var a="msgs"===n.tab?"&tab=messages":"",r=makeUrl("/mail?q="+e+a);Mn(r),i?jn(r):t.timer=setTimeout((function(){jn(r,{replace:!0})}),300)}else jn("/mail",{replace:!0})}}function In(){fe.setMainLoading(!1),fe.setConvoLoading(!1),Tn.clearTimer(),jn("/mail",{replace:!0})}function Mn(e){var t=(e=makeUrl(e)).split("?"),n=t[0],i=qs2obj(t[1]),a=store.mail,o=a.cur,c=a.scraps;if(o){var l=i.act,d=i.peer,f=i.chat,p=i.email,h=i.m,m=toInt(i.msg)||toInt(i.id)||null,v="messages"===i.tab?"msgs":"peers",A=i.q||"",b=+i.community||0;if(si())return ha(n,i,e),!0;if(!Object(We.isNewMailPage)(n,i))return clog("[mail nav] Exit Mail"),void Qi();if((o.groupId?-o.groupId:0)===b){ha(n,i,e),m&&(Ft=!0),_.default.clearSystemMessage2();var w=d?toInt(d):f?toInt(f)+2e9:p?-toInt(p)-2e9:null,y="unread"===l||"important"===l||"unrespond"===l||"ad_tag"===l?l:"all",O=function(e){switch(e){case"template":case"mrs":case"msg":return!0}return!1}(l),S=!O&&!!o.page,k=o.query!==A||o.tab!==v;o.page;if(function(){var e=store.mail.cur;if(e.peerId||e.page||e.query)return!1;return!0}()&&Object(_t.saveFolderScroll)(o.folder,fe.getMainBody().scrollTop),S&&(o.page=null),k&&w&&("peers"===o.tab?store.mail.cur.mvk_entrypoint="conversations_search":"msgs"===o.tab&&(store.mail.cur.mvk_entrypoint="message_search")),o.peerId&&!w&&A)clog("[mail nav] Peer back to Search"),o.query=A,o.peerId=null,o.tab=v,Ln(),fe.setQuery(A),Fn();else if(k&&o.peerId===w)o.query=A,o.tab=v,c.search=[],o.tab!==v&&(store.mail.reached.search.msgs={}),_e.redrawView(),fe.setQuery(A),_.default.redrawSearch(),A?(clog("[mail nav] Search update"),Fn()):(clog("[mail nav] Search exit"),function(){var e=store.mail,t=e.cur,n=e.scraps;t.query="",t.tab="peers",n.search=[],_e.redrawView(),_.default.redrawSearch(),fe.setQuery("")}(),0===c.folder.length&&Nn());else if(O)clog("[mail nav] Enter Page: "+l),o.page=l,o.peerId&&(o.peerId=null,Ln()),o.backUrl=Xi({peerId:w}),_e.redrawView(),function(e){var t=store.mail.cur,n=fe.getPageLayer();"mrs"===t.page&&store.mail.mrs?(store.mail.scraps.mrs=store.mail.rolls.mrs.concat(),n.classList.toggle("messenger__layer_loading",!1),n.innerHTML=s.default.html(at({count:t.countMR}))):(n.classList.toggle("messenger__layer_loading",!0),n.innerHTML=(i=Object(g.MailHat_page)(),a=Object(u.default)({mix:"messenger__body",inner:[he()]}),r.default.html(ce(),i,a)),ajaxRequest(e,{},(function(e,t){t&&storeMethods.injectMail(t),n.classList.toggle("messenger__layer_loading",!1),n.innerHTML=e})));var i,a}(e);else{if(o.peerId&&o.peerId===w)return!0;o.peerId!==w||S&&w?w?(clog("[mail nav] Enter Dialog"),o.backUrl=Xi({peerId:w}),xn(w,m)):(clog("[mail nav] Exit Dialog"),Ln(),Pn(y),Nn()):w&&h?(clog("[mail nav] Peer System Msg"),store.mail.peers[w].systemMessageCode=toInt(h),_.default.updateClass("peer"),_.default.redrawSystemMessage(),fe.scrollConvoToBottom()):(o.folder!==y||S&&y)&&(clog("[mail nav] Enter Folder"),Pn(y),Nn())}return!0}}}function Pn(e,t){void 0===t&&(t={restoreScroll:!0});var n=store.mail,i=n.cur,a=n.scraps,r=n.rolls;i.folder=e,Dn()?kn():(t.restoreScroll?a.folder=(r.folder[e]||[]).concat():a.folder=first(20,r.folder[e]),_.default.folderSetItems(a.folder),_e.redrawView(),T.redraw()),Object(Rt.updateCounters)(location.href,document.referrer),t.restoreScroll?fe.getMainBody().scrollTop=Object(_t.restoreFolderScroll)(e):fe.getMainBody().scrollTop=0}function Dn(){var e=store.mail,t=e.rolls,n=e.cur,i=e.msgs,a=t.folder[n.folder];return!a||("important"===n.folder?a.some((function(e){return!i[e]})):a.some((function(e){return!(t.peer[e]&&t.peer[e].length>0)})))}function xn(e,t){var n=store.mail,i=n.cur,a=n.msgs,r=n.peers,o=n.scraps,s=n.rolls,c=n.reached;if(sa={},r[e]){var l=s.peer[e]||[];if(t||!(r[e].countUnread>1)||r[e].isIncomingMR||r[e].isRejectedMR){i.peerId=e,o.peer=[],Mi(),t?(o.peer=[t],s.peer[e]=[],c.peer.before[e]=!1,c.peer.after[e]=!1):(o.peer=last(20,l),f()),store.mail.reached.peer.after[e]=!0,_.default.updateClass("peer"),_e.redrawView(),fe.redrawConvoLayer(),Fi(),T.startStatusUpdate(),Ke.default.checkStickers(),_.default.peerSetItems(o.peer),zt(),mt.ready().then((function(){p.default.init()})),t||Bn(e);var u=r[e];t&&(_.default.updateClass("peer"),_e.scrollToMsg(t)),t?Hn(t):Hn(),Object(Et.resizePosters)(),Object(Rt.updateCounters)(location.href,document.referrer),requestAnimationFrame((function(){t||(fe.scrollConvoToBottom(),mt.ready().then((function(){fe.scrollConvoToBottom()}))),AudioMessagePlayer.redrawWaves(),requestAnimationFrame((function(){t||fe.scrollConvoToBottom()}))})),ga(e,store.mail.cur.viewerId),u.banner&&"birthday"===u.banner.name&&statlogsValueEvent("gifts_im_birthday_banner","view",e)}else{fe.setConvoLoading(!0),window._preventedCheckTop=!0,Ft=!0,i.peerId=e,o.peer=[],Mi(),Je.default.redrawUnread(e),_e.redrawView(),fe.redrawConvoLayer(),Fi(),T.startStatusUpdate(),f(),_.default.peerSetItems([]),zt(),mt.ready().then((function(){p.default.init()}));var d={act:"show",peer_id:e,msg:"unread",reply_msg_id:i.msgReply[i.peerId]};ajaxRequest("/mail",d,(function(t,n,i){if(store.mail.cur){var r=t.rolls.peer[e];if(storeMethods.injectMail(t),c.peer.after[e]=n,c.peer.before[e]=i,l=s.peer[e]||[],(Object(He.arrayIntersects)(r,l)||n&&0===l.length)&&(s.peer[e]=l.concat(r).filter(unique).sort(asc)),store.mail.cur.peerId===e){p.default.preventShowToBottom(),o.peer=r.slice(),geByClass1("mailScrap__items_peer").innerHTML="",_.default.updateClass("peer"),_.default.peerSetItems(r),AudioMessagePlayer.redrawWaves(),Bn(e),ga(e,store.mail.cur.viewerId);var u=r.find((function(e){return a[e].isUnread}));_e.scrollToMsg(u,!0,!1),requestAnimationFrame((function(){window._preventedCheckTop=!1,Ft=!1,fe.setConvoLoading(!1)}))}}}))}}else ajaxRequest("/mail",{act:"get_peers",peer_ids:[e]},(function(n){storeMethods.injectMail(n),r[e]?xn(e,t):window.location.reload()}));function f(){i.forwardFromId&&(Ai(),i.forwardFromId=null)}}function Ln(e){void 0===e&&(e={});var t=store.mail,n=t.cur,i=t.scraps;T.cancelStatusUpdate(),$i(),n.peerId=null,n.mvk_entrypoint="",i.peer=[],Mi(),n.hasAttachments=!1,e.keepSelected||(n.msgSelected={}),_e.redrawView(),T.redraw(),p.default.reset(),fe.cleanConvoBody(),qt(),requestAnimationFrame((function(){h.default.setCount(0),_e.redrawMailActions(),st.default.redraw(),requestAnimationFrame((function(){_.default.peerSetItems(i.peer)}))}))}function Bn(e){bt("read_dialog"+e,(function(){!function(e){var t=store.mail.peers;if(!t)return;var n=t[e];if(n&&(n.isIncomingMR||n.isRejectedMR))return;!n||n.countUnread>0||n.isMarkedUnread?ajaxRequest("/mail",{act:"read_dialog",peer_id:e,mark_conversation_as_read:n.isMarkedUnread,hash:n.hashRead},(function(){ai(null,e)})):setTimeout((function(){ai(null,e)}),500)}(e)}))}function Rn(e,t){bt("read_dialog"+t,(function(){!function(e,t){var n=store.mail.peers;if(!n)return;ai(null,t),ajaxRequest("/mail",{act:"read_message",msg_id:e,peer_id:t,hash:n[t].hashRead},(function(){}))}(e,t)}))}function Nn(){var e=Nn,t=e.locked||(e.locked={}),n=store.mail,i=n.cur,a=n.scraps,r=n.rolls,o=n.reached,s=i.folder,c=a.folder,l=r.folder[s]||[],u="folder_"+s,d=o.folder[s]&&last(c)===last(l);if(fe.setMainLoading(0===c.length&&!d),!t[u]&&!d){var f="important"===s,p=Dn(),h=f?desc:Ii,m=[];if(0===c.length)m=first(20,l);else{var v=l.indexOf(last(c));m=v>=0?l.slice(v+1,v+20+1):[]}if(m.length&&!p){var g=c.concat(m).filter(unique).sort(h);a.folder=g,_.default.folderAddItems(m)}else{t[u]=!0;var A="all"===s?null:s,b=p||c.length<20?0:c.length;ajaxRequest("/mail",{act:A,offset:b},(function(e,n){if(store.mail.cur){storeMethods.injectMail(e),Object.keys(e.peers).forEach((function(e){store.mail.reached.peer.after[e]=!0})),"all"!==s&&"unread"!==s||Object.keys(e.msgs).forEach((function(t){t=toInt(t);var n=e.msgs[t].peerId;r.peer[n]=(r.peer[n]||[]).concat(t).filter(unique).sort(asc)}));var d=Object.keys(f?e.msgs:e.peers).map(toInt).sort(h).filter((function(e){return-1===c.indexOf(e)})),m=l.concat(d).filter(unique).sort(h);r.folder[s]=m,n&&(o.folder[s]=n),t[u]=!1,i.folder===s&&(a.folder=m,_.default.updateClass("folder"),b>0?_.default.folderAddItems(d):_.default.redrawFolder(),fe.setMainLoading(!1),p&&(_.default.folderSetItems(a.folder),_e.redrawView(),T.redraw()))}}))}}}function Fn(){var e=Fn,t=e.locked||(e.locked={}),n=store.mail,i=n.cur,a=n.scraps,r=n.rolls,o=n.reached,s=i.tab,c=i.query,l="search_msgs_"+s+"_"+c,u=a.search,d=r.search[s][c]||[],f=o.search[s][c]&&last(u)===last(d);if(fe.setMainLoading(0===u.length&&!f),!t[l]&&!f){var p=[];if("peers"===s&&(d.length||(d=function(){var e=store.mail,t=e.cur,n=e.peers,i=(e.rolls,Object.keys(n).map(toInt)),a=QuickSearch.getQueryREs(t.query),r=[];return a.forEach((function(e){i.forEach((function(t){n[t].title.match(e)&&r.push(t)}))})),r.filter(unique).sort(Ii)}()),d.length))if(0===u.length)p=first(20,d);else{var h=d.indexOf(u);p=h>=0?d.slice(h+1,h+41):[]}if(p.length&&(a.search=u.concat(p).filter(unique).sort(Ii),_.default.redrawSearch(),_.default.updateClass("search"),fe.setMainLoading(!1)),!p.length||"peers"===s){var m="msgs"===s?{act:"search",q:c,offset:a.search.length,messages:1}:{act:"search",q:c};e.timer&&clearTimeout(e.timer),e.timer=setTimeout((function(){t[l]=!0,ajaxRequest("/mail",m,(function(e,n){if(store.mail.cur){t[l]=!1,storeMethods.injectMail(e);var u=Object.keys("peers"===s?e.peers:e.msgs).map(toInt),f="peers"===s?Ii:desc,p=d.concat(u).filter(unique).sort(f);r.search[s][c]=p,n&&(o.search[s][c]=n),i.tab===s&&i.query===c&&(fe.setMainLoading(!1),a.search=a.search.concat(u).filter(unique).sort(f),_.default.redrawSearch(),_.default.updateClass("search"))}}))}),300)}}}function Hn(e){if(!Object(V.$)(".load_before_closed")){var t=Hn,n=t.locked||(t.locked={}),i=store.mail,a=i.cur,r=i.scraps,o=i.rolls,s=i.reached,c=i.flags,l=i.peerProfileTags,u=i.peers;if(a){var d=a.peerId,f=r.peer,h=o.peer[d]||[],m="peer_before_"+d,v=s.peer.before[d]&&f[0]===h[0],g=a.msgReply[d],A=!!u[d].actionUrls;if(fe.setConvoLoading(f.length<1&&!v),!(n[m]||v&&A)){var b=fe.getConvoBody(),w=!Object(He.arrayIntersects)(f,h),y=first(f),O=y?h.indexOf(y):-1,S=0===f.length?last(10,h):O>=0?h.slice(O-20,O):[];if(S.length&&!e){if(b.scrollTop>6e3&&!w)return;if(window._preventedCheckTop)return;var k=r.peer.slice(),C=f.concat(S).filter(unique).sort(asc);r.peer=C,_.default.peerAddItemsBefore(S.filter((function(e){return-1===k.indexOf(e)}))),AudioMessagePlayer.redrawWaves(),_.default.updateClass("peer"),fe.setConvoLoading(!1)}else{if(!d)return;var j={act:"show",peer_id:d,msg:f[0],direction:e?"around":"before",reply_msg_id:g},E=f[0];n[m]=!0,ajaxRequest("/mail",j,(function(t,i,a){if(store.mail.cur){e&&setTimeout((function(){Ft=!1}),10);var u=store.mail.peers[d],v=t.peers[d];c.isPeerProfileEnabled&&Object(We.isUser)(d)&&(u.peerProfileData=v.peerProfileData,fe.renderMessengerPeerProfile({tags:l,tagsData:v.peerProfileTagsData,data:v.peerProfileData})),n[m]=!1,u.actionUrls=v.actionUrls,t.peers=[],storeMethods.injectMail(t);var g=Object.keys(t.msgs).map(toInt).filter((function(e){return-1===f.indexOf(e)})),A=f.concat(g).filter(unique).sort(asc);if(a&&(s.peer.before[d]=!0),i&&(s.peer.after[d]=!0),h=o.peer[d]||[],(Object(He.arrayIntersects)(A,h)||a&&0===h.length)&&(o.peer[d]=(o.peer[d]||[]).concat(A).filter(unique).sort(asc)),store.mail.cur.peerId===d){if(p.default.preventShowToBottom(),b.scrollTop>6e3&&!w)return;var y=r.peer.slice();r.peer=A,_.default.updateClass("peer"),E?(_.default.peerAddItemsBefore(g.filter((function(e){return-1===y.indexOf(e)&&e<E})),!0),_.default.peerAddItemsAfter(g.filter((function(e){return-1===y.indexOf(e)&&e>E})),!0)):_.default.peerAddItemsBefore(g,!0),e&&(_e.scrollToMsg(e),fe.setConvoLoading(!1)),AudioMessagePlayer.redrawWaves(),g.forEach((function(e){CasperTimer.init(e)})),fe.setConvoLoading(!1),null!=t.flags.stickersAutoplay&&StickersSettings.setAutoplay(t.flags.stickersAutoplay),_e.expandPeerBefore(),setTimeout(_e.expandPeerBefore,100),e&&Ai(),T.redrawActions(),p.default.redrawReply()}}}))}}}}}function Un(){var e=Un,t=e.locked||(e.locked={}),n=store.mail,i=n.cur,a=n.scraps,r=n.rolls,o=n.reached;if(!Ft&&i){var s=i.peerId,c=a.peer,l=r.peer[s]||[],u="peer_after_"+s;if(!(t[u]||o.peer.after[s]&&last(c)===last(l))){var d=fe.getConvoBody(),f=!Object(He.arrayIntersects)(c,l),p=function(){return d.scrollHeight-d.scrollTop-d.offsetHeight},h=last(c),m=h?l.indexOf(h):-1,v=m>=0?l.slice(m+1,m+21):[];if(!v.length||nav.getQuery("msg")||nav.getQuery("id")){if(!s)return;var g={act:"show",peer_id:s,msg:last(c),direction:"after"};t[u]=!0,ajaxRequest("/mail",g,(function(e,n){if(store.mail.cur){t[u]=!1,e.peers=[],storeMethods.injectMail(e);var i=Object.keys(e.msgs).map(toInt).filter((function(e){return-1===c.indexOf(e)})).sort(asc),d=c.concat(i).filter(unique).sort(asc);if(n&&(o.peer.after[s]=n),l=r.peer[s]||[],(Object(He.arrayIntersects)(d,l)||n&&0===l.length)&&(r.peer[s]=(r.peer[s]||[]).concat(d).filter(unique).sort(asc)),store.mail.cur.peerId===s){if(p()>6e3&&!f)return;n&&_.default.updateClass("peer"),a.peer=d,_.default.updateClass("peer"),_.default.peerAddItemsAfter(i),AudioMessagePlayer.redrawWaves()}}}))}else{if(p()>6e3&&!f)return;var A=c.concat(v).filter(unique).sort(asc);a.peer=A,_.default.peerAddItemsAfter(v),_.default.updateClass("peer"),AudioMessagePlayer.redrawWaves()}}}}Tn.clearTimer=function(){var e=Tn;e.timer&&(clearTimeout(e.timer),e.timer=null)};var Vn=!1;function Wn(e){var t=store.mail,n=t.cur,i=t.scraps,a=t.rolls,r=t.reached,o=e.scrollTop,s=e.scrollHeight,c=e.offsetHeight;if(n){var l=n.folder,u=i.folder,d=a.folder[l],f=!(r.folder[l]&&last(u)===last(d))&&c+20>=s;if(!n.query&&o<=20&&i.folder.length&&!f){if(Vn){Vn=!1;i.folder.slice();i.folder=first(20,a.folder[n.folder]),_.default.folderCutItems(20)}}else(o>20||f)&&(Vn=!0,s-o-c<window.innerHeight&&(n.query?Fn():l&&Nn()))}}function $n(){var e=store.mail,t=e.cur,n=e.scraps,i=e.rolls,a=e.reached,r=n.peer,o=i.peer[t.peerId]||[];if(o.length&&last(r)===last(o)&&a.peer.after[t.peerId])fe.scrollConvoToBottom(),p.default.hideToBottom(),_.default.updateClass("peer");else{var s=t.peerId;ajaxRequest("/mail",{act:"show",peer_id:s},(function(e,t){if(store.mail.cur){var r=e.rolls.peer[s];i.peer[s]=r.slice(),storeMethods.injectMail(e),a.peer.after[s]=!0,store.mail.cur.peerId===s&&(p.default.preventShowToBottom(),n.peer=r.slice(),geByClass1("mailScrap__items_peer").innerHTML="",_.default.peerAddItemsBefore(r),_.default.updateClass("peer"),fe.scrollConvoToBottom(),AudioMessagePlayer.redrawWaves())}}))}}function qn(e){var t=qn;t.timer||(t.timer=setTimeout((function(){t.timer=null,function(e){var t=store.mail,n=t.cur,i=t.scraps,a=t.msgs,r=t.peers;if(!n)return;var o=i.peer.find((function(e){return a[e]&&a[e].isUnread&&a[e].authorId!==n.viewerId})),s=e.scrollTop,c=e.scrollHeight-s-e.offsetHeight;if(o){var l=Ue.default.getElem(o),u=e.scrollHeight-l.offsetTop;c-u<=100&&Bn(n.peerId)}e._prevScroll||(e._prevScroll=0),c<300&&Object(V.$)(".mailScrap_reachedAfter")?p.default.hideToBottom():s>e._prevScroll-5||n.peerId&&r[n.peerId].countUnread?p.default.showToBottom():p.default.hideToBottom();e._prevScroll=s}(e)}),50))}function zn(e){for(var t=0,n=e.attaches.length;t<n;t++){if("sticker"===e.attaches[t].type)return!1}var i=store.mail.cur;return i.userId===e.peerId&&!i.groupId||e.isOut}function Yn(e,t){var n,i=e.peerId,a=e.id,r=e.authorId,o=e.attaches,s=e.adminId,c=e.isService,l=e.isStealth,u=e.isOut,d=e.keyboard,_=e.ttl,f=e.ts,p=e.text,h=store.mail,m=h.peers,v=h.members,g=h.cur,A=h.rolls,b=m[i]&&m[i].pinnedMsgId===a,w=Object(We.getMsgSendId)(e),y=Object(_t.getPendingMsg)(w,i),O=!(!y&&!e.replaced),S=g.peerId===i&&!A.peer[i].length;if(jt.SAKIntegration.isIntegrated&&jt.SAKIntegration.sendMessage("add_msg",{peerId:i,attaches:o,title:m[i]?m[i].title:""}),y)ht.mark(w,"opt_to_lp"),n=function(e){return!!e.length}(o);else{var k=!!m[i],C=c||o.length||b||e.hasTemplate,j=!v[r]||s&&!v[s];n=k?C||j:!l}if(y){var E=function(e){var t=store.mail.cur;if(Object(_t.removePendingMsg)(e),mt.remove(e.sendId,"silent"),t.peerId&&-1===e.sendId.indexOf("edit"))return lt.getMsg(e)}(y),I=Object.assign({},y,{id:a,failed:!1,pending:!1,waiting:!0,sendId:void 0,canEdit:zn(e),ts:f,ttl:_,text:Kn(p)});if(storeMethods.injectMsg(I),Gn(I,{existingElem:E},t),S&&T.redrawActions(),!n)return void ht.clean(w)}if(!d||!d.inline){if((d||n)&&!u&&!e.edited)Object(_t.getKeyboardState)(i).updateTime=Date.now();!d||n||u||e.edited||function(e){var t=e.peerId,n=e.authorId,i=e.msgId,a=e.keyboard,r=store.mail.peers[t];Object(_t.clearCallbackButtons)(t),r&&(r.keyboard=Object(We.prepareKeyboard)({keyboard:a,authorId:n,msgId:i}))}({peerId:i,authorId:r,msgId:a,keyboard:d})}if(!y&&!n){var M=function(e){var t,n=e.peerId,i=e.id,a=e.authorId,r=e.isOut,o=e.text,s=e.ts,c=e.flags,l=e.adminId,u=e.isService,d=e.ttl,_=e.isExpired,f=store.mail,p=f.cur,h=f.peers,m=f.msgs,v=f.members,g=h[n],A=Object(We.formatTime)(s,p.timeShift),b=m[i],w="";o&&(w=o.replace(/<br>/g,"\n").replace(We.MENTION_DOMAIN_REGEXP,"@$3").replace(We.MENTION_REGEXP,"@$1 ($3)"));t=e.replaced?!!b&&b.edited:!!e.edited;var y=o,O=Kn(o,c),S=e.keyboard;S=S&&S.inline?Object(We.prepareKeyboard)({keyboard:S,authorId:a,msgId:i}):null;var k=r?i>g.outReadUpToId:i>g.inReadUpToId,C={id:i,peerId:n,authorId:a,ts:s,date:A,dateShort:A,text:O,textInput:w,body:y,isUnread:k,edited:t,canEdit:zn(e),isOut:r,isService:u,keyboard:S,attaches:{},forwards:[],hasReply:!!e.hasReply,ttl:d,isExpired:Boolean(_)};l&&(C.adminName=l===p.userId?lang.mobile_mail_you:v[l].name,C.adminUrl=v[l].url);return C}(e);return storeMethods.injectMsg(M),Gn(M,{isReplace:O},t),void(S&&T.redrawActions())}im.pause(),kt({msgId:a,forcePinned:b,onTryError:function(e){var t=e.type;w&&(ht.error(w,"server_load_attach",t),ht.clean(w))},onResult:function(e){var n=e[0],r=e[1];w&&(ht.mark(w,"attach"),ht.clean(w)),store.mail.cur&&(storeMethods.injectMail(n),r&&function(e,t){var n=t.unpin,i=t.pinned,a=store.mail,r=a.cur,o=a.peers;if(n){o[e].pinnedMsg="",o[e].hasPinnedMsg=!1;var s=Vi();delete s[e],Wi(s),r.peerId===e&&(_e.redrawPinnedMsg(),Fi())}else i&&(o[e].pinnedMsg=i,o[e].hasPinnedMsg=!0,r.peerId===e&&(_e.redrawPinnedMsg(),Fi()))}(i,r),Gn(n.msgs[a],{isServerMsg:!0,isReplace:O},t),S&&T.redrawActions(),im.resume())}})}function Gn(e,t,n){var i=void 0===t?{}:t,a=i.isServerMsg,r=i.isReplace,o=i.existingElem,s=store.mail,c=s.cur,l=s.peers,u=s.rolls,d=s.scraps,f=s.reached,h=e.peerId,m=e.authorId,v=e.isOut,g=e.id,A=!v,b=l[h]&&0===l[h].countUnread&&A,w=r||!!e.edited,y=l[h],S=y.isIncomingMR,k=y.isRejectedMR,C=fe.getConvoBody(),j=!1;e.isUnread&&(j=c.viewerId===h||c.peerId===h&&A&&C.scrollHeight-C.scrollTop-C.offsetHeight<400&&!!Object(V.$)(".mailScrap_reachedAfter")),j&&A&&!S&&!k&&Rn(g,h);var E=l[h];if(n&&E&&(E.minorSortId=n),e.groupCall&&E&&E.groupCall&&(E.groupCall.updateTime=Date.now()),!w){var I=last(u.peer[h]||[]);u.peer[h]=(u.peer[h]||[]).concat(g).filter(unique).sort(asc),S||k||(u.folder.all=u.folder.all.concat(h).filter(unique).sort(Ii),f.peer.after[h]||(f.peer.after[h]=!0,f.peer.before[h]=!1));var M=l[h];if(A&&(h===c.peerId&&p.default.renderKeyboardIfNeeded({update:!0}),e.isUnread&&(S||k||(u.folder.unread=u.folder.unread.concat(h).filter(unique).sort(Ii)),a||(M.countUnread||(M.countUnread=0),M.countUnread+=1)),h===c.peerId&&p.default.redrawToBottom()),!S&&!k)if(b&&(O(1,M.isMuted),T.redrawCounter()),c.groupId&&(A?u.folder.unrespond=u.folder.unrespond.concat(h).filter(unique).sort(Ii):Object(He.arrayRemove)(u.folder.unrespond,h)),"all"===c.folder){var P=d.folder.slice();d.folder=d.folder.concat(h).filter(unique).sort(Ii),_.default.redrawFolder(P)}else if("unread"===c.folder&&m!==c.viewerId){var D=d.folder.slice();d.folder=d.folder.concat(h).filter(unique).sort(Ii),_.default.redrawFolder(D)}else if("unrespond"===c.folder){var x=d.folder.slice();A?d.folder=d.folder.concat(h).filter(unique).sort(Ii):Object(He.arrayRemove)(d.folder,h),_.default.redrawFolder(x)}if(S&&(u.mrs=u.mrs.concat(h).filter(unique).sort(Ii),"mrs"===c.page)){var L=d.mrs.slice();d.mrs=d.mrs.concat(h).filter(unique).sort(Ii),_.default.redrawMRs(L)}if(c.peerId!==h||!Object(He.arrayIntersects)(d.peer,u.peer[h])&&0!==d.peer.length||last(d.peer)!==I)o&&o.remove();else{d.peer=d.peer.concat(g).filter(unique).sort(asc);var B=Qn((function(){o?_.default.peerAddElemAfter(g,o):_.default.peerAddItemsAfter([g])}));A&&!B&&p.default.showToBottom(),m===c.viewerId&&_.default.removeDivider()}var R=Object(ct.uTyping_getPeerTyping)(h);R&&R.users.length&&(Object(_t.removePeerTypingUser)(h,m),h===c.peerId&&st.default.redraw(),Je.default.redrawTyping(h))}var N=g===Object(Je.uConvo_getLastMsgId)(h);w&&(Object(_t.clearCallbackButtons)(h,g),N?Qn((function(){return _.default.peerReplaceItems([g])})):_.default.peerReplaceItems([g]),Object.keys(sa).filter((function(e){return!!sa[e]})).forEach((function(e){AudioMessagePlayer.toggleTranscription(null,Object(V.$)(".audio-msg-track__transcriptionButton",Ue.default.getElem(e)),!0)}))),N&&(Je.default.redrawLastMsg(h),Je.default.redrawUnread(h),StickersAnimation.checkSettingsAndLoad(e.id)),CasperTimer.init(e.id),h===c.peerId&&Si(),e.attaches&&e.attaches.gift&&Ke.default.checkStickers({force:!0,ignore_hash:!0})}function Kn(e,t){return void 0===t&&(t=0),e=Object(We.wrapLinks)(e,t),e=Object(We.wrapMention)(e),e=Object(dt.emojiToHTML)(e)}function Qn(e){var t=fe.getConvoBody(),n=t.scrollTop+t.offsetHeight>=t.scrollHeight-2;e();var i=t.scrollHeight-t.scrollTop-t.offsetHeight<400;return n&&fe.scrollConvoToBottom(),i}function Xn(){if(store.mail.cur){var e=store.mail.cur.backUrl;if(store.mail.cur.backUrl=null,qt(),e)history.back();else jn(function(){var e=store.mail.cur;return"mrs"===e.page?"/mail":"template"===e.page?"/mail?act=show&peer="+nav.getQuery("from"):(e.tab||e.peerId,"/mail")}(),{replace:!0})}}function Jn(){var e=store.mail.cur,t=e.msgSelected,n=e.forwardFromId;e.forwardFromId=null,Object.keys(t).forEach((function(e){delete t[e]})),Ue.default.unselectAll(),_e.redrawMailActions(),n&&xn(n)}var Zn={};function ei(e,t,n){var i=store.mail,a=i.cur,r=i.peers,o=r?r[e]:null;if(o&&!o.isIncomingMR&&!o.isRejectedMR){var s=Object(_t.filterPeerTypingUser)({type:"text",users:t,count:n},a.viewerId);Object(_t.setPeerTyping)(e,s);var c=Zn[e];c&&clearTimeout(c),s.count&&s.users.length&&(Zn[e]=setTimeout((function(){Zn[e]=null,ei(e,[],0)}),7e3),ea(s.users,e)),e===a.peerId&&st.default.redraw(),Je.default.redrawTyping(e)}}var ti={};function ni(e,t,n){var i=store.mail,a=i.cur,r=i.peers;if(r?r[e]:null){var o=Object(_t.filterPeerTypingUser)({type:"audio",users:t,count:n},a.viewerId);Object(_t.setPeerTyping)(e,o);var s=ti[e];s&&clearTimeout(s),o.count&&o.users.length&&(ti[e]=setTimeout((function(){ti[e]=null,ni(e,[],0)}),7e3),ea(o.users,e)),e===a.peerId&&st.default.redraw(),Je.default.redrawTyping(e)}}function ii(e){var t=e.userId,n=e.isOnline,i=e.onlinePlatform,a=e.lastActionTime,r=store.mail,o=r.cur,s=r.peers[t];s&&s.canSeeOnline&&(s.isOnline=n,e.isOnline&&(s.onlinePlatform=i),a&&(s.lastActionTime=a),Je.default.redrawOnline(t),o.peerId===t&&T.redrawOnline())}function ai(e,t){var n=store.mail,i=n.cur,a=n.peers,r=n.msgs,o=n.scraps,s=n.rolls;if(i){var c=i.peerId===t?o.peer:[],l=s.peer[t]||[],u=a[t];if(l.concat(c).forEach((function(t){var n=r[t];n&&t<=e&&n.authorId!==i.viewerId&&(delete n.isUnread,Ue.default.markAsRead(t))})),u&&(u.inReadUpToId=e,u.countUnread&&(O(-1,u.isMuted),u.countUnread=0)),Object(He.arrayRemove)(s.folder.unread,t),"unread"===i.folder){var d=o.folder.slice();Object(He.arrayRemove)(o.folder,t),_.default.redrawFolder(d)}T.redrawCounter(),p.default.redrawToBottom(),Je.default.redrawUnread(t)}}function ri(e,t){var n=store.mail,i=n.cur,a=n.msgs,r=n.peers,o=n.rolls,s=n.scraps,c=o.peer[t]||[],l=a[e],u=r[t];if(u&&(u.outReadUpToId=e),l)for(var d=c.indexOf(e);d>=0;){var _=a[c[d]];_.authorId===i.viewerId&&_.id<=e&&(delete _.isUnread,Ue.default.markAsRead(_.id)),d--}else last(c)&&e<=last(c)&&c.forEach((function(t){var n=a[t];n.authorId===i.viewerId&&n.id<=e&&(delete n.isUnread,Ue.default.markAsRead(n.id))}));i.peerId===t&&s.peer.forEach((function(t){var n=a[t];n.authorId===i.viewerId&&n.id<=e&&(delete n.isUnread,Ue.default.markAsRead(n.id))})),Je.default.redrawUnread(t)}function oi(){if(si())return!0;var e=store.mail.cur;if(e&&(e.backUrl=null),e&&e.forwardFromId)return Jn(),!0;Se.default.safari_mobile&&document.activeElement.blur();var t=qs2obj(location.search.slice(1)).act;if(!Object(V.$)(".uMessenger")&&"/mail"===location.pathname&&"show_medias"!==t)return nav.go(location,null,{no_push:!0,need_restore:!1}),!0;var n=new RegExp(/z=photo/).test(location.search);if(Object(V.$)(".uMessenger")&&!n&&!ge("z_photoview")&&!ge("StoriesView")){var i=Mn(location.pathname+location.search);return i&&nav.go(location.pathname+location.search,null,{no_push:!0,push_only:!0}),i}}function si(){var e=si;if(mediaUpload.isUploading)return e.noAlert||alert(unescapeAttr(lang.mobile_mail_wait_until_uploaded)),e.noAlert=!0,setTimeout((function(){e.noAlert=!1}),10),!0}function ci(e,t,n,i){void 0===i&&(i={});var a=store.mail.cur;if(jt.SAKIntegration.isIntegrated&&!t._sak_embed_force){if(!jt.SAKIntegration.isNewMail)return va(t),jt.SAKIntegration.sendMessage("nav",{isNewMail:Object(We.isNewMailPage)(e,t),path:e,query:t,url:n}),!0;if(!Object(We.isNewMailPage)(e,t))return va(t),jt.SAKIntegration.sendMessage("nav",{isNewMail:!1,path:e,query:t,url:n}),a||setTimeout((function(){location.reload()})),!0}if(!("/mail"===n&&a&&a.groupId||i.replace))return!t.m&&geByClass1("uMessenger")?jn(n):void 0}function li(){window.isNewMail&&(store.mail.cur?Object(We.isNewMailPage)(location.pathname,location.search)?Ki():Qi():Tn.clearTimer())}function ui(){var e=store.mail,t=e.cur,n=(e.msgs,e.peers),i=e.hash,a=t.msgSelected,r=toInt(Object.keys(a)[0]),o=n[t.peerId];t.hasAttachments=!1,t.msgSelected={},o.pinnedMsgId=r,o.hasPinnedMsg=!0,Ue.default.unselectAll(),_e.redrawMailActions(),ajaxRequest("/mail?act=pin",{hash:i.pin,chat:nav.getQuery("chat")||store.mail.cur.peerId-2e9,msg:r,_ajax:1})}function di(){var e,t=store.mail,n=t.cur,i=t.msgs,a=(t.peers,t.hash),r=(t.replies,t.pendingReplies,n.msgSelected),o=toInt(Object.keys(r)[0]),s=n.peerId,c=Object(_t.getPeerDraft)(n.viewerId,n.peerId),l=i[o],u=function(e){l.hasReply||c&&c.editing&&c.editing.id==o&&c.msgs&&(n.msgAttached[s]=c.msgs),l.hasReply?n.msgReply[s]=l.reply:n.msgReply[s]=null,p.default.redrawReply(),p.default.onAttachedMsgsRemove(),p.default.uiRedrawAttachments(s),p.default.setModifiers({editing:!0}),T.setModifiers({editing:!0}),_e.redrawMailActions(),_i(),p.default.setText(e)};if(n.editing==o)return e=c&&c.editing&&c.editing.id==o?c.editing.text||"":l.textInput,void u(e);n.editing=o,qi(),ajaxRequest("/mail?act=edit_message_start",{hash:a.edit,edit_msg_id:o,peerId:s,_ajax:1},(function(e,t){Object(_t.pushPeerAttachments)(n.peerId,e),u(t)}))}function _i(){var e=store.mail.cur.msgSelected;Object.keys(e).forEach((function(t){delete e[t]})),Ue.default.unselectAll(),h.default.setCount(0),_e.redrawMailActions()}function fi(){var e=store.mail,t=(e.msgs,e.cur),n=Object.keys(t.msgSelected).every(pi);1!==Object.keys(t.msgSelected).length||n?Ve.default.open({canDeleteForAll:n}):mi()}function pi(e){var t=store.mail,n=t.msgs,i=(t.cur,t.peers),a=vk.id,r=n[e],o=nav.getQuery().community,s=i[r.peerId];return!!r&&(r.authorId!==a&&r.authorId!==-o?s.isAdmin&&-1===s.adminIds.indexOf(r.authorId):!(r.peerId===a&&!o)&&(333!==r.peerId&&(!(Date.now()/1e3-r.ts>86400)&&!(s.kicked||s.closed||s.unableToWrite||s.kickedMessage))))}function hi(){var e=store.mail.cur.editing;e?(!function(e){var t=store.mail,n=t.cur,i=(t.hash,t.msgs,t.peers),a=n.peerId,r=ajaxRequest("/mail",{act:"delete_for_all",peer:a,ids:e+"",hash:i[a].hashRemove},(function(){})).promise;on(e,r),_e.redrawMailActions()}(e),$i(!0)):mi(!1,Ve.default.isDeleteMessagesForAll()),Ve.default.close()}function mi(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1);var n=store.mail,i=n.cur,a=n.peers,r=i.peerId,o=i.msgRemoved,s=i.msgSelected,c=Object.keys(s),l=window.AudioMessagePlayer.getAttachedTrackPlayer(),u=0;if(l){var d=l.closest(".msg");u=d?Ue.default.getId(d):0}var _=ajaxRequest("/mail",{act:t?"delete_for_all":e?"spam":"delete",peer:r,ids:c.join(","),hash:a[r].hashRemove},(function(){})).promise;c.forEach((function(n){(n=+n)===u&&window.AudioMessagePlayer.detachPlayer(),delete s[n],t?on(n,_):(o[n]=!e||"spam",e?Ue.default.spam(n):Ue.default.remove(n))})),_e.redrawMailActions()}function vi(){mi(!0)}function gi(){var e=store.mail,t=e.cur,n=e.hash,i=e.msgs,a=t.msgSelected,r=Object.keys(a),o=r.some((function(e){return!i[e].isImportant}))?1:0;r.forEach((function(e){delete a[e],i[e].isImportant!=!!o&&(o?t.countImportant++:t.countImportant--),i[e].isImportant=!!o,Ue.default.toggleImportant([e],!!o)})),ajaxRequest("/mail",{act:"mark_important",ids:r,hash:n.important,val:o},(function(){})),Ue.default.unselectAll(),_e.redrawMailActions()}function Ai(){var e=store.mail.cur,t=e.peerId,n=Object.keys(e.msgSelected).map(toInt);e.msgAttached[t]=n,Object(_t.setPeerDraft)(e.viewerId,e.peerId,{msgs:n,reply:void 0},e.editing),e.msgReply[t]&&!e.editing&&ajaxRequest("/mail",{act:"reply_cancel",peer_id:store.mail.cur.peerId,hash:store.mail.hash.reply}),e.msgReply[t]=null,e.msgSelected={},Ue.default.unselectAll(),h.default.setCount(0),p.default.redrawReply(),p.default.uiRedrawAttachments(t),_e.redrawMailActions()}function bi(){var e=store.mail,t=e.cur,n=e.flags,i=e.pendingReplies,a=t.peerId;if(!Object(We.isContactPeer)(a)){if(!n.replies)return Ai();var r=toInt(Object.keys(t.msgSelected)[0]);t.msgReply[a]=r,i[r]=Ue.default.getReplyDataFromHTML(r),Object(_t.setPeerDraft)(t.viewerId,t.peerId,{reply:r,msgs:void 0},t.editing),ajaxRequest("/mail",{act:"reply_start",hash:store.mail.hash.reply,peer_id:store.mail.cur.peerId,msg_id:r}),t.msgAttached[a]=[],t.msgSelected={},Ue.default.unselectAll(),h.default.setCount(0),p.default.redrawReply(),p.default.uiRedrawAttachments(a),_e.redrawMailActions(),p.default.openKeyboard("text")}}function wi(){var e=store.mail.cur;if(e){var t=e.msgSelected,n=Object.keys(t);Object(We.isContactPeer)(e.peerId)||Oi(n)&&(e.forwardFromId=e.peerId,e.query="",e.tab="peers",fe.setQuerySilently(""),Ln({keepSelected:!0}),Pn("all",{restoreScroll:!1}),Nn())}}function yi(e){if(store.mail.cur){var t=store.mail,n=t.cur,i=t.peers,a=t.msgs,r=t.flags,o=n.msgRemoved,s=n.msgSelected,c=i[n.peerId];if(p.default.hideStickersPanel(),!o[e]){s[e]?delete s[e]:s[e]=!0;var l=Object.keys(s),u=l.length,d=1===u&&l[0]==i[n.peerId].pinnedMsgId,_=l.reduce((function(e,t){return e&&a[t].isImportant}),!0),f=l.some((function(e){return a[e].ttl}));h.default.setCount(u),h.default.setModifiers({pinned:d,important:_}),h.default.setLabels({pinned:d,important:_}),Object(We.isContactPeer)(n.peerId)?h.default.toggleQuickButtons(!1):h.default.toggleQuickButtons(!0),r.replies&&(1!==u||c.isIncomingMR?h.default.setReplyAvailable(!1):h.default.setReplyAvailable(!0));var m=toInt(Object.keys(s)[0]),v=1==u&&a[m];if(h.default.setEditAvailable(v&&v.canEdit&&!c.unableToWrite),h.default.setImportantAvailable(u>0&&n.viewerId>0),h.default.setForwardAvailable(Oi(l)),c.canPin&&function(e){var t=store.mail.msgs[e];if(!t)return!1;return!t.noPin}(m)){var g=toInt(Object.keys(s)[0]);h.default.togglePin(1===u&&g!==c.pinnedMsgId)}else h.default.togglePin(!1);h.default.setForwardAvailable(!0),f&&(h.default.setImportantAvailable(!1),h.default.togglePin(!1),h.default.setForwardAvailable(!1)),_e.redrawMailActions()}}}function Oi(e){var t=store.mail.msgs;return 0===e.filter((function(e){return t[e]&&t[e].noForward})).length}function Si(){var e=store.mail.msgs;AudioMessagePlayer.redrawWaves(),Array.from($$(".im_msg_audiomsg")).map((function(e){return e.closest(".msg")})).forEach((function(t){var n,i=Ue.default.getId(t),a=e[i];if(t.classList.contains("msg_pending")&&(null==(n=a.attaches)?void 0:n.audiomsg)){var r=Object(V.$)(".pi_medias",t);r.isSameNode=function(){return!0},a&&(a.attachesHTML=r.outerHTML)}}))}function ki(e){var t=store.mail,n=t.cur,i=t.hash,a=t.msgs[e],r="spam"===n.msgRemoved[e]?"nospam":"restore";delete n.msgRemoved[e],Ue.default.restore(e),ajaxRequest("/mail",{act:r,id:e,hash:i.restore},(function(){})),a.isImportant&&(n.countImportant++,an(e)),_.default.redrawFolder()}function Ci(e){var t=store&&store.mail&&store.mail.cur;if(t&&e){var n=store.mail.msgs[e],i=!n;if((!n||n.peerId&&n.peerId===t.peerId)&&!t.msgRemoved[e])_e.scrollToMsg(e)||(i=!0),i&&ajaxRequest("/mail",{act:"get_msgs",msgs:[e]},(function(t){storeMethods.injectMail(t);var n=store.mail,i=n.msgs,a=n.cur;a.peerId&&i[e]&&!i[e].isDeletedForAll&&xn(a.peerId,e)}))}}function ji(e,t,n){var i=store&&store.mail&&store.mail.cur;if(i&&e){var a=store.mail.forwards[n];if(a.peerId&&a.peerId===i.peerId&&!i.msgRemoved[e])_e.scrollToMsg(e)||ajaxRequest("/mail",{act:"get_msgs",msgs:[e]},(function(i){storeMethods.injectMail(i);var a=store.mail,r=a.msgs,o=a.cur;o.peerId&&(!r[e]||r[e].isDeletedForAll?Ei(e,t,n):xn(o.peerId,e))}));else Ei(e,t,n)}else Ei(e,t,n)}function Ei(e,t,n){var i=nav.getQuery();t&&"show"===i.act&&(i.msg=t,nav.go(location.pathname+obj2qs(i),!1,{replace:!0,push_only:!0}));var a=Object(We.isMessageWithoutLocalId)(t)?Object(Ue.Msg_makePinnedReplyLink)(i.chat,n):Object(Ue.Msg_makeReplyLink)(e,t,n);nav.go(a,null,{force:!0})}function Ti(e){var t,n=store.mail.cur;n&&Oi([e])&&(n.msgSelected=((t={})[e]=!0,t),statlogsValueEvent("messages_channel_forward_click",0),wi())}function Ii(e,t){var n=store.mail,i=n.rolls,a=n.presend,r=n.msgs,o=n.peers,s=i.peer[t]||[0],c=na(a.pending[e],(function(e){return-1===e.indexOf("edit")})),l=na(a.pending[t],(function(e){return-1===e.indexOf("edit")})),u=last(s),d=c&&a.msgs[c].ts||0,_=l&&a.msgs[l].ts||0;if(_||(_=u&&r[u].ts||0),d)return _-d;var f=o[e]&&o[e].majorSortId||0,p=o[t]&&o[t].majorSortId||0,h=o[e]&&o[e].minorSortId||0,m=o[t]&&o[t].minorSortId||0;return f!==p?p-f:m-h}function Mi(){if(store.mail.cur){var e=!!store.mail.cur.peerId;$$(".vk__page_mail").forEach((function(t){return t.classList.toggle("messenger_noPullToRefresh",e)}))}}function Pi(){var e=store.mail.cur.peerId,t=Object(V.$)(".pinnedMsg");if(t){Number(t.dataset.id);var n=Vi();delete n[e],Wi(n),Fi()}}function Di(){var e=store.mail.cur.peerId,t=Object(V.$)(".pinnedMsg");if(t){var n=Number(t.dataset.id),i=Vi();i[e]=n,Wi(i),Fi()}}function xi(){var e=store.mail.cur.peerId,t=store.mail.hash;pn(e,!0),ajaxRequest("/mail",{act:"mark_dialog_as_unread",peer_id:e,hash:t.markDialogAsUnread},(function(t){t.error&&pn(e,!1)})),Xn()}function Li(){var e=store.mail.cur.peerId,t=store.mail.hash;ajaxRequest("/mail",{act:"pin_convo",peer_id:e,hash:t.pinDialog})}function Bi(){var e=store.mail.cur.peerId,t=store.mail.hash;ajaxRequest("/mail",{act:"unpin_convo",peer_id:e,hash:t.unpinDialog})}function Ri(e,t){var n,i=store.mail,a=i.cur,r=i.peers[a.peerId],o=r.banner;void 0!==t&&(n=r.banner&&r.banner.buttons[t],"birthday"===o.name&&"gifts_link"===n.type&&statlogsValueEvent("gifts_im_birthday_banner","click",a.peerId)),ajaxRequest("/mail",{act:"banner_callback",hash:r.hashBanner,peer_id:a.peerId,callback_data:n&&n.callback_data}),Ht=Date.now(),r.banner=null,_e.redrawBanner()}function Ni(e){var t=Object(V.$)(".messenger__banner_content");t&&t.classList.toggle("messenger__banner_contentExpanded")}function Fi(){var e=store.mail,t=e.cur;e.peers;if(t){var n=t.peerId;if(n){var i=Object(V.$)(".pinnedMsg"),a=Vi()[n],r=i?intval(i.dataset.id):null;_e.setPinnedVisibility(r&&a!==r)}}}function Hi(){var e=store.mail.cur;e&&e.peerId&&_e.pinActionToggle()}function Ui(){if(store.mail.cur&&store.mail.cur.peerId){var e=Object(V.$)(".pinnedMsg");if(e)if(!Number(e.dataset.id)){var t=store.mail.cur.peerId,n=Vi();delete n[t],Wi(n)}}}function Vi(){return lsGet("messenger.pinHidden")||{}}function Wi(e){lsSet("messenger.pinHidden",e)}function $i(e){var t=store.mail.cur;if(t&&t.editing){t.editing=!1,qi(),!0!==e&&ajaxRequest("/mail?act=edit_message_cancel",{peerId:t.peerId}),Object(_t.popPeerAttachments)(t.peerId),Object(_t.setPeerDraft)(t.viewerId,t.peerId,{});var n=Object(_t.getPeerDraft)(t.viewerId,t.peerId);t.msgAttached[t.peerId]=n.msgs||[],t.msgReply[t.peerId]=n.reply||null,p.default.setText(n&&n.text||""),p.default.setModifiers({editing:!1}),T.setModifiers({editing:!1}),p.default.uiRedrawAttachments(t.peerId),p.default.redrawReply();var i=fe.getConvoBody();i.scrollTop+i.offsetHeight>=i.scrollHeight-2&&fe.scrollConvoToBottom()}}function qi(){var e=nav.getQuery();store.mail.cur.editing?e.edit_msg_id=store.mail.cur.editing||void 0:delete e.edit_msg_id,nav.go(location.pathname+obj2qs(e),!1,{replace:!0,push_only:!0})}function zi(){if(store.mail.msgs){var e=+nav.getQuery("edit_msg_id");e&&store.mail.msgs[e]&&(store.mail.cur.msgSelected[e]=!0,di())}}function Yi(e){var t=e.closest("."+Ue.default.class);if(t){var n=Ue.default.getId(t);store.mail.msgs[n].textFull=Ue.default.getTextHtml(t)}}function Gi(e){jn(e)}function Ki(){if(store.mail.cur){if(window.isCustomScroll&&Object(ke.restoreDocumentScroll)(),(store.mail.cur||store.mail.page)&&!store.mail.cur.peerId){qt();var e=fe.getMainBody();e&&Wn(e)}store.mail.cur.peerId&&zt();var t,n,i=Object(Dt.getTimeFromStart)()-ajax.navStart;if(Object(xt.isNumber)(i)&&i>=50)statlogsValueEvent("mvk_mail_loading_time",i,store.mail.cur.folder,null==(t=store.mail.rolls.folder.all)?void 0:t.length);mt.ready().then(Zi).then((function(){ta(),store.mail.cur.peerId&&(p.default.init(),ai(null,store.mail.cur.peerId)),nav.getQuery("msg")||nav.getQuery("id")||fe.scrollConvoToBottom()})),im.on(),rt||((rt=new vt.default({id:"mail_user",element:document,focusElement:window,triggerEvents:"mouseover mousedown keypress touchstart",idleTimeout:15e3})).on("unidle",wt),rt.on("unidle",gt)),ot={},rt.start(),n=qs2obj(location.search.slice(1)),store.mail.cur.mvk_entrypoint=n.mvk_entrypoint||"notifications"===n.from&&"notifications"||"",_e.startPolling(),addEvent(window,"resize",Et.resizePosters),navigator.setAppBadge&&navigator.setAppBadge(y()),pt.onOpenCallback(ua),pt.onCloseCallback(da),jt.SAKIntegration.onMessage.on("embed",fa),pa(y()),ga(store.mail.cur.peerId,store.mail.cur.viewerId)}}function Qi(){if(jt.SAKIntegration.onMessage.off("embed",fa),store.mail.cur){if(pt.onOpenCallback(ua),pt.onCloseCallback(da),!document.body.classList.contains("vk__page_mail"))return im.off(),At(),void storeMethods.resetMail();Object(ke.restoreDocumentScroll)(),fe.cleanConvoBody(),im.off(),At(),_e.stopPolling(),T.cancelStatusUpdate(),_.default.resetPrevScraps(),storeMethods.resetMail()}}function Xi(e){var t=e.peerId,n=store.mail.cur,i=null;if("mrs"===n.page)i="/mail?act=mrs";else if("template"===n.page)i="/mail?act=template";else if("msg"===n.page)i="/mail?act=show=peer="+t;else if(n.forwardFromId&&n.forwardFromId!==t)i="/mail?act=show&peer="+n.forwardFromId;else if(n.query){var a="msgs"===n.tab?"&tab=messages":"";i="/mail?q="+n.query+a}else if(n.peerId)i="/mail?act=show&peer="+n.peerId;else if(n.folder&&!n.forwardFromId){var r="";"all"!==n.folder&&(r="?act="+n.folder),i="/mail"+r}return i}function Ji(){var e=store.mail.cur.countMR,t=store.mail.rolls.mrs;store.mail.cur.countMR=0,Nt=!0,store.mail.rolls.mrs=[],t.forEach((function(e){Object(_t.removePeer)(e)})),ajaxRequest("/mail",{act:"mrs_reject",all:!0,hash:store.mail.hash.mrs},(function(n){if(n.error)return store.mail.cur.countMR=e,store.mail.rolls.mrs=t,Nt=!1,void at.cancelRejeectLoading();_e.redrawView(),jn("/mail")}),(function(){store.mail.cur.countMR=e,store.mail.rolls.mrs=t,Nt=!1,at.cancelRejeectLoading()}))}function Zi(){store.mail.cur&&Object(_t.queueToPresendMsgs)(mt.getItems())}function ea(e,t){var n=store.mail.members;(e=e.filter((function(e){return!n[e]}))).length&&(Ut=Ut.concat(e),Vt.push(t),Wt())}function ta(){var e=store.mail,t=e.rolls,n=e.scraps,i=e.cur;t.folder.all=t.folder.all.filter(unique).sort(Ii),"all"===i.folder&&(n.folder=n.folder.filter(unique).sort(Ii),_.default.redrawFolder())}function na(e,t){if(!e||!e.length)return null;for(var n=e.length-1;n>=0;n--)if(t(e[n],n))return e[n];return null}function ia(){im.abortWaiting()}function aa(e){var t=+e.getAttribute("data-msg"),n=e.closest(".im_msg_audiomsg");if(t&&!Object(We.isForwardedMessageId)(t)&&store.mail.cur&&!(null==n?void 0:n.classList.contains("im_msg_audiomsg_listened"))){var i=store.mail.msgs[t],a=i&&store.mail.peers[i.peerId];a&&!i.listened&&i.authorId!==store.mail.cur.viewerId&&i.peerId===store.mail.cur.peerId&&Object(We.mailRequest)("/mail",{act:"listen_audiomsg",msg_id:t,hash:a.hashRead})}}var ra,oa,sa={};function ca(e,t){var n=ca,i=store.mail.cur.peerId,a=+t.getAttribute("data-msg"),r=store.mail.msgs[a],o=store.mail.hash.recognize,s=n.locked||(n.locked={});sa[a]=e;var c,l=t.closest(".im_msg_audiomsg");c=l?l.id.replace("audmsg",""):-1,statlogsValueEvent("audio_message_transcript",null,e,i,parseInt(r.conversationMsgId),c);var u=Object(V.$)(".audio-msg-track__transcriptionText",l),d="done"===r.transcript_state&&(null==u?void 0:u.classList.contains("audio-msg-track__transcriptionText--recognized"));e&&d&&aa(t),e&&"uninitialized"===r.transcript_state&&!s[a]&&(s[a]=!0,Object(We.mailRequest)("/mail",{act:"recognise_audiomessage",msg_id:a,hash:o}))}function la(e,t){Ye.showCaptcha(e,t)}function ua(){ra&&clearTimeout(ra),ra=setTimeout((function(){return addClass(Object(V.$)(".messenger__layer_convo"),_a())}),200)}function da(){ra&&clearTimeout(ra),ra=setTimeout((function(){return removeClass(Object(V.$)(".messenger__layer_convo"),_a())}),200)}function _a(){return oa||(oa="messenger__layer_convo--iosKeyboard",ft.isIPad&&ft.isIOSChrome&&ft.iosMajor>=11&&(oa="messenger__layer_convo--iosKeyboardChrome"),oa)}function fa(e,t){("nav"===e&&t.url&&(jn(t.url)||nav.go(t.url)),"reload_current_chat"===e)&&xn(store.mail.cur.peerId)}function pa(e){if(jt.SAKIntegration.isIntegrated){var t=Boolean(nav.getQuery("community"));jt.SAKIntegration.sendMessage("message_unread_counter",{isCommunity:t,count:e})}}function ha(e,t,n){jt.SAKIntegration.isIntegrated&&(va(t),jt.SAKIntegration.sendMessage("nav_info",{isNewMail:!0,path:e,query:t,url:n}))}function ma(){var e=store.mail.cur;if(e){var t=e.peerId,n=Object(We.isChatPeer)(t),i=store.mail.peers[t];i&&(i.groupCall?jt.SAKIntegration.sendMessage("call_join",{callData:i.groupCall.data,peerId:t}):jt.SAKIntegration.sendMessage("call",{isGroup:n,peerId:t,peer:i}))}}function va(e){e&&(delete e._sak_embed_force,delete e._sak_embed_at,delete e._sak_embed_origin,delete e._sak_embed_name,delete e.forced_color_scheme_mode)}function ga(e,t){e===Bt.VK_OFFICIAL_PEER_ID&&Lt.customMetricsCollector.logEvent({experiment_id:1285,service:"messages",metric_name:"open_vk_service_chat",metric_value:4,unit_id:t,unit_type_id:1})}t.default=_e;window.uMessenger=_e,window.Messenger=fe},"4bPz":function(e,t,n){"use strict";n.r(t);var i=n("+cqQ");window.uVK={onReady:Object(i.default)(),onResize:Object(i.default)(),onOrientationChange:Object(i.default)()},onDOMReady((function(){if(window.isNewMail&&document.body){window.uVK.onReady();var e=document.body.getAttribute("onresize"),t=document.body.getAttribute("onorientationchange");document.body.setAttribute("onresize","uVK.onResize(); "+e),document.body.setAttribute("onorientationchange","uVK.onOrientationChange(); "+t)}}))},"4fRq":function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);e.exports=function(){return n(i),i}}else{var a=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),a[t]=e>>>((3&t)<<3)&255;return a}}},"4qiT":function(e,t){var n={init:function(e){var t=this;this.store?addEvent(window,"scroll touchstart",this._onScrollHandler):(this.store=extend({},e),this.loadCount=20,this.store.offset=this.store.offset?this.store.offset:this.loadCount,this.isLoading=!1,this.elems={wrap:geByClass1("author-page"),nav:geByClass1("author-page-nav",this.wrap),header:geByClass1("author-page-header",this.wrap),content:geByClass1("author-page__inner",this.wrap),spinner:geByClass1("author-page__spinner",this.wrap)},this._onScrollHandler=this._onScrollHandler.bind(this),addEvent(window,"scroll touchstart",this._onScrollHandler),e.isStandalone&&(window.al=!1),window.cur.destroy.push((function(){removeEvent(window,"scroll touchstart",t._onScrollHandler)})))},_getLoadOffset:function(){return this.store.offset},_showLoader:function(){this.isLoading=!0,addClass(this.elems.spinner,"active")},_hideLoader:function(){this.isLoading=!1,removeClass(this.elems.spinner,"active")},_onScrollHandler:function(){var e=this,t=this.elems,n=t.nav,i=t.header,a=t.content,r=this.store.totalCount>this._getLoadOffset();toggleClass(n,"author-page-nav_shown",i.getBoundingClientRect().bottom-n.clientHeight<0),r&&window.scrollTop()+2*window.innerHeight>a.offsetHeight&&this._loadMore(this.store.sortBy,this._getLoadOffset(),(function(t){e.elems.content.innerHTML+=t}))},_loadMore:function(e,t,n){var i=this;void 0===e&&(e=!1),void 0===t&&(t=!1),this.isLoading||(e&&(this.store.sortBy=e),isFunction(n)||(n=function(){}),this._showLoader(),ajax.post("author_page.php",{act:"load_more",author_id:this.store.authorId,sort_by:e||this.store.sortBy,count:this.loadCount,offset:void 0!==t?t:this._getLoadOffset()},{onFail:function(){i._hideLoader()},onDone:function(e){i._hideLoader(),i.store.offset+=20,e&&n(e)}}))},subscribe:function(e,t,n){ajax.post("author_page.php",{act:"subscribe",author_id:t,hash:n},{onDone:function(t,n){toggleClass(e,"Btn_theme_link",t),e.innerHTML=n}})},sortBy:function(e,t){e.preventDefault(),Unfold.setActive(e.target.parentNode),this._closeUnfold(e),t!==this.store.sortBy&&this.updateList(t)},updateList:function(e,t){var n=this;void 0===t&&(t=!1),e=e||this.store.sortBy,addClass(this.elems.content,"loading"),t&&Unfold.setActive(geByClass1("Unfold__item")),this._loadMore(e,0,(function(e){n.elems.content.innerHTML=e,n.store.offset=n.loadCount,removeClass(n.elems.content,"loading")}))},_closeUnfold:function(e){if(e){var t=e.target.closest(".Unfold");t&&removeClass(t,"Unfold_open")}},addToBookmark:function(e,t,n,i,a){e.preventDefault(),this._closeUnfold(e);var r=+domData(t,"is-bookmarked"),o=r?"bookmark_remove":"bookmark_add",s=geByClass1("Unfold__itemText",t);ajax.post("bookmarks.php",{_ajax:1,act:o,item_type:5,item_oid:n,item_id:i,hash:a},{onDone:function(e,n,i){domData(t,"is-bookmarked",r?0:1),r?s&&(s.innerHTML=lang.mobile_bookmarks_actions_add):s&&(s.innerHTML=lang.mobile_bookmarks_actions_remove),i&&Bookmarks.showSuccessSnack(i)}})},pinArticle:function(e,t,n,i,a){var r=this;e.preventDefault(),this._closeUnfold(e),ajax.post("author_page.php",{act:"pin_article",article_owner_id:t,article_id:n,do_pin:i?0:1,hash:a},{onDone:function(){r.updateList("date",!0)}})},hideArticle:function(e,t,n,i){var a=this;e.preventDefault(),this._closeUnfold(e),ajax.post("author_page.php",{act:"hide_article",article_owner_id:t,article_id:n,hash:i},{onDone:function(){a.updateList()}})}};window.AuthorPage=n},"6Mr/":function(e,t,n){"use strict";n.r(t);var i=n("Ubt6"),a=n("/88W");n.d(t,"setHelpHintShown",(function(){return a.setHelpHintShown})),n.d(t,"canShow",(function(){return a.canShow})),n.d(t,"close",(function(){return a.close})),n.d(t,"initShownHelpHints",(function(){return a.initShownHelpHints})),n.d(t,"TooltipHelpHints",(function(){return a.TooltipHelpHints})),n.d(t,"toggleLock",(function(){return a.toggleLock})),n.d(t,"getHelpHint",(function(){return a.getHelpHint})),t.default=i.default,window.Tooltip={close:a.close,setHelpHintShown:a.setHelpHintShown,initShownHelpHints:a.initShownHelpHints,initHelpHints:a.initHelpHints,TooltipHelpHints:a.TooltipHelpHints}},"75Qd":function(e,t,n){"use strict";n.r(t);n("XCiN");var i,a,r=n("OcsD"),o=n("aJgW"),s=n("CQvH"),c=n("a0wW"),l=n("z9sQ"),u=n("+cqQ"),d=n("TYsd"),_=n("Cbap"),f=n("tgcV"),p=n("T3FL"),h=n("FbVm"),m=n("r0fY");!function(e){e.PAYMENT_FORM="payment_form",e.PAYMENT_FORM_CLICK_OFFER="payment_form_click_offer",e.PAYMENT_FORM_CLICK_PAY="payment_form_click_pay",e.PAYMENT_FORM_CLICK_CLOSE="payment_form_click_close",e.PAYMENT_FORM_CHANGE_CLICK_CHANGE="payment_form_change_click_change",e.CLICK_SHOW_MORE="click_show_more",e.WIDGET_VIEW="widget_view",e.DESCRIPTION_VIEW="description_view"}(i||(i={})),function(e){e.PAYMENT_START="payment_start",e.DATA_ACCESS="data_access",e.RESULT_PAYMENT_SUCCESS_OK="result_payment_success_ok",e.RESULT_PAYMENT_SUCCESS_WAITING="result_payment_success_waiting",e.RESULT_PAYMENT_SUCCESS_WAITING_TIMEOUT="result_payment_success_waiting_timeout",e.RESULT_RESUB_SUCCESS_WAITING="result_resub_success_waiting",e.RESULT_RESUB_SUCCESS_WAITING_OK="result_resub_success_waiting_ok",e.RESULT_PAYMENT_UNAVAILABLE="result_payment_unavailable",e.RESULT_PAYMENT_CANCEL="result_payment_cancel",e.RESULT_ERROR="result_error",e.CHANGE_START="change_start",e.RESULT_CHANGE_ERROR="result_change_error",e.RESULT_CHANGE_SUCCESS_OK="result_change_success_ok",e.RESULT_CHANGE_SUCCESS_WAITING="result_change_success_waiting",e.RESULT_CHANGE_SUCCESS_WAITING_TIMEOUT="result_change_success_waiting_timeout",e.RESULT_CHANGE_UNAVAILABLE="result_change_unavailable",e.UNKNOWN="donut_payment_screen_unknown"}(a||(a={}));var v=function(){return(v=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},g=new(function(){function e(){this.productionStatCollector=new h.ProductionStatCollector,this.actionStatCollector=new h.ActionStatCollector(this.productionStatCollector),this.navStatCollector=new h.NavigationStatCollector(this.productionStatCollector)}return e.prototype.logEventAction=function(t){return this.actionStatCollector.logEvent(e.createDonutActionStatEvent(t))},e.prototype.logEventActionView=function(e){return this.logEventAction(v(v({},e),{event_type:i.PAYMENT_FORM}))},e.prototype.logEventDescriptionClick=function(t){this.navStatCollector.logEvent(v(v({},e.createNavStatEventBase()),e.createDescriptionClickStatEvent(t)))},e.createDonutActionStatEvent=function(e){var t;return(t={type:m.ActionProductionStatEventTypes.TYPE_DONUT_PAYMENT_ITEM})[m.ActionProductionStatEventTypes.TYPE_DONUT_PAYMENT_ITEM]=e,t},e.createNavStatEventBase=function(){return{screen:"wall",subtype:m.NavigationProductionStatEventTypes.GO}},e.createDescriptionClickStatEvent=function(t){var n;return(n={item:e.processClickParamsToEventItem(t),type:m.NavigationProductionStatEventTypes.TYPE_DONUT_DESCRIPTION_NAV_ITEM})[m.NavigationProductionStatEventTypes.TYPE_DONUT_DESCRIPTION_NAV_ITEM]={},n},e.processClickParamsToEventItem=function(e){return{type:m.EventItemType.BROWSER,owner_id:e.ownerId,track_code:e.trackCode}},e}()),A=n("HLtZ");function b(e,t){var n=function(e){try{return JSON.parse(e)}catch(n){var t={environment:"parseJsonError",breadcrumb:{message:"Uncaught json parse error",data:{json:e},category:"custom"}};return Object(A.logError)(n,t),{}}}(e),i=n.type,a=n.type_property,r=n.params;a===m.ActionProductionStatEventTypes.TYPE_DONUT_PAYMENT_ITEM?g.logEventAction({event_type:r.event_type,source:r.source,owner_id:r.owner_id}):t&&i===m.ProductionStatEventTypes.TYPE_NAVGO&&function(e,t){var n=t.params;if(t.typeProperty===m.NavigationProductionStatEventTypes.TYPE_DONUT_DESCRIPTION_NAV_ITEM){var i=n.owner_id,a=n.track_code;if(!n||"number"!=typeof i||"string"!=typeof a)return;g.logEventDescriptionClick({ownerId:i,trackCode:a})}}(0,{typeProperty:a,params:r})}var w=n("ZMWW"),y=n("qHA9");window.SAKIntegration=w.SAKIntegration,window.SAKIntegrationInit=function(e){e.isNewMail=Object(y.isNewMailPage)(location.pathname,location.search),w.SAKIntegration.init(e)};var O=n("T24x"),S=n("W9Tc"),k=n("XHVZ"),C=n("Bj12"),j=function(){function e(){}return e.prototype.logEvent=function(e){e.type&&e[e.type]?Object(C.saveNetworkStats)(e):Object(A.logError)(new Error("NetworkStatCollector: invalid event."))},e}(),E=new j,T=n("o5u5"),I=function(){function e(e){this.networkStatCollector=e}return e.prototype.logEvent=function(e,t,n){var i,a=((i={network_type:t,network_effective_type:n,type:T.NetworkStatEventTypes.TYPE_NETWORK_AUDIO_ITEM})[T.NetworkStatEventTypes.TYPE_NETWORK_AUDIO_ITEM]=e,i);this.networkStatCollector.logEvent(a)},e}(),M=new k.ModuleNavigationStatCollector(E);O.default.onChanged((function(){p.navigationStat.addStatEvent(p.navigationStat.getModule(),h.NavigationProductionStatEventTypes.GO),Object(S.partConfigEnabled)("measure_module_navigation_stats_mvk")&&M.logEvent("mvk")}));var P=n("DM2o"),D=n("BZzM"),x=(n("eGQV"),n("uQjJ"),n("jk6M")),L=(n("wcVR"),n("kr3z")),B=n("wx14"),R=n("Y6JH"),N=n("V4qE"),F=n("UxAg"),H=n("5Hhy"),U={isUploading:!1,onBeforeRemove:Object(u.default)(),onRemove:Object(u.default)("removeElem"),onStart:Object(u.default)(),onError:Object(u.default)("response"),onComplete:Object(u.default)("response"),_uploadData:{},_uploadQueue:[],_readerQueue:[],_processUploadQueue:!1,_processReaderQueue:!1,_isFakeUploading:!1,fallback:function(e,t){var n=window.post;return e&&n.add_attach(e,t),!1},getLastAttachId:function(){if(!ge("attached_wrap"))return 0;var e,t=0;return each(geByTag("input"),(function(){if(e=this.name.match(/^attach(\d+)_type$/i)){var n=intval(e[1]);t<n&&(t=n)}})),t},refreshAttachIds:function(e){var t=ge("attached_wrap");if(t){var n,i=gpeByClass("mr_x_wrap",e),a=geByTag1("input",i),r=intval((a&&a.name.match(/^attach(\d+)(_type)?$/i)||[])[1]);if(gpeByClass("mr_timer",e)){var o=attr("add_post_btn","data-value");o&&val("add_post_btn",o)}else r&&each(geByTag("input",t),(function(){if(n=this.name.match(/^attach(\d+)(_type)?$/i)){var e=intval(n[1]);e==r?this.disabled=!0:e>r&&(this.name="attach"+(e-1)+(n[2]||""))}}))}},startFakeUploading:function(){U._isFakeUploading=!0,U.onStart()},finishFakeUploading:function(){U._isFakeUploading=!1,U.onComplete()},getAttachesCount:function(e){void 0===e&&(e=!0);var t=0;return window.ThumbsEdit&&window.ThumbsEdit.initialized&&e&&(t=ThumbsEdit.getThumbsCount()),t+=geByClass("mr_x_wrap","attached_wrap").length},refreshUploadState:function(e){isUndefined(e)&&(e=U.getAttachesCount(!0));var t=ge("attached_wrap"),n=geByClass1("mr_timer",t),i=geByClass1("pi_medias",t),a=ge("attach_photo_btn");if(toggle(i,e>0||isVisible(n)),toggleClass("attached_wrap_empty",t,e<=0),a){toggleClass("cp_attachBtnEl_sel",a,e>0);var r=geByClass1("inline_upload",a);if(r||(r=geByClass1("inline_upload",a.parentNode)),r){var o=attr(r,"data-max-attaches")||10;r.disabled=e>=o}}show("attached_options"),show("attached_flush")},checkUploading:function(e){return!U._processUploadQueue&&!U._isFakeUploading||cancelEvent(e)},attachedPhotoTpl:function(e){var t=[{id:"upload_item_"+e,class:"medias_thumb thumb_item mr_x_wrap thumb_upload",inner:[{id:"upload_image_"+e,class:"tu_img"},{id:"item_progress_wrap_"+e,class:"tu_progress_wrap",inner:[{id:"item_progress_"+e,class:"tu_progress"}]},{id:"item_cancel_wrap_"+e,class:"tu_cancel_wrap",onclick:"return mediaUpload.reset(this, event, '"+e+"');",inner:[{id:"item_cancel_"+e,class:"tu_progress"}]}]}];return ceFromString(d.default.html(t))},attachedTpl:function(e){void 0===e&&(e={});var t=e,n=t.id,i=t.type,a=["medias_row","mr_x_wrap","thumb_upload"];i&&a.push("attachment_type_"+i);var r=Object(H.getDocument24Icon)(),o={inner:[{inner:[{inner:[{inner:[Object(R.default)({icon:r})],class:"medias_link_icon",tag:"span"}],class:"medias_link_icon",tag:"span"},{inner:[{inner:[e.label],class:"medias_link_labeled medias_link_title",tag:"span"}],class:"medias_link_texts",tag:"span"}],class:"mr_label medias_link",tag:"span"},{inner:[{class:"tu_progress",id:"item_progress_"+n,tag:"div"}],class:"tu_progress_wrap",id:"item_progress_wrap_"+n,tag:"div"},{inner:[{class:"tu_progress",id:"item_cancel_"+n,tag:"div"}],class:"tu_cancel_wrap",id:"item_cancel_wrap_"+n,onclick:"return mediaUpload.reset(this, event, '"+n+"');",tag:"div"}],id:"upload_item_"+n,class:a,tag:"div"};return ceFromString(d.default.html([o]))},onUploadProgress:function(e){var t=ge("item_progress_"+this.id);window.ThumbsEdit&&ThumbsEdit.initialized?ThumbsEdit.onUploadProgress(this.id,e.loaded/e.total*100):setStyle(t,{width:e.loaded/e.total*100+"%",visibility:"visible"})},onUploadComplete:function(e){var t=this,n=e.target.responseText,i=!1;try{i=parseJSON(n)}catch(e){i={error:"ERR_CLIENT_BAD_RESPONSE: bad request response"}}if(i.error)U.onUploadError.call(t,e);else{var a=ThumbsEdit.initialized;t.xhr=ajax.post(t.done_url,{_ajax:1,_query:n,te:intval(a)},{onDone:function(e){var n,i=ge("item_progress_wrap_"+t.id),r=U.getLastAttachId()+1,o=ge("upload_item_"+t.id);if(o&&o.classList.add("thumb_uploaded"),a?(ThumbsEdit.replaceTemp(t.id,e.photo_raw,e.list||"",e.sizes),n=Object(F.$)('[data-media="phototemp_'+t.id+'"]')):n=ge("upload_image_"+t.id),n)if(e.src)var s=ce("img",{id:"upload_image_"+t.id,className:"ph_img",onload:function(){if(a&&(n.src=e.src,n.classList.remove("Thumb__wrap--temp"),n.setAttribute("data-media","photo"+e.photo_raw),n.setAttribute("data-upload",t.id)),replace(s,n),t.iw&&t.ih){if(t.iw>t.ih==s.width>s.height)var i=Math.min(130,Math.floor(75/t.ih*t.iw));else i=Math.min(130,Math.floor(75/t.iw*t.ih));setStyle(s,"width",i)}reflow(s),setStyle(s,"opacity",1)},src:e.src});else{var c=ge("upload_image_"+t.id);setStyle(c,"opacity",1)}var l=t.attach_type||"photo",u=(e.hash,e.photo_raw);t.attach_type&&"photo"!==t.attach_type&&(u=e.owner_id+"_"+e.id),o&&(o.appendChild(ce("input",{type:"hidden",name:"attach"+r,value:u})),o.appendChild(ce("input",{type:"hidden",name:"attach"+r+"_type",value:l}))),setStyle(i,"opacity",0),t.attached=!0,t.delete_url=e.delete_url,U._processUploadQueue||(U.isUploading=!1,U.onComplete(e))}}),addClass("tu_progress_request","item_progress_wrap_"+t.id),t.uploaded=!0,U.uploadQueueNext()}},onUploadError:function(e){clog("upload error.",e.target.responseText),Snackbar.init({text:"blog"===cur.module?lang.mobile_jobs_upload_error:lang.mobile_unknown_error,type:N.SNACKBAR_TYPE_ERROR}),this.id&&U.reset(null,null,this.id),U.uploadQueueNext(),U.onError(e.target.responseText)},uploadFile:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t,n=e.file_attr_name||"photo",i=JSON.parse(e.upload_params);e.xhr=uploadFile(e.upload_url,Object(B.default)(((t={})[n]=e.file,t),i),{onProgress:bind(U.onUploadProgress,e),onComplete:bind(U.onUploadComplete,e),onError:bind(U.onUploadError,e)})})),readFile:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){readFile(e.file,(function(t){var n=ge("upload_image_"+e.id);if(n)var i=ce("img",{id:"upload_image_"+e.id,className:"ph_img",onload:function(){replace(i,n),e.iw=i.width,e.ih=i.height},src:t});U.readerQueueNext()}))})),addFile:function(e){var t,n=ge("attached_wrap"),i=geByClass1("pi_medias",n),a=i?geByClass("medias_thumb",i):[],r=i?geByClass1("medias_row",i):null,o=a[a.length-1],s=e.attach_type||"photo";if(t="photo"===s?U.attachedPhotoTpl(e.id):U.attachedTpl({id:e.id,type:s,label:e.file?e.file.name:""}),n){if(window.ThumbsEdit&&ThumbsEdit.initialized)readFile(e.file,(function(t){var n=ce("img");n.src=t,n.onload=function(){var i=n.width,a=n.height;window.fakeImg=n;var r=getImageOrientation(t);t="/images/blank.gif";var o=!1;r>4&&r<9&&(o=!0);var s=["photo",e.id,{sizes:{temp:[t,o?a:i,o?i:a]}},{remove:e.id}];ThumbsEdit.addTempPreview(s),CreatePost.checkAttaches()}}));else{if(!i){var c=geByClass1("AddedAttach",n);i=ce("div",{className:"pi_medias"}),append(i,c||n)}o?after(t,o):r?before(t,r):append(t,i)}U._processReaderQueue||U.readerQueueNext()}},uploadQueueNext:function(){clog("next upload"),U._processUploadQueue=!0;var e=U.uploadQueueRemove();if(!e)return clog("empty upload"),U._processUploadQueue=!1,void(U.isUploading=!1);U.uploadFile(e)},readerQueueNext:function(){clog("next reader"),U._processReaderQueue=!0;var e=U.readerQueueRemove();if(!e)return clog("empty reader"),void(U._processReaderQueue=!1);U.readFile(e)},queueInsert:function(e){var t=srand();return U.getUploadDataById(t)?U.queueInsert(e):(U._uploadData[t]=extend(e,{id:t}),U._uploadQueue.push(t),U._readerQueue.push(t),U._uploadData[t])},uploadQueueRemove:function(){var e=U._uploadQueue.shift();return!!e&&U.getUploadDataById(e)},readerQueueRemove:function(){var e=U._readerQueue.shift();return!!e&&U.getUploadDataById(e)},getUploadDataById:function(e){return U._uploadData[e]||!1},delUploadDataById:function(e){delete U._uploadData[e]},start:function(e,t){if(!e||!canUploadFile())return U.fallback(e,t);var n=e.files,i=e.form||gpeByTag("form",e),a=submitBtn(i),r=ge("attach_photo_btn"),o=attr(e,"data-upload-url"),s=attr(e,"data-upload-params"),c=domData(e,"file-attr-name"),l=domData(e,"attach-type"),u=attr(e,"data-done-url"),d=attr(e,"data-max-attaches")||10,_=U.getAttachesCount();return o&&u?(each(n,(function(){var e={attach_type:l,file_attr_name:c,upload_url:o,upload_params:s,done_url:u,file:this,uploaded:!1,attached:!1};if(_>=d)return!1;U.queueInsert(e),U.addFile(e),_++})),removeEvent(i,"submit",U.checkUploading),addEvent(i,"submit",U.checkUploading),removeEvent(a,"click",U.checkUploading),addEvent(a,"click",U.checkUploading),removeEvent(r,"click",U.checkUploading),addEvent(r,"click",U.checkUploading),U.refreshUploadState(_),replace(clone(e),e),U._processUploadQueue||U.uploadQueueNext(),window.isNewMail&&U.onStart(),U.isUploading=!0,!1):U.fallback(e,t)},reset:function(e,t,n,i){if(cancelEvent(t),window.isNewMail&&U.onBeforeRemove(e),"/"==n[0]){ajax.post(n,{_ajax:1}),U.refreshAttachIds(e);var a=gpeByClass("mr_x_wrap",e)||gpeByClass("mr_timer",e);i?i():remove(a)}else{var r=n,o=U.getUploadDataById(r);if(!o)return!1;o.attached?o.delete_url&&(ajax.post(o.delete_url,{_ajax:1}),U.refreshAttachIds(e)):(o.xhr&&o.xhr.abort&&o.xhr.abort(),o.loaded||U.uploadQueueNext()),i?i():remove("upload_item_"+r),U.delUploadDataById(r)}return U.refreshUploadState(),window.isNewMail&&U.onRemove(e),Replies.abortTimer("editing"),!1},onUnfoldItemClick:function(e,t){var n=Object(F.$)('[type="file"]',t);e.target!==n&&n.click()}};window.mediaUpload=U;var V=n("cGUQ"),W=n("PU8N"),q=function(e,t,n,i,a,r,o,s,c,l,u){var d=s||i,_=c||a,f=l||r||t.naturalWidth,p=u||o||t.naturalHeight;e.beginPath(),e.arc(d+n,_+n,n,Math.PI,Math.PI+Math.PI/2),e.lineTo(d+f-n,_),e.arc(d+f-n,_+n,n,Math.PI+Math.PI/2,2*Math.PI),e.lineTo(d+f,_+p-n),e.arc(d+f-n,_+p-n,n,2*Math.PI,Math.PI/2),e.lineTo(d+n,_+p),e.arc(d+n,_+p-n,n,Math.PI/2,Math.PI),e.closePath(),e.save(),e.clip(),e.drawImage(t,i,a,r,o,s,c,l,u),e.restore()},z=function(e,t,n,i,a,r){var o={};if("number"==typeof r)o={tl:r,tr:r,br:r,bl:r};else{var s={tl:0,tr:0,br:0,bl:0};for(var c in s)o[c]=o[c]||s[c]}e.save(),e.beginPath(),e.moveTo(t+o.tl,n),e.lineTo(t+i-o.tr,n),e.quadraticCurveTo(t+i,n,t+i,n+o.tr),e.lineTo(t+i,n+a-o.br),e.quadraticCurveTo(t+i,n+a,t+i-o.br,n+a),e.lineTo(t+o.bl,n+a),e.quadraticCurveTo(t,n+a,t,n+a-o.bl),e.lineTo(t,n+o.tl),e.quadraticCurveTo(t,n,t+o.tl,n),e.closePath(),e.restore()};function Y(e,t,n){var i=Object.assign({},{pollStickerX:157,pollStickerY:1075,pollStickerWidth:760,pollStickerHeight:391,pollStickerOffset:45},n||{}),a=i.pollStickerX,r=i.pollStickerY,o=i.pollStickerWidth,s=i.pollStickerHeight+i.pollStickerOffset;return{type:"poll",poll_id:t,poll_owner_id:e,clickable_area:[{x:a,y:r},{x:a+o,y:r},{x:a+o,y:r+s},{x:a,y:r+s}]}}var G={title:"",titleColor:"#000",titleAlign:"center",titleFontSize:58,titleFont:"TT Commons",voteButtonText:window.getLang("stories_poll_sticker_vote_button_text"),voteButtonTextAlign:"center",voteButtonTextColor:"#fff",voteButtonFontSize:49,voteButtonFont:"TT Commons",voteButtonBackgroundColor:"#3F8AE0",width:760,height:391,radius:50,offset:45,backgroundColor:"#fff",backgroundCircleColor:"#fff",backgroundCircleSize:90,foregroundCircleColor:"#3F8AE0",foregroundCircleSize:72};function K(e){return Object(W.loadImage)("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyNCIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik04IDJhMiAyIDAgMTE0IDB2MjBhMiAyIDAgMTEtNCAwVjJ6bTggMTJhMiAyIDAgMTE0IDB2OGEyIDIgMCAxMS00IDB2LTh6TTIgOGEyIDIgMCAwMC0yIDJ2MTJhMiAyIDAgMTA0IDBWMTBhMiAyIDAgMDAtMi0yeiIgZmlsbD0iI2ZmZiIvPjwvc3ZnPg==").then((function(t){return new Promise((function(n){var i=Object.assign({},K.defaultOptions,e||{}),a=i.title,r=i.titleColor,o=i.titleAlign,s=i.titleFontSize,c=i.titleFont,l=i.voteButtonText,u=i.voteButtonTextAlign,d=i.voteButtonTextColor,_=i.voteButtonFontSize,f=i.voteButtonFont,p=i.voteButtonBackgroundColor,h=i.width,m=i.height,v=i.radius,g=i.offset,A=i.backgroundColor,b=i.backgroundCircleColor,w=i.backgroundCircleSize,y=i.foregroundCircleColor,O=i.foregroundCircleSize,S=document.createElement("canvas"),k=S.getContext("2d");S.width=h,S.height=m+g,k.fillStyle=A,z(k,0,g,h,m,v),k.fill(),k.fillStyle=b,k.beginPath(),k.arc(h/2,w,w,0,2*Math.PI,!1),k.fill(),k.fillStyle=y,k.beginPath(),k.arc(h/2,w,O,0,2*Math.PI,!1),k.fill();k.drawImage(t,h/2-27,w-36,54,72),k.save(),k.font="500 "+s+"px "+c,k.fillStyle=r,k.textAlign=o,k.fillText(a,h/2,230),k.restore(),k.save();var C=h-75,j=(h-C)/2,E=m+g-103-35;k.fillStyle=p,z(k,j,E,C,103,29),k.fill(),k.restore(),k.save();var T=h/2,I=m+g-103+30;k.font="500 "+_+"px "+f,k.fillStyle=d,k.textAlign=u,k.fillText(l,T,I),k.restore(),n(S)}))}))}K.defaultOptions=G;var Q={newAvatarUrl:"",oldAvatarUrl:"",newAvatarStrokeWidth:17,newAvatarStrokeColor:"#fff",oldAvatarStrokeWidth:17,oldAvatarStrokeColor:"#fff",baseWidth:1080,baseHeight:1920,displayWidth:375,backgroundColor:"rgba(0, 0, 0, .16)",newAvatarInBackgroundBlur:160,avatarWidth:500,title:window.getLang("stories_new_avatar_story_title_header"),titleColor:"#fff",titleTextAlign:"center",titleFont:"TT Commons",titleFontSize:69,titleLineHeight:87,titleShadowOffsetX:0,titleShadowOffsetY:4,titleShadowBlur:12,titleShadowColor:"rgba(0, 0, 0, 0.24)",pollStickerX:157,pollStickerY:1075,blobImageType:"image/jpeg",blobQuality:1};function X(e,t){var n=Object.assign({},X.defaultOptions,e||{}),i=n.newAvatarUrl,a=n.oldAvatarUrl,r=n.newAvatarStrokeWidth,o=n.newAvatarStrokeColor,s=n.oldAvatarStrokeWidth,c=n.oldAvatarStrokeColor,l=n.baseWidth,u=n.baseHeight,d=n.displayWidth,_=n.backgroundColor,f=n.newAvatarInBackgroundBlur,p=n.avatarWidth,h=n.title,m=n.titleColor,v=n.titleTextAlign,g=n.titleFont,A=n.titleFontSize,b=n.titleLineHeight,w=n.titleShadowOffsetX,y=n.titleShadowOffsetY,O=n.titleShadowBlur,S=n.titleShadowColor,k=n.pollStickerX,C=n.pollStickerY,j=n.pollStickerOptions,E=n.blobImageType,T=n.blobQuality;j=Object.assign({},{title:window.getLang("stories_new_avatar_story_poll_sticker_title")},j||{});var I=d*(u/l),M=t||document.createElement("canvas"),P=M.getContext("2d");return M.width=l,M.height=u,M.style.width=d+"px",M.style.height=I+"px",new Promise((function(e,t){Object(W.loadImages)([i,a]).then((function(n){var i=n[0],a=n[1];P.clearRect(0,0,M.width,M.height),P.fillStyle=_,P.fillRect(0,0,M.width,M.height),P.save(),P.filter="blur("+f+"px)";var l,u,d,I,D,x,L,B,R,N=(l=i.naturalWidth,u=i.naturalHeight,d=M.width,I=M.height,(R=l/u)>d/I?(L=I,B=I*R):(B=d,L=d/R),{width:B,height:L,offsetLeft:(d-B)*(D=void 0===(D=.5)?.5:D),offsetTop:(I-L)*(x=void 0===(x=.5)?.5:x)});if(P.drawImage(i,N.offsetLeft,N.offsetTop,N.width,N.height),P.restore(),"none"!==P.filter){var F=Object(W.getAverageRGB)(P);P.fillStyle="rgb("+F.r+", "+F.g+", "+F.b+")",P.fillRect(0,0,M.width,M.height)}P.save(),P.shadowOffsetX=w,P.shadowOffsetY=y,P.shadowBlur=O,P.shadowColor=S,P.font="600 "+A+"px/"+b+"px "+g,P.fillStyle=m,P.textAlign=v;var H=null==h?void 0:h.split("{br}");null==H||H.forEach((function(e,t){var n=b*t,i=M.width/2,a=M.height/2-b*H.length/2+n-395;P.fillText(e,i,a)})),P.restore();var U=(M.width-p)/2,V=Math.min(a.width,a.height),$=Math.min(i.width,i.height);P.save(),q(P,a,p/2,0,0,V,V,U-165,665,p,p),P.lineWidth=s,P.strokeStyle=c,P.stroke(),q(P,i,p/2,0,0,$,$,U+165,665,p,p),P.lineWidth=r,P.strokeStyle=o,P.stroke(),P.restore(),K(j).then((function(t){P.drawImage(t,k,C),null==M||M.toBlob(e,E,T)})).catch(t)})).catch(t)}))}X.defaultOptions=Q;var J=n("fdw3"),Z=n("bKAG"),ee={newAvatarStoryOptions:{},onUploadedDone:Object(u.default)("resp"),fallback:function(e,t){var n=window.nav,i=e.nextSibling;return!!i&&!n.go(i)},onUploadProgress:function(e){window.photoview.updateUpload({progress:e.loaded/e.total})},onUploadComplete:function(e){var t=window.photoview,n=e.target.responseText,i=!1;try{i=parseJSON(n)}catch(e){i={error:"ERR_CLIENT_BAD_RESPONSE: bad request response"}}if(i.error)ee.onUploadError.call(this,e);else{this.xhr=null,this.photo_res=n,this.photo_size=i.size;var a=this.static_url+i.x_src,r=i.size[0],o=i.size[1],s=Math.min(r,o);if(t.onClose=bind(ee.onClose,this),t.openCrop({src:a,max_scale:s/200,onSelect:bind(ee.onCropSelected,this)}),ee.newAvatarStoryOptions.shouldCreateNewAvatarStory){var c;if(i.photo.sizes2&&i.photo.sizes2.length>0){var l=i.photo.sizes2.findIndex((function(e){return e[3]===i.size[0]&&e[4]===i.size[1]}));i.photo.urls2&&i.photo.urls2[l]&&(c=this.static_url+i.photo.urls2[l])}c=c||a,ee.initNewAvatarStory(vk.id,c)}}},onUploadError:function(e){var t=window.photoview;clog("upload error.",e.target.responseText),t.close()},onClose:function(e){this.xhr&&this.xhr.abort&&this.xhr.abort()},onCropSelected:function(e,t,n){var i=window.photoview,a=this,r=a.photo_res,o=a.photo_size,s=o[0],c=o[1],l=Math.min(s,c),u=Math.round(e*s),d=Math.round(t*c),_=Math.round(n*l);if(a.upload_edit_url)var f=a.upload_edit_url;else f=a.base_url+"upload.php?"+Object(V.toQueryString)({act:"owner_photo_edit",_query:r,_origin:location.protocol+"//"+location.host},!0);a.xhr=ajax.plainpost(f,{_crop:[u,d,_].join(",")},(function(e){ee.onCropSuccess.call(a,e)}),(function(e){ee.onCropCancel.call(a)}),!0),i.updateCrop({saving:!0})},onCropSuccess:function(e){var t=window.photoview,n=this;new Promise((function(e){ee.newAvatarStoryOptions.shouldCreateNewAvatarStory?ee.saveNewAvatarStory().then((function(){return e(!0)})).catch((function(){return e(!1)})):e()})).then((function(i){n.xhr=ajax.post("/photos.php?act=done_photo",{_ajax:1,_query:e,_from:n.from,is_snackbar_disabled:Boolean(i)},{onDone:function(e){ee.onUploadedDone(e),t.close()},onFail:function(){ee.onCropCancel.call(n)}})}))},onCropCancel:function(){window.photoview.updateCrop({saving:!1})},prepareInput:function(e){e.files&&e.files.length&&(e.value="")},start:function(e,t){var n=window.photoview;if(!e||!canUploadFile())return ee.fallback(e,t);var i=e.files[0]||!1,a=attr(e,"data-upload-url"),r=attr(e,"data-base-url"),o=attr(e,"data-static-url"),s=attr(e,"data-from"),c=JSON.parse(attr(e,"data-new-avatar-story-data"))||{};if(!i)return!1;if(!a)return ee.fallback(e,t);var l={upload_url:a,base_url:r,static_url:o,file:i,from:s};return ee.newAvatarStoryOptions=Object(B.default)({},c),l.xhr=uploadFile(a,{photo:i},{onProgress:bind(ee.onUploadProgress,l),onComplete:bind(ee.onUploadComplete,l),onError:bind(ee.onUploadError,l)}),readFile(i,(function(e){n.updateUpload({thumb:e})})),replace(clone(e),e),n.onClose=bind(ee.onClose,l),n.openUpload({src:null}),!1},initNewAvatarStory:function(e,t){var n;ee.getNewAvatarStoryUploadResult=Object(f.addStatic)((n={},n[ee.newAvatarStoryOptions.newAvatarStoryFontsCssPath]=null,n)).then((function(){return Promise.all([Object(W.loadFontFacePromise)("TT Commons",{weight:500}),Object(W.loadFontFacePromise)("TT Commons",{weight:600})])})).then((function(){return Promise.all([X({newAvatarUrl:t,oldAvatarUrl:ee.newAvatarStoryOptions.currentPhoto,title:Object(J.getLang)("mobile_stories_new_avatar_story_title_header"),pollStickerOptions:{title:Object(J.getLang)("mobile_stories_new_avatar_story_poll_sticker_title"),voteButtonText:Object(J.getLang)("mobile_stories_poll_sticker_vote_button_text")}}),(n=ee.newAvatarStoryOptions.newAvatarStoryCreatePollHash,new Promise((function(e,t){window.ajax.post(Object(W.isMvk)()?"stories.php":"al_stories.php",{act:"create_new_avatar_poll",hash:n},{onDone:e,onError:t,onFail:t})}))).then((function(e){return e||Promise.reject()})).then((function(t){return Object(Z.getStoryUploadUrl)({clickable_stickers:JSON.stringify({original_width:1080,original_height:1920,clickable_stickers:[Y(e,t)]}),hash:ee.newAvatarStoryOptions.newAvatarStoryUploadUrlHash,entry_point:Z.StoryEntryPoint.CHANGE_AVATAR,ref:window.cur.module})}))]).then((function(e){var t=e[0],n=e[1];return window.StoryPublisher.uploadStoryBlobToServer(t,n)}));var n}))},saveNewAvatarStory:function(){return ee.getNewAvatarStoryUploadResult.then((function(e){var t=e.response;return Object(Z.saveStoryOnServer)(t&&t.upload_result,ee.newAvatarStoryOptions.newAvatarStorySaveHash).then((function(e){var t=e.story,n=t.owner_id,i=t.id;N.init({type:N.SNACKBAR_TYPE_SUCCESS,text:{inner:[{inner:Object(J.getLang)("mobile_stories_new_avatar_story_success_box_text"),attrs:{style:"margin-bottom: 8px;"}},{tag:"a",class:"link",href:"/story"+n+"_"+i,onclick:"window.ownerPhotoUpload.openNewAvatarStory(event, "+n+", "+i+")",inner:Object(J.getLang)("mobile_stories_new_avatar_story_success_box_open_story")}]}})})).catch((function(e){N.init({type:N.SNACKBAR_TYPE_ERROR,text:e&&e.message||Object(J.getLang)("global_error")})}))}))},openNewAvatarStory:function(e,t,n){e.metaKey||e.ctrlKey||(e.preventDefault(),window.Stories.init(t+"/"+t+"_"+n,{source:Z.StorySource.PROFILE_SNACKBAR}))},getCropFromTag:function(e,t,n){if(!e)return!1;if(3==e.length)var i=+e[0],a=+e[1],r=+e[2];else{i=+e[0]*t/1e4,a=+e[1]*n/1e4,r=+e[2]*t/1e4;var o=+e[3]*n/1e4;if(r>o&&(i+=(r-o)/2,r=o),r<200){var s=(200-r)/2;i-=s,a-=s,r=200}r=Math.min(Math.max(r,200),Math.min(t,n)),i=Math.min(Math.max(i,0),t-r),a=Math.min(Math.max(a,0),n-r)}return[i/t,a/n,r/Math.min(t,n)]},crop:function(e){if(!e||!e.size&&!e.url)return!1;var t=window.photoview,n={upload_edit_url:e.upload_url};if(e.size){n.photo_size=e.size;var i=Math.min(e.size[0],e.size[1]);t.onClose=bind(ee.onClose,n),t.openCrop({src:e.thumb,max_scale:i/200,rect:ee.getCropFromTag(e.rect,e.size[0],e.size[1]),onSelect:bind(ee.onCropSelected,n)})}else{var a=ce("img",{src:e.url,onload:function(){n.photo_size=[a.width,a.height];var i=Math.min(a.width,a.height);t.updateCrop({src:e.thumb,max_scale:i/200,rect:ee.getCropFromTag(e.rect,a.width,a.height),onSelect:bind(ee.onCropSelected,n)})}});t.onClose=bind(ee.onClose,n),t.openCrop({src:!0})}return!0},generateNewAvatarStory:X,drawPollSticker:K};window.ownerPhotoUpload=ee;n("+YbT");var te=n("dmnf"),ne=n("2W9W");var ie=n("wTbK"),ae=n("t7Ww"),oe=n("w1cP");var le,ue=function(){return[Object(ae.ModalMenuHeaderCloseButton)({onClose:["DarkSchemeModal.closeAndSendStat","click_close_button","this"]}),Object(ae.ModalMenuIcon)({inner:[{inner:[Object(R.default)({icon:Object(oe.getImgDarkThemeIcon)()})],class:"DarkSchemeModal__icon",tag:"div"}]}),Object(ae.ModalMenuTitle)({inner:[d.default.wrap(Object(J.getLang)("mobile_dark_scheme_modal_title"))]}),Object(ae.ModalMenuBody)({inner:[{inner:[d.default.wrap(Object(J.getLang)("mobile_dark_scheme_modal_description"))],class:"DarkSchemeModal__description",tag:"div"},{inner:[d.default.wrap(Object(J.getLang)("mobile_dark_scheme_modal_description_additional"))],class:"DarkSchemeModal__descriptionAdditional",tag:"div"}]}),Object(ae.ModalMenuBtn)({inner:[Object(J.getLang)("mobile_dark_scheme_modal_button")],url:"/settings?act=appearance",theme:"regular",size:"large",isBtn:!0,onclick:["DarkSchemeModal.goToAppearance","this","event"]})]};function de(e){ie.default.close(e)}function _e(e){if(!le){var t={event:e,_ajax:1};L.default.post("/promo?act=dark_scheme_guide_close",t),le=!0}}var fe={open:function(){var e=d.default.elem(Object(ie.default)({class:"DarkSchemeModal",on_overlay_click:["DarkSchemeModal.closeAndSendStat","click_overlay"],body:ue()}));o.colorScheme.applyScheme(e,o.ColorSchemeName.Dark),le=!1,ie.default.open(e,!0,"",{onClose:function(){_e("close")}}),Object(P.statlogsValueEvent)("mvk_dark_scheme_guide","shown")},close:de,closeAndSendStat:function(e,t){_e(e),de(t)},goToAppearance:function(e,t){return _e("click_button"),de(e),nav.go(e,t)}};window.DarkSchemeModal=fe;var pe,he=n("wMVj"),me=n("BoyB"),ve=n("YU/R"),Ae=n("Fkq0"),be=n("h8oe"),we=n("RJa5"),ye=n("IetZ"),Oe=n("XNGt"),Se=function(){return(Se=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ke=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),a=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,a++)i[a]=r[o];return i},Ce=function(){function e(e,t){var n=this;this.blockId=t;this.observed_items=[],this.observer=new IntersectionObserver((function(e){return n.onView(e)}),{root:null,rootMargin:"0px",threshold:.5}),this.productCollector=new h.ProductionStatCollector,this.viewCollector=new h.ViewStatCollector(this.productCollector),this.clickCollector=new h.ClickStatCollector(this.productCollector),this.elements=e,this.addHandlers()}return e.prototype.destroy=function(){var e=this;this.observer.disconnect(),this.observed_items.forEach((function(t,n){return e.sendViewStat(n)})),this.elements.forEach((function(t){return t.removeEventListener("mousedown",e.clickHandler)}))},e.prototype.addHandlers=function(){var e=this;this.clickHandler=this.onClick.bind(this),this.elements.forEach((function(t){return t.addEventListener("mousedown",e.clickHandler)})),this.elements.forEach((function(t){return e.observer.observe(t)}))},e.prototype.onClick=function(e){if(e.currentTarget&&e.currentTarget instanceof HTMLElement&&e.currentTarget.parentElement&&e.currentTarget.dataset.id){var t=parseInt(e.currentTarget.dataset.id),n={type:m.ClickProductionStatEventTypes.TYPE_CATALOG_BANNER_ITEM,position:ke(e.currentTarget.parentElement.children).indexOf(e.currentTarget)+1},i={type:m.EventItemType.CATALOG_BANNER,id:t,track_code:this.blockId};this.clickCollector.logEvent(n,i)}},e.prototype.sendViewStat=function(e){if(void 0!==this.observed_items[e]){var t=Se(Se({},this.observed_items[e]),{end_view:this.productCollector.getCurrentTime()}),n={type:m.EventItemType.CATALOG_BANNER,id:e,track_code:this.blockId};this.viewCollector.logEvent(t,n),delete this.observed_items[e]}},e.prototype.onView=function(e){var t=this;e.forEach((function(e){var n=e.target;if(n instanceof HTMLElement&&n.parentElement&&n.dataset.id){var i=parseInt(n.dataset.id);e.isIntersecting?void 0===t.observed_items[i]&&(t.observed_items[i]={type:m.ViewProductionStatEventTypes.TYPE_CATALOG_BANNER_ITEM,start_view:t.productCollector.getCurrentTime(),end_view:"0",position:ke(n.parentElement.children).indexOf(n)+1}):t.sendViewStat(i)}}))},e}();!function(e){e.Click="click",e.Close="close"}(pe||(pe={}));var je,Ee=function(){function e(e,t){this.blockContent=e,this.blockId=t;var n=this.getBanners();this.bannerStatCollector=new Ce(n,t)}return e.prototype.getBanners=function(){return Array.from(this.blockContent.querySelectorAll(".BannerItem"))},e.prototype.setBannersEvents=function(){var e=this;this.getBanners().forEach((function(t){if(t.dataset.id){var n=parseInt(t.dataset.id);e.addConsumableClick(t,n),e.addConsumableCloseClick(t,n)}}))},e.prototype.checkItems=function(){this.getBanners().length||this.blockContent&&this.blockContent.remove()},e.prototype.destroy=function(){this.bannerStatCollector.destroy()},e}(),Te=(je=function(e,t){return(je=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}je(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Ie=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),a=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,a++)i[a]=r[o];return i},Me=function(e){var t=e.split(" "),n=(t=t.slice(0,t.length-1)).join(" ");return n&&(n+="..."),n},Pe=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.initLoop(),i.truncateTexts(),i.setBannersEvents(),i}return Te(t,e),t.initBannerBlocks=function(){var e=document.querySelectorAll(".AudioBlock_catalog_banners");return Ie(e).map((function(e){return new t(e,e.dataset.blockId||"")}))},t.prototype.truncateTexts=function(){this.getBanners().forEach((function(e){var t=e.querySelector(".Banner__subheader");if(t instanceof HTMLElement&&t.scrollHeight/t.clientHeight>1.1)for(var n=t.clientHeight,i=t.innerHTML;i&&t.scrollHeight/n>1.1;)i=Me(i),t.innerHTML=i;var a=e.querySelector(".Banner__header");if(a instanceof HTMLElement&&a.scrollHeight>a.clientHeight)for(var r=a.innerHTML;r&&a.scrollHeight>a.clientHeight;)r=Me(r),a.innerHTML=r}))},t.prototype.addConsumableClick=function(e,t){var n=this;if(e.classList.contains("BannerItem--consumable")&&e.dataset.id){var i=e.querySelector(".Banner__link");if(i instanceof HTMLElement){var a=i.onclick;i.onclick=null,i.addEventListener("click",(function(i){n.consumeBanner(t,pe.Click),n.removeBanner(t),a&&a.call(e,i)}))}}},t.prototype.addConsumableCloseClick=function(e,t){var n=this,i=e.querySelector(".Banner__dismiss");i instanceof HTMLElement&&(i.onclick=function(e){n.consumeBanner(t,pe.Close),n.removeBanner(t),n.checkItems(),e.stopPropagation(),e.preventDefault()})},t.prototype.removeBanner=function(e){this.blockContent.querySelectorAll('.BannerItem[data-id="'+e+'"]').forEach((function(e){return e.remove()})),this.loopSlider&&this.loopSlider.init()},t.prototype.initLoop=function(){if((this.blockContent.classList.contains("AudioBlock_slider")||this.blockContent.classList.contains("AudioBlock_large_slider"))&&this.blockContent.querySelector(".Slider--loop")){var e=this.blockContent.querySelector(".Slider__scroll");e instanceof HTMLElement&&(e.onwheel=null,this.loopSlider=new Oe.LoopSlider(e,this.blockContent.querySelector(".Slider__line")))}},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.loopSlider&&this.loopSlider.destroy()},t.prototype.consumeBanner=function(e,t){L.default.post("/audio",{act:"consume_banner",id:e,ref:this.blockId,reason:t})},t}(Ee),De="",xe=function(){function e(){}return e.initBanners=function(){Pe.initLoop()},e.getContainerElement=function(){return document.querySelector("."+e.CONTAINER)},e.getSection=function(t){return document.querySelector("."+e.BASE_SELECTOR+"__"+t)},e.getAllSections=function(){return Array.from(document.querySelectorAll("."+e.BASE_SELECTOR))},e.setSectionContent=function(e,t){var n=document.querySelector("."+e);n&&(n.innerHTML=t)},e.onSearchLoaded=function(t,n,i,a,r){De===a&&e.toggleSearch(a,r)},e.onSearchFiltered=function(t,n){De=t,e.toggleSearch(t,n)},e.toggleSearch=function(t,n){e.getAllSections().forEach((function(e){var i=n===e?!!t:!t,a=e.querySelector(".show_more");a instanceof HTMLElement&&(i?delete a.dataset.disabled:a.dataset.disabled="1"),Object(r.toggle)(e,i)}))},e.handlePagination=function(t,n){var i=e.getSection(n.name),a=window.cdf(t);if(i&&a){var r=void 0,o=i.querySelectorAll(".AudioBlock"),s=o[o.length-1];(r=s instanceof HTMLElement&&s.dataset.view_type&&["list","music_chart_list"].includes(s.dataset.view_type)?s.querySelector(".AudioBlock__content"):i)&&r.append(a)}},e.BASE_SELECTOR="AudioSection",e.CONTAINER="AudioSerp",e}(),Le=n("lPa4"),Be=n("1UEa");function Re(e){var t=!1,n={onStart:function(){Object(r.addClass)("wia_item--loading",this.link)},onDone:function(){var i=e.onDone&&e.onDone.apply(this,arguments);if(i){var a=i.wdHTML,o=i.data,s=i.onDoneEnd;if(a){var c=Wd.elem(a);Object(r.replace)(c,this.link.parentNode),o&&!t&&Snackbar.init({text:o.title,action:{url:o.href,text:o.undo_title,callback:function(e,i){var a=i.id;e.preventDefault(),t=!0,ajax.click(c.querySelector("a"),n),Snackbar.close(a)}}}),t=!1}s&&s()}}};return n}var Ne={onDone:function(e,t,n,i,a){var o=window,s=o.photo;if(Le.Like.onDone.apply(this,arguments),this.photo_id){var c=s.get(this.photo_id);if(c){Object(r.ce)("div",{innerHTML:t});var l=Object(r.ce)("div",{innerHTML:i});c.likes=Object(r.val)(u),c.likes_cnt=Object(r.intval)((Object(r.attr)(Object(r.geByClass1)("v_like",l),"data-like_count")||"").replace(/\D+/g,"")),c.likes_me=a,c.liked_people=t,c.like_buttons=i;var u=Object(r.ce)("div",{innerHTML:c.actions}),d=Object(r.geByClass1)("like_wrap",u);Object(r.val)(d,i),s.save(c)}}},onFail:Le.Like.onFail},Fe={onDone:function(e){var t=window.photo;if(this.photo_id){if(!e.error){var n={};"confirm"===e.type?n={type:N.SNACKBAR_TYPE_SUCCESS,text:getLang("mobile_msg_photos_tag_confirmed")}:"delete"===e.type&&(n={type:N.SNACKBAR_TYPE_SUCCESS,text:getLang("mobile_msg_photos_tag_deleted")}),Snackbar.init(n)}var i=t.get(this.photo_id);i&&(i.tag_info="",t.save(i));var a=Object(r.geByClass1)("photo_view"),o=Object(r.geByClass1)("pv_tag_wrap",a);Object(r.val)(o,"")}}},He=Re({onStart:function(e){console.log(this,e)},onDone:function(e,t,n,i){var a=photo.get(t);a&&(a.isDeleted=n,photo.save(a)),Object(F.$)(".PhotoviewPage").classList.toggle("PhotoviewPage--deleted",n);return{wdHTML:e,data:i,onDoneEnd:function(){var e=Object(F.$)("#photo_actions"),t=$$(".ContextMenu__list li",e);Array.from(t).forEach((function(e){n&&"delete"!==domData(e,"name")&&Object(r.hide)(e),n||Object(r.show)(e)})),a&&(a.actions=e.innerHTML,photo.save(a))}}}}),Ue={onDone:function(e,t){var n=window.isNewMail&&Object(F.$)(".messenger")&&this.link.closest(".msg");if(Object(r.val)(e,t),n){var i=Number(n.className.match(/msg_id_(\d+)/)[1]);store.mail.msgs[i].textFull=n.$(".msg__text").innerHTML}}},Ve={onDone:function(e){this.link&&(Object(r.after)(cdf(e),Object(r.gpeByClass)("pic_body_wrap",this.link)),Object(r.hide)(this.link))}},We=Re({onStart:function(){Object(r.addClass)("cm_item_loading",this.link)},onDone:function(e,t,n){if(!e)return{wdHTML:t,data:n};this.link&&Object(r.val)(this.link.parentNode,e)}}),$e={onDone:function(e,t,n){if(void 0===n&&(n={}),e){var i=window.photo;Object(r.remove)(e+"_msg");var a=Object(r.ge)(e);if(a){if(n.remove)re(a),re(e+"_msg");else if(t){var o=Object(r.ce)("div",{id:e+"_msg",className:(a.className||"")+" post_message_item"}),s=n.no_wrap?t:'<div class="pi_cont">'+t+"</div>";Object(r.val)(o,s),Object(r.after)(o,a),Object(r.hide)(a),Object(r.geByClass1)("rtm_reply_wrap",a)&&window.reply&&window.reply.edithide()}else Object(r.show)(e);if(this.photo_id){var c=i.get(this.photo_id);if(c){var l=Object(r.geByClass1)("photoview"),u=Object(r.geByClass1)("comments_wrap",l);c.comments_html=Object(r.val)(u)}}}}}},qe={onDone:function(e,t,n,i){if(e){Object(r.remove)(e+"_msg");var a=Object(r.ge)(e);if(a)if(t){var o=(/^([a-z]+)_item$/i.exec(n||"")||[])[1]||"inline",s=Object(r.ce)("div",{id:e+"_msg",className:o+"_item "+o+"_message_item"}),c=i||"message_item_cont";Object(r.val)(s,'<div class="'+c+'">'+t+"</div>"),Object(r.after)(s,a),Object(r.hide)(a)}else!1===t?(a.classList.add("_deleted"),Object(r.hide)(a)):Object(r.show)(a)}}},ze={onDone:function(e,t,n){if(e){var i=Object(r.ge)(e),a=Object(r.getY)(i)||Object(r.getY)(e+"_msg"),o=Object(r.getH)(i)||Object(r.getH)(e+"_msg"),s=a+(u<320?o:0)-Object(r.scrollTop)();if(Object(r.remove)(e+"_msg"),i){var c=Object(r.hasClass)("wall_item",i)||Object(r.hasClass)("post",i)?"wall":"post";if(n){var l=Object(r.ce)("div",{id:e+"_msg",className:c+"_item post_message_item"});Object(r.val)(l,'<div class="pi_cont">'+n+"</div>"),Object(r.after)(l,i)}if(t){Object(r.each)(Object(r.geByClass)(c+"_item"),(function(){var e=!!this.id&&this.id.match(/^wall((-?\d+)_(-?\d+)(_\d+)?)$/),i=Object(r.attr)(this,"data-copy"),a=!!i&&i.match(/^(-?\d+)_(-?\d+)$/);if(!e)return!0;(!e[4]&&e[2]==t||e[4]&&e[3]==t||a&&a[1]==t)&&Object(r.toggleClass)("post_item_ignored",this,n)}));var u=Object(r.getCw)(),d=(a=Object(r.getY)(i)||Object(r.getY)(e+"_msg"),o=Object(r.getH)(i)||Object(r.getH)(e+"_msg"),a+(u<320?o:0)-s);Object(r.geByClass1)("wall_item")===i&&(d=0),Object(r.scrollTop)(d);var _=Object(F.$)(".ContextMenu",i);_&&ve.default.close(_)}}}}},Ye={onDone:function(e,t){if(e){var n=Object(r.ge)(e);if(Object(r.remove)(e+"_msg"),n&&t){var i=Object(r.hasClass)("wall_item",n)||Object(r.hasClass)("post",n)?"wall":"post",a=Object(r.ce)("div",{id:e+"_msg",className:i+"_item post_message_item"});Object(r.val)(a,'<div class="pi_cont">'+t+"</div>"),Object(r.after)(a,n)}Object(r.toggleClass)("post_item_ignored",n,t)}}},Ge={onDone:function(e,t,n){if(e){var i=Object(r.ge)(e);if(Object(r.remove)(e+"_msg"),i){if(n){var a=Object(r.ce)("div",{id:e+"_msg",className:"wall_item post_message_item"});Object(r.val)(a,'<div class="pi_cont">'+n+"</div>"),Object(r.after)(a,i)}Object(r.toggleClass)("post_item_ignored",i)}}}},Ke={onStart:function(){var e=Object(r.gpeByClass)("show_more_wrap",this.link),t=Object(r.geByClass1)("show_more",e)||this.link,n=Object(r.ce)("div",{id:"show_more_loading",className:"show_more_loading show_more_loading--spinner",innerHTML:Object(me.default)({spinner:!0})}),i=Object(r.ce)("div",{id:"show_more_wrap",className:"show_next_wrap show_next_wrap_transparent"});Object(r.attr)(n,"data-href",Object(r.getHref)(t)),i.appendChild(n),Object(r.before)(i,e),Object(r.remove)(e)},onDone:function(e){var t=window.cur;ajax.tAlProcess=(new Date).getTime();var n=Object(r.ge)("show_more_wrap"),i=cdf(e);Object(r.before)(i,n),Object(r.remove)(n),ajax.prepare_click("mcont"),Object(r.onBodyScrollForce)(100),ajax.tAlModule=t.module,ajax.tAlRender=(new Date).getTime(),ajax.onPostsLoad(),Gif.onUpdate(),window.UnauthorizedFeed&&UnauthorizedFeed.onUpdate(),Object(D.resizePosters)()}},Qe={onStart:Ke.onStart,onDone:function(e){Ke.onDone.apply(null,arguments),Object(ye.cutTextToHighlight)(".SearchItemServicesInfo__textMatch")}},Xe={onStart:Ke.onStart,onDone:function(e,t){Ke.onDone.apply(null,arguments),Bookmarks.pushItemsToStore(t)}},Je={onStart:Ke.onStart,onDone:function(e,t){var n=window.cur;ajax.tAlProcess=(new Date).getTime();var i=Object(r.geByClass1)("photos_page","mcont"),a=Object(r.ge)("show_more_wrap"),o=cdf(t);e=e.replace(/<img src="([^"]+)" class="/gi,'<img data-src="$1" class="_image ');var s=cdf(e);i&&i.appendChild(s),Object(r.before)(o,a),Object(r.remove)(a),ajax.prepare_click("mcont"),Object(r.onBodyScrollForce)(100),ajax.tAlModule=n.module,ajax.tAlRender=(new Date).getTime(),Object(D.resizePosters)()}},Ze={onStart:Ke.onStart,onDone:function(e,t){var n=window.cur;ajax.tAlProcess=(new Date).getTime();var i=Object(r.geByClass1)("audios_block",Object(r.geByClass1)("audios","mcont")),a=Object(r.ge)("show_more_wrap"),o=cdf(t),s=cdf(e);i&&i.appendChild(s),Object(r.before)(o,a),Object(r.remove)(a),ajax.prepare_click("mcont"),ajax.tAlModule=n.module,ajax.tAlRender=(new Date).getTime()}},et={onStart:Ke.onStart,onDone:function(e,t){var n=window.cur,i=e[0],a=e[1],o=Object(r.ge)("show_more_wrap");ajax.tAlProcess=Date.now(),xe.handlePagination(i,t),Object(r.remove)(o);var s=xe.getSection(t.name);s&&s.appendChild(cdf(a)),ajax.prepare_click("mcont"),Object(r.onBodyScrollForce)(100),ajax.tAlModule=n.module,ajax.tAlRender=Date.now()}},tt=Re({onDone:function(e,t,n){if(!e)return{wdHTML:t,data:n};var i=Object(r.ge)(e);i&&i.parentNode&&t&&Object(r.replace)(cdf(t),i.parentNode)}}),nt=Re({onDone:function(e,t,n){return void 0===n&&(n={}),n.snackbar&&Snackbar.init(n.snackbar),{wdHTML:e,data:t}}}),it={onStart:function(){Object(r.addClass)("mva_item_loading",this.link)},onDone:function(e,t){Object(r.removeClass)("mva_item_loading",this.link),ownerPhotoUpload&&ownerPhotoUpload.newAvatarStoryOptions.shouldCreateNewAvatarStory&&(ownerPhotoUpload.newAvatarStoryOptions={}),e.upload_url||t&&nav.hard_go(t),ownerPhotoUpload&&ownerPhotoUpload.crop(e)||t&&nav.hard_go(t)},onFail:function(){Object(r.removeClass)("mva_item_loading",this.link)}},at={onStart:function(){var e=this.link,t=Object(r.gpeByClass)("notify_lite",e);if(t)return Object(r.remove)(t);for(;e=e.parentNode;)if(Object(r.hasClass)("notify_item",e)){Object(r.hasClass)("notify_panel",e.parentNode)?Object(r.remove)(e.parentNode):Object(r.remove)(e);break}}},rt={onStart:function(){var e=Object(r.geByClass)("pagination","mcont");Object(r.each)(e,(function(e,t){Object(r.before)(Object(r.ce)("div",{className:"summary_loading",innerHTML:'<i class="i_loading"></i>'}),t.firstChild)}))},onDone:function(e,t,n){var i=window.mail,a=Object(r.ge)("messages"+t);a&&(Object(r.val)(a,e),i.onMessagesRepainted(!0),!this.save&&Object(r.scrollToEl)()),this.save&&i.saveDialog({messages:e},t),this.clear&&(Object(r.val)(Object(r.geByTag1)("textarea","write_form"),""),Object(r.remove)(Object(r.geByClass1)("pi_medias","write_form"))),Object(r.removeClass)("cp_attach_btn_sel",Object(r.geByClass1)("cp_attach_btn")),window.isNewMail&&MailScrap.clearSystemMessage2(),n&&n.play_animation_msg_id&&StickersSettings.getAutoplay()&&StickersAnimation.loadStickerInMvkIMAndPlay(n.play_animation_msg_id)},onFail:function(){var e=Array.prototype.slice.call(arguments),t=e.shift();switch(t){case 2:this.link.form&&this.link.form.submit()}}},ot={onStart:function(){var e=Object(r.geByClass)("pagination","mcont");Object(r.each)(e,(function(e,t){Object(r.before)(Object(r.ce)("div",{className:"summary_loading",innerHTML:'<i class="i_loading"></i>'}),t.firstChild)}))},onDone:function(e,t){var n=window.mail,i=Object(r.ge)("dialogs");i&&(Object(r.val)(i,e),!this.no_scroll&&Object(r.scrollToEl)(),n.cacheDialogsPage()),n.save(t)}},st={onFail:function(e,t){if(e===ajax.RESPONSE_CAPTCHA){var n=this.link&&this.link.form;t+="&code="+(n&&n.code?n.code.value:""),nav.hard_go(t)}}},ct={onStart:function(){var e=Object(r.gpeByClass)("friendsList__showMoreBtnWrap",this.link),t=Object(r.geByClass1)("friendsList__showMoreBtn",e)||this.link,n=Object(r.ce)("div",{id:"show_more_loading",className:"show_more_loading",innerHTML:'<i class="i_loading">&nbsp;</i>'}),i=Object(r.ce)("div",{id:"show_more_wrap",className:"show_next_wrap show_next_wrap_transparent friendsList__showMoreBtnWrap"});Object(r.attr)(n,"data-href",Object(r.getHref)(t)),i.appendChild(n),Object(r.before)(i,e),Object(r.remove)(e)},onFail:function(){var e=this,t=this.link.getAttribute("data-href")||this.link.getAttribute("href");setTimeout((function(){ajax.post(t,{_ajax:1},{onDone:ct.onDone.bind(e),onFail:ct.onFail.bind(e)})}),500)},onDone:Ke.onDone},lt=Re({onDone:function(e,t,n){if(!e)return{wdHTML:t,data:n};var i=Object(r.ge)(e);i&&i.parentNode&&t&&Object(r.replace)(cdf(t),i.parentNode)}}),ut=Re({onDone:function(e,t,n){if(!e)return{wdHTML:t,data:n};var i=Object(r.geByClass)(e);if(i.length&&t)for(var a=0,o=i.length;a<o;a++)i[a].parentNode&&Object(r.replace)(cdf(t),i[a].parentNode)}}),dt={onStart:function(){var e=this.link;e.classList.contains("wia_item")&&e.classList.add("wia_item--loading")},onDone:function(e,t,n,i,a){if(e){var o=Object(r.geByClass)(e);if(o.length&&t)for(var s=0,c=o.length;s<c;s++)o[s].parentNode&&Object(r.replace)(cdf(t),o[s].parentNode);Share.setBookmarkState(i,a),n&&Bookmarks.showSuccessSnack(n);var l=Object(Ae.parseBookmarkedProductClass)(e);l&&Object(be.trackMarketEvent)({event:a?we.ECommGoodsEvent.ADD_ITEM_TO_BOOKMARKS:we.ECommGoodsEvent.REMOVE_ITEM_FROM_BOOKMARKS,ownerId:l.ownerId,itemId:l.itemId,instant:!0}),n&&31===n.item_type&&a&&Object(Be.sendNarrativeAnalytic)(Be.NarrativeAnalyticEventType.addToBookmarks,n.item_oid,n.item_id,Be.NarrativeAnalyticNavScreen.other)}}},_t=Re({onDone:function(e,t,n,i,a,o){if(!e)return{wdHTML:a,data:o};var s=Object(r.ge)(e);if(!s)return{wdHTML:a,data:o};var c=Object(r.geByClass1)("wia_close",s);if(c&&(Object(r.val)(c,n),c.href=t),!Object(r.hasClass)("single_wall_item",s))return{wdHTML:a,data:o};var l=Object(r.ge)("nc_form"),u=Object(r.geByClass1)("wall_replies");return l?Object(r.toggle)(l,!!i):i&&(u?domInsert(u,i):(domInsertAfter(Object(r.ce)("div",{innerHTML:i}),s),u=Object(r.geByClass1)("wall_replies"))),Object(r.toggleClass)("closed_comments",u,!i),{wdHTML:a,data:o}}}),ft={onStart:function(){var e=domPN(this.link),t=Object(r.geByClass1)("Loading",e);t||(t=Object(r.ceFromString)(Object(me.default)({})),append(t,e)),Object(r.addClass)("RepliesThreadNext_loading",e)},onDone:function(e,t,n,i){var a,o=domPN(this.link),s=Object(r.hasClass)("RepliesThreadNext_prev",o),c=0,l=cdf(e);if(domChildren(l).forEach((function(e){Object(r.ge)(e.id)&&re(e)})),s?(a=Object(r.gpeByClass)("wall_replies",o),c=Object(r.getH)(a),Object(r.after)(l,o)):Object(r.before)(l,o),i?(this.link.href=i,Object(r.removeClass)("RepliesThreadNext_loading",o)):re(o),Gif.onUpdate(),Object(D.resizePosters)(),n&&(cur.replyNames=Object(r.extend)(cur.replyNames||{},n)),t&&t.length&&Mention.addItems(t),s){var u=Object(r.getH)(a)-c;Object(r.scrollTop)(Object(r.scrollTop)()+u)}Object(r.onBodyScrollForce)()},onFail:function(){var e=domPN(this.link),t=Object(r.geByClass1)("i_loading",e);Object(r.hide)(t),Object(r.show)(this.link),Object(r.removeClass)("RepliesThreadNext_loading",e)}},pt={onDone:function(e,t,n){var i=Object(r.geByClass1)("RepliesWrap");i.innerHTML=e,Gif.onUpdate(),Object(D.resizePosters)(),n&&Object(r.extend)(cur.replyNames,n),t&&t.length&&Mention.addItems(t),Object(r.scrollTop)(Object(r.getH)(i)+Object(r.getY)(i))}},ht={onDone:function(e,t,n,i){if(e){var a=Object(r.ge)(e);if(a){if(i)Object(r.geByClass)("ReplyItem__message_type_"+i,a).forEach((function(e){re(e)}));var o=Object(r.geByClass1)("ReplyItem__wrap",a),s=Object(r.geByClass)("ReplyItem__message",a),c=s.pop();if(t){var l=cdf(t);Object(r.hide)(c||o),Object(r.after)(l,c||o),Object(r.geByClass1)("rtm_reply_wrap",a)&&window.reply&&window.reply.edithide()}else i||(re(c),c=s.pop()),Object(r.show)(c||o);if(n){var u=Object(r.ge)("RepliesThread"+n);u&&Object(r.toggle)(u,!t)}}}}},mt={onStart:function(){Btn.setLoading(document.querySelector("#email_soft_bouncing a.Btn"),!0)},onDone:function(e){1===e&&document.getElementById("email_soft_bouncing").remove(),Btn.setLoading(document.querySelector("#email_soft_bouncing a.Btn"),!1)}};window.Like=Le.Like,window.PhotoLike=Ne,window.PhotoTag=Fe,window.PhotoDelete=He,window.Poll=Ue,window.CopyHistory=Ve,window.ToggleMenu=We,window.Comment=$e,window.ItemDelete=qe,window.FeedIgnore=ze,window.FeedIgnoreItem=Ye,window.FeedIgnoreComments=Ge,window.Wall=Ke,window.SearchServices=Qe,window.Bookmark=Xe,window.BookmarkToggle=dt,window.Photos=Je,window.Audios=Ze,window.AudioSection=et,window.FixPost=tt,window.ContextMenuCommonAction=nt,window.ProfileMove=it,window.Notify=at,window.Dialog=rt,window.Dialogs=ot,window.LoginCheckAuthCodePage=st,window.WallSubscribe=lt,window.FeedSubscribe=ut,window.ImportedFriends=ct,window.CloseComments=_t,window.RepliesNext=ft,window.RepliesLast=pt,window.ReplyAction=ht,window.MiniAppsCatalogResetRecent=function(e){if(e.dataset.section){var t={act:"mini_apps_reset_recent",hash:e.dataset.hash||""};ajax.post("/apps.php",t,{onDone:function(){var t=Object(r.ge)("mini_apps_"+e.dataset.section);t&&t.remove()}})}},window.ResetEmailSoftBounce=mt;n("AeId"),n("Gzds"),n("kYGI");var vt=n("Qz23"),gt=n("dONA"),At=n("zq7H"),bt=!1,wt={NEED_MENU_PARAM:"_nlm",NEED_MENU:1,FORCE_NEED_MENU:2,enabled:function(e){return!1},opened:function(){return Object(r.hasClass)("lm_opened",window.bodyNode)},toggle:function(e,t){return Object(r.checkEvent)(e),!0},open:function(e){window.zlayer;return Object(r.checkEvent)(e),!0},close:function(e){return Object(r.checkEvent)(e),!0},fix_size:function(e){var t=Object(r.ge)("l"),n=Object(r.ge)("m"),i=Object(r.ge)("mhead"),a=i&&i.offsetHeight||0,o=wt._st||0;t&&n&&(e?n.style.minHeight="0":(o=o>a?o:0,n.style.minHeight=t.offsetHeight+o+"px"),!wt.fixed||Object(r.getCw)()<320?e?n.style.marginTop="0":(t.style.minHeight=Object(r.getCh)()+"px",n.style.marginTop=-o+"px"):t.style.minHeight="0")},clear_hover:function(){thover.clear()},hasMenu:function(){return window.al&&window.al.menu},isMenuHasItems:function(){return wt.hasMenu()&&Object(r.isArray)(window.al.menu)&&window.al.menu.length||Object(r.isObject)(window.al.menu)&&Object.keys(window.al.menu).length},refreshCounters:function(e){if(!wt.hasMenu())return!0;if(!e)return!0;if(Object(r.isArray)(e)&&!e.length)return!0;if(Object(r.isObject)(e)&&!Object.keys(e).length)return!0;if(Object(r.isArray)(e)&&!Object(r.isArray)(window.al.menu))return!1;if(Object(r.isObject)(e)&&!Object(r.isObject)(window.al.menu))return!1;if(Object(r.isArray)(e)&&e.length!=window.al.menu.length)return!1;if(Object(r.isObject)(e)&&Object.keys(e).length!=Object.keys(window.al.menu).length)return!1;void 0!==e[At.COUNTERS_POS_NOTIFICATIONS]&&Tabbar.setCounter(Tabbar.TAB_ID_NOTIFICATION,e[At.COUNTERS_POS_NOTIFICATIONS]),void 0!==e[At.COUNTERS_POS_MESSAGES]&&Tabbar.setCounter(Tabbar.TAB_ID_MESSAGES,e[At.COUNTERS_POS_MESSAGES]);var t=e[At.COUNTERS_POS_NOTIFICATIONS];"number"==typeof t&&isFinite(t)&&(Bell.setCount(t),window.store&&(store.notificationsCount=t));var n=window.al,i=Object(F.$)(".main_menu",document.getElementById("l"));return Object.entries(e).forEach((function(e){var t=e[0],a=e[1];if(void 0===a)return!0;var o=n.menu[t],s=Object(F.$)(".mmi_"+o[0],i),c=Object(F.$)(".mm_item",s),l=Object(F.$)(".mmi_wrap",s),u=Object(F.$)(".mm_counter",l);Object(r.attr)(c,"data-href",!1),a?(o[3]&&Object(r.attr)(c,"href",o[3]),u?Object(r.val)(u,a):Object(r.append)(Object(r.ce)("em",{className:"mm_counter",innerHTML:a}),l)):(o[2]&&Object(r.attr)(c,"href",o[2]),Object(r.remove)(u)),ajax.prepare_click(c)})),!0},refreshSingleCounter:function(e,t){var n;wt.hasMenu()&&(Object(r.isArray)(window.al.menu)&&((n=new Array(al.menu.length))[e]=t),Object(r.isObject)(window.al.menu)&&(n={},Object.entries(window.al.menu).forEach((function(i){i[0];var a=i[1];parseInt(a,10)===parseInt(e,10)?n[a]=t:n[a]=void 0}))),wt.refreshCounters(n))},refreshNotifications:function(e){window.store&&(store.menuNotifications=e);var t=Object(F.$)(".mmi_apps .mmi_wrap");if(t){var n=Object(F.$)('[data-id="menu-apps-notification"]',t);!e[At.COUNTERS_POS_APPS]&&n&&n.remove(),e[At.COUNTERS_POS_APPS]&&!n&&(t.innerHTML+=d.default.render(Object(gt.default)({id:"menu-apps-notification"})))}},refresh:function(e){e=e||{},ajax.refreshLinks(e.fv_link,e.app_link),void 0!==e.pp&&!1!==e.pp&&Object(r.val)("lm_prof_panel",e.pp),void 0!==e.tn&&!1!==e.tn&&Object(r.val)("lm_top_notify",e.tn),void 0!==e.bn&&!1!==e.bn&&Object(r.val)("lm_bottom_notify",e.bn),e.lm&&Object(r.val)("l",e.lm),e.counters&&wt.refreshCounters(e.counters),e.notifications&&wt.refreshNotifications(e.notifications),e.tab&&Tabbar.setCurrentId(e.tab),e.topbar||Object(r.remove)("vk_topbar")},initEvents:function(){var e=wt.getStickedScrollingHandler();e&&(Object(r.onBodyScroll)(e),e(Object(r.scrollGetY)())),Object(r.onBodyResize)((function(){var t=Object(r.ge)("vk_wrap"),n=t&&t.offsetWidth,i=Object(r.hasClass)("_hfixed",window.bodyNode);n>=882&&wt.close(),wt.fix_size(!wt.opened(),i),e&&e(Object(r.scrollGetY)())}))},init:function(){wt.fixed=Object(r.hasClass)("_hfixed",window.bodyNode),wt.initEvents(),Object(r.addEvent)(window,"orientationchange",(function(){var e=Object(r.ge)("vk_wrap").offsetWidth,t=wt._st||0;e>=882&&t>44&&wt.close()}));var e=Object(F.$)(".leftMenu__content");e&&Object(vt.setScrollView)(e,{topBanner:!!x.default.ipad&&void 0,overscrollY:!1,standalone:!0})},blockScroll:function(e){var t=Object(r.ge)("vk_wrap");wt.opened()&&Object(r.getW)(t)<882&&Object(r.preventEvent)(e)},qsOpened:!1,qsOpen:function(){wt.qsOpened||(wt.qs_st=Object(r.scrollTop)(),Object(r.addClass)("qs_opened","vk_wrap"),Object(r.addClass)("qs_opened",window.bodyNode),Object(r.getW)("vk_wrap")<882&&Object(r.scrollTop)(0),wt.qsOpened=!0)},qsClose:function(){wt.qsOpened&&(Object(r.removeClass)("qs_opened","vk_wrap"),Object(r.removeClass)("qs_opened",window.bodyNode),Object(r.getW)("vk_wrap")<882&&Object(r.scrollTop)(wt.qs_st||0),wt.qsOpened=!1)},initSearch:function(){bt||(bt=!0,Object(r.addEvent)("lm_search_items","mousedown touchstart",(function(e){e.stopPropagation()}),{passive:!0}),Object(r.addEvent)(Object(F.$)(".head_search",document.getElementById("l")),"mousedown touchstart",(function(e){e.stopPropagation()}),{passive:!0}),Object(r.addEvent)(document,"mousedown touchstart",(function(e){Object(r.ge)("vk_wrap");wt.qsOpened&&(wt.qsClose(),Object(r.elblur)("lm_search_field"))}),{passive:!0}))},closeSearch:function(){return!0},cancelSearch:function(){return!0},headerAction:function(e,t){return Object(r.getW)("vk_wrap")>=882?nav.go(e,t):wt.toggle()},getStickedScrollingHandler:function(){var e=Object(F.$)(".leftMenu__content"),t=document.body;if(e&&t&&t.classList.contains("_hfixed")&&!t.classList.contains("_touch")){var n,i=Object(r.scrollGetY)(),a=Object(r.scrollGetY)(),o=!1,s=function(t,n){void 0===n&&(n=0),e.style.position=t,e.style.top=n+"px",e.style.bottom=""};return function(t){if(!(t<0||t+window.innerHeight>document.body.scrollHeight||Object(r.getCw)()<882)){var c=e.getBoundingClientRect(),l=Math.round(c.top),u=Math.floor(c.height);if(0!==u){var d=document.body,_=document.documentElement;if(u+56>=Math.max(d.scrollHeight,d.offsetHeight,_.clientHeight,_.scrollHeight,_.offsetHeight))s("absolute");else if(!(u+56>_.scrollHeight)){if((t>i||t===i&&t>0)&&(n="down"),t<i&&(n="up"),i=t,u<window.innerHeight)return s("fixed"),void(a=t+l-56);switch(n){case"down":o=u+l<=window.innerHeight;break;case"up":o=0<=l-56}var f,p;o?("down"===n?(f="fixed",void 0===p&&(p=0),e.style.position=f,e.style.top="",e.style.bottom=p+"px"):s("fixed"),a=t+Math.round(e.getBoundingClientRect().top)-56):s("absolute",a)}}else s("absolute")}}}}};window.menu=wt;var yt=n("wTgh"),Ot=n("cZev"),St=function(){var e={},t={},n=null,i=!1,a={},o={},s={},c=null;function l(){if(n){var t=[],i=!1;if(each(geByClass("_unread"),(function(){var e=+attr(this,"data-id");e&&t.push(e),i=St.getPeerByMsg(e),replaceClass("_unread","_read",this)})),i){var a=ge("messages"+i);a&&e[i]&&(e[i].messages=val(a))}if(t.length)St.sendMarkAsRead(n,t);else{var r=e[n].last_msg;St.sendMarkAsRead(n,r?[r]:[]),St.updateMarkAsUnread(n,!1)}}}function u(e,t){t?(addClass("lvi",e),toggleClass("mlvi",e,!!x.mobPlatforms[t])):(removeClass("lvi",e),removeClass("mlvi",e))}function d(e){(0,e.updater)(document.body),each(e.caches,(function(t,n){var i=n.storage,a=n.getter,r=function(e,t){var n,i=t.split("."),a=i.length,r=e;for(n=0;n<a;n++)if(!(r=r[i[n]]))return null;return r}(i,a);if(r){var o="string"==typeof r;o&&(r=ce("div",{innerHTML:r})),e.updater(r),function(e,t,n){var i,a,r=t.split("."),o=r.length-1,s=e;for(a=0;a<o;a++)s=s[i=r[a]]||(s[i]={});s[r[o]]=n}(i,a,o?r.innerHTML:r)}}))}return!window.isNewMail&&window.nav&&window.nav.onBeforeGo((function(e,t,n){if(nav.getQuery("community")&&(!n||!n.ignore_cur_process)&&"/mail"===("string"==typeof e?e:attr(e,"href")||attr(e,"data-href")))return nav.go(e,t,{ignore_cur_process:!0}),!0})),!window.isNewMail&&window.nav&&window.nav.onBeforeGo((function(){if(nav.getQuery("community"))var e=ajax.post("/",{_ajax:1,act:"ping"},{onDone:function(){try{var t=JSON.parse(e.response),n=t&&t[1]&&t[1][2];St.actualizeMessagesCornerCounter(n)}catch(e){}}})})),{wrapLinks:yt.wrapLinks,wrapMention:Ct,onShowDialogFromCache:Object(r.se)(),onShowWritePageFromCache:Object(r.se)(),onShowDialogsPageFromCache:Object(r.se)(),onMessagesRepainted:Object(r.se)(),init:function(t,a){var r=window.im;window.cur.destroy.push((function(){AudioMessagePlayer.detachPlayer()})),a&&(cur.ref=a.ref,cur.refSource=a.ref_source),t&&(n=t,a&&(St.saveDialog(a,t),e[t])),i||(i=!0,addEvent(document,x.isTouch?"touchstart":"mousedown",l)),setTimeout((function(){r.on()}))},unpinMessage:function(t){d({caches:[{storage:e,getter:t+".write_form"}],updater:function(e){e.$$(".cm_unpin").forEach(hide),e.$$(".head_actions_wrap").forEach((function(e){return e.classList.remove("head_actions_has_pinned")})),e.$$(".pinnedMsg_peer_"+t).forEach((function(e){return e.classList.add("pinnedMsg_hidden")}))}})},pinMessage:function(t,n){d({caches:[{storage:e,getter:t+".write_form"}],updater:function(e){e.$$(".cm_unpin").forEach(show),e.$$(".head_actions_wrap").forEach((function(e){return e.classList.add("head_actions_has_pinned")})),$$(".pinnedMsg_peer_"+t).forEach((function(e){return e.outerHTML=n}))}})},clear:function(){nav.clear();var r=window.im;e={},t={},a={},n=null,removeEvent(document,x.isTouch?"touchstart":"mousedown",l),i=!1,r.off()},send:function(e,t){if(mediaUpload&&!mediaUpload.checkUploading())return!1;var n=ajax.click(e,extend({clear:!0,save:!0},Dialog),{lock:!0,url_params:{ref_source:cur.refSource,ref:cur.ref}});return cur.ref=void 0,cur.refSource=void 0,n},save:function(t){each(t,(function(t,n){e[t]&&n.last_msg==e[t].last_msg&&delete n.messages,St.saveDialog(n,t)}))},saveDialog:function(t,n){e[n]||(e[n]={});var i=e[n];extend(i,t),i.msgs&&each(i.msgs,(function(e,t){a[t]=n}))},getPeerByMsg:function(e){return a[e]||!1},cacheDialogsPage:function(){nav.getQuery("community")&&nav.getQuery("tab")||(t.page=val("m"),nav.getQuery().act?t.link=kt("/mail"):t.link=nav.cur)},keyup:function(e,t,n){var i=c||"",a=e.value||"";i.length==a.length&&i==a||(St.myTyping(t,n),c=a)},myTyping:function(e,t){if(!(e<=-2e9)){var n=vkNow();s[e]&&n-s[e]<5e3||(s[e]=n,ajax.post("/mail",{_ajax:1,act:"typing",peer:e,hash:t,community:nav.getQuery("community")}))}},typing:function(e,t){t=t||e;e>2e9?(o[e]||(o[e]={}),o[e][t]=vkNow()):o[e]=vkNow(),St.updateTyping(e)},updateTyping:function(e){var t=function(e,t){return e.getAttribute&&e.getAttribute(t)},n=window.lang,i=ge("dialog_near"+e),a=geByClass1("di_current_peer",i),r=geByClass1("di_typing",i);if(i){var s=[],c=vkNow();if(e>2e9)each(o[e]||{},(function(e,n){t(r,"data-u"+e)&&n&&c-n<6e3&&s.push(e)}));else{var l=o[e];t(r,"data-u"+e)&&l&&c-l<6e3&&s.push(e)}if(s.length){if(1==s.length){var u=s[0],d=t(r,"data-u"+u),_=t(r,"data-s"+u);val(r,'<i class="i_typing"></i>'+(n.mobile_mail_typing[_]||"").replace("{user}",d))}else{each(s,(function(e,n){s[e]=t(r,"data-u"+n)}));var f=s.pop();val(r,'<i class="i_typing"></i>'+(n.mobile_mail_multi_typing||"").replace("{users}",s.join(", ")).replace("{last_user}",f))}a.offsetWidth&&setStyle(r,"minWidth",a.offsetWidth),addClass("di_typing_now",i),setTimeout((function(){addClass("di_typing_animated",i)}),10),setTimeout((function(){St.updateTyping(e)}),2e3)}else val(r,""),setStyle(r,"minWidth",0),removeClass("di_typing_animated",i),removeClass("di_typing_now",i)}},updateOnline:function(t,n){var i=ge("messages"+t);if(i&&remove(geByClass1("di_activity",i)),each(geByClass("_lv"+t,"mcont"),(function(e,t){u(t,n)})),e[t]){if(e[t].write_form){var a=ce("div",{innerHTML:e[t].write_form});each(geByClass("_lv"+t,a),(function(e,t){u(t,n)})),e[t].write_form=val(a)}if(e[t].messages){a=ce("div",{innerHTML:e[t].messages});remove(geByClass1("di_activity",a)),e[t].messages=val(a)}}},updateImportantMessages:function(n,i,a){d({caches:[{storage:t,getter:"page"},{storage:nav.page_get(kt("/mail")),getter:"html"}],updater:function(e){var t=geByClass1("dialogs_filter_button_important",e);if(t){var n=intval(val(t))+a;val(t,n),toggleClass("dialogs_filter_without_important",geByClass1("dialogs_filter",e),0===n)}}}),d({caches:[{storage:e,getter:n+".messages"}],updater:function(e){var t=geByClass1("_msg"+i,e);t&&toggleClass("msg_item_important",t,1===a)}})},updateImportantDialog:function(e,n){nav.getQuery("community")&&d({caches:[{storage:t,getter:"page"},{storage:nav.page_get(kt("/mail")),getter:"html"}],updater:function(t){var i=geByClass1("_peer"+e,t);i&&toggleClass("dialog_item_important",i,n)}})},markAsListened:function(t){var i=+t.getAttribute("data-msg");if(i&&n){var a=e[n];a&&a.hash&&ajax.post("/mail",{_ajax:1,act:"listen_audiomsg",msg_id:i,hash:a.hash},{onDone:function(){var e=$$('.audio-msg-track[data-msg="'+i+'"]');if(e&&(e.forEach((function(e){e.closest(".im_msg_audiomsg").classList.add("im_msg_audiomsg_listened")})),a&&a.messages)){var t=ce("div",{innerHTML:a.messages}),n=geByClass1("_msg"+i,t),r=$('.audio-msg-track[data-msg="'+i+'"]',n);r&&r.closest(".im_msg_audiomsg").classList.add("im_msg_audiomsg_listened"),a.messages=val(t)}}})}},sendMarkAsRead:function(t,n){isArray(n)||(n=[n]);var i=e[t];i&&i.hash&&ajax.post("/mail",{_ajax:1,act:"mark_read",peer:t,msgs:n.join(","),mark_conversation_as_read:0===n.length,hash:i.hash,community:nav.getQuery("community")},{onDone:function(e){e&&each(n,(function(e,n){St.markAsRead(t,n)}))}})},markAsRead:function(t,n){window.im;var i=ge("messages"+t);if(i){var a=geByClass1("_msg"+n,i);hasClass("_read",a)||removeClass("mi_unread",a);var r=e[t];if(r&&r.messages){var o=ce("div",{innerHTML:r.messages});a=geByClass1("_msg"+n,o);hasClass("_read",a)||removeClass("mi_unread",a),r.messages=val(o)}}},markPeerAsRead:function(n,i,a){var r=ge("messages"+n);if(r&&(each(geByClass("msg_item",r),(function(){if(!a==!hasClass("_unread",this))return!0;+attr(this,"data-id")<=i&&!hasClass("_read",this)&&removeClass("mi_unread",this)})),(l=e[n])&&l.messages)){var o=ce("div",{innerHTML:l.messages});each(geByClass("msg_item",o),(function(){if(!a==!hasClass("_unread",this))return!0;+attr(this,"data-id")<=i&&!hasClass("_read",this)&&removeClass("mi_unread",this)})),l.messages=val(o)}var s=ge("dialogs"),c=a?"di_unread_outbox":"di_unread_inbox";if(s)(l=geByClass1("_peer"+n,s))&&hasClass(c,l)&&(removeClass(c,l),remove(geByClass1("di_unread_cnt",l)));else if(t.page){var l;o=ce("div",{innerHTML:t.page});(l=geByClass1("_peer"+n,o))&&hasClass(c,l)&&(removeClass(c,l),remove(geByClass1("di_unread_cnt",l))),t.page=val(o)}d({caches:[{storage:nav.page_get(kt("/mail")),getter:"html"}],updater:function(e){var t=geByClass1("_peer"+n,e);t&&hasClass(c,t)&&(removeClass(c,t),remove(geByClass1("di_unread_cnt",t)))}})},markAsDeleted:function(t,n){var i=ge("messages"+t);if(i){remove(geByClass1("_msg"+n,i));var a=e[t];if(a&&a.messages){var r=ce("div",{innerHTML:a.messages});remove(geByClass1("_msg"+n,r)),a.messages=val(r)}}ajax.click(kt(nav.path),extend({no_scroll:!0},Dialogs))},updateMarkAsUnread:function(e,t){d({caches:[{storage:nav.page_get(kt("/mail")),getter:"html"}],updater:function(n){var i=$("._peer"+e,n);if(i){i.classList.toggle("di_unread_inbox",t);var a=$(".di_head",i);if(t){var r=$(".di_chat_user",i),o=document.createElement("span");o.classList.add("di_unread_cnt"),o.innerHTML="&nbsp;",a.insertBefore(o,r)}else{var s=$(".di_unread_cnt",i);s&&s.remove()}}}})},addMessage:function(t,n,i,r){if(t<2e9?delete o[t]:o[t]&&delete o[t][i],St.updateTyping(t),!0!==r){if(t&&n&&(a[n]=t),!geByClass1("_msg"+n)){var s=e[t];if(s&&s.messages){s.msgs&&s.msgs.push(n);var c=ce("div",{innerHTML:s.messages});(u=geByClass1("di_activity",c))?(after(cdf(r),u),s.messages=val(c)):s.messages=r+s.messages,(l=ge("messages"+t))&&(val(l,s.messages),St.onMessagesRepainted(!0))}else{var l,u;if(l=ge("messages"+t))(u=geByClass1("di_activity",l))?after(cdf(r),u):val(l,r+val(l))}}}else if(ge("dialogs")&&"/mail"==nav.path){var d=nav.getQuery();d.act||d.offset||d.q||ajax.click(kt(nav.path),extend({no_scroll:!0},Dialogs))}},replaceMessage:function(t,n,i,a){var r=ge("messages"+t),o=e[t];if(o&&o.messages){var s=ce("div",{innerHTML:o.messages}),c=geByClass1("_msg"+n,s);c&&(c.outerHTML=a),o.messages=val(s),val(r,o.messages)}else geByClass1("_msg"+n).outerHTML=a},getMsgHTML:function(t,n,i,a,r,o,s,c){var l=window,u=l.vk,d=l.lang,_=2&n?u.id:s&&s.from||i;if(!_)return!1;if(!ge("messages"+i))return!0;if(s.attach1||s.fwd||s.geo||s.emoji)return!1;if(s.source_act)return!1;if(!e[i]||!e[i].hash)return!1;var f="_u"+_,p=geByClass1(f,"mcont","a"),h=stripTags(attr(p,"data-name")||val(p)||""),m=getHref(p),v=geByClass1(f,"mcont","img"),g=v&&v.src||"";if(!h||!m||!g)return!1;i=intval(i),t=intval(t),r=r&&-1==r.toString().indexOf(" ... ")&&i<2e9?r:"";var A,b,w,y=1&n?" mi_unread":"";return!(2&n)&&1&n&&(y+=y?" _unread":""),o=St.wrapLinks(o,n),o=St.wrapMention(o),('<a name="msg{{msgId}}"></a><div  class="msg_item _msg{{msgId}}{{msgClass}}"  data-id="{{msgId}}"  onclick="return MessagesActions.onMessageClick(event);">  <div class="mi_iwrap">    <a class="al{{cl}}" href="{{href}}">      <img src="{{photo}}" class="mi_img {{cl}}" />    </a>  </div>  <div class="mi_cont">    <div class="mi_head">      <a class="mi_date" href="'+kt("/mail?act=msg&id={{msgId}}").replace(/\&/g,"&amp;")+'">        {{time}}      </a>      {{edited}}\n      <a class="mi_author al{{cl}} {{cl}}" href="{{href}}" data-name="{{dataName}}">        {{name}}      </a>    </div>    <div class="mi_body">      {{mi_title}}      <div class="mi_text">{{text}}</div>    </div>  </div></div>').replace(/{{msgId}}/g,t).replace(/{{cl}}/g,f).replace(/{{href}}/g,m).replace("{{msgClass}}",y).replace("{{edited}}",c?'<span class="mi_edited">'+d.mobile_mail_edited+"</span>":"").replace("{{photo}}",g).replace("{{time}}",(A=new Date(1e3*a),b=A.getHours(),w=A.getMinutes(),b+":"+(w<10?"0":"")+w)).replace("{{dataName}}",escapeAttr(h)).replace("{{name}}",h.split(" ").shift()).replace("{{mi_title}}",r?'<div class="mi_title">'+r+"</div>":"").split("{{text}}").join(o)},updateStickers:function(){window.cur;var t=window.post,i=e[n];if(i){var a=i.write_form?(Ot.default.getStickerPanel()||"").split("mail-0").join("mail"+n):"",r=ge("stickers_panel");r&&(replace(cdf(a),r),r=null,t.stickersInit())}},showDialog:function(i,a,r){window.cur;var o=window,s=o.MessagesActions,l=o.Mention,u=o.Dialog,d=window.post;if(s.hasFwdMessages())return s.attachFwdMessages(a),!1;t.scroll_top=scrollTop();var _=e[a];if(_){var f=ce("div",{innerHTML:val("m")}),p=geByClass1("mhb_back",f);if(p&&_.header){var h=ce("div");val(h,_.header),before(h.firstElementChild,p),remove(p)}var m=_.write_form?(Ot.default.getStickerPanel()||"").split("mail-0").join("mail"+a):"";val(geByClass1("pcont",geByClass1("mcont",f)),_.write_form+m+(a?'<div id="messages'+a+'" class="messages bl_cont">'+(_.messages||"")+'<div id="al_loading"></div></div>':"")),val("m",f.innerHTML),d.stickersInit(),ajax.refreshLinks(_.fv_link,_.app_link),alLoadingFix(),n=a,_;var v=getHref(i);nav.go(v,null,{push_only:!0,no_push:r}),a?(c=null,St.updateTyping(a),ajax.click(v,extend({save:a},u),{scroll:!0})):St.onShowWritePageFromCache(!0),St.onShowDialogFromCache(!0),scrollTop(0,10)}else nav.al_go(_&&_.cur_link||getHref(i)||nav.cur);nav.getQuery("community")&&"unread"===nav.getQuery("ctab")&&removeClass("al_back",geByClass1("mhb_back"));var g=geByClass1("MentionContainer"),A=parseJSON(attr(g,"data-mentions"))||[];return A.length&&l.init({url:!1,appendTo:g,defaultItems:A,items:A,preferDomain:!0}),AudioMessagePlayer.events.on("listened",St.markAsListened),!1},backToDialogs:function(e){if(t.page)nav.go(t.link,null,{push_only:!0,no_push:e}),ajax.click(t.link,extend({no_scroll:!0},Dialogs)),val("m",t.page),ajax.refreshLinks(attr("fv_link","href")||attr("fv_link","data-href"),"vkontakte://vk.com/mail"),n=null,scrollTop(t.scroll_top||0),St.onShowDialogsPageFromCache(!0);else{var i=kt(t.link||"/mail");nav.go(i,null,{push_only:!0,no_push:e}),nav.al_go(i)}},actualizeMessagesCornerCounter:function(e){d({caches:[{storage:t,getter:"page"},{storage:nav.page_get(kt("/mail")),getter:"html"}],updater:function(t){var n=geByClass1("mhi_notify",t),i=geByClass1("mh_notify_counter",n);i||(i=ce("em",{className:"mh_notify_counter"}),append(i,n)),e?i.innerText=e:n.innerHTML="&nbsp;"}})}}}();function kt(e){var t=window.nav.getQuery(),n=t.community,i=t.ctab,a=n&&-1===e.indexOf("community=")?"community="+n:"",r=n&&i&&-1===e.indexOf("ctab=")?"&ctab="+i:"";return a?e+(e.indexOf("?")>=0?"&":"?")+a+r:e}function Ct(e){return e.replace(/\[(id|club)(\d+)(?:\:([a-z0-9_\-]+))?\|([^\$]+?)\]/g,(function(e,t,n,i,a){return'<a href="/'+(t+n)+'" class="mem_link">'+a+"</a>"}))}window.mail=St,window.makeUrl=kt,window.Scroller=function(e,t){var n,i,a,r,o,s=t&&t.ignoreMouseWheel,c=t&&t.noAutoScroll,l=!isUndefined(document.ontouchmove),u=!0,d=!1,_=!1,f=!1,p=!1,h=0,m=0,v=!1,g=0,A=!1,b=!1,w=!1,y=!1;function O(e){var t=e.touches,n=getX(i),a=getY(i);return{x:((t&&t[0]?t[0].pageX:e.pageX)||0)-n,y:((t&&t[0]?t[0].pageY:e.pageY)||0)-a}}function S(e){v||(v=[]),v.push([vkNow(),e]),v=v.slice(-20)}function k(){v=!1}function C(){if(!v||v.length<2)return[0,0,0];for(var e=vkNow(),t=!1,n=v.pop(),i=v.length-1;i>=0;i--){if((a=e-v[i][0])>150)break;t=v[i]}if(!t||!n)return[0,0,0];var a,r=n[1].x-t[1].x,o=n[1].y-t[1].y,s=Math.sqrt(r*r+o*o);return(a=n[0]-t[0])?[s/a,r/a,o/a]:[0,0,0]}function j(e){"touchstart"==e.type?u=!e.touches||1==e.touches.length:"touchmove"==e.type?u=!1:"click"==e.type&&(u||(cancelEvent(e),u=!0))}function E(e){if(!(window.isNewMail&&e.target.closest(".stickers_panel")&&e.target.closest(".messenger")||y&&e.touches&&e.touches.length>1)){if(k(),_){if(m<=1)return}else if(getW(i)-getW(a)>=0)return;f=O(e),S(p=f),w=!0,setStyle.animate(a)}}function T(e){if(f&&(y||w)){thover&&thover.cancel(e);var t=O(e);if(S(p=t),w){var n=f.x-t.x,r=f.y-t.y;if(Math.abs(n)>=Math.abs(r)&&(cancelEvent(e),y=!0),w=!1,y){var o=getY(i),s=getH(i),l=scrollTop(),u=getCh();!c&&(o-7<l?scrollTop(o-7):o+s+7>l+u&&scrollTop(o+s+7-u))}}if(y)if(cancelEvent(e),_){var v=getW(i);n=f.x-t.x;(h<=0&&n<0||h>=m-1&&n>0)&&(n/=3);var A=-h-n/v,b=d?100*A+"%":A*v;setStyle.transform(a,{translate:[b,0]})}else{var k=getW(i)-getW(a);n=f.x-t.x;if(k>0&&(k=0),(A=g-n)<k)b=k-(k-A)/3;else if(A>0)b=0+(A-0)/3;else b=g-n;D(b),setStyle.transform(a,{translate:[b,0]})}}}function I(e){if(f&&y){if(cancelEvent(e),_){var t=4.7*C()[1],n=f.x-p.x,r=getW(i),o=Math.abs(n)>=r/2;(h>0&&(o&&n<0||t>1)||h<m-1&&(o&&n>0||t<-1))&&(h+=n>0?1:-1);var s=-h,c=d?100*s+"%":s*r;f=!1,k(),L(),setStyle.animate(a,"transform",{duration:200,func:"ease"}),setStyle.transform(a,{translate:[c,0]})}else{var l=function(){if(!v)return!1;var e=C(),t=e[0],n=e[1];if(k(),!t)return!1;var i=t/4.7,a=n*i-4.7*i*i/2;return i*=530,a*=140,clog("dx",a,"t",i),!(t<.1||!a)&&{dx:a,t:i}}(),u=getW(i)-getW(a);n=f.x-p.x,s=g-n;l&&(s+=l.dx),u>0&&(u=0),g=s<u?u:s>0?0:s;var A={duration:200,func:"ease"};l&&(A={duration:l.t,func:"cubic-bezier(0, 1, 1, 1)"}),D(g),setStyle.animate(a,"transform",A),setStyle.transform(a,{translate:[g,0]})}y=!1}}function M(e){if(!(s||window.isNewMail&&e.target.closest(".stickers_panel")&&e.target.closest(".messenger"))){if(preventEvent(e),_){if(m<=1)return}else if((n=getW(i)-getW(a))>=0)return;var t=(e.detail?e.detail:e.wheelDelta)>0?3:-3;if(!1===A&&(A=0),A+=t,!_){var n=getW(i)-getW(a),r=g-A;if(n>0&&(n=0),r<n)var o=n-(n-r)/3;else if(r>0)o=0+(r-0)/3;else o=g-A;D(o),setStyle.transform(a,{translate:[o,0]})}clearTimeout(b),b=setTimeout((function(){if(_){(h>0&&A<0||h<m-1&&A>0)&&(h+=A>0?1:-1);var e=-h,t=getW(i),n=d?100*e+"%":e*t;L(),setStyle.animate(a,"transform",{duration:200,func:"ease"}),setStyle.transform(a,{translate:[n,0]})}else{var r=getW(i)-getW(a);r>0&&(r=0),(e=g-A)<r?g=r:e>0?g=0:g-=A,D(n),setStyle.animate(a,"transform",{duration:200,func:"ease"}),setStyle.transform(a,{translate:[g,0]})}A=!1}),200)}}function P(e){if(_){var t=h;if(e&&e.target){var n=hasClass("sp_ppt",e.target)?e.target:gpeByClass("sp_ppt",e.target),r=+attr(n,"data-i");h=r<0?0:r>m-1?m-1:r}f=!1,k(),y=!1;var o=getW(i),s=-h,c=d?100*s+"%":s*o;L(),t!=h&&setStyle.animate(a,"transform",{duration:200,func:"ease"}),setStyle.transform(a,{translate:[c,0]})}}function D(e){if(!_){e=e||g;var t=getW(i)-getW(a);toggleClass("sw_left",i,e<0),toggleClass("sw_right",i,e>t)}}function L(){if(_){var e=geByClass1("sp_ppt_sel",n);e&&e===o[h]||(removeClass("sp_ppt_sel",e),addClass("sp_ppt_sel",o[h]))}}extend(this,{init:function(){i=geByClass1("scroller_wrap",n),a=geByClass1("scroller_cont",i),_?(r=geByClass1("sp_pages_pts",n),o=geByClass("sp_ppt",r),m=(geByClass("scroller_page",a)||[]).length,h=0,L()):D(g=0),v=!1,setStyle.transform(a,{translate:[0,0]}),l?(addEvent(i,"touchstart touchmove click",j),addEvent(i,"touchstart",E),addEvent(i,"touchmove",T),addEvent(i,"touchend touchcancel",I)):(addEvent(i,"mousewheel",M),addEvent(r,"click",P)),d||onBodyResize(P)},destroy:function(){l?(removeEvent(i,"touchstart touchmove click",j),removeEvent(i,"touchstart",E),removeEvent(i,"touchmove",T),removeEvent(i,"touchend touchcancel",I)):(removeEvent(i,"mousewheel",M),removeEvent(r,"click",P)),d||onBodyResize("__clear",P)},onShow:function(){_?L():D(g)},canClick:function(){return u}}),n=e,(t=t||{}).byPage?(_=!0,d=!x.default.android):(_=!1,d=!1,this.showElem=function(e){if(!_){var t=getX(e)-getX(i),n=t+g,r=n+getW(e),o=getW(i),s=!1;n<0?s=0-t+20:r>o&&(s=o-getW(e)-t-20);var c=getW(i)-getW(a);if(c>0&&(c=0),s<c)s=c;else if(s>0)s=0;clog(t,g,n,r,0,o,s),!1!==s&&(D(g=s),setStyle.animate(a,"transform",{duration:200,func:"ease"}),setStyle.transform(a,{translate:[g,0]}))}})};var jt=n("izth"),Et=function(){var e=null,t={},n=1,i=null,a=!1,r=!1;function o(){n<64&&(n*=2)}function s(e,t){!1===e&&(e=getNotify()+(t||1)),setNotify(e),menu.refreshSingleCounter(At.COUNTERS_POS_MESSAGES,e)}function c(e){return Object.keys(e).some((function(e){return-1!==e.indexOf("attach")}))||e.fwd||e.emoji||e.geo}function l(e,t,n){var i=toInt(e.from_admin)||null,a=toInt(nav.getQuery("community"));return i&&a?a:2&t?window.vk.id:toInt(e.from)||n}function d(){return Number(nav.getQuery("offset"))>0}function _(e){try{return JSON.parse(e)}catch(e){return null}}return{onNewMsg:Object(u.default)("{ peerId, msgId, authorId, text, date, hasAttachments, flags, isService }"),onEditMsg:Object(u.default)("{ peerId, msgId, authorId, text, date, hasAttachments, flags }"),onMsgReadByMe:Object(u.default)("msgId","dialogId"),onMsgReadByOther:Object(u.default)("msgId","dialogId"),onOnlineChange:Object(u.default)("{ userId, isOnline, onlinePlatform, lastActionTime }"),onTyping:Object(u.default)("dialogId","authorId"),onMultiTyping:Object(u.default)("peerId","userIds","totalCount"),onMsgImportantRemove:Object(u.default)("msgId"),onMsgImportantAdd:Object(u.default)("msgId"),onMsgRemove:Object(u.default)("msgId"),onMsgRestore:Object(u.default)("msgId"),onPeerKeyboard:Object(u.default)("peerId"),onPeerBanner:Object(u.default)("peerId"),onDialogImportant:Object(u.default)("peerId","isImportant"),onDialogMarkedUnread:Object(u.default)("peerId","isMarkedUnread"),onDialogPin:Object(u.default)("peerId"),onDialogUnpin:Object(u.default)("peerId"),onUnreadCount:Object(u.default)("event"),onResync:Object(u.default)(),isLongPollingEnabled:function(){return!!a},init:function(t){e||(Object(jt.setDocumentDomain)(),e=ce("iframe",{src:t.frameUrl},{display:"none"}),onDOMReady((function(){append(e,window.bodyNode),!0}))),Et.refreshParams(t),setTimeout(Et.check,1e3)},on:function(){clog("[longpoll] start"),a=!0,setTimeout(Et.check,1e3)},off:function(){clog("[longpoll] pause"),a=!1},refreshParams:function(e){extend(t,e||{}),extend(Et,t)},getKey:function(){if(i)try{i.abort()}catch(e){}i=ajax.post("/mail",{_ajax:1,act:"im_get_key",community:nav.getQuery("community")},{onDone:function(e){/[0-9a-f]{40}/i.test(e)?(Et.refreshParams({key:e}),Et.check()):clog("[longpoll] invalid key")},onFail:function(e){setTimeout(Et.getKey,1e3*n),clog("[longpoll] from getKey delaying getKey for "+n+"secs"),o()}})},check:function(){if(a&&!r)if(Et.makeRequest)try{Et.makeRequest((function(e,t){if(r=!1,a)if(window.vk.__debug)Et.checked(parseJSON(t))&&(Et.check(),n=1);else try{Et.checked(parseJSON(t))&&(Et.check(),n=1)}catch(e){try{clog("[longpoll] error",e.message||"no message",e.type||"no type",e.stack||"no stack")}catch(e){}setTimeout(Et.check,1e3*n),o()}}),(function(){r=!1,setTimeout(Et.check,1e3*n),o()})),r=!0}catch(e){clog("[longpoll] makeRequest failed")}else setTimeout(Et.check,1e3)},checked:function(e){var i,a,r,u=e.failed;if(1==u||t.ts>=e.ts+256){if(Et.refreshParams({ts:e.ts}),u)return!0}else{if(2==u)return clog("[longpoll] delaying getKey for "+n+"secs"),setTimeout(Et.getKey,1e3*n),o(),!1;if(u)return void clog("[longpoll]",e)}if(Et.refreshParams({ts:e.ts}),e.updates){var f=[],p=!1;for(var h in e.updates){if(116==e.updates[h][0])var m=e.updates[h][1],v=[e.updates[h][0],m.id,m.flags,m.peer_id,m.date,m.title||"",m.message,m.kludges,m.random_id];else v=e.updates[h];var g=intval(v[0]),A=intval(v[1]),b=intval(v[2]),w=intval(v[3]);if(1===b){if(10===g){mail.updateImportantDialog(A,!1);continue}if(12===g){mail.updateImportantDialog(A,!0);continue}}if(b&1<<20){if(10===g){mail.updateMarkAsUnread(A,!1);continue}if(12===g){mail.updateMarkAsUnread(A,!0);continue}}if(8&b){if(2===g){if(window.isNewMail){Et.onMsgImportantAdd(A);continue}mail.updateImportantMessages(w,A,1);continue}if(3===g){if(window.isNewMail){Et.onMsgImportantRemove(A);continue}mail.updateImportantMessages(w,A,-1);continue}}if(51!=g)if(61!=g)if(62!=g)if(8!=g)if(9!=g)if(6!=g&&7!=g)if(80!=g||!A||nav.getQuery("community"))if(52!=g){if(w)if(4!=g&&5!=g&&116!=g)if(0!=g)if(2!=g);else{if(128&b){if(window.isNewMail){Et.onMsgRemove(A);continue}mail.markAsDeleted(w,A)}window.isNewMail&&64&b&&Et.onMsgRemove(A)}else{if(window.isNewMail){Et.onMsgRemove(A);continue}mail.markAsDeleted(A)}else{var y=5==g||116==g;if(window.isNewMail){var O=v,S=O[1],k=O[3],C=O[4],j=O[6],E=O[7],T=void 0===E?{}:E,I=O[8],M=c(T),P=(i=void 0,a=void 0,r=void 0,i=new Date(1e3*C),a=i.getHours(),r=i.getMinutes(),a+":"+(r<10?"0":"")+r),D=toInt(T.from_admin)||null,x=(toInt(nav.getQuery("community")),l(T,b,k)),L=!!T.source_act,B=T.keyboard?_(T.keyboard):null;if(y){var R={peerId:k,msgId:S,authorId:x,text:j,date:P,hasAttachments:M,flags:b,adminId:D,randomId:I};116==g?R.refreshed=1:R.edited=Math.floor(Date.now()/1e3),Et.onEditMsg(R)}else Et.onNewMsg({peerId:k,msgId:S,authorId:x,text:j,date:P,hasAttachments:M,flags:b,adminId:D,randomId:I,isService:L,keyboard:B});continue}var N=window.vk,F=2&b?N.id:v[7]&&v[7].from||w,H=v[7]&&v[7].source_act;p||(p=!!need("PinnedMsg").getByMsgId(A));var U=v[7].from_admin||H||p?null:mail.getMsgHTML(A,b,w,v[4],v[5],v[6],v[7],116!=g?y:"");if(U&&(y?mail.replaceMessage(w,A,F,U):d()||mail.addMessage(w,A,F,U),2&b||nav.getQuery("community")||s(!1,1)),"chat_kick_user"===H&&v[7].source_mid==N.id){var V=v[3];mail.unpinMessage(V)}U&&"chat_pin_message"!==H&&"chat_unpin_message"!==H||f.push({peer:w,msg_id:A,from_id:F,source_act:H,edited:y})}}else{var W=v,$=W[1],q=W[2];if(!window.isNewMail)continue;11==$&&Et.onPeerKeyboard(q),10==$&&Et.onPeerBanner(q)}else s(A);else{if(window.isNewMail){var z=v[1],Y=v[2];6===g?Et.onMsgReadByMe(Y,z):Et.onMsgReadByOther(Y,z);continue}mail.markPeerAsRead(A,b,7==g)}else{if(window.isNewMail){Et.onOnlineChange({userId:-A,isOnline:!1,lastActionTime:w});continue}mail.updateOnline(-A,0)}else{if(window.isNewMail){Et.onOnlineChange({userId:-A,isOnline:!0,onlinePlatform:7===(b||7)?"desktop":"mobile"});continue}mail.updateOnline(-A,b||7)}else{if(window.isNewMail){var G=2e9+b,K=A;Et.onTyping(G,K);continue}mail.typing(2e9+b,A)}else{if(window.isNewMail){var Q=A,X=A;Et.onTyping(Q,X);continue}mail.typing(A)}}if(f.length){var J=[];each(f,(function(e,t){J.push(t.msg_id)}));var Z={_ajax:1,act:"get_messages",msgs:J.join(","),community:nav.getQuery("community")};p&&(Z.force_pinned=1),ajax.post("/mail",Z,{onDone:function(e,t){var n=window.cur,i=d();each(f,(function(t,n){var a=e[n.msg_id],r=n.peer;a.text&&!i&&(n.edited?mail.replaceMessage(n.peer,n.msg_id,n.from_id,a.text):mail.addMessage(n.peer,n.msg_id,n.from_id,a.text)),a.unpin&&mail.unpinMessage(r),a.pinned&&mail.pinMessage(r,a.pinned)})),t&&(t.play_animation_msg_id&&StickersAnimation?StickersAnimation.loadStickerInMvkIMAndPlay(t.play_animation_msg_id):(extend(n,t),mail.updateStickers()))}})}}return!0}}}(),Tt=Et,It=n("WwUR");window.isNewLongpoll?window.im=It.default:window.im=Tt;n("gNTM"),n("eoxF");var Mt=n("j80l"),Pt=n("y/eL");function Dt(){var e=location.protocol+"//"+location.host+nav.cur,t=window.page.lastTrackedPage&&window.page.lastTrackedPage!==e?location.protocol+"//"+location.host+window.page.lastTrackedPage:"";window.page.lastTrackedPage=nav.cur,Object(Pt.updateCounters)(e,t)}var xt=n("Fbxv"),Lt={};function Bt(e){var t,n,i;Bt.getQueryREs=ne;var a,o,s,c,l,d,_,f,p,h,m,v,g,A=!1,b=[],w={},y={},O={},S={},k=!1,C=null,j=null,E=null,T=0,I=[],M=null,P=null,D=null,x=!1,L=!1,N=10,H=[],U=!0,V=!1,W=!1,$=!1,q={},z=[],Y=!1,G="",K=!1,Q=0,X=0,J=!1,Z={},ee=e&&"AudioSectionSearch_field"===e.field,te=Wd.elem({class:["show_next_wrap","show_next_wrap_transparent"],inner:{class:"show_more_loading",inner:{tag:"i",class:"i_loading",inner:""}}});function ne(e){var t,n,i;e=e.replace(/https?:\/\/(m\.)?vk\.com\/([^#]+#\/)?/,"");for(var a=L,o=[e,n=Object(r.parseRusKeys)(e,a)||e,i=Object(r.parseLatKeys)(e,a)||e,Object(r.parseLat)(n),Object(r.parseCyr)(i)],s={},c=[],l=0,u=o.length;l<u;l++)o[l]&&!s[o[l]]&&(s[o[l]]=!0,t=(t=Object(r.escapeRE)(o[l])).replace(/[её]/gi,"[её]").replace(/(e|yo)/gi,"(?:e|yo)"),c.push(new RegExp("(^|\\s|\\(|>)("+t+")","gi")));return c}function ie(e){return void 0===e&&(e=""),"_"+e+(q&&Object(r.len)(q)?JSON.stringify(q):"")}function ae(e,n,i,o){if(clearTimeout(j),!i)return j=setTimeout((function(){ae(e,n,!0)}),10),!1;var s=Object(r.val)(e)||"";if(C===s&&!o)return!1;var c,l=ie(s),u=y[l],m=ne(s);if(!ee&&!u&&s.length>2&&y["_"+s.slice(0,-2)]){var v="_"+s.slice(0,-2);y[v]&&S[v]&&!y[v].length&&(!$||$&&!O[v])&&(S[l]=!0,u=y[l]=[],$&&(O[l]=""))}o&&(delete S[l],delete y[l],delete O[l]);var g=0;if(!u){u=[];if(Rt.isCachedPage)g=(Object(r.geByClass1)("_si_container",a)||a).childNodes.length;if(!s&&b.length)for(var A=T,I=T+Math.min(Math.max(N,g),b.length);A<I;A++)u.push([b[A]]);else{var M={},P=0;for(A=0,I=b.length;A<I;A++){var D=b[A];if(w[D]){if(M[D]=!0,(c=oe(m,w[D][0]))&&(u.push([D,c]),++P>=30))break;0}}if(P<30)for(var D in w)if(!M[D]&&(c=oe(m,w[D][0]))){if(u.push([D,c]),++P>=30)break;0}}S[l]=S[l]||!s&&b.length||u.length>2*N,S[l]=S[l]||$&&u.length>N}var L=!f||!!s;(!S[l]&&(U||$)||o)&&!_&&L&&function e(n,i,o){var s=ee?800:200;if(clearTimeout(E),!o)return E=setTimeout((function(){e(n,i,!0)}),s),!1;window.ajax.post(t,Object(r.extend)({_ajax:1,q:i},q),{onDone:function(e,t,o){var s;"string"==typeof p?(s=Wd).handle2.apply(s,[[p],null].concat(Array.prototype.slice.call(arguments),[i,a])):p&&p.apply(void 0,Array.prototype.slice.call(arguments).concat([i,a]));for(var c,l=ie(i),u=y[l]||[],_={},f=ne(i),h=0;h<u.length;h++)_[u[h][0]]=!0;for(var m=0;m<t.length;m++){var v=t[m];_[v]||((c=oe(f,e[v][0]))||x||!i)&&u.push([v,c])}S[l]=!0,y[l]=u,$&&(O[l]=o||""),w=Object(r.extend)(e,w),Z._cache=w,U=!V||Object(r.len)(w)<V,C===i?(se(u,O[l]),Object(r.onBodyScrollForce)(),Dt()):delete y[l],U||Object(r.removeClass)("input_loading",n),d&&(U=!1,V=Object.keys(w).length)},onFail:function(){var e=ie(i);delete y[e],Object(r.removeClass)("input_loading",n)}}),Object(r.geByClass1)("al_loading",a)||Object(r.addClass)("input_loading",n)}(e,s),y[l]=u;var R=C!==s;if(C=s,se(u,O[l]),"string"==typeof h?Wd.handle2([h],null,s,a):h&&h(s,a),(W||!C||R)&&(Q=Math.max(N,g)),Y&&k){var F=Object(Mt.parseURL)(nav.cur),H=Object(r.qs2obj)(F.search.replace("?","")),G=Object.keys(H).reduce((function(e,t){return z.includes(t)?e[t]=q[t]:z.includes(t)||(e[t]=Object(r.isUndefined)(e[t])?H[t]:e[t]),e}),Object(r.extend)(Object(r.copy)(q),{q:s})),K=Mt.default.make(nav.path,Object(B.default)({act:G.act},G)),X=Object(r.extend)(nav.page_get(nav.cur)||{},{page:Object(r.ge)("m"),state:page.stash(),cur:window.cur,options:{replacePrevPage:!0}});nav.set({replace:!0,nav:Object(r.extend)({},nav,{cur:nav.path,path:nav.path||"",push:K||"",params:Object(r.obj2qs)(G).replace("?","")||""})}),page.save(K,X)}return Object(r.onBodyScrollForce)(),!1}function re(){var e=a&&a.querySelector(".show_next_wrap");e&&e.remove()}function oe(e,t){if(!t)return!1;"string"!=typeof t&&(t=t.toString());var n=[t],i=/([№])/gi;-1!==t.search(i)&&n.push(t.replace(i,""));for(var a=0;a<n.length;a++)for(var r=0,o=e.length;r<o;r++)if(-1!==n[a].search(e[r]))return e[r];return!1}function se(e,t,n){var i="";if(P&&a){var s=Object.keys(H).filter((function(e){return!!H[e]})).map((function(e){return e+""}));s.length&&""===C&&(e=e.filter((function(e){return!s.includes(String(e[0]))})),s.forEach((function(t){e.unshift([t,!1])})));for(var u=function(t){var n=e[t],a=n[0],r=n[1];if(!w[a])return"continue";var o=w[a].slice(1);if(r)for(var s in I){var c=I[s];o[c]&&(o[c]=o[c].replace(r,'$1<em class="found">$2</em>'))}i+=P.apply({id:a,q:C,highlight:function(e){if("string"!=typeof e)throw new Error("Highlighting expected string but got "+typeof e);return e.replace(r,'$1<em class="found">$2</em>')},template:function(e,t){var n=this;return e.replace(/%(\d+)%|#(\d+)#/g,(function(e,i,a){return a&&t[a-1]?n.highlight(t[a-1]):i&&t[i-1]?t[i-1]:""}))}},o)},d=0;d<e.length;d++)u(d);if(!i&&!S[ie(C)]&&(U||$)&&!_){re(),Object(r.removeClass)("_si_container_loading",a);var f=Wd.html({class:"al_loading qs_loading",inner:Object(R.default)(Object(xt.getLoading40Icon)())});i=C?f:'<div id="al_loading"></div>'}if(!i&&D&&(i=D(C)),Object(r.removeClass)("input_loading",o),n&&(i+=n),t||i!==g||K){var p=M?M(i,C,W,t):i+(t||"");Object(r.val)(a,p)}if(g=i,c){var h=Object(F.$)('[data-prefix="'+G+'"]');h&&h.classList.toggle("qs_with_clear",!!C)}l&&Object(r.toggle)(l,!!C),!C&&Object(r.alLoadingFix)(),Object(F.$)(".al_loading",a)&&(J=!0),m&&m(C)}}Object(r.extend)(this,{go:function(e){return!o||(ae(o,e,!0,!0),o.blur(),Object(r.cancelEvent)(e),!1)},redraw:function(){var e=ie(C);se(y[e],O[e]),Object(r.onBodyScrollForce)()},clear:function(e,t){return Object(r.val)(o,""),t?Object(r.elfocus)(o):Object(r.elblur)(o),this.setSearchParams({}),this.go(e),Object(r.cancelEvent)(e),!1},blur:function(){Object(r.elblur)(o)},toggleAttach:function(e,t){H[e]=t},setSearchParams:function(e){var t=Object(r.copy)(q);if(isArray(e)){var n=nav.getQuery()||{};q=Object(r.extend)(q,e.reduce((function(e,t){var i=n[t];return i&&(e[t]=i),e}),{}))}else q=e;var i=JSON.stringify(t)!==JSON.stringify(q);this.onSearchParamsChange(q,t,i);var a=Object(F.$)('[data-prefix="'+G+'"]');if(a){var o=Object(F.$)(".filter_btn",a);o&&(Object(r.toggle)(o,!!C),k&&i&&(w={}))}},getSearchParams:function(){return q},onSearchParamsChange:Object(u.default)(),init:function(e){var u=this;if(e=e||{},a=Object(r.ge)(e.container)||null,o=Object(r.ge)(e.field)||null,s=Object(r.ge)(e.btn)||null,c=Object(r.ge)(e.clear_btn)||null,l=Object(r.ge)(e.filter_btn)||null,C=null,!Object(r.attr)(a,"data-qsearch-inited")){if(!k||t!=e.action||!e.init_once){y={},O={},S={},t=e.action||"",A=null!==e.next_from,i=e.next_from,n=e.al_action||t,b=e.top_items||[],w=e._cache||{},K=e.forceRerender||!1,I=e.hl_fields||[],M=e.tpl||null,P=e.item_tpl||null,D=e.null_tpl||null,x=e.soft_filter||!1,L=e.need_invalid_keys||!1,N=e.top_len||10,V=e.load_limit||!1,p=e.onLoaded||!1,h=e.onFiltered||!1,m=e.onRendered||!1,v=e.onFocusChanged||!1,W=e.al_need||!1,T=!W&&e.init_offset||0,$=e.global_search||!1,_=e.no_search_query||!1,f=e.search_non_empty_query||!1,d=e.load_once||!1,Y=e.updateQuery||!1,z=e.availableSearchParams||[],G=e.prefix||"";var g=e.action+e.container;Lt[g]?Z=Lt[g]:(Z._cache=w,Z.top_items=b,Lt[g]=Z),Rt.isCachedPage&&(b=Z.top_items,w=Z._cache,i=Z.next_from),z.length&&(this.setSearchParams(z),window.onDOMReady((function(){u.setSearchParams(z),Object(r.onBodyResize)((function(){u.setSearchParams(z)}))})))}var j=null;t&&a&&o&&P&&(U=!0!==t&&(!V||Object(r.len)(w)<V),Object(r.addEvent)(o,"focus",(function(e){e&&e.preventDefault();clearTimeout(j),v&&v.call({q:C},!0),function t(n){!n&&ae(o,e,!0),j=setTimeout(t,100)}(!0)})),Object(r.addEvent)(o,"keydown keypress change blur",(function(e){"blur"==e.type&&(clearTimeout(j),v&&v.call({q:C},!1)),ae(o,e,"keydown"!=e.type&&"keypress"!=e.type)})),e._new||s&&!Object(r.attr)(s,"onclick")&&Object(r.attr)(s,"onclick","return qsearch.go(event);"),!W||k&&e.init_once||(Q=N,X=Object(r.len)(w),Object(r.initAutoScroll)((function(){var e=(Object(r.geByClass1)("_si_container",a)||a).childNodes;return e[Q]||e[e.length-1]}),(function(){var e=Object(r.geByClass1)("_si_container",a)||a;if(!J&&!C)if(A?!!i:Q+N>X&&U)J=!0,a&&a.append(te),Object(r.addClass)(e,"_si_container_loading"),window.ajax.post(n,{_ajax:1,offset:X,next_from:i,q:C},{onDone:function(n,a,o,s){i=o;var c,l=s?s.needLoad:void 0,u=s&&s.html||"";"string"==typeof p?(c=Wd).handle2.apply(c,[[p],null].concat(Array.prototype.slice.call(arguments))):p&&p.apply(void 0,arguments);var d=Object(r.len)(n);if(J=!1,re(),Object(r.removeClass)(e,"_si_container_loading"),V||(b=b.slice(0,X).concat(a),Z.top_items=b),X+=d,w=Object(r.extend)(n,w),Z._cache=w,Z.next_from=i,U=!0!==t&&(!V&&d||Object(r.len)(w)<V),!1===l&&(U=!1),!C){Q+=N;for(var _=[],f=0,h=Math.min(Q,b.length);f<h;f++)_.push([b[f]]);se(_,O._,u),Object(r.onBodyScrollForce)()}},onFail:function(){J=!1,re(),Object(r.removeClass)(e,"_si_container_loading")}});else if(Q<b.length){Q+=N;for(var o=[],s=0,c=Math.min(Q,b.length);s<c;s++)o.push([b[s]]);se(o,O._),Object(r.onBodyScrollForce)()}}))),e.common_cache&&(e.common_cache&&e.common_cache._gq_cache&&(O=e.common_cache._gq_cache),e.common_cache._q_loaded&&(S=e.common_cache._q_loaded)),!e.skip_init_filter&&ae(o,null,!0),Object(r.attr)(a,"data-qsearch-inited",!0),k=!0)}}}),e&&this.init(e)}var Rt=new Bt;window.QuickSearch=Bt,window.QuickSearchCache=Lt,window.qsearch=Rt;var Nt={onClose:Object(u.default)(),inited:!1,width:!1,height:!1,onResize:null,_lastNav:!1,_opened:!1,_destroy:!1,init:function(){Nt.inited||(Nt.inited=!0,Nt.initEvents())},initEvents:function(){var e=function(e){Nt.fixHeight(vkNow()+2e3,e)};addEvent(window,"orientationchange",e),onBodyResize(e),e(!0)},opened:function(){return hasClass("z_opened",window.bodyNode)!==Nt.opened&&toggleClass("z_opened",window.bodyNode,Nt._opened),Nt._opened},toggle:function(e,t){return!!checkEvent(e)||(Nt.opened()?Nt.close(e,t):Nt.open(e,t),!1)},open:function(e,t){return!!checkEvent(e)||(Nt.opened()||(thover.clear(),Nt.init(),Nt._st=scrollTop(),Nt._lastNav=!1,addClass("z_opened",window.bodyNode),Nt._opened=!0,Nt.fixHeight(vkNow()+2e3,!0),scrollTop(0)),!1)},close:function(e,t){return!!checkEvent(e)||!!Nt.opened()&&(thover.clear(),val("z",""),removeClass("z_opened",window.bodyNode),Nt._lastNav={cur:nav.cur,path:nav.path,params:nav.params,hash:nav.hash},Nt._opened=!1,Nt._destroy&&(Nt._destroy(),Nt._destroy=!1),scrollTop(Nt._st,1),Nt._st=!1,Nt.onResize=null,Nt.onClose(),!1)},updateSize:function(){var e=ge("z");e&&e.offsetWidth&&e.offsetHeight&&(Nt.width=e.offsetWidth,Nt.height=e.offsetHeight,Nt.onResize&&Nt.onResize())},fixHeight:function(e,t){if((Nt._opened||t)&&(e&&!(vkNow()>e)||t)){var n=getCw(),i=getCh();(Nt._lastWidth!=n||Nt._lastHeight!=i||t)&&(Nt._lastWidth=n,Nt._lastHeight=i,setStyle("z","height",i),Nt.updateSize(),scrollTop()||scrollTop(0)),clearTimeout(Nt._fixTo),Nt._fixTo=setTimeout(Nt.fixHeight,50,e)}},create:function(e,t){val("z",e),Nt._destroy=t}};window.zlayer=Nt;var Ft=n("rc7J"),Ht=n("GVTI"),Ut=n("vhZE"),Vt="photo",Wt="audio";window.photo=function(){var e,t,n,i,a,r,o,s,c,l,u=4,d=!1,_={},f={},p={},h=null,m=null,v=!1,g=null,A=null,b=!0,y=0,O=!1;function k(){if(!(e=$(".PhotoviewPage")))return nav.al_go(nav.cur),!1;if(geByClass1("pv_summary",e),geByClass1("photo_msg",e),o=geByClass1("pv_tag_wrap",e),n=geByClass1("PhotoviewPage__thumb",e),t=geByClass1("pv_nav",n),r=geByClass1("PhotoviewPage__photo",e),a=$(".PhotoviewPage__photo img",n),geByClass1("pv_footer",e),d=hasClass("pv_touch_full",e),t){var u=geByClass1("pv_nav_left",t),_=geByClass1("pv_nav_z",t),f=geByClass1("pv_nav_right",t);s=geByClass1("pv_nav_link",u),l=geByClass1("pv_nav_link",_),c=geByClass1("pv_nav_link",f),attr(s,"onclick","return photo.prev(event);"),attr(c,"onclick","return photo.next(event);"),attr(i,"onclick",!d&&"return photo.next(event);"),ajax.prepare_click([s,c,i])}return removeEvent(window,"orientationchange",D),addEvent(window,"orientationchange",D),removeEvent(window,"keydown",x),addEvent(window,"keydown",x),removeEvent(window,"resize",L),addEvent(window,"resize",L),Ut.default.onClear("__clear",L),Ut.default.onClear(L),!0}function C(){var t=window.photoview;return!!t&&(O||(O=!0,t.onPhotoChange=function(e,t){y=e,N(e,t)},t.onUpdate=function(){},t.onClose=function(t){if(uRegisterFloatBtn.show(),!function(e){var t=qs2obj(nav.params);if(delete t.z,!e.local&&!e.crop){if(nav.tryHistoryBack())return!1;var n=nav.path+obj2qs(t)+nav.hash;nav.go(n,null,{push_only:!0})}return!0}(t))return!0;var n=qs2obj(nav.params);e&&n.list==m&&R(y,!0)}),!0)}function j(e){var t=window.photoview,n=[];return each(e,(function(e,t){if(!t)return!0;n.push(_[t.id]=t)})),h&&t&&t.saveSource(M(h)),n}function E(e){return _[e]||{}}function T(e,t,n){if(null!==t){f[e]||(f[e]=new Array(n||len(t))),j(t);var i=f[e];v&&i.reverse(),extend(i,t),v?(h=copy(i),i.reverse()):h=i}else delete f[e]}function I(e){if("string"!=typeof e)return e;var t=f[e]||[];return v?copy(t).reverse():t}function M(e){var t=I(e),n=new Array(t.length),i=qs2obj(nav.params);for(var a in delete i.z,t){var r=h[a],o="",s="";r.hash&&(s=obj2qs({hash:r.hash,mp4:!0})),r.isDoc?(o="doc"+r.id+s,n[a]={id:r.id,photo_url:"/"+o,src:r.original_src,isDoc:!0,hasVideo:r.hasVideo}):(o="photo"+r.id+"?list="+m+(v?"&rev=1":"")+(A?"&from="+A:""),n[a]={id:r.id,photo_url:"/"+o,like_url:"/like?act="+(r.likes_me?"del":"add")+"&object=photo"+r.id+"&from="+encodeURIComponent(o)+"&list="+m+"&hash="+r.like_hash,likes_me:r.likes_me,src:r.original_src,max_src:r.max_src,tags:r.tags,caption:r.caption,likes_cnt:r.likes_cnt,replies_cnt:r.replies_cnt,market_tags:r.market_tags,restriction:r.restriction})}return n}function P(e,t){for(var n in t||(t=h),t)if(h[n].id==e)return+n;return-1}function D(){nav.hash||onDOMReady((function(){if(geByClass1("photo_view")){var e=scrollTop();n&&getY(n)<e&&scrollToEl(n)}}))}function x(e){if(zlayer.opened())return!1;switch(e.which){case 37:e.preventDefault(),photo.prev();break;case 39:e.preventDefault(),photo.next()}}function L(t){e&&document.body.contains(e)&&(document.activeElement&&["INPUT","TEXTAREA"].includes(document.activeElement.tagName)||isVisible($("#stickers_panel"))||R(y,!0))}function R(t,_,f){var m=window.cur,w=window.lang,O=h[t],S=1==h.length;if(O){nav.hash?scrollToHash(nav.hash):D();var k={};g&&(k.list=g),v&&(k.rev=1),A&&(k.from=A);var C=obj2qs(k),j="photo"+O.id+C,E=O.photo,T=(H(t-1)||{}).id,I=(H(t+1)||{}).id;if(S||(r&&(r.href="/photo"+I+C),s&&(s.href="/photo"+T+C),c&&(c.href="/photo"+I+C),ajax.prepare_click([s,c,i])),d){var M="photo"+O.id+"/"+g+(v?"/rev":""),P=extend({},k,{z:M}),x="/photo"+O.id+obj2qs(P);if(zlayer._lastNav){var R=zlayer._lastNav;(P=qs2obj(R.params)).z=M,x=R.path+obj2qs(P)+R.hash}l&&(l.href=x),ajax.prepare_click(l),attr(l,"onclick","return photo.fullscreen('"+escapeAttr(x)+"', event);")}if(a&&a.src!=E){a.onload=null,remove(a);var N;N=Wd.html(Object(Ht._PhotoviewPage_tags)(O.tags)),val(r,'<img src="'+(E||"/images/blank.gif")+'" alt="" class="ph_img" />'+N),a=geByTag1("img",r)}toggleClass("photo_deleted",e,!!O.deleted),toggleClass("pv_one_photo",n,1==h.length),val(o,O.tag_info||"");var F=(Ot.default.getStickerPanel()||"").split("photo-0_0").join("photo"+O.id),V=O.comments_html||"";F&&(V=V.split("\x3c!--stickers_panel--\x3e").join(F)),e.classList.toggle("PhotoviewPage--deleted",!!O.isDeleted),e.childNodes[0].setAttribute("id","photo"+O.id);var W=$(".wi_like_wrap",e);W&&(W.innerHTML=O.liked_people||"",W.classList.toggle("is_empty",!O.liked_people));var q,z=$(".PhotoviewPage__restrictedInfo"),Y=!!(O.restriction&&"block"===O.restriction.type||O.restriction&&"blur"===O.restriction.type&&!Ut.default.isCleared("photo"+O.id));Y&&(q=Object(B.default)({},O.restriction,{forceText:!0,raw:"photo"+O.id,width:getW(r),height:getH(r)}),a.complete||a.onload||(a.onload=L)),e.classList.toggle("pv_touch--hideZOpen",Y),toggle(z,Y),r.classList.toggle("PhotoviewPage__photo--block",!(!q||"block"!==q.type)),r.classList.toggle("PhotoviewPage__photo--blur",!(!q||"blur"!==q.type)),Y&&z&&(z.innerHTML=Wd.html(Object(Ut.default)(q)));var G=$(".wi_buttons",e);val(G,O.like_buttons||"");var K=$(".AlbumInfoRow",e);K&&(K.outerHTML=Wd.html(Object(Ft.default)({url:O.album_href,author_url:O.author_href,avatar:O.avatar,title:Wd.wrap(O.album_title),subtitle:Wd.wrap(O.album_info_subtitle),withoutBottomBorder:!O.has_replies})));var Q=$(".PhotoviewPage__description",e);if(Q){O.description&&O.description,Q.innerHTML=O.description,Q.classList.toggle("PhotoviewPage__description--empty",!O.description)}var X=$(".PhotoviewPage__caption",e);if(X){var Z="";O.caption&&(Z+=O.caption),val(X,Z)}var ee=$(".Replies");ee&&(ee.outerHTML=O.replies_html);var te=$(".RepliesField"),ne=Ot.default.getStickerPanel();te&&O.reply_field_html&&ne&&(te.outerHTML=O.reply_field_html.replace("\x3c!--stickers_panel--\x3e",ne));var ie=$("#mhead .HeaderSubtitle__subtitle");ie&&(ie.innerHTML=w.mobile_photos_photo_header.replace("%s",y+1).replace(/%s|{count}/,h.length));var ae=ge("photo_actions");if(ae&&(ae.innerHTML=Wd.render(O.actions)),post.stickersInit(),m.replyTo=0,ajax.refreshLinks(O.fv_link,O.app_link),photo.closeTags(),!_){var re="/"+j;nav.go(re,null,{no_push:_,push_only:!0,replace:f}),page.save(re,{st:scrollTop(),page:ge("m"),state:page.stash(),cur:window.cur,options:{replacePrevPage:!0}},!1)}setTimeout((function(){var e=Object(J.getState)("autoload")||{};Replies.init(e.enable||!1,O.author_id||O.owner_id)}))}b||(U(),function(){for(var e=0,t=y+1;e<u;e++){var n=H(e+t),i=n&&n.photo;if(i&&!p[i]){var a=p[i]=new Image;a.src=i,a.onload=function(){p[i]=!0}}}}())}function N(e,t){void 0===t&&(t={});var n=t,i=n.isDoc,a=n.hash,r=n.hasVideo,o=window.photoview,s=h[e];h.length;if(s){var c=qs2obj(nav.params);if(c.z=i?"doc"+s.id+"/"+a:"photo"+s.id+"/"+g+(v?"/rev":""),t.no_open||o.open(e,M(h),{local:t.local,showControls:t.showControls,isDoc:i,hasVideo:r}),!t.local&&!t.crop){var l=nav.path+obj2qs(c)+nav.hash;nav.go(l,null,{no_push:t.no_push,push_only:!0,replace:t.replace,nav_init:!t.no_open,nav_incr:!0})}}t.local||t.crop||U(!0,i)}var F=!1;function H(e){return e>0?e%=h.length:e=(100*h.length+e)%h.length,h[e]}function U(e,t){if(void 0===t&&(t=!1),!F){for(var n=window.photoview,i=!1,a=1,r=0;r<5;r++){if(!(s=H(o=r+y))||!s.owner_id){i=o,a=1;break}}if(!1===i)for(r=-1;r>-3;r--){var o,s;if(!(s=H(o=r+y))||!s.owner_id){i=o,a=-1;break}}if(!1!==i){var c=H(y);if(c){F=!0,show(void 0);var l=window.cur,u=c.owner_id||(c.id||"").split("_")[0],d=Gif.isMp4Supports()&&c.hasVideo,_=o==y&&c.id?(t?"/doc":"/photo")+c.id+(c.hash?"?hash="+c.hash:"")+(d?(c.hash?"&":"?")+"mp4":""):"/photos.php",f={_ajax:1,oid:u,list:m,offset:i,direction:a,rev:v?1:0};Ot.default.getStickerPanel()||(f.need_stickers=1),nav.getQuery("community")&&(f.community=nav.getQuery("community")),ajax.post(_,f,{onDone:function(t,i,a,r){hide(void 0),F=!1,a&&(l.replyNames||(l.replyNames={}),extend(l.replyNames,a)),r&&extend(l,r),T(m,t,i||h.length),e?n&&n.saveSource(M(m),!1,!0):R(y,!0)}})}}}}function V(e,t,n,i,a){if(h=[],e){var r=gpeByClass("thumbs_list",e)||gpeByClass("wiki_body",e);r&&each(geByTag("img",r),(function(){var e=domData(this,"id"),t=JSON.parse(domData(this,"restriction")),n=domData(this,"src_big");if(!e||!n)return!0;var i=(n=n.split("|"))[0],a=+n[1]||0,r=+n[2]||0;h.push({id:e,original_src:i,width:a,height:r,restriction:t})}))}h.length||h.push({id:t,original_src:!0,isDoc:n,hasVideo:i,hash:a})}function W(){addClass("pv_icons_hide",n)}return{save:j,get:E,saveSource:T,getSource:I,clear:function(){removeEvent(window,"resize",L),removeEvent(window,"orientationchange",D),removeEvent(window,"keydown",x)},open:function(e,t,n,i,a){if(checkEvent(n))return!0;if(!k())return!0;if(v=!1,"/rev"==t.substr(-4)&&(t=t.slice(0,-4),v=!0),A=i||null,t)m=t;else{var r=E(e);m=r.album?"album"+r.album:""}if(g=m,h=I(m),-1===(y=P(e,h))){if(!(r=E(e)).id)return!1;h=[r],y=0}b=h.length<2,!1;var o=h[y]&&e!=h[y].id;return R(y,a&&!o,o),!1},prev:function(e){return!!checkEvent(e)||!(F&&!H(y-1))&&(!k()||(b?photo.close():(--y<0&&(y=h.length-1),R(y),W(),!1)))},next:function(e){return!!checkEvent(e)||!(F&&!H(y+1))&&(!k()||(b||(++y>=h.length&&(y=0),R(y),W()),!1))},close:function(e,t){return!!checkEvent(e)},fullscreen:function(e,t){return!!hasClass("pv_photo_tags_selected",n)||nav.go(unescapeAttr(e),t,{need_restore:!0})},showIcons:function(){var e=geByClass1("PhotoviewPage","m");if(!e)return!1;setTimeout((function(){removeClass("pv_hidden_icons",e),setTimeout((function(){addClass("pv_icons_hide",e)}),2e3)}),10)},selectTag:function(e,t,i){if(i&&!hasClass("pv_photo_tags_selected",n))return!0;var a=ge("pv_tag"+e),r=geByClass1("pv_tag_selected","pv_photo_tags_wrap"),o=ge("pv_tag_label"+e),s=geByClass1("pv_tag_label_selected","pv_tags_list");return hasClass("pv_tag_selected",a)||(removeClass("pv_tag_selected",r),addClass("pv_tag_selected",a)),hasClass("pv_tag_label_selected",o)?nav.go(o,t):(removeClass("pv_tag_label_selected",s),addClass("pv_tag_label_selected",o),addClass("pv_photo_tags_selected",n),cancelEvent(t),!1)},closeTags:function(e){if(!hasClass("pv_photo_tags_selected",n))return!0;var t=geByClass1("pv_tag_selected","pv_photo_tags_wrap"),i=geByClass1("pv_tag_label_selected","pv_tags_list");return t&&removeClass("pv_tag_selected",t),i&&removeClass("pv_tag_label_selected",i),removeClass("pv_photo_tags_selected",n),cancelEvent(e),!1},init:function(e,t,n,i,a,r,o){u=isUndefined(o.preload)?1:o.preload,v=!!a,photo.saveSource(e,t,n),onDOMReady((function(){photo.open(i,e+(a?"/rev":""),null,r,!0)}))},zopen:function(e,t,n,i,a){if(void 0===a&&(a={}),checkEvent(t))return!0;if(w.SAKIntegration.isIntegrated)return w.SAKIntegration.sendMessage("photo",{id:n+"_"+(a.key||"")}),!1;if(t&&t.isTrusted&&!a.forceUnauth&&!window.vk.id&&Object(S.partConfigEnabled)("unauthorized_media_layer_box")&&document.querySelector(".PageBottomBanner--unauth"))return a.forceUnauth=!0,window.Unauthorized.showMoreBox(null,0,Vt,(function(){window.photo.zopen(e,t,n,i,a)})),!1;var r=a,o=r.isDoc,s=r.hasVideo,c=r.hash;if(C(),v=!1,"/rev"==i.substr(-4)&&(i=i.slice(0,-4),v=!0),delete qs2obj(nav.params).z,A=a.from||!1,i)m=i;else{var l=E(n);m=l.album?"album"+l.album:""}if(g=m,(h=I(m))[0]&&h[0].isDoc&&h[0].hasVideo!==s&&(h=[]),h.length||V(e,n,o,s,c),-1===(y=P(n,h))&&(V(e,n,o,s,c),y=P(n,h)),-1===y){if(!(l=E(n)).id)return!0;h=[l],y=0}b=h.length<2,!1;var u=h[y]&&n!=h[y].id;return N(y,{no_push:a.no_push&&!u,replace:u,local:a.local,showControls:a.showControls,isDoc:o,hasVideo:s,hash:c}),uRegisterFloatBtn.hide(),cancelEvent(t),!1},zclose:function(e,t){return uRegisterFloatBtn.show(),!!checkEvent(e)}}}();var $t=function(){function e(){}return e.follow=function(t,n,i,a){lockButton(a),ajax.post("/audio",{_ajax:1,act:"artist_follow",ref:n,hash:i,artist_id:t},{onDone:function(i){unlockButton(a),a.classList.add("MusicAuthorCover__followBtn__followed"),a.onclick=function(r){r.preventDefault(),e.unfollow(t,n,i,a)}},onFail:function(){return unlockButton(a)}})},e.unfollow=function(t,n,i,a){lockButton(a),ajax.post("/audio",{_ajax:1,act:"artist_unfollow",ref:n,hash:i,artist_id:t},{onDone:function(i){unlockButton(a),a.classList.remove("MusicAuthorCover__followBtn__followed"),a.classList.contains("MusicAuthorCover__followBtn__canFollow")&&(a.onclick=function(r){r.preventDefault(),e.follow(t,n,i,a)})},onFail:function(){return unlockButton(a)}})},e.trackToOfficial=function(e,t){ajax.post("/audio",{_ajax:1,act:"artist_track_to_official",hash:e,url:t})},e}(),qt=n("29dZ"),zt=function(){function e(){}return e.follow=function(t,n,i){qt.default.setDisabled(i,!0),ajax.post("curator.php",{_ajax:1,act:"follow",hash:n,curator_id:t},{onDone:function(n){qt.default.setDisabled(i,!1),i.classList.add("MusicAuthorCover__followBtn__followed"),i.onclick=function(a){a.preventDefault(),e.unfollow(t,n,i)}},onFail:function(){return qt.default.setDisabled(i,!1)}})},e.unfollow=function(t,n,i){qt.default.setDisabled(i,!0),ajax.post("curator.php",{_ajax:1,act:"unfollow",hash:n,curator_id:t},{onDone:function(n){qt.default.setDisabled(i,!1),i.classList.remove("MusicAuthorCover__followBtn__followed"),i.onclick=function(a){a.preventDefault(),e.follow(t,n,i)}},onFail:function(){return qt.default.setDisabled(i,!1)}})},e}(),Yt=n("lkNA"),Gt=n("rEJs"),Kt=0,Qt=1,Xt=2,Jt=3,Zt=4,en=5,tn=6,nn=8,an=9,rn=10,on=11,sn=12,cn=13,ln=14,un=15,dn=16,_n=17,fn=18,pn=19,hn=20,mn=21,vn=22,gn=24,An=25,bn=2,wn=4,yn=32,On=128,Sn=512,kn=1024;function Cn(e){if(!e)return!1;var t=isObject(e)?e.extra:e[sn];return isObject(t)||(t=JSON.parse(t||"{}")),!!t.podcast}var jn=function(){function e(e,t,n){this._isPlaying=!1,this._adsCurrentProgress=0,this._adman=null,this._admanLoaded=!1,this._adEvents=[],this.player=e||{},this.playerVersion=t||null,this._startAdsTO=null,this._adsConfig=null,this._duration=0,this.isMvk=Boolean(n),this.adsStatUrl=this.isMvk?"audio":"al_audio.php"}var t=e.prototype;return t.isPlaying=function(){return this._isPlaying},t.setAdsConfig=function(e){this._adsConfig=e},t.getCurrentProgress=function(){return this._adsCurrentProgress},t.getDuration=function(){return this._duration},t.loadAdman=function(t){var n=this,i=function(e){return t&&t(e)};if(this._admanLoaded)i();else{var a=0;Object(Yt.loadScript)(e.ADMAN_SRC,{onLoad:function(){n._admanLoaded=!0,i()},onError:function(){window.abp?(n._admanLoaded=!0,i()):(3===(a+=1)&&(n._admanLoaded=!0),i("script_load_fail"))}})}},t._fetchAd=function(t,n,i,a,r){var o=this;this.loadAdman((function(s){if(!window.AdmanHTML)return o._sendEvent("no_adman",n,e.AD_TYPE,s),a&&a();o._adman=new AdmanHTML;var c=o._adsConfig||vk.audioAdsConfig||window.audioAdsConfig,l={_SITEID:276,ver:251116,vk_id:vk.id,duration:t.duration,content_id:En(t.ownerId,t.id),vk_catid:e.CAT_IDS[n]||e.CAT_IDS.other,sign:c.sign||""};extend(l,t.ads||{}),nav.objLoc&&nav.objLoc.preview&&(l.preview=intval(nav.objLoc.preview)),cur.adsPreview&&(l.preview=1,l.vk_id=398724832),o._adman.setDebug(!!l.preview),o._adman.onError((function(){return a&&a()})),o._adman.onReady((function(){if(o._adman){var t=o._adman.getBannersForSection(e.AD_TYPE);t&&t.length?"statistics"===t[0].type?(o._play(!0,n),a&&a()):(o._sendEvent("received",n),i?(o._sendEvent("rejected",n,e.AD_TYPE,r),o.deinit(),a&&a()):(o._sendEvent("ready",n),o.player.notify(Gt.events.AD_READY),o._play(!1,n,a))):(i||o._sendEvent("not_received",n),a&&a())}})),o._adman.init({slot:3514,wrapper:o.isMvk?ce("div"):se("<div></div>"),params:l,browser:{adBlock:!!window.abp,mobile:!1}}),o._sendEvent("requested",n)}))},t._sendEvent=function(e,t,n,i){var a=this,r=n?"/"+n:"",o=i?"/"+i:"";this._adEvents.push(e+"/"+t+r+o),clearTimeout(this._adEventDelay),this._adEventDelay=setTimeout((function(){ajax.post(a.adsStatUrl,{act:"ad_event",events:a._adEvents.join(","),v:a.playerVersion,abp:intval(window.abp)},{onFail:function(){return!0}}),a._adEvents=[]}),500)},t._play=function(t,n,i){var a=this;this._adman.onCompleted((function(){a.deinit(!0),t?a._sendEvent("statistics",n):(a.player.notify(Gt.events.PROGRESS,0),a.player.notify(Gt.events.AD_COMPLETED),a._isPlaying=!1,a._adsCurrentProgress=0,a._sendEvent("completed",n),window.setDocumentTitle&&window.setDocumentTitle(a._adsPrevTitle),i&&i())})),this._adman.onStarted((function(){t||(a.player.setIsPlaying(!0),a.player.notify(Gt.events.PLAY),a.player.notify(Gt.events.PROGRESS,0),a.player.notify(Gt.events.AD_STARTED),a.updateVolume(),a._sendEvent("started",n),window.statlogsValueEvent&&statlogsValueEvent("audio_web_ad_link","show"))})),this._adman.onPaused((function(){a.player.setIsPlaying(!1),a.player.notify(Gt.events.PAUSE)})),this._adman.onPlayed((function(){a.player.setIsPlaying(!0),a.player.notify(Gt.events.PLAY)}));var r=[.25,.5,.75];if(this._adman.onTimeRemained((function(e){a._duration=isNaN(e.duration)?0:e.duration,a._adsCurrentProgress=(isNaN(e.percent)?0:e.percent)/100,a.player.notify(Gt.events.PROGRESS,a._adsCurrentProgress,a._duration),each(r,(function(e,t){if(a._adsCurrentProgress>=t)return r.shift(),a._sendEvent("progress_"+intval(100*t),n),!1}))})),this._adman.start(e.AD_TYPE),t)return i&&i();this._isPlaying=!0,this._adsPrevTitle=document.title,this.isMvk||setDocumentTitle(getLang("global_audio_ad"))},t.updateVolume=function(){this._adman&&this._adman.setVolume(.7*this.player.getVolume())},t.deinit=function(e){this._adman=null,!e&&this.player.notify(Gt.events.AD_DEINITED)},t.pause=function(){this._adman&&(this.player.setIsPlaying(!1),this._adman.pause())},t.stop=function(){this._adman&&(this.player.setIsPlaying(!1),this._adman.stop())},t.resume=function(){this._adman&&(this.player.setIsPlaying(!0),this._adman.resume(),this.player.notify(Gt.events.PLAY))},t.checkPlay=function(t,n){var i=this.player._getPlayingContextSection(),a=this._isAllowed(t),r=a.type,o=a.reason,s=function(){return n&&n()};switch(r){case e.ALLOW_ALLOWED:this._fetchAd(t,i,!1,s);break;case e.ALLOW_DISABLED:s();break;case e.ALLOW_REJECT:this._fetchAd(t,i,!0,!1,o),s()}},t._isAllowed=function(t){if(vk.widget)return{type:e.ALLOW_DISABLED};if(Cn(t))return{type:e.ALLOW_DISABLED};if(window.browser&&window.browser.safari)return{type:e.ALLOW_DISABLED};var n=this._adsConfig||vk.audioAdsConfig||window.audioAdsConfig;if(n){if(!n.enabled)return{type:e.ALLOW_DISABLED};if(cur.adsPreview)return{type:e.ALLOW_ALLOWED};if(n.day_limit_reached)return{type:e.ALLOW_REJECT,reason:e.REJECT_REASON_LIMIT};var i=this.player._getPlayingContextSection();return n.sections.indexOf(i)>-1?{type:e.ALLOW_ALLOWED}:{type:e.ALLOW_REJECT,reason:e.REJECT_REASON_SECTION}}return{type:e.ALLOW_REJECT,reason:e.REJECT_REASON_UNKNOWN}},t.startPlay=function(e,t){this.checkPlay(e,t)},e}();function En(e,t){for(var n=e.toString(16),i=t.toString(16);i.length<8;)i="0"+i;return n+i}jn.ADMAN_SRC="//ad.mail.ru/static/admanhtml/rbadman-html5.min.js",jn.CAT_IDS={my:101,my_playlists:101,audio_feed:109,recent:113,user_wall:104,group_wall:104,user_list:102,group_list:103,user_playlists:102,group_playlists:103,feed:105,search:110,global_search:110,replies:104,im:106,group_status:104,user_status:104,recs:107,recs_audio:107,recs_album:107,other:114},jn.AD_TYPE="preroll",jn.ALLOW_DISABLED=1,jn.ALLOW_ALLOWED=2,jn.ALLOW_REJECT=3,jn.REJECT_REASON_UNKNOWN="unknown",jn.REJECT_REASON_LIMIT="track_limit_exceeded",jn.REJECT_REASON_SECTION="section_not_allowed";var Tn=function(){function e(e){this.audioplayer=e}var t=e.prototype;return t.notify=function(e){var t,n=this.audioplayer.getCurrent();switch(e){case Gt.events.AD_COMPLETED:case Gt.events.AD_STARTED:this.audioplayer.notify(e,n);break;case Gt.events.PAUSE:case Gt.events.PLAY:this.audioplayer.notify(e,n.fullId);break;case Gt.events.PROGRESS:for(var i=arguments.length,a=new Array(i>1?i-1:0),r=1;r<i;r++)a[r-1]=arguments[r];(t=this.audioplayer).notify.apply(t,[e,n.fullId].concat(a))}},t.setIsPlaying=function(e){this.audioplayer.setIsPlaying(e)},t.getVolume=function(){var e=Object(r.ssGet)("audio_vol");return null===e?1:e},t._getPlayingContextSection=function(){return window.playerAdapter.getContext()},e}(),In=n("Po+v");function Mn(e,t){function n(e){var t=["Webkit","Moz","O","ms"],n=document.createElement("div");if(void 0!==n.style[e])return!0;for(var i in e=e.charAt(0).toUpperCase()+e.slice(1),t)if(void 0!==n.style[t[i]+e])return!0;return!1}function i(e,t){new RegExp("(\\s|^)"+t+"(\\s|$)").test(e.className)||(e.className+=" "+t)}function a(e,t){e.className=e.className.replace(new RegExp("(\\s+|^)"+t+"(\\s+|$)","g")," ").replace(/^\s+|\s+$/g,"")}function r(e,t){0>e?e=0:e>v-1&&(e=v-1);for(var n=O.dots.length-1;n>=0;n--)a(O.dots[n],j.activeDot);return i(O.dots[e],j.activeDot),k=e,o(-e*O.width,void 0===t?C.speed:t),_(),C.onSlideChange&&C.onSlideChange(e),e}function o(e,t){var n=t?t+"ms":"";A.style.webkitTransitionDuration=A.style.MozTransitionDuration=A.style.msTransitionDuration=A.style.OTransitionDuration=A.style.transitionDuration=n,c(e)}function s(e,t){if(y&&clearInterval(y),t){var n=+new Date,i=O.left;y=setInterval((function(){function a(e,t){return(t-e)*s+e}var r,o,s=(+new Date-n)/t,l=[0,.7,1,1];return s>=1?(c(e),void clearInterval(y)):(r=e-i,o=a(a(a(l[0],l[1]),a(l[1],l[2])),a(a(l[1],l[2]),a(l[2],l[3]))),void c(Math.floor(o*r+i)))}),15)}else c(e)}function c(e){A.style.webkitTransform="translate("+e+"px,0) translateZ(0)",A.style.msTransform=A.style.MozTransform=A.style.OTransform=A.style.transform="translateX("+e+"px)",O.left=e}function l(e){A.style.left=e+"px",O.left=e}function u(){var e=k+1;return e>v-1&&(e=0),r(e)}function d(){w=!0,_()}function _(){w&&(b&&clearTimeout(b),b=setTimeout((function(){u()}),C.slideshowInterval))}function f(){b&&clearTimeout(b)}function p(){w=!1,b&&clearTimeout(b)}function h(){O.width=e.offsetWidth,A.style.width=O.width*v+"px";for(var t=0;v>t;t++)O.slides[t].style.width=O.width+"px";o(-k*O.width)}function m(e,t,n,i){t&&(e.addEventListener?e.addEventListener(t,n,!!i):e.attachEvent("on"+t,n))}var v,g,A,b,w,y,O={slides:[],dots:[],left:0},S=200,k=0,C={speed:300,touchSpeed:300,slideshow:!1,slideshowInterval:4e3,stopSlideshowAfterInteraction:!1,startSlide:0,mouseDrag:!0,disableIfOneSlide:!0,cssPrefix:"peppermint-",dots:!1,dotsPrepend:!1,dotsContainer:void 0,slidesContainer:void 0,onSlideChange:void 0,onSetup:void 0};t&&function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}(C,t);var j={inactive:C.cssPrefix+"inactive",active:C.cssPrefix+"active",mouse:C.cssPrefix+"mouse",drag:C.cssPrefix+"drag",slides:C.cssPrefix+"slides",dots:C.cssPrefix+"dots",activeDot:C.cssPrefix+"active-dot",mouseClicked:C.cssPrefix+"mouse-clicked"},E={transforms:n("transform"),transitions:n("transition")};return function(){var t=C.slidesContainer||e,n=C.dotsContainer||e;if(!(C.disableIfOneSlide&&t.children.length<=1)){(!E.transforms||window.opera)&&(c=l),(!E.transitions||window.opera)&&(o=s),i(A=C.slidesContainer||document.createElement("div"),j.slides);for(var u=0,_=t.children.length;_>u;u++){var b=t.children[u],w=document.createElement("li");O.slides.push(b),w.setAttribute("tabindex","0"),w.setAttribute("role","button"),w.innerHTML="<span></span>",function(t,n){m(n,"click",(function(){r(t),C.stopSlideshowAfterInteraction&&p()})),m(n,"keyup",(function(e){13==e.keyCode&&(r(t),C.stopSlideshowAfterInteraction&&p())})),m(n,"mouseup",(function(){i(n,j.mouseClicked)})),m(n,"blur",(function(){a(n,j.mouseClicked)}),!0),m(b,"focus",b.onfocusin=function(){e.scrollLeft=0,setTimeout((function(){e.scrollLeft=0}),0),r(t)},!0)}(u,w),O.dots.push(w)}v=O.slides.length,100/v,i(e,j.active),a(e,j.inactive),C.mouseDrag&&i(e,j.mouse),O.width=e.offsetWidth,A.style.width=O.width*v+"px";for(u=0;v>u;u++)O.slides[u].style.width=O.width+"px",A.appendChild(O.slides[u]);if(C.slidesContainer||e.appendChild(A),C.dots&&v>1){i(g=document.createElement("ul"),j.dots);for(u=0,_=O.dots.length;_>u;u++)g.appendChild(O.dots[u]);C.dotsPrepend?n.insertBefore(g,n.firstChild):n.appendChild(g)}m(window,"resize",h),m(window,"orientationchange",h),setTimeout((function(){r(C.startSlide,0)}),0),C.slideshow&&d(),Pn(A,{mouse:C.mouseDrag,start:function(){i(e,j.drag)},move:function(e,t,n){f(),n.x=n.x/(!k&&n.x>0||k==v-1&&n.x<0?Math.abs(n.x)/O.width*2+1:1),o(n.x-O.width*k)},end:function(t,n,i){if(i.x){var o=Math.abs(i.x)/O.width,s=Math.floor(o)+(o-Math.floor(o)>.25?1:0);s+=i.time<S+S*s/1.8&&Math.abs(i.x)-s*O.width>(s?-O.width/9:20)?1:0,i.x<0?r(k+s,C.touchSpeed):r(k-s,C.touchSpeed),C.stopSlideshowAfterInteraction&&p()}a(e,j.drag)}}),setTimeout((function(){C.onSetup&&C.onSetup(v)}),0)}}(),{slideTo:function(e,t){return r(parseInt(e,10),t)},next:u,prev:function(){var e=k-1;return 0>e&&(e=v-1),r(e)},start:d,stop:p,pause:f,getCurrentPos:function(){return k},getSlidesNumber:function(){return v},recalcWidth:h}}function Pn(e,t){function n(e,t,n,a){return t?(e.addEventListener?e.addEventListener(t,n,!!a):e.attachEvent("on"+t,n),{remove:function(){i(e,t,n,a)}}):void 0}function i(e,t,n,i){t&&(e.removeEventListener?e.removeEventListener(t,n,!!i):e.detachEvent("on"+t,n))}function a(e){}function r(e){if((m={x:(_?e.clientX:e.touches[0].clientX)-h.x,y:(_?e.clientY:e.touches[0].clientY)-h.y,time:Number(new Date)-h.time}).time-g[g.length-1].time){for(var t=0;t<g.length-1&&m.time-g[t].time>80;t++);v={x:(m.x-g[t].x)/(m.time-g[t].time),y:(m.y-g[t].y)/(m.time-g[t].time)},g.length>=5&&g.shift(),g.push({x:m.x,y:m.y,time:m.time})}}function o(e,t){b=!0,O[_=t](e)||(n(document,y[_][1],s),n(document,y[_][2],c),n(document,y[_][3],c),u.preventDefault,h={x:_?e.clientX:e.touches[0].clientX,y:_?e.clientY:e.touches[0].clientY,time:Number(new Date)},d=void 0,m={x:0,y:0,time:0},v={x:0,y:0},g=[{x:0,y:0,time:0}],u.start(e,h))}function s(e){!u.preventScroll&&d||O[_](e)||(r(e),(Math.abs(m.x)>u.clickTolerance||Math.abs(m.y)>u.clickTolerance)&&(b=!1),void 0===d&&3!==_&&(d=Math.abs(m.x)<Math.abs(m.y)&&!u.preventScroll)||(u.preventDefault,u.move(e,h,m,v)))}function c(e){_&&r(e),!b&&e.target&&e.target.blur&&e.target.blur(),i(document,y[_][1],s),i(document,y[_][2],c),i(document,y[_][3],c),u.end(e,h,m,v)}var l=function(){},u={preventDefault:!0,clickTolerance:0,preventScroll:!1,mouse:!0,start:l,move:l,end:l,click:l};t&&function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}(u,t);var d,_,f=!!window.navigator.pointerEnabled,p=!!window.navigator.msPointerEnabled,h={},m={},v={},g=[],A=[],b=!0,w=f?1:p?2:0,y=[["touchstart","touchmove","touchend","touchcancel"],["pointerdown","pointermove","pointerup","pointercancel"],["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerCancel"],["mousedown","mousemove","mouseup",!1]],O=[function(e){return e.touches&&e.touches.length>1||e.scale&&1!==e.scale},function(e){return!e.isPrimary||e.buttons&&1!==e.buttons||!u.mouse&&"touch"!==e.pointerType&&"pen"!==e.pointerType},function(e){return!e.isPrimary||e.buttons&&1!==e.buttons||!u.mouse&&e.pointerType!==e.MSPOINTER_TYPE_TOUCH&&e.pointerType!==e.MSPOINTER_TYPE_PEN},function(e){return e.buttons&&1!==e.buttons}];return A.push(n(e,y[w][0],(function(e){o(e,w)}))),A.push(n(e,"dragstart",a)),u.mouse&&!w&&A.push(n(e,y[3][0],(function(e){o(e,3)}))),A.push(n(e,"click",(function(e){b&&u.click(e)}))),{getClicksAllowed:function(){return b},kill:function(){for(var e=A.length-1;e>=0;e--)A[e].remove()}}}window.jQuery&&function(e){e.fn.Peppermint=function(t){return this.each((function(){e(this).data("Peppermint",Mn(this,t))})),this}}(window.jQuery),window.Peppermint=Mn,window.EventBurrito=Pn;var Dn=Mn,xn=function(){function e(){this.initPopup(),this.popup&&(this.connectEvents(),this.initSlider(),e.sendStat("show_screen"))}e.sendStat=function(e){Object(r.statlogsValueEvent)("audio_onboarding",e)};var t=e.prototype;return t.initPopup=function(){var e=document.querySelector(".audioRestrictionSplash");e&&(this.popup=In.default.open(e,!0,{forceScrollDisable:!0}))},t.connectEvents=function(){var t=this;this.popup.querySelectorAll(".audioRestrictionSplash__closeIcon").forEach((function(n){n.addEventListener("click",(function(n){Object(r.gpeByClass)("audioRestrictionSplash__firstScreen",n.target)?e.sendStat("skip_1screen"):Object(r.gpeByClass)("audioRestrictionSplash__secondScreen",n.target)&&e.sendStat("skip_2screen"),t.close()}))})),this.popup.querySelector(".audioRestrictionSplash__explain").addEventListener("click",(function(){return e.sendStat("click_more")})),this.popup.querySelector(".audioRestrictionSplash__continueFreeLink").addEventListener("click",(function(){e.sendStat("continue_free"),t.close()})),this.popup.querySelector(".audioRestrictionSplash__continueButton").addEventListener("click",(function(){t.slider.next(),e.sendStat("next_1screen")})),this.popup.querySelector(".audioRestrictionSplash__specialLink").addEventListener("click",(function(){return e.sendStat("get_offer")}))},t.initSlider=function(){this.screens=this.popup.querySelector(".audioRestrictionSplash__screens"),this.slider=Dn(this.screens,{dots:!0,speed:500})},t.close=function(){In.default.close(this.popup)},e}(),Ln=n("r/ag"),Bn=function(){function e(){this.visibleCallbacks=[],this.hiddenCallbacks=[],this.visibilityPrefix="",this.hiddenStateName="hidden",this.isHidden=!1,this.listen()}e._supports=function(e){return e+"Hidden"in document};var t=e.prototype;return t.onVisible=function(e){this.visibleCallbacks.push(e)},t.onHidden=function(e){this.hiddenCallbacks.push(e)},t.listen=function(){var e=this,t=arguments;try{var n=x.default.version.split(".")[0];if(x.default.safari_mobile&&n<=7)return window.addEventListener("pagehide",(function(){return e._hidden()})),void window.addEventListener("pageshow",(function(){return e._visible()}));var i=x.default.android&&x.default.safari&&n<5,a=!i&&this.isSupported();a?(document.addEventListener(this.visibilityPrefix+"visibilitychange",(function(){return e._nativeSwitch(t)})),window.addEventListener(this.visibilityPrefix+"visibilitychange",(function(){return e._nativeSwitch(t)}))):document.addEventListener?(window.addEventListener("focus",(function(){return e._visible()}),1),window.addEventListener("blur",(function(){return e._hidden()}),1)):(document.attachEvent("onfocusin",(function(){return e._visible()})),document.attachEvent("onfocusout",(function(){return e._hidden()})))}catch(e){}},t.isSupported=function(){for(var t=0;t<e.prefixes.length;t++){var n=e.prefixes[t];if(e._supports(n))return this.hiddenStateName=(n?n+"H":"h")+"idden",this.visibilityPrefix=n,!0}return!1},t._visible=function(){this.isHidden=!1,this.visibleCallbacks.forEach((function(e){return e()}))},t._hidden=function(){this.isHidden=!0,this.hiddenCallbacks.forEach((function(e){return e()}))},t._nativeSwitch=function(){!0===document[this.hiddenStateName]?this._hidden():this._visible()},e}();function Rn(e){var t=null;if(e.action_button){var n=e.action_button;t={class:"AudioPopup__actionButtonWrapper",inner:{class:["AudioPopup__actionButton","button"],onclick:n.onclick,href:n.href,inner:n.text}}}var i=["AudioPopup"];e.popupClass&&i.push(e.popupClass);var a={class:"AudioPopup__content",inner:[{class:"AudioPopup__title",inner:e.title},{class:"AudioPopup__description",inner:e.description},t,e.additional_link]};return new Ln.default({content:a,class:i.join(" ")})}Bn.prefixes=["webkit","o","ms","moz",""];var Nn=n("J8bf"),Fn=function(){function e(){audioSubscribe||(this.isIdle=!1,this.showAlertCountToday=function(e,t){void 0===t&&(t=0);var n=parseInt(Object(Nn.getCookie)(e),10);if(isNaN(n,10))return t;return n}(e.SHOW_ALERT_COOKIE),this.initVisibilityChangeEvent())}e.writePopupStat=function(e){statlogsValueEvent("mvk_audio_background_popup",e)},e.createPopup=function(){var t={href:e.EXPLANATION_LINK,onclick:'AudioBackgroundRestriction.writePopupStat("explanation_click");',class:"AudioPopup__explanation",inner:getLang("mobile_audio_background_restriction_explanation")};return Wd.elem(Rn({popupClass:"AudioRestrictionPopup",title:getLang("mobile_audio_background_restriction_title"),description:getLang("mobile_audio_background_restriction_description"),action_button:{href:e.REMOVE_RESTRICTION_LINK,onclick:'AudioBackgroundRestriction.writePopupStat("link_click");',text:getLang("mobile_audio_background_restriction_button")},additional_link:t}))};var t=e.prototype;return t.onIdle=function(){window.audio.playing()&&this.triggerRestriction()},t.showBackgroundMessage=function(){var t=e.createPopup();this.showAlertCountToday+=1,Object(Nn.setCookie)("remixaudio_show_alert_today",this.showAlertCountToday,1),this.showAlertCountToday%3||(Ln.default.open(t,!0),e.writePopupStat("show"))},t.triggerRestriction=function(){audio.pause(),this.showBackgroundMessage()},t.initVisibilityChangeEvent=function(){var e=this;this.pageVisibility=new Bn,this.pageVisibility.onVisible((function(){e.isIdle=!1})),this.pageVisibility.onHidden((function(){e.isIdle=!0,e.onIdle()}))},e}();Fn.SHOW_ALERT_COOKIE="remixaudio_show_alert_today",Fn.REMOVE_RESTRICTION_LINK="/offermusic",Fn.EXPLANATION_LINK="https://vk.cc/9uFgyl";var Hn=n("L9Nh"),Un=function(e){this.queueHandler=e},Vn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Wn=function(e){function t(t){return e.call(this,t)||this}return Vn(t,e),t.prototype.connect=function(e){var t=this;e&&this.listenQueueKey!==e.key&&(this.listenQueueKey=e.key,Hn.QueueManager.addQueue({key:e.key,ts:e.timestamp},(function(e,n){return t.queueHandler(n)})),Hn.QueueManager.start())},t}(Un);var $n=0,qn=function(){function e(){this.audioQueueListener=new Wn(this.handleAudioQueueMessage),this.subscriptionQueueListener=new Wn(this.handleSubscriptionQueueMessage)}return e.prototype.connect=function(e){var t=this;if(void 0===e&&(e=!1),Hn.QueueManager.initialized){var n=window.audio.getCurrent(),i=!e&&(this.audioQueueListener.listenQueueKey||this.subscriptionQueueListener.listenQueueKey);n&&!i&&window.ajax.post("/audio",{act:"queue_params",audio_id:n.id,owner_id:n.ownerId,hash:n.actionHash},{onDone:function(e){var n,i,a=(i={},(n=e)&&n.length&&n.filter((function(e){return!!e})).map((function(e){return e.queues&&e.queues[0]})).forEach((function(e){return i[e.type]=e})),i);a.audio&&t.audioQueueListener.connect(a.audio),a.subscription&&t.subscriptionQueueListener.connect(a.subscription),e&&(t.listenQueueRefreshTO&&clearTimeout(t.listenQueueRefreshTO),t.listenQueueRefreshTO=window.setTimeout((function(){return t.connect(!0)}),3e4))},onFail:function(){return $n<3&&($n++,setTimeout((function(){return t.connect()}),5e3)),!0}})}},e.prototype.handleAudioQueueMessage=function(t){for(var n=window.audio.playing(),i=0;i<t.events.length;i++){var a=t.events[i].data;if("start"===a.type&&window.audio.getDeviceId()!==a.uuid&&!e.startPlaybackBox&&n){window.audio.pause(),e.showMultipleStreamPopup(a);break}}},e.prototype.handleSubscriptionQueueMessage=function(e){e.events.length&&e.events.forEach((function(e){if(1===e.data.product_id){var t=window.audioAdsConfig||window.vk.audioAdsConfig;t&&(t.enabled=!e.data.active)}}))},e.showMultipleStreamPopup=function(t){var n=e.createPopup(t.device_name);Ln.default.open(n,!0,{oncloseCallback:function(){return e.startPlaybackBox=!1}}),document.querySelector(".AudioPopup__actionButton").addEventListener("click",(function(){Ln.default.close()})),e.startPlaybackBox=!0},e.createPopup=function(e){return d.default.elem(Rn({title:Object(J.getLang)("mobile_audio_start_playback_title"),description:Object(J.getLang)("mobile_audio_start_playback_body").replace("{device_name}",e),action_button:{text:Object(J.getLang)("mobile_audio_continue")}}))},e.startPlaybackBox=!1,e}(),zn="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA",Yn=n("xk4V"),Gn=n.n(Yn),Kn=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),a=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,a++)i[a]=r[o];return i},Qn=function(){function e(){this.subscriptions={}}return e.prototype.subscribe=function(e,t){var n=this;return Array.isArray(e)&&e.forEach((function(e){return n.subscribe(e,t)})),this.subscriptions[e]||(this.subscriptions[e]=[]),this.subscriptions[e].push(t),{unsubscribe:function(){return n.unsubscribe(e,t)}}},e.prototype.unsubscribe=function(e,t){if(this.subscriptions[e]){var n=this.subscriptions[e].indexOf(t);n>=0&&this.subscriptions[e].splice(n,1)}},e.prototype.emit=function(e){for(var t=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];this.precheck&&!this.precheck.apply(this,Kn([e],n))||(this.onAnyCallBack&&setTimeout((function(){return t.onAnyCallBack.apply(t,Kn([e],n))})),this.subscriptions[e]&&this.subscriptions[e].forEach((function(e){return setTimeout((function(){return e.apply(void 0,n)}))})))},e}(),Xn="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMN0PQRSTUVWXYZO123456789+/=",Jn={v:function(e){return e.split("").reverse().join("")},r:function(e,t){var n;e=e.split("");for(var i=Xn+Xn,a=e.length;a--;)~(n=i.indexOf(e[a]))&&(e[a]=i.substr(n-t,1));return e.join("")},s:function(e,t){var n=e.length;if(n){var i=function(e,t){var n=e.length,i=[];if(n){var a=n;for(t=Math.abs(t);a--;)t=(n*(a+1)^t+a)%n,i[a]=t}return i}(e,t),a=0;for(e=e.split("");++a<n;)e[a]=e.splice(i[n-1-a],1,e[a])[0];e=e.join("")}return e},i:function(e,t){return Jn.s(e,t^vk.id)},x:function(e,t){var n=[];return t=t.charCodeAt(0),each(e.split(""),(function(e,i){n.push(String.fromCharCode(i.charCodeAt(0)^t))})),n.join("")}};function Zn(e){if((!window.wbopen||!~(window.open+"").indexOf("wbopen"))&&~e.indexOf("audio_api_unavailable")){var t,n,i=e.split("?extra=")[1].split("#"),a=""===i[1]?"":ei(i[1]);if(i=ei(i[0]),"string"!=typeof a||!i)return e;for(var r=(a=a?a.split(String.fromCharCode(9)):[]).length;r--;){if(t=(n=a[r].split(String.fromCharCode(11))).splice(0,1,i)[0],!Jn[t])return e;i=Jn[t].apply(null,n)}if(i&&"http"===i.substr(0,4))return i}return e}function ei(e){if(!e||e.length%4==1)return!1;for(var t,n,i=0,a=0,r="";n=e.charAt(a++);)~(n=Xn.indexOf(n))&&(t=i%4?64*t+n:n,i++%4)&&(r+=String.fromCharCode(255&t>>(-2*i&6)));return r}function ti(e,t){var n="";return e.forEach((function(i,a){var r="/audio?performer=1&q="+encodeURIComponent(i.name),o=window.getWebHost?window.getWebHost():"";i.id&&(r="/artist/"+i.id),n+=t?'<a class="artist_link" href="'+o+r+'">'+i.name+"</a>":i.name,a<e.length-1&&(n+=", ")})),n}function ni(e){if(!e)return null;if(isObject(e))return e;if("string"==typeof e)return{id:e};var t=(e[cn]||"").split("/"),n=(e[ln]||"").split(","),i=function(e,t){void 0===t&&(t=!0);var n="",i=!Cn(e)&&t;if(isArray(e[_n])&&(n=ti(e[_n],i)),isArray(e[fn])&&(n+=" feat. ",n+=ti(e[fn],i)),!n){var a=e[Zt]?e[Zt].replace(/<\/?em>/g,""):"";if(i)n='<a class="artist_link" data-performer="'+a+'" href="'+("/audio?performer=1&q="+encodeURIComponent(a))+'">'+a+"</a>";else n=a}return n}(e,!1);return{id:intval(e[Kt]),owner_id:intval(e[Qt]),ownerId:e[Qt],fullId:e[Qt]+"_"+e[Kt],title:e[Jt]||"",subTitle:e[dn],performer:i,mainArtists:e[_n],featArtists:e[fn],authorLink:e[nn],duration:intval(e[en]),lyrics:intval(e[an]),url:e[Xt],flags:e[rn],context:e[on],extra:e[sn],accessKey:e[gn],addHash:t[0]||"",editHash:t[1]||"",actionHash:t[2]||"",deleteHash:t[3]||"",replaceHash:t[4]||"",urlHash:t[5]||"",restoreHash:t[6]||"",canEdit:!!t[1],canDelete:!!t[3],isLongPerformer:e[rn]&yn,canAdd:!!(e[rn]&bn),coverUrl_s:n[0],coverUrl_p:n[1],isClaimed:!!(e[rn]&wn),isExplicit:!!(e[rn]&kn),isUMA:!!(e[rn]&On),isReplaceable:!!(e[rn]&Sn),ads:e[un],album:e[pn],albumId:intval(e[tn]),albumPart:intval(e[vn]),trackCode:e[hn],restrictionStatus:e[mn],chartInfo:e[An]}}var ii=n("XMCv");function ai(e){try{return e.play()||Promise.resolve()}catch(e){return Promise.reject(e)}}var ri,oi=n("Xrg9"),si=function(){return(si=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ci=function(){function e(e,t){var n=this;this.fullyLoaded=!1,this.url="",this.audioElement=new Audio,this.audioElement.crossOrigin="anonymous",this.audioElement.preload="auto",this.volume=e.volume,this.addEventListeners(e),t&&this.setUrl(t).then((function(){n.audioElement.load()}));var i=new j;this.audioNetworkStatCollector=new I(i)}return Object.defineProperty(e.prototype,"isFullyLoaded",{get:function(){return this.fullyLoaded},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this.audioElement.error||null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"played",{get:function(){return this.audioElement.played},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"src",{get:function(){return this.url},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hls",{get:function(){return this.hlsInstance||null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return isFinite(this.audioElement.duration)?this.audioElement.duration:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this.audioElement.readyState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this.audioElement.currentTime},set:function(e){this.audioElement.currentTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this.audioElement.volume},set:function(e){this.audioElement.volume=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playbackRate",{set:function(e){this.audioElement.playbackRate=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentProgress",{get:function(){return isNaN(this.audioElement.duration)?0:Math.max(0,Math.min(1,this.audioElement.currentTime/this.audioElement.duration))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentBuffered",{get:function(){return this.audioElement.buffered.length?Math.min(1,this.audioElement.buffered.end(0)/this.audioElement.duration):0},enumerable:!0,configurable:!0}),e.prototype.play=function(){return ai(this.audioElement).catch((function(e){switch(e.code){case e.NOT_SUPPORTED_ERR:case e.ABORT_ERR:break;default:throw e}}))},e.prototype.pause=function(){this.audioElement.pause()},e.prototype.addEventListeners=function(e){var t=this;this.audioElement.addEventListener("pause",(function(){return e.onPause()})),this.audioElement.addEventListener("play",(function(){return e.onPlay()})),this.audioElement.addEventListener("progress",(function(){if(e.onBufferUpdate(),!t.hlsInstance){var n=t.audioElement.buffered;n.length&&Math.abs(n.end(n.length-1)-t.audioElement.duration)<1&&(t.fullyLoaded=!0)}})),this.audioElement.addEventListener("timeupdate",(function(){e.onProgressUpdate&&e.onProgressUpdate()})),this.audioElement.addEventListener("ended",(function(){e.onEnd&&e.onEnd()})),this.onFail=e.onFail||function(){},this.audioElement.addEventListener("error",(function(){t.onFail()})),this.audioElement.addEventListener("canplay",(function(){e.onCanPlay&&e.onCanPlay()})),this.audioElement.addEventListener("durationchange",(function(){e.onDurationChange&&e.onDurationChange()}))},e.isHlsUrl=function(e){return Zn(e).includes(".m3u8")},e.prototype.setUrl=function(t){var n=this,i=Zn(t);return this.url=i,e.isHlsUrl(i)&&!e.shouldUseNativeHls()&&"function"==typeof window.MediaSource?this.initHls(i).catch((function(){return n.onFail()})):(this.hlsInstance&&this.hlsInstance.destroy(),this.audioElement.src=i,this.audioElement.load(),Promise.resolve())},e.shouldUseNativeHls=function(){var e=window.browser.version.split(".")[0],t=parseInt(e);return window.browser.safari||window.browser.msie_edge&&t>11&&t<78},e.prototype.initHls=function(t){var n=this;return e.loadHls().then((function(e){var i=e.default;return new Promise((function(e){var a=!1,r=!!oi.default.get("_audio_hls_debug");n.hlsInstance&&n.hlsInstance.destroy();var o=new i({debug:r,maxBufferHole:3,nudgeOffset:.5,nudgeMaxRetry:5,maxFragLookUpTolerance:.2});o.on(i.Events.BUFFER_EOS,(function(){return n.fullyLoaded=!0})),o.on(i.Events.ERROR,(function(e,t){t.details===i.ErrorDetails.BUFFER_STALLED_ERROR&&(a=!0),(r||t.fatal)&&console.log("audio hls error",e,t),t.details===i.ErrorDetails.BUFFER_STALLED_ERROR&&(o.stopLoad(),o.startLoad()),t.fatal&&n.onFail({type:t.type,details:t.details,url:t.frag&&t.frag.url||t.context&&t.context.url,code:t.networkDetails?t.networkDetails.status:0})})),o.on(i.Events.FRAG_BUFFERED,(function(e,t){var i=function(){try{return window.isMVK?window.audio.getCurrent():ni(window.getAudioPlayer().getCurrentAudio())}catch(e){return{id:0,ownerId:0}}}(),r={owner_id:i.ownerId,audio_id:i.id,fragment_id:t.frag.sn.toString(),fragment_duration:Math.ceil(1e3*t.frag.duration).toString(),time_to_first_byte:Math.ceil(t.stats.tfirst-t.stats.trequest).toString(),time_to_first_frame:Math.ceil(t.stats.tload-t.stats.trequest).toString(),buffering_time:Math.ceil(t.stats.tbuffered-t.stats.trequest).toString()};a&&n.audioNetworkStatCollector.logEvent(si(si({},r),{event_type:T.AudioNetworkType.FRAGMENT_STALLED}),ii.default.getConnectionType(),ii.default.getConnectionEffectiveType()),a=!1,n.audioNetworkStatCollector.logEvent(si(si({},r),{event_type:T.AudioNetworkType.FRAGMENT_LOADED}),ii.default.getConnectionType(),ii.default.getConnectionEffectiveType())})),o.loadSource(t),o.attachMedia(n.audioElement),n.hlsInstance=o,e()}))}))},e.loadHls=function(){return n.e("hls").then(n.t.bind(null,"ulZh",7))},e}(),li=function(){function e(e){this.type="html5",this.opts=e||{},this._audioNodes=[],this._currentAudioEl=this._createAudioNode(),this._prefetchAudioEl=this._createAudioNode()}var t=e.prototype;return t.destroy=function(){},t.getPlayedTime=function(){for(var e=this._currentAudioEl.played,t=0,n=0;n<e.length;n++)t+=e.end(n)-e.start(n);return t},t.getCurrentTime=function(){return this._currentAudioEl.currentTime},t.clearAudioNode=function(){this._currentAudioEl=this._createAudioNode(zn)},t.isCurrent=function(e){return e===this._currentAudioEl},t._createAudioNode=function(e){var t=this,n=new ci({onBufferUpdate:function(){t.isCurrent(n)&&t.opts.onBufferUpdate(t.getCurrentBuffered())},onProgressUpdate:function(){t.isCurrent(n)&&t.opts.onProgressUpdate(t.getCurrentProgress(),t.getPlayedTime(),t.getCurrentTime())},onEnd:function(){t.isCurrent(n)&&n.src!==zn&&t.opts.onEnd()},onSeeked:function(){t.isCurrent(n)&&t.opts.onSeeked()},onSeek:function(){t.isCurrent(n)&&t.opts.onSeek()},onFail:function(e){t._prefetchAudioEl===n?t._prefetchAudioEl=t._createAudioNode():t.isCurrent(n)&&n.src!==zn&&(t._hlsError=e,t.opts.onFail&&t.opts.onFail())},onDurationChange:function(){t.isCurrent(n)&&t._seekOnReady&&n.duration>0&&(t.seek(t._seekOnReady),t._seekOnReady=!1)},onCanPlay:function(){t.isCurrent(n)&&t.opts.onCanPlay&&t.opts.onCanPlay()},onPause:this.opts.onPause,onPlay:this.opts.onPlay,volume:this.hasOwnProperty("_volume")?this._volume:this.opts.defaultVolume},e);return n},t.onReady=function(e){e()},t.prefetch=function(e){this._prefetchAudioEl&&this._prefetchAudioEl.url===Zn(e)||(this._prefetchAudioEl=this._createAudioNode(e))},t.seek=function(e){var t=this._currentAudioEl;t.duration>0&&t.src&&t.src!==zn?t.currentTime=t.duration*e:this._seekOnReady=e},t.setVolume=function(e){void 0===e&&(e=this._currentAudioEl.volume),this._currentAudioEl.volume=e,this._prefetchAudioEl&&(this._prefetchAudioEl.volume=e),this._volume=e},t.setPlaybackRate=function(e){this._currentAudioEl.playbackRate=e},t.getCurrentProgress=function(){return this._currentAudioEl.currentProgress},t.getCurrentBuffered=function(){return this._currentAudioEl&&this._currentAudioEl.currentBuffered},t.getDuration=function(){return this._currentAudioEl&&this._currentAudioEl.duration},t.isFullyLoaded=function(){return this._currentAudioEl.isFullyLoaded},t.setUrl=function(e,t){var n,i=this;if(void 0===t&&(t=function(){}),!e)return t&&t(!1);var a=Zn(e),r=this._currentAudioEl;if(this._currentAudioEl.src&&this._currentAudioEl.src!==zn&&(this._seekOnReady=!1),this._currentAudioEl.src===a)return this.opts.onCanPlay&&this.opts.onCanPlay(),void(t&&t(!0));if(this._prefetchAudioEl){if(this._prefetchAudioEl.src===a)return this._currentAudioEl.pause(),this._currentAudioEl.setUrl(zn),this._prefetchAudioEl.readyState>=3&&setTimeout((function(){return i.opts.onCanPlay&&i.opts.onCanPlay()})),this._currentAudioEl=this._prefetchAudioEl,this._prefetchAudioEl=null,void(t&&t(!0));a!==zn&&this._prefetchAudioEl.setUrl(zn)}r.src!==a&&(n=r.setUrl(a).then((function(){return i._stopFrequencyAnalise()}))),n?n.then((function(){return t(!0)})).catch((function(){return t(!1)})):t(!0)},t.play=function(){this._stopFrequencyAnalise();var e=this._currentAudioEl;if(e.src){var t=e.play();return this._startFrequencyAnalise(),t}return Promise.resolve()},t.preparePlay=function(){if(browser.safari)return this._currentAudioEl.play()},t._startFrequencyAnalise=function(){var e=this;function t(e,t,n,i){return(n-t)*e/i+t}function n(e,t){return Math.random()*(t-e)+e}this._stopFrequencyAnalise();var i=999,a=null,r=null;this._freqUpdateInterval=setInterval((function(){var o;e._currentAudioEl.paused?o=[0,0,0,0]:(++i>3&&(i=0,a=r,r=[n(.7,1),n(.55,.8),n(.3,.55),n(.03,.45)],a||(a=[n(.7,1),n(.55,.8),n(.3,.55),n(.03,.45)])),o=[t(i,a[0],r[0],3),t(i,a[1],r[1],3),t(i,a[2],r[2],3),t(i,a[3],r[3],3)]),e.opts.onFrequency&&e.opts.onFrequency(o)}),50)},t._stopFrequencyAnalise=function(){clearInterval(this._freqUpdateInterval),this.opts.onFrequency&&this.opts.onFrequency([0,0,0,0])},t.pause=function(){this._currentAudioEl.pause(),this._stopFrequencyAnalise()},t.stop=function(){this._currentAudioEl.pause(),this.seek(0),this._stopFrequencyAnalise()},t._setFadeVolumeInterval=function(e){if(e){if(!this._fadeVolumeWorker&&window.Worker&&window.Blob){var t=new Blob(["\n          var interval;\n          onmessage = function(e) {\n            clearInterval(interval);\n            if (e.data == 'start') {\n              interval = setInterval(function() { postMessage({}); }, 20);\n            }\n          }\n        "]);try{this._fadeVolumeWorker=new Worker(window.URL.createObjectURL(t))}catch(e){this._fadeVolumeWorker=!1}}this._fadeVolumeWorker?(this._fadeVolumeWorker.onmessage=e,this._fadeVolumeWorker.postMessage("start")):this._fadeVolumeInterval=setInterval(e,60)}else this._fadeVolumeWorker&&(this._fadeVolumeWorker.terminate(),this._fadeVolumeWorker=null),this._fadeVolumeInterval&&clearInterval(this._fadeVolumeInterval)},t.fadeVolume=function(e,t,n){var i=this;e=Math.max(0,Math.min(1,e));var a=this._currentAudioEl,r=0;if(t){var o=e-a.volume;r=o/(t/20||1)}else r=e<a.volume?-.06:.001;if(Math.abs(e-a.volume)<=.001)return this._setFadeVolumeInterval(),n&&n();var s=a.volume;this._setFadeVolumeInterval((function(){!t&&r>0&&(r*=1.35),s+=r;if(r<0?s<=e:s>=e)return i.setVolume(e),i._setFadeVolumeInterval(),n&&n();i.setVolume(s)}))},t.getErrorData=function(){var e=this._currentAudioEl.error||{};return{is_hls:this._currentAudioEl.hls?1:0,url:this._currentAudioEl.src,error_code:e.code,error_message:e.message,hls_error:this._hlsError?JSON.stringify(this._hlsError):null}},e}();!function(e){e.URL="url",e.PLAYBACK_RATE="playback_rate",e.DELAY="delay",e.SEEK="seek",e.PAUSE="pause",e.PLAY="play",e.VOL_SET="vol_set",e.VOL_UP="vol_up",e.VOL_DOWN="vol_down"}(ri||(ri={}));var ui=function(){function e(e){this.impl=e,this.taskIDCounter=1,this.tasks=[],this.taskInProgress=null,this.taskAbort=null}return e.prototype.newTask=function(e,t){var n,i,a=new Promise((function(e,t){n=e,i=t}));return this.tasks.push({name:e,fn:function(){return t().then(n).catch(i)},id:e+"_"+this.taskIDCounter++}),this.doTasks(),a},e.prototype.clearAllTasks=function(){this.taskAbort=this.taskInProgress,this.taskInProgress=null,this.tasks=[]},e.prototype.clearTask=function(e){this.tasks=this.tasks||[],this.tasks=this.tasks.filter((function(t){return t.name!==e}))},e.prototype.doTasks=function(){var e=this;if(!this.taskInProgress){var t=this.tasks.shift();t&&(this.taskInProgress=t.id,this.ensureImplReady().then((function(){return t.fn()})).then((function(){e.taskAbort!==t.id?(e.taskInProgress=null,e.doTasks()):e.taskAbort=null})))}},e.prototype.ensureImplReady=function(){var e=this;return new Promise((function(t){return e.impl.onReady(t)}))},e.prototype.delay=function(e){return this.newTask(ri.DELAY,(function(){return new Promise((function(t){return function(e,t){if(!window.Worker||!window.Blob)return setTimeout(e,t);var n=new Blob(["\n      var timeout;\n      onmessage = function(e) {\n        clearTimeout(timeout);\n        if (e.data == 'start') {\n          timeout = setTimeout(function() { postMessage({}); }, "+t+");\n        }\n      }\n    "]);try{var i=new Worker(window.URL.createObjectURL(n));return i.onmessage=function(){i.terminate(),e()},i.postMessage("start"),i}catch(n){return setTimeout(e,t)}}(t,e)}))}))},e.prototype.setUrl=function(e){var t=this;return this.newTask(ri.URL,(function(){return new Promise((function(n){return t.impl.setUrl(e,n)}))}))},e.prototype.seekImmediate=function(e){this.impl.seek(e)},e.prototype.seek=function(e){var t=this;return this.clearTask(ri.SEEK),this.newTask(ri.SEEK,(function(){return new Promise((function(n){t.seekImmediate(e),n()}))}))},e.prototype.pause=function(){var e=this;return this.newTask(ri.PAUSE,(function(){return new Promise((function(t){e.impl.pause(),t()}))}))},e.prototype.play=function(){var e=this;return window.browser.safari&&this.impl.play(),this.newTask(ri.PLAY,(function(){return new Promise((function(t,n){e.impl.play().then(t).catch(n)}))}))},e.prototype.setVolume=function(e,t,n){var i=this;if(void 0===n&&(n=null),t){var a=e?ri.VOL_UP:ri.VOL_DOWN;return this.newTask(a,(function(){return new Promise((function(t){return i.impl.fadeVolume(e,n,(function(){return t()}))}))}))}return this.newTask(ri.VOL_SET,(function(){return new Promise((function(t){i.impl.setVolume(e),t()}))}))},e.prototype.updatePlaybackRate=function(e){var t=this;return this.newTask(ri.PLAYBACK_RATE,(function(){return new Promise((function(n){t.impl.setPlaybackRate(e),n()}))}))},e}();function di(e){return Object(r.geByClass)("audio_item_"+e)}function _i(e){return di(e)[0]}function fi(e){var t=_i(e);if(!t)return null;if(t.dataset&&t.dataset.playlistId)return t.dataset.playlistId;var n=Object(r.gpeByClass)("AudioPlaylistRoot",t);if(!n)return console.log("no playlist Element found"),null;var i=n.dataset.playlistId;return i||(console.log("no playlist Id found"),null)}var pi=n("iwo4"),hi=window.audio||function(){var e=Object(r.ssGet)("audio_vol"),t="number"==typeof e?e:.8,n={onPause:function(){Object(P.statlogsValueEvent)("mvk_audio_player_listening",h[m].id,hi.getCurrentProgress()),b&&(b=!1,ssSet("audio_play","0"),clearTimeout(O));s.emit(Gt.events.PAUSE,M())},onPlay:function(){b||(b=!0,ssSet("audio_play","1"),clearTimeout(O),O=setTimeout(x,100));if(audioBackgroundRestriction&&audioBackgroundRestriction.isIdle)return void hi.pause();s.emit(Gt.events.PLAY,M())},onBufferUpdate:function(e){s.emit(Gt.events.BUFFERED,M(),e,hi.duration())},onEnd:function(){if(c>0)return;s.emit(Gt.events.ENDED,M()),y?(y=!1,hi.next()):w=!0},onProgressUpdate:function(e,t,n){if(mi.isPlaying())return;if(!e&&n)try{e=n/hi.duration()}catch(e){}s.emit(Gt.events.PROGRESS,M(),e,hi.duration(),t),e>.01&&(E=t);ssSet("audio_pos",e),!y&&a.getDuration()-a.getCurrentTime()<.5&&(y=!0);if(e>.8&&j){var i=function(){var e=m+1;if(e&&h&&e<h.length)return h[e];return null}();i&&a.isFullyLoaded()&&(j=!1,function(e){e&&e.url&&a.prefetch(e.url)}(i))}w&&(w=!1,hi.next())},defaultVolume:t},i=!(browser.safari||browser.chrome&&browser.version<50),a=new li(n),o=new ui(a),s=new Qn,c=0,l=null,d={},_=new qn,f=!1,p=srand(),h=[],m=null,v={},g="",A=null,b=!1,w=!1,y=!1,O=null,k=!1,C=!1,j=!1,E=0;function T(e,t){if(void 0===t&&(t=!1),!hi.support)return!1;var n;if(b&&hi.pause(),s.emit(Gt.events.DESELECT,I()),(n=hi.canRepeat!==pi.audioRepeat.ONE||t?m+e:m)>=h.length||n<0){if(hi.canRepeat!==pi.audioRepeat.ALL&&hi.canRepeat!==pi.audioRepeat.ONE)return!1;n=n>=h.length?0:Math.max(0,h.length-1)}Object(P.statlogsValueEvent)("mvk_audio_player_listening",h[m].id,hi.getCurrentProgress());var i=h[n];hi.play(i.fullId).then((function(t){t||T(e>0?e+1:e-1)})).catch((function(){}))}function I(){return h[m]||!1}function M(){return I().fullId||!1}function D(e){return function(e){return new Promise((function(t,n){l&&l(),l=n;var i=[];if(d=d||{},e)if(e.url)t(e);else{var a=v[e.fullId];if(a>=0)for(var r=a;r<a+3;r++){var o=h[r];o&&!o.url&&!d[o.fullId]&&o.urlHash&&(i.push(o.fullId+"_"+o.actionHash+"_"+o.urlHash),d[o.fullId]=!0)}ajax.post("/audio",{act:"reload_audio",ids:i.join(",")},{onDone:function(i){i?(i.forEach((function(n){var i=ni(n),a=h[v[i.fullId]];a&&(a.url=i.url),di(i.fullId).forEach((function(e){try{var t=JSON.parse(e.dataset.audio);t[Xt]=i.url,e.dataset.audio=JSON.stringify(t)}catch(e){}})),i.fullId===e.fullId&&(e.url=i.url,t(e)),delete d[i.fullId]})),n()):n()},onFail:n})}else n()})).catch((function(){return d={}}))}(e).then((function(e){o.clearTask(ri.URL);var t=e.url;if(!t)throw new Error;return o.setUrl(t).then((function(t){t?c=0:(o.clearAllTasks(),s.emit(Gt.events.FAILED),b&&c<2&&(e.pause(),e.next(),c++))}))}))}function x(){if(b){var e=lsGet("audio_current_player");p!=e?hi.pause():O=setTimeout(x,100)}}function L(e){ssSet("audio_query",e),k&&Object(Nn.setCookie)(k+"q",encodeURIComponent(e),1)}return{support:!0,canRepeat:pi.audioRepeat.ALL,shuffled:!1,onInit:Object(u.default)(),init:function(e){!C&&hi.support&&(C=!0,e.cookie&&(k=e.cookie,e.cookie_path||"/"),onDOMReady((function(){!function(e){var t=Object(r.ssGet)("audio_id"),n=Object(r.ssGet)("audio_pos"),i=Object(Nn.getCookie)(k+"_playlist");e.playlist&&e.playlist.length&&(i&&hi.setPlaylistId(i),hi.playlist((e.playlist||[]).map(ni),{q:e.playlist_q||""})),t&&hi.select(t).then((function(){n<1&&hi.setPosition(n,!0)})).catch((function(){}))}(e),hi.onInit()})))},subscribe:function(e,t){return s.subscribe(e,t)},unsubscribe:function(e,t){return s.unsubscribe(e,t)},notify:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];s.emit.apply(s,[e].concat(n))},getCurrent:I,getCurrentId:M,operate:function(e){if(!hi.support)return!1;!e||h[m]&&e===M()?b?hi.pause():hi.play():(Object(P.statlogsValueEvent)("mvk_audio_player_listening",I().id,hi.getCurrentProgress()),hi.play(e))},setPlaylistId:function(e){e!==A&&(A=e,s.emit(Gt.events.PLAYLIST_CHANGED))},playing:function(){return b},select:function(e){if(!hi.support)return Promise.reject();if(!e)return Promise.reject();h.length||s.emit(Gt.events.EMPTY_PLAYLIST,e);var t=h[v[e]];return t?(M()&&s.emit(Gt.events.DESELECT,I()),D(t).then((function(){m=v[e],j=!0,s.emit(Gt.events.SELECT,h[m]);var t,n=fi(e);n&&A!==n&&hi.setPlaylistId(n),t=M(),ssSet("audio_id",t),k&&(Object(Nn.setCookie)(k,t,1),Object(Nn.setCookie)(k+"_playlist",A,1))})).catch((function(){return Promise.reject()}))):(s.emit(Gt.events.NOT_FOUND_PLAYLIST,e),Promise.reject())},autoplay:function(e){hi.play(e)},getCurrentPlaylistId:function(){return A},play:function(e){var t=this;if(hi.support)return new Promise((function(n){var r=e===M();return b&&r?(hi.pause(),n(!0)):mi.isPlaying()?(e&&!r?(hi.select(e).catch((function(){})),mi.resume()):b?mi.pause():mi.resume(),n(!0)):(b=!0,!e||r?(t._play(),n(!0)):(a.setUrl(zn),void hi.select(e).then((function(){if(s.emit(Gt.events.PLAY_REQUESTED,e),!Object(S.partConfigEnabled)("mvk_audio_ads")||!i)return t._play(),n(!0);o.clearAllTasks(),mi.startPlay(h[v[e]],(function(){return t._play(),n(!0)}))})).catch((function(){return b=!1,M()&&hi.select(M()),n(!1)}))))}))},_play:function(){I()&&(o.play().then((function(){ssSet("audio_play","1"),_.connect()})).catch((function(){b=!1,s.emit(Gt.events.PAUSE)})),lsSet("audio_current_player",p))},clearCurrentPlaylist:function(){if(!hi.support)return!1;b&&!mi.isPlaying()&&hi.pause(),I()&&s.emit(Gt.events.DESELECT,I()),h=[],g="",m=null,hi.setPlaylistId(null),v={},L(g)},pause:function(){if(!hi.support)return!1;b&&(mi.isPlaying()?mi.pause():a.pause(),b=!1,ssSet("audio_play","0"))},getDeviceId:function(){var e=lsGet("audio_player_device_id");return e||(e=Gn()(),lsSet("audio_player_device_id",e)),e},getPosition:function(){return hi.isAdsPlaying()?mi.getCurrentProgress()*mi.getDuration():a.getCurrentTime()},getCurrentProgress:function(){return hi.isAdsPlaying()?mi.getCurrentProgress():a.getCurrentProgress()},setPosition:function(e,t){if(!hi.support)return!1;var n=0;t?n=e:e&&hi.duration()&&(n=e/hi.duration()),o.seek(n).then((function(){ssSet("audio_pos",n),s.emit(Gt.events.SEEK,M(),n,hi.duration())}))},volume:function(e){if(!hi.support)return!1;if(void 0===e)return t;var n=Math.min(1,Math.max(0,e));t=n,o.setVolume(t),ssSet("audio_vol",t),mi.updateVolume(),s.emit(Gt.events.VOLUME,M(),t)},loaded:function(){return a.getCurrentBuffered()},duration:function(){if(this.isAdsPlaying())return mi.getDuration();var e=a.getDuration(),t=h[m]&&h[m].duration;return e||t||0},played:function(){return a.getPlayedTime()},getListenedTime:function(){return E},next:function(e){return void 0===e&&(e=!1),T(1,e)},prev:function(e){return void 0===e&&(e=!1),T(-1,e)},shuffle:function(){var e=hi.isPlaying()&&!hi.isAdsPlaying(),t=hi.getPosition(),n=hi.getCurrentId();hi.pause(),hi.shuffled=!hi.shuffled,hi.shuffled?(h.forEach((function(e,t){return e.position=t})),h.sort((function(){return Math.random()-.5}))):h.sort((function(e,t){return e.position-t.position})),v=h.reduce((function(e,t,n){return e[t.fullId]=n,e}),{}),n&&(hi.select(n),hi.setPosition(t),e&&requestAnimationFrame((function(){return hi.play()})))},repeat:function(){switch(hi.canRepeat){case pi.audioRepeat.NONE:hi.canRepeat=pi.audioRepeat.ALL;break;case pi.audioRepeat.ALL:hi.canRepeat=pi.audioRepeat.ONE;break;case pi.audioRepeat.ONE:hi.canRepeat=pi.audioRepeat.NONE;break;default:hi.canRepeat=pi.audioRepeat.NONE}},playlist:function(e,t){return!!hi.support&&(void 0===e?h:(b&&!mi.isPlaying()&&hi.pause(),I()&&s.emit(Gt.events.DESELECT,I()),h=e,g=t&&t.q||"",m=null,v={},each(e,(function(e,t){return v[t.fullId]=e})),void L(g)))},addToPlaylist:function(e,t){var n={},i=t||h.length;h.forEach((function(e){return n[e.fullId]=!0})),e.forEach((function(e){n[e.fullId]||(t?h.splice(i,0,e):h.push(e))}))},playlist_q:function(){return g},setIsPlaying:function(e){b=e},isAdsPlaying:function(){return mi.isPlaying()},isPlaying:function(){return b},initSplash:function(){f||(window.audioRestrictionSplash=new xn,f=!0)},playNothing:function(){a.setUrl(zn,(function(){}))},events:Gt.events}}();window.Artist=$t,window.Curator=zt;var mi=new jn(new Tn(hi),null,!0);hi.ads=mi,window.audio=hi,window.AudioBackgroundRestriction=Fn,window.audioBackgroundRestriction=null,document.addEventListener("DOMContentLoaded",(function(){Object(S.partConfigEnabled)("audio_mvk_background_restriction_enabled")&&(window.audioBackgroundRestriction=new Fn)})),document.addEventListener("DOMContentLoaded",(function(){"audio"===cur.module&&hi.initSplash()})),window.page.onChange((function(){"audio"===cur.module?hi.initSplash():window.audioRestrictionSplash&&window.audioRestrictionSplash.popup&&window.audioRestrictionSplash.close()}));var vi,gi,Ai=function(){function e(e){this.player=e,this.listeners=[]}var t=e.prototype;return t.listen=function(e,t,n){var i=t.bind(n||this);this.listeners.push({event:e,fn:t,listener:i}),this.playerListen(e,i)},t.unListen=function(e,t){var n=-1;if(each(this.listeners,(function(i,a){if(a.event===e&&a.listener===t)return n=i,!1})),!(n<0)){var i=this.listeners[n];this.playerUnListen(e,i.listener),this.listeners.splice(n,1)}},t.unListenAll=function(){for(var e;e=this.listeners[0];)this.unListen(e.event,e.listener)},t.listenPlay=function(e,t){this.listen(Gt.events.PLAY,e,t)},t.listenPause=function(e,t){this.listen(Gt.events.PAUSE,e,t)},t.listenStop=function(e,t){this.listen("stop",e,t)},t.listenProgress=function(e,t){this.listen(Gt.events.PROGRESS,e,t)},t.listenVolume=function(e,t){this.listen(Gt.events.VOLUME,e,t)},t.listenSeek=function(e,t){this.listen(Gt.events.SEEK,e,t)},t.listenPlaylistChanged=function(e,t){this.listen(Gt.events.PLAYLIST_CHANGED,e,t)},t.listenEnded=function(e,t){this.listen(Gt.events.ENDED,e,t)},t.listenPlayNext=function(e,t){this.listen(Gt.events.PLAY_NEXT,e,t)},t.listenAdCompleted=function(e,t){this.listen(Gt.events.AD_COMPLETED,e,t)},t.playerListen=function(e,t){this.player.subscribe(e,t)},t.playerUnListen=function(e,t){this.player.unsubscribe(e,t)},t.getPausedBy=function(){return null},t.getState=function(){return document.hidden?1:3},t.getProgress=function(){return this.player.playerGetProgress()},t.getProgressInSeconds=function(){return this.player.getProgressInSeconds()},t.getVolume=function(){return this.player.getVolume()},t.getAudioId=function(){return this.player.getAudioId()},t.getAudio=function(){return this.player.getAudio()},t.getAudioTrackCode=function(){return this.player.getAudioTrackCode()},t.getPrevAudioId=function(){return this.player.getPrevAudioId()},t.getPrevPlaylistId=function(){return this.player.getPrevPlaylistId()},t.getPlaylistId=function(){return this.player.getPlaylistId()},t.getContext=function(){return this.player.getContext()},t.getSequence=function(){return this.player.getSequence()},t.getType=function(){return this.player.getType()},t.getListenedTime=function(){return isNaN(this.player.getListenedTime())?0:Math.round(this.player.getListenedTime())},t.getSearchParams=function(){return this.player.getSearchParams()},t.isPlaying=function(){return this.player.isPlaying()},t.isAutoPlayed=function(){return this.player.isAutoPlayed()},t.isRepeatCurrentAudio=function(){return this.player.isRepeatCurrentAudio()},t.isRepeatAll=function(){return this.player.isRepeatAll()},t.isShuffledPlaylist=function(){return this.player.isShuffledPlaylist()},t.isRealPlaylist=function(){return this.player.isRealPlaylist()},t.isRealPrevPlaylist=function(){return this.player.isRealPrevPlaylist()},t.isPodcast=function(){return this.player.isPodcast()},t.isAdPlaying=function(){return this.player.ads.isPlaying()},t.isLastTrack=function(){return this.player.isLastTrack()},t.hasPrevAudio=function(){return this.player.hasPrevAudio()},t.hasPrevPlaylist=function(){return this.player.hasPrevPlaylist()},t.hasPlaylist=function(){return this.player.hasPlaylist()},t.hasSearchParams=function(){return this.player.hasSearchParams()},t.isDebug=function(){return!1},t.sendListenedData=function(e){return this.player.sendListenedData(e)},e}(),bi=n("BJj/"),wi=((vi={}).start=1,vi.stop=2,vi.volume=3,vi.rewind=4,vi.play_further=5,vi.added=6,vi.removed=7,vi.recommendation_removed=8,vi.show_album=9,vi.share_audio=10,vi.broadcast=11,vi.curator=12,vi),yi=((gi={}).default=1,gi.next_track=2,gi.prev_track=3,gi.auto=4,gi.interruption=5,gi.pause=6,gi.new=7,gi.close_app=8,gi.queue=9,gi.pause=10,gi.upload=11,gi.on=12,gi.off=13,gi.follow=14,gi.unfollow=15,gi),Oi=function(){function e(e){if(this.playerAdapter=e,this.listenedData=null,this.sendTimeout=null,this.currentAudioId=null,this.currentAudio=null,this.currentAudioTrackCode=null,this.pausedAudioId=null,this.playlistChanged=!1,this.currentPosition=0,this.currentListened=0,this.playedTime=0,this.adsCompleted=!1,this.wasEnded=!1,vk.id)this.uniqueUserId=null;else{var t=oi.default.get("audio_unique_unauth_id");t?this.uniqueUserId=t:(this.uniqueUserId=Gn()(),oi.default.set("audio_unique_unauth_id",this.uniqueUserId))}this.debug=e.isDebug(),this.onVolume=Object(bi.debounce)(this.onVolume.bind(this),300),this.playerAdapter.listenPlay(this.onPlay,this),this.playerAdapter.listenPause(this.onPause,this),this.playerAdapter.listenStop(this.onPause,this),this.playerAdapter.listenProgress(this.onProgress,this),this.playerAdapter.listenVolume(this.onVolume,this),this.playerAdapter.listenSeek(this.onSeek,this),this.playerAdapter.listenPlaylistChanged(this.onPlaylistChanged,this),this.playerAdapter.listenEnded(this.onEnded,this),this.playerAdapter.listenPlayNext(this.onPlayNext,this),this.playerAdapter.listenAdCompleted(this.onAdCompleted,this),this.onPageClose=this.onPageClose.bind(this),addEvent(window,"beforeunload",this.onPageClose)}var t=e.prototype;return t.canOperate=function(){return!this.playerAdapter.isPodcast()&&!this.playerAdapter.isAdPlaying()},t.getCurrentAudioParams=function(){var e=this.currentAudioId||this.playerAdapter.getAudioId();if(e){var t=e.split("_");return{ownerId:t[0],audioId:t[1],trackCode:this.currentAudioTrackCode||this.playerAdapter.getAudioTrackCode()}}return{}},t.getEnvParams=function(){return{state:this.playerAdapter.getState(),context:this.playerAdapter.getContext(),ref:window.cur&&vk.widget?String(cur.widgetReferrer||"").substring(0,20):""}},t.getListenedTime=function(){return Math.round(this.playerAdapter.getListenedTime())||0},t.getPlaySubtype=function(){if(this.playerAdapter.isAutoPlayed())return"auto";var e=this.playerAdapter.getSequence();if(e)return e>0?"next_track":"prev_track";var t=this.pausedAudioId,n=this.playerAdapter.getAudioId();return t&&n===t?"pause":"new"},t.onPlay=function(){if(this.canOperate()){var e=this.playerAdapter.getAudio(),t=e.fullId,n=this.currentAudioId===t||!this.currentAudioId,i=this.currentAudioId!==this.pausedAudioId,a=this.playerAdapter.getListenedTime();!n&&i&&this.onTrackSwitch(this.currentAudio,this.currentPlaylistId),this.playedTime=vkNow(),this.currentAudioId=t,this.currentAudio=e,this.currentAudioTrackCode=this.playerAdapter.getAudioTrackCode(),this.currentPlaylistId=this.playerAdapter.getPlaylistId(),this.wasEnded||this.playerAdapter.hasPrevAudio()&&(!this.pausedAudioId||this.playerAdapter.isAutoPlayed())?(this.currentPosition=0,a=0):this.currentPosition=this.playerAdapter.getProgressInSeconds(),this.currentListened=a,this.sendCurrentAudioEvent({type:"start",subtype:this.getPlaySubtype(),position:this.currentPosition,listened:a}),this.pausedAudioId=null,this.playlistChanged=!1,this.wasEnded=!1}},t.onPause=function(){var e=this,t=this.playerAdapter.getAudioId();if(this.canOperate()&&t){var n=this.collectListenedData();this.sendListenedDataDelayed(1e3,n),setTimeout((function(){if(!(e.currentAudio&&t!==e.currentAudio.fullId||vkNow()-e.playedTime<150)){e.pausedAudioId=t;var n=e.playerAdapter.getPausedBy(e.playedTime);e.sendCurrentAudioEvent({type:"stop",subtype:n?"queue"===n?"queue":"interruption":"pause"})}}),100)}},t.onProgress=function(){this.playerAdapter.getProgress()<.01||!this.playerAdapter.isPlaying()||(this.currentPosition=this.playerAdapter.getProgressInSeconds(),this.currentListened=this.playerAdapter.getListenedTime(),!this.pausedAudioId&&vkNow()-this.playedTime>150&&this.collectListenedData(),this.adsCompleted&&(this.sendCurrentAudioEvent({type:"start",subtype:this.getPlaySubtype(),position:this.currentPosition}),this.adsCompleted=!1))},t.onVolume=function(){this.canOperate()&&this.sendCurrentAudioEvent({type:"volume",subtype:"default"})},t.onSeek=function(){if(this.canOperate()){var e={position:this.currentPosition,positionTo:this.playerAdapter.getProgressInSeconds()};e.position!==e.positionTo&&this.sendCurrentAudioEvent(Object(B.default)({type:"rewind",subtype:"default"},e))}},t.onPlaylistChanged=function(){this.canOperate()&&(this.playlistChanged=!0)},t.onEnded=function(){this.listenedData&&this.playerAdapter.isLastTrack()&&(this.listenedData.end_stream_reason="session_end"),this.wasEnded=!0,this.playerAdapter.isRepeatCurrentAudio()?(this.sendCurrentAudioEvent({type:"stop",subtype:"auto"}),this.collectListenedData(),this.sendListenedData()):this.sendListenedDataDelayed(150)},t.onPlayNext=function(e,t){if(this.canOperate()){var n=t.split("_"),i=n[0],a=n[1];this.sendAudioEvent({type:"play_further",subtype:"default",ownerId:i,audioId:a})}},t.onAdCompleted=function(){this.adsCompleted=!0},t.onTrackSwitch=function(e,t){if(e){var n="new",i=this.playerAdapter.getSequence(),a=e.fullId.split("_"),r=a[0],o=a[1];this.playerAdapter.isAutoPlayed()?n="auto":i&&(n=i>0?"next_track":"prev_track"),this.sendCurrentAudioEvent({type:"stop",subtype:n,position:this.currentPosition,listened:this.currentListened,trackCode:e.trackCode,playlistId:t,ownerId:r,audioId:o}),this.wasEnded=!0,this.collectListenedData(e),this.collectListenedDataSwitch();var s=this.listenedData;this.listenedData=null,this.sendListenedData(s)}},t.onPageClose=function(){this.playerAdapter.isPlaying()&&(this.sendCurrentAudioEvent({type:"stop",subtype:"close_app"}),this.sendListenedData())},t.collectListenedDataSwitch=function(){if(this.listenedData){if("session_end"===this.listenedData.end_stream_reason)return;var e=this.playerAdapter.isAutoPlayed(),t=this.getListenedTime(),n=this.playerAdapter.getSequence(),i=null;n&&!e?i=n>0?"next_btn":"prev":this.playlistChanged&&(i="playlist_change"),!i&&e&&(i="playlist_next"),this.listenedData.end_stream_reason=i||"new",t&&(this.listenedData.listened=t)}},t.collectListenedData=function(e){void 0===e&&(e=null);var t=e||this.currentAudio;if(this.canOperate()&&t){var n=t.fullId,i=t.trackCode||this.playerAdapter.getAudioTrackCode(),a=this.getListenedTime(),r=t.urlHash;if(r||console.log("no url hash"),a&&r){var o={audio_id:n,listened:a,context:this.playerAdapter.getContext(),hash:r};return window.cur&&vk.widget&&(o.ref=cur.widgetReferrer||""),this.playerAdapter.hasSearchParams()&&(o.search_params=JSON.stringify(this.playerAdapter.getSearchParams())),this.playerAdapter.hasPlaylist()&&(this.playerAdapter.isRealPlaylist()&&(o.playlist_id=this.playerAdapter.getPlaylistId()),this.playerAdapter.isShuffledPlaylist()&&(o.shuffled=1)),i&&(o.track_code=i),this.playerAdapter.isRepeatCurrentAudio()?o.repeat="one":this.playerAdapter.isRepeatAll()&&(o.repeat="all"),this.playerAdapter.isAutoPlayed()&&(o.auto=1),this.playerAdapter.hasPrevAudio()&&(o.prev_audio_id=this.playerAdapter.getPrevAudioId()),this.playerAdapter.hasPrevPlaylist()&&this.playerAdapter.isRealPrevPlaylist()&&(o.prev_playlist_id=this.playerAdapter.getPrevPlaylistId()),this.playerAdapter.isPlaying()||(o.end_stream_reason="stop_btn"),o.state=document.hidden?"background":"app",this.listenedData=o,this.sendListenedDataDelayed(1e4,o),o}}},t.sendListenedData=function(e){void 0===e&&(e=null),clearTimeout(this.sendTimeout);var t=e||this.listenedData;this.listenedData=null,t&&t.listened&&(this.uniqueUserId&&(t.unique_id=this.uniqueUserId),this.playerAdapter.sendListenedData(t))},t.sendListenedDataDelayed=function(e,t){var n=this;void 0===e&&(e=0),void 0===t&&(t=null),clearTimeout(this.sendTimeout),this.sendTimeout=setTimeout((function(){return n.sendListenedData(t)}),e)},t.serializeEvent=function(e){var t=[wi[e.type],yi[e.subtype],1];return e.audioId?t.push(e.ownerId+"_"+e.audioId):t.push(0),e.trackCode?t.push(e.trackCode):t.push(0),e.state?t.push(e.state):t.push(0),e.ref?t.push(e.ref):t.push(""),e.context?t.push(e.context):t.push("other"),e.volume||0===e.volume?t.push(e.volume):t.push(this.playerAdapter.getVolume()),e.position||0===e.position?t.push(e.position):t.push(this.playerAdapter.getProgressInSeconds()),e.shuffle?t.push(e.shuffle?1:0):t.push(0),e.repeat?t.push(e.repeat):t.push(0),e.listened?t.push(Math.max(e.listened,0)):t.push(0),e.playlistId?t.push(e.playlistId):t.push(""),e.targetOwnerId?t.push(e.targetOwnerId):t.push(0),this.uniqueUserId?t.push(this.uniqueUserId):t.push(""),e.positionTo?t.push(e.positionTo):t.push(null),t},t.sendEvent=function(e){this.debug&&(console.log("audio stats event",e.type,e.subtype,e),window._statForTest||(window._statForTest=[]),window._statForTest.push(e)),P.statlogsValueEvent.apply(void 0,["audio_sts"].concat(this.serializeEvent(e)))},t.sendCurrentAudioEvent=function(e){this.sendEvent(Object(B.default)({shuffle:this.playerAdapter.isShuffledPlaylist(),repeat:this.playerAdapter.isRepeatCurrentAudio()?1:this.playerAdapter.isRepeatAll()?2:0,volume:this.playerAdapter.getVolume(),position:this.playerAdapter.getProgressInSeconds(),listened:this.getListenedTime(),playlistId:this.playerAdapter.getPlaylistId()},this.getEnvParams(),{},this.getCurrentAudioParams(),{},e))},t.sendAudioEvent=function(e){var t=Object(B.default)({},e,{},this.getEnvParams());!vk.id&&this.uniqueUserId&&(t.uniqueUnauthId=this.uniqueUserId),this.sendEvent(t)},t.destroy=function(){this.playerAdapter.unListenAll(),removeEvent(window,"beforeunload",this.onPageClose),this.playerAdapter=null,this.listenedData=null,clearTimeout(this.sendTimeout)},e}(),Si=n("dI71"),ki=function(e){function t(){return e.apply(this,arguments)||this}Object(Si.default)(t,e);var n=t.prototype;return n.getPausedBy=function(e){return ge("StoriesView")?"stories":null},n.getState=function(){var t=e.prototype.getState.call(this),n=this.getAudioId();return n&&ge("audio"+n)?2:t},n.getProgress=function(){var e=this.player.getCurrent();return e?this.player.getPosition()/e.duration:0},n.getProgressInSeconds=function(){return Math.round(this.player.getPosition())},n.getVolume=function(){return Math.round(100*this.player.volume())},n.getAudioId=function(){return this.player.getCurrentId()},n.getAudio=function(){return this.player.getCurrent()},n.getAudioTrackCode=function(){try{return this.player.getCurrent().trackCode}catch(e){return!1}},n.getPrevAudioId=function(){var e=this.getAudioId(),t=window.audioplayer.getPlaybackQueue();if(e){var n=t.lastIndexOf(e);if(-1!==n)return t[n-1]}},n.getPlaylistIdFromAudioId=function(e){return fi(e)},n.getPlaylistTypeFromAudioId=function(e){if(e&&isString(e)){var t=e.split("_"),n=t[0],i=t[1],a=t[2],r=t[3];return n&&i?a&&0===a.indexOf("playlist")?a.replace("playlist","")+"_"+r:a:void 0}},n.getPrevPlaylistId=function(){return this.getPlaylistIdFromAudioId(this.getPrevAudioId())},n.getPlaylistId=function(){return this.getPlaylistIdFromAudioId(this.getAudioId())},n.updateContext=function(){var e=this.getPlaylistTypeFromAudioId(this.getAudioId());if(e){var t=this.getContextByType(e);"other"===t&&nav.getQuery("from")?this.context=this.getContextByType(nav.getQuery("from")):this.context=t}else this.context="other"},n.getContextByType=function(e){if(void 0===e&&(e=""),0===e.indexOf("recoms"))return nav.getQuery("q")?"search":"recs";if(0===e.indexOf("audios")){var t=intval(e.replace("audios",""));return t===vk.id?"my":t<0?"group_list":"user_list"}return 0===e.indexOf("popular")?"recs_audio":0===e.indexOf("search")?"search":0===e.indexOf("wall")?"group_list":0===e.indexOf("mail")?"im":0===e.indexOf("feed")?"feed":"other"},n.getContext=function(){return this.context||"other"},n.getSequence=function(){return 0},n.getSearchParams=function(){return null},n.getType=function(){return"html5"},n.isPlaying=function(){return this.player.playing()},n.isAutoPlayed=function(){return window.audioplayer.isAutoPlayed()},n.isRepeatCurrentAudio=function(){return!1},n.isRepeatAll=function(){return!1},n.isShuffledPlaylist=function(){return!1},n.isPodcast=function(){return!1},n.isAdPlaying=function(){return!1},n.isRealPlaylist=function(){return!0},n.isRealPrevPlaylist=function(){return!0},n.isLastTrack=function(){var e=this.player.getCurrent(),t=this.player.playlist();return!!e&&(!(!e||t&&t.length)||t.indexOf(e)+1===t.length)},n.hasPrevPlaylist=function(){return!1},n.hasPlaylist=function(){var e=this.player.playlist();return Boolean(e&&e.length>1)},n.hasPrevAudio=function(){var e=this.getAudioId(),t=window.audioplayer.getPlaybackQueue();return Boolean(e&&t.length>1)},n.hasSearchParams=function(){return!1},n.isDebug=function(){return Boolean(lsGet("audio_stats_debug"))},n.sendListenedData=function(e){var t=nav.getQuery("from");ajax.post("/audio",{_ajax:1,act:"playback",audio:e.audio_id,track_code:e.track_code,prev:e.prev_audio_id,state:e.state,from_block:t,listened:e.listened,hash:e.hash,playlist_id:e.playlist_id,end_stream_reason:e.end_stream_reason,auto:e.auto,unique_user_id:e.unique_id})},t}(Ai),Ci=n("jE6c"),ji=n("TZ9a"),Ei=n("YR85"),Ti=n("N25v"),Ii=n("cZvj"),Mi=n("QdNn"),Pi=n("DiiU"),Di=n("TD5r"),xi=n("bJmD"),Li=n("7FHG"),Bi=n("GfAd");function Ri(e){var t=["ai_controls"];e.position&&t.push("ai_has_position");var n=e.can_del?"true":"false",i="return window.audioplayer.morePopup(event, '"+e.audio_id+"', '"+e.access_key+"', "+n+");",a=e.is_authenticated?"audioplayer.setPosition(this, event);":null,r=e.is_authenticated?"audioplayer.sliderMove(event);":null,o=e.is_authenticated?"audioplayer.sliderUp(event);":null,s="aic_line";e.is_authenticated||(s+=" aic_line_blocked");var c=["ai_chart_info_state"],l="";switch(e.chart_info_state){case"new_release":c.push("ai_chart_info_state-new_release"),l=Object(R.default)(Object(Li.getNew16Icon)());break;case"no_changes":c.push("ai_chart_info_state-no_changes"),l=Object(R.default)(Object(xi.getMinus16Icon)());break;case"moved_up":c.push("ai_chart_info_state-moved_up"),l=Object(R.default)(Object(Bi.getUp16Icon)());break;case"moved_down":c.push("ai_chart_info_state-moved_down"),l=Object(R.default)(Object(Di.getDown16Icon)());break;case"crown":c.push("ai_chart_info_state-crown"),l=Object(R.default)(Object(Pi.getCrown16Icon)());break;default:l=""}return(e.chart_info_position||l)&&t.push("ai_controls_chart"),{inner:[{inner:[Ni(e),e.has_actions_menu?{inner:[{class:"i_pointer",tag:"i"},{class:"ai_menu_toggle_button",onClick:i,"aria-label":Object(J.getLang)("mobile_more"),tag:"button"}],class:"ai_menu_wrap",tag:"div"}:null,{inner:[e.chart_info_position||l?{inner:[e.chart_info_position?{inner:[e.chart_info_position],class:"ai_chart_info_position",tag:"div"}:null,l?{inner:[l],class:c,tag:"div"}:null],class:"ai_chart_info",tag:"div"}:null,e.duration?{inner:[e._duration_title],class:"ai_dur","data-dur":e.duration,onClick:"audioplayer.switchTimeFormat(this, event);",tag:"time"}:null,{inner:[{inner:[Wd.wrap(e.title),e.subtitle?{inner:[Wd.wrap(e.subtitle)],class:"ai_subtitle",tag:"span"}:null],class:"ai_title",tag:"span"},e.title?{inner:[Wd.wrap(" &ndash; ")],class:"divider",tag:"span"}:null,{inner:[Wd.wrap(e.artist)],class:"ai_artist",tag:"span"}],class:"ai_label",tag:"div"},{type:"hidden",value:e.url,tag:"input"}],class:"ai_body",tag:"div"}],class:"ai_info",tag:"div"},{inner:[{inner:[{inner:[{inner:[{inner:[{class:"aic_ln aic_back_line",onClick:"cancelEvent(event);",tag:"div"},{class:"aic_ln aic_load_line",onClick:"cancelEvent(event);",tag:"div"},{inner:[{inner:[{class:"aic_slider",onClick:"cancelEvent(event);",tag:"div"}],class:"aic_ln aic_progress_line",onClick:"cancelEvent(event);",tag:"div"}],class:"aic_ln aic_pl_wrap",onClick:"cancelEvent(event);",tag:"div"}],class:s,onTouchStart:e.is_mobile?a:null,onMouseDown:e.is_mobile?null:a,onTouchMove:e.is_mobile?r:null,onTouchEnd:e.is_mobile?o:null,onTouchCancel:e.is_mobile?o:null,onMouseMove:e.is_mobile?null:r,onMouseUp:e.is_mobile?null:o,onClick:"cancelEvent(event);",tag:"div"}],class:"aic_progress_wrap",tag:"td"},{inner:[{inner:[{class:"aic_ln aic_back_line",onClick:"cancelEvent(event);",tag:"div"},{inner:[{inner:[{class:"aic_slider",onClick:"cancelEvent(event);",tag:"div"}],class:"aic_ln aic_progress_line",onClick:"cancelEvent(event);",tag:"div"}],class:"aic_ln aic_pl_wrap",onClick:"cancelEvent(event);",tag:"div"}],class:"aic_line",onTouchStart:e.is_mobile?"audioplayer.setVolume(this, event);":null,onMouseDown:e.is_mobile?null:"audioplayer.setVolume(this, event);",onTouchMove:e.is_mobile?"audioplayer.sliderMove(event);":null,onTouchEnd:e.is_mobile?"audioplayer.sliderUp(this, event);":null,onTouchCancel:e.is_mobile?"audioplayer.sliderUp(this, event);":null,onMouseMove:e.is_mobile?null:"audioplayer.sliderMove(event);",onMouseUp:e.is_mobile?null:"audioplayer.sliderUp(event);",onClick:"cancelEvent(event);",tag:"div"}],class:"aic_volume_wrap",tag:"td"}],tag:"tr"}],class:"row_table",tag:"table"}],class:t,tag:"div"}],tag:"div"}}function Ni(e){var t=e.is_playlist_forced?", true":"",n="audioplayer.playPause(event, '"+e.audio_id+"'"+t+");",i="",a=e.has_cover?Object(R.default)(Object(ji.getPlayOnCover24Icon)()):Object(R.default)(Object(Ei.getPlay24Icon)()),r=e.has_cover?Object(R.default)(Object(Ti.getPauseOnCover24Icon)()):Object(R.default)(Object(Ii.getPause24Icon)());return e.has_cover&&!e.cover_style&&(i={inner:[Object(R.default)(Object(Mi.getSongOutline28Icon)())],class:"ai_cover_placeholder",tag:"span"}),{inner:[i,{inner:[a],class:"i_play",tag:"span"},{inner:[r],class:"i_pause",tag:"span"}],class:"ai_play",style:e.cover_style,onClick:n,tag:"button"}}var Fi=function(e){var t=e.is_playlist_forced?", true":"",n=e.is_disabled?"":"audioplayer.playPause(event, '"+e.audio_id+"'"+t+")",i=e.classes||[],a={};a[e.audio_id]=!0;var r=[l.default.class("audio_item",a,"_"),e.is_no_progress&&"ai_noProgress",e.is_focus&&"ai_focus",e.is_explicit&&"audio_item_explicit",e.is_disabled&&"audio_item_disabled",(e.can_add||e.can_del)&&"ai_has_btn",!e.has_actions_menu&&"ai_no_menu",e.has_cover&&"ai_has_cover"];e.is_attachment&&r.push("ai_select");var o=Object(J.mergeArrays)(r,i).filter((function(e){return e})).join(" ");return e.is_attachment?{inner:[Ri(e)],"data-id":e.audio_id,class:o,"data-audio":e.serialized,href:e.attachment_action,tag:"a"}:{inner:[Ri(e)],"data-id":e.audio_id,"data-playlist-id":e.playlist_id,class:o,onClick:n,"data-audio":e.serialized,tag:"div"}},Hi=window.audio,Ui=function(){if(!HTMLAudioElement)return{init:function(){},initAudio:function(){}};var e=!1,t="1"==lsGet("audio_time_left"),n={},i=!1,a=!1,r=!1,o=[],c=null,l=[];function _(e){if(e){$$("#lm_player").forEach((function(e){show(e)})),$$("#lm_audio").forEach((function(t){t&&(t.querySelector(".ai_artist").innerHTML=e.performer,t.querySelector(".ai_title").innerHTML=e.title,t.querySelector(".ai_play").style.backgroundImage=e.coverUrl_p?"url("+e.coverUrl_p+")":""),Hi.isAdsPlaying()&&W(e,!0)}));var t=di(e.fullId);t&&each(t,(function(t,n){Hi.isAdsPlaying()?(V(e,!0),addClass("ai_playing",n)):(j(n,0),E(n,0),C(n,M(0,Hi.duration()))),T(n,Hi.volume()),addClass("ai_current",n)}))}else $$("#lm_player").forEach((function(e){hide(e)}))}function f(e){var t=e.fullId,i=e.duration;$$("#lm_audio").forEach((function(e){removeClass("ai_playing",e)}));var a=di(t);a&&(each(a,(function(e,t){C(t,I(i)),removeClass("ai_playing",t),removeClass("ai_current",t)})),n[t]&&delete n[t],Hi.isAdsPlaying()&&V(e,!1))}function p(e,t,i,a){var r=di(e);if(r.length){var o=t*(i||0);each(r,(function(e,n){v||E(n,t),C(n,Ui.getFormatedTime(o,i))})),o>1&&(n[e]=1)}}function h(e,t){window.audio.playNothing(),ajax.post("/audio",{act:"block_playlist",block_id:e},{onDone:function(n){if(n){var i=n.map((function(e){return ni(e)}));Hi.playlist(i),Hi.setPlaylistId(e),t&&t(i)}}})}function m(e,t){void 0===t&&(t=!1);var n=_i(e),i=gpeByClass("audios_list",n)||gpeByClass("AudioBlock",n),a=geByClass("audio_item",i),r=[],o=!1;each(a,(function(t,n){var i=JSON.parse(domData(n,"audio"));if(i){var a=ni(i);r.push(a),a.fullId===e&&(o=!0)}})),Hi.playlist(r,{q:attr(i,"data-query")}),t&&o&&o&&Hi.play(e)}onDOMReady((function(){window.playerAdapter=new ki(Hi),new Oi(window.playerAdapter),l=Pe.initBannerBlocks()})),window.page.onChange((function(){"audio"===cur.module&&(l&&l.forEach((function(e){return e.destroy()})),l=Pe.initBannerBlocks())})),Hi.subscribe(Gt.events.PLAY,(function(e){var t=Hi.getCurrent();t&&Hi.playing()&&!Hi.isAdsPlaying()&&ajax.post("/audio",{act:"start_playback",audio_id:t.id,owner_id:t.ownerId,hash:t.actionHash,uuid:Hi.getDeviceId()});e,$$("#lm_audio").forEach((function(e){addClass("ai_playing",e)}));var n=di(e);if(!n)return;each(n,(function(e,t){addClass("ai_playing",t),addClass("ai_current",t)})),o[o.length-1]!==e&&o.push(e);r?r=!1:(a=i,i=!1,Ui.onPlay(e));N()})),Hi.subscribe(Gt.events.PLAY_REQUESTED,(function(e){U(e)})),Hi.subscribe(Gt.events.PAUSE,(function(e){$$("#lm_audio").forEach((function(e){removeClass("ai_playing",e)})),N();var t=di(e);if(!t.length)return;each(t,(function(e,t){removeClass("ai_playing",t),addClass("ai_current",t)})),r||(Ui.onPause(e),N())})),Hi.subscribe(Gt.events.SELECT,_),Hi.subscribe(Gt.events.DESELECT,f),Hi.subscribe(Gt.events.PROGRESS,p),Hi.subscribe(Gt.events.SEEK,p),Hi.subscribe(Gt.events.AD_STARTED,(function(e){V(e,!0),W(e,!0)})),Hi.subscribe(Gt.events.AD_COMPLETED,(function(e){V(e,!1),W(e,!1),p(e.id,0,0)})),Hi.subscribe(Gt.events.NOT_FOUND_PLAYLIST,m),Hi.subscribe(Gt.events.EMPTY_PLAYLIST,m),Hi.subscribe(Gt.events.ENDED,(function(e){var t=geBySel('.audio_item[data-id="'+e+'"]');t&&(each(t,(function(e,t){E(t,1)})),i=!0,window.Unauthorized&&window.vk&&!window.vk.id&&Object(S.partConfigEnabled)("audio_unauth_preview_box")&&(i=!1,window.audio.pause(),window.Unauthorized.showMoreBox(null,0,Wt)),Ui.onEnded(e))})),Hi.subscribe(Gt.events.VOLUME,(function(e,t){var n=geBySel('.audio_item[data-id="'+e+'"]');n&&(each(n,(function(e,n){T(n,t)})),Ui.onVolume(e,t))}));var v=null,g=null,A=!1,b=!1,w=!1;function y(e){if(v){w||(addEvent(document,x.isTouch?"touchmove":"mousemove",y),addEvent(document,x.isTouch?"touchend touchcancel":"mouseup",O),w=!0);var t=gpeByClass("audio_item",v),n=k(v,e);e&&cancelEvent(e);var i=di(attr(t,"data-id"));each(i,(function(e,t){A&&E(t,n),b&&(T(t,n),Hi.volume(n))})),g=n}}function O(e){if(v){w=!1,removeEvent(document,x.isTouch?"touchmove":"mousemove",y),removeEvent(document,x.isTouch?"touchend touchcancel":"mouseup",O);var t=gpeByClass("audio_item",v),n=k(v,e)||g;e&&cancelEvent(e);var i=geBySel('.audio_item[data-id="'+attr(t,"data-id")+'"]');each(i,(function(e,i){A&&(E(i,n),Hi.setPosition(n,!0)),b&&T(t,n)})),A&&(r=Hi.playing(),Ui.onSeek(n)),v=g=null,A=b=!1}}function k(e,t){var n=gpeByClass("Slider__scroll",e),i=hasClass("touch",window.bodyNode)?10:8,a=(t.pageX||t.touches&&t.touches[0]&&t.touches[0].pageX||0)-(n?e.getBoundingClientRect().left:getX(e))-i/2,r=e.offsetWidth-i;return r?Math.max(0,Math.min(a/r,1)):0}function C(e,t){if(e){var n=geByClass1("ai_dur",e);val(n,t)}}function j(e,t){if(e){var n=geByClass1("aic_progress_wrap",e),i=geByClass1("aic_load_line",n);i&&(i.style.width=100*Math.max(0,Math.min(t,1))+"%")}}function E(e,t){if(e){var n=geByClass1("aic_progress_wrap",e),i=geByClass1("aic_progress_line",n);i&&(i.style.width=100*t+"%")}}function T(e,t){if(e){var n=geByClass1("aic_volume_wrap",e),i=geByClass1("aic_progress_line",n);i&&(i.style.width=100*t+"%")}}function I(e){var t,n,i,a=e<0;return t=(n=(e=Math.round(a?-e:e))%60)<10?"0"+n:n,t=(i=(e=Math.floor(e/60))%60)+":"+t,(e=Math.floor(e/60))>0&&(i<10&&(t="0"+t),t=e+":"+t),a&&(t="-"+t),t}function M(e,n){return I(t&&n?e-n:e)}function P(e){var t=window.cur;t.deletedAudios||(t.deletedAudios={}),t.deletedAudios[e]=!0}function D(e){var t=window.cur;t.deletedAudios&&delete t.deletedAudios[e]}function L(e,t,n){void 0===n&&(n=null),t?function(e){var t=window.cur;t.addedAudios||(t.addedAudios={}),t.addedAudios[e]=!0}(e):function(e){var t=window.cur;t.addedAudios&&delete t.addedAudios[e]}(e);var i=geBySel('.audio_item[data-id="'+e+'"]');each(i,(function(e,n){toggleClass("ai_added",n,t),val(geByClass1("ai_add",n),t?lang.global_delete_audio:lang.global_add_to_audio)}));var a=geBySel1('body > [id="ai_menu_'+e+'"]'),r=geByClass1("ai_add",a);val(r,t?lang.global_delete_audio:lang.global_add_to_audio),$[e]=t,n&&((n.querySelector(".Btn__text")||n).innerText=t?lang.global_delete_audio:lang.global_add_to_audio),ActionMenu.update()}function R(e,t,n){void 0===n&&(n=null),t?P(e):D(e);var i=geBySel('.audio_item[data-id="'+e+'"]');each(i,(function(e,n){toggleClass("ai_deleted",n,t),val(geByClass1("ai_del",n),t?lang.global_add_to_audio:lang.global_delete_audio)}));var a=geBySel1('body > [id="ai_menu_'+e+'"]'),r=geByClass1("ai_del",a);val(r,t?lang.global_add_to_audio:lang.global_delete_audio),$[e]=!t,n&&((n.querySelector(".Btn__text")||n).innerText=t?lang.global_add_to_audio:lang.global_delete_audio),ActionMenu.update()}function N(){var e=window.audio.getCurrentId(),t=di(e),n=[],i=window.audio.playing();i&&e&&t.length&&t.forEach((function(e){var t=gpeByClass("audios_list",e)||gpeByClass("mcont",e);n.push(t)})),each(geByClass("_AudioPlayStatus"),(function(e,t){var n=i&&t.dataset.playlistId===Hi.getCurrentPlaylistId();toggleClass(t,"playing",n)}))}function H(e,t,n){if(window.isArticleWebView)return Article.audioPlay(Hi.getCurrentId(),Hi.playlist()),cancelEvent(e),!1;var i=window.lang;if(Hi.support){var a=_i(t);if(a&&hasClass("ai_deleted",a)&&!hasClass("ai_current",a))return!0;n&&t!==Hi.getCurrentId()||fi(t)!==Hi.getCurrentPlaylistId()?m(t,!0):Hi.operate(t)}else alert(i.mobile_audio_player_not_support);return cancelEvent(e),!1}function U(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null);var i=di(e);Hi.playing()?(each(i,(function(e,t){addClass("ai_playing",t)})),$$("#lm_audio").forEach((function(e){addClass("ai_playing",e)}))):(each(i,(function(e,t){removeClass("ai_playing",t)})),$$("#lm_audio").forEach((function(e){removeClass("ai_playing",e)}))),null!==t&&null!==n&&each(i,(function(e,i){j(i,t/n),addClass("ai_current",i)}))}function V(e,t){var n=_i(e.fullId);toggleClass("ad_mode",n,t);var i=geByClass1("ai_title",n);val(i,t?Object(J.getLang)("global_audio_ad"):e.title),toggleClass("ad_placeholder",i,t)}function W(e,t){geBySel(".audio_item.al_player").forEach((function(n){if(n){var i=geByClass1("ai_title",n);val(i,t?Object(J.getLang)("global_audio_ad"):e.title),toggleClass("ad_placeholder",i,t),toggleClass("ad_mode",n,t),toggle(geByClass1("ai_artist"),!t)}}))}var $={},q={};return page.onChange((function(){$={},q={}})),{init:function(t){e||(e=!0,onDOMReady((function(){window.nav&&window.audio&&window.audioplayer&&"#player"==nav.hash&&Hi.playlist().length&&Ui.openPlayer(geByClass1("AudioPlayerMini"),!0)})))},initAudio:function(){each(geByClass("ai_current"),(function(e,t){f(t=function(e){if(!(e=ge(e))||!e.dataset.audio)return null;var t=null;try{t=JSON.parse(e.dataset.audio)}catch(e){return null}return ni(t)}(t))}));var e=Hi.loaded(),t=Hi.getPosition(),n=Hi.duration(),i=n?t/n:0;U(Hi.getCurrentId(),e,n),_(Hi.getCurrent()),p(Hi.getCurrentId(),i,n),setTimeout((function(){N()}),1)},getDOMFromAudio:function(e,t,n,i){if(!Object.keys(e).length)return'<div class="audio_item audio_item_disabled"></div>';var a=ni(e);if(!a)return"";var r=Object(Ci.htsc)(a.ownerId+"_"+a.id),o=a.coverUrl_p||a.coverUrl_s,s=e,c=[];if(function(e){var t=window.cur;return!!t.deletedAudios&&t.deletedAudios[e]}(r)){if(n)return"";c.push(" ai_deleted")}(function(e){var t=window.cur;return!!t.addedAudios&&t.addedAudios[e]})(r)&&c.push("ai_added"),r===Hi.getCurrentId()&&(Hi.playing()&&c.push("ai_playing"),c.push("ai_current"));var l=!!vk.id&&(!a.isClaimed||a.canDelete);vk.id||c.push("ai_no_menu");var u=new Fi({is_playlist_forced:t,is_disabled:a.isClaimed,audio_id:r,is_authenticated:!!vk.id,login_redirect_url:"",is_explicit:a.isExplicit,can_add:a.canAdd,can_del:a.canDelete,serialized:JSON.stringify(s),classes:c,has_cover:i,cover_style:o?"background-image: url("+o+")":"",has_actions_menu:l,position:a.chartInfo?a.chartInfo.position:"",duration:a.duration,is_mobile:x.isTouch,_duration_title:I(a.duration),title:a.title,subtitle:a.subtitle,artist:a.performer,url:a.url});return d.default.html(u)},morePopup:function(e,t,n,i){if(void 0===t&&(t=null),void 0===n&&(n=null),void 0===i&&(i=null),null===t){var a=Hi.getCurrent()||{};t=a.fullId,n=a.accessKey,i=a.canDelete,q[t]=a}var r="";r=void 0!==$[t]?$[t]?Object(J.getLang)("global_delete_audio"):Object(J.getLang)("global_add_to_audio"):i?Object(J.getLang)("global_delete_audio"):Object(J.getLang)("global_add_to_audio"),ie.default.open(d.default.elem(Object(ie.default)({on_overlay_click:["return ContextMenu.close","this"],class:"ContextMenu",close:!0,onClose:["return ContextMenu.close","this"],items:[{tag:"ul",class:"ContextMenu__list",inner:[!i&&{tag:"li",class:"ContextMenu__listItem",inner:[{tag:"a",class:"ContextMenu__listLink",href:"#",inner:r,onclick:"return audioplayer.add('"+t+"', '"+n+"', event, this);"}]},i&&{tag:"li",class:"ContextMenu__listItem",inner:[{tag:"a",class:"ContextMenu__listLink",href:"#",inner:r,onclick:"return audioplayer.del('"+t+"', event, this);"}]}]}]})),!0),e&&cancelEvent(e)},add:function(e,t,n,i){void 0===t&&(t=null),void 0===i&&(i=null);var a=_i(e);if(!hasClass("ai_ajax",a)){var r=a?ni(JSON.parse(a.dataset.audio)):q[e]||{};q[e]||(q[e]=Object(B.default)({},r));var o=!1;a?(o=hasClass("ai_added",a),q[e].deleteid=attr(a,"data-deleteid"),q[e].deleteHash=attr(a,"data-delete-hash")):void 0!==$[e]&&(o=$[e]),r.deleteid=r.deleteid||q[e].deleteid,r.deleteHash=r.deleteHash||q[e].deleteHash,r.restoreHash=r.restoreHash||q[e].restoreHash,L(e,!o,i),addClass("ai_ajax",a),Ui.onAdd(),i&&(i.disabled=!0),ajax.post("/audio",{_ajax:1,act:o?"delete":"add",audio:o?r.deleteid:r.fullId,hash:o?r.deleteHash:r.addHash,access_key:t,track_code:r.trackCode,source_playlist_id:fi(r.fullId)},{redirectToLoginPage:!0,onDone:function(t,n){removeClass("ai_ajax",a),t?(q[e].deleteid=t,q[e].deleteHash=n,attr(a,"data-deleteid",t),attr(a,"data-delete-hash",n)):L(e,o,i),i&&(i.disabled=!1)},onFail:function(){removeClass("ai_ajax",a),L(e,o,i);var n=Array.prototype.slice.call(arguments),s=n.shift();switch(s){case 2:nav.go("/audio?act=add&audio="+e+"&hash="+(o?r.deleteHash:r.addHash)+"&access_key="+t)}i&&(i.disabled=!1)}}),n&&cancelEvent(n)}},del:function(e,t,n){void 0===n&&(n=null);var i=_i(e),a=!1;i?a=hasClass("ai_deleted",i):void 0!==$[e]&&(a=!$[e]),R(e,!a,n);var r=i?ni(JSON.parse(i.dataset.audio)):q[e]||{};q[e]||(q[e]=Object(B.default)({},r)),a?D(e):P(e),Ui.onDel(),n&&(n.disabled=!0),r.deleteid=r.deleteid||q[e].deleteid,r.deleteHash=r.deleteHash||q[e].deleteHash,r.restoreHash=r.restoreHash||q[e].restoreHash,ajax.post("/audio",{_ajax:1,act:a?"restore":"delete",audio:e,playlist_id:fi(e),hash:a?r.restoreHash:r.deleteHash},{redirectToLoginPage:!0,onDone:function(t){t||R(e,a,n),n&&(n.disabled=!1)},onFail:function(){R(e,a,n);var t=Array.prototype.slice.call(arguments),i=t.shift();switch(i){case 2:nav.go("/audio?act="+(a?"restore":"delete")+"&audio="+e+"&hash="+(a?r.restoreHash:r.deleteHash))}n&&(n.disabled=!1)}}),t&&cancelEvent(t)},playPause:H,getFormatedTime:M,switchTimeFormat:function(e,n){var i=gpeByClass("audio_item",e);return!(hasClass("ai_current",i)&&!hasClass("ai_select",i))||(t=!t,lsSet("audio_time_left",t?"1":"0"),C(_i(Hi.getCurrentId()),M(Hi.getPosition(),Hi.duration())),n&&cancelEvent(n),!1)},setPosition:function(e,t){v||Hi.isAdsPlaying()||(v=e,A=!0,y(t))},setVolume:function(e,t){v||(v=e,b=!0,y(t))},openPlayer:function(e,t){var n=window.audio,i=nav.path,a=n.getCurrentPlaylistId(),r=nav.params;a&&!r.includes("playlist_id")&&(r=(r?r+"&":"")+"playlist_id="+a);var o=i+(r?"?":"")+r+"#player";return nav.al_go(o,null,{local:!0,target:e,nav:{push:o,path:i,params:r,hash:"#player"},no_push:t})},getCurrentElem:function(){return Object(F.$)(".ai_current")},playFirst:function(e,t){e&&cancelEvent(e);var n=Hi.getCurrent(),i=gpeByClass("_audioPlaylist",t),a=n?n.fullId:null;if(!a||!geByClass1("ai_current",i)){var r=(i||ge("mcont")).$(".audio_item");a=r&&r.getAttribute("data-id")}a&&H(e,a)},hasArticleWebViewClientAudioSupport:function(){return window.clientWebviewAudioSupport},getPlaybackQueue:function(){return o},isAutoPlayed:function(){return a},playBlock:function(e,t,n){t.preventDefault(),Hi.getCurrentPlaylistId()!==e?h(e,(function(t){if(t.length){var i=t[0].fullId;Hi.select(i).then((function(){Hi.play(i),n.classList.add("playing"),n.dataset.playlistId=e}))}})):Hi.operate()},playShuffledBlock:function(e,t){e.preventDefault(),h(t.dataset.blockId,(function(e){if(e.length){var t=e[0].fullId;window.audio.play(t)}}))},openModal:function(e,t){var n=t.parentElement.querySelector(".Popup");return ie.default.open(n,!0),c=Object(s.expandPopup)(t),cancelEvent(e),!1},closeModal:function(e){ie.default.close(e),c&&c()},onAdd:Object(u.default)(),onDel:Object(u.default)(),onPlay:Object(u.default)(),onPause:Object(u.default)(),onProgress:Object(u.default)(),onVolume:Object(u.default)(),onSeek:Object(u.default)(),onPlaylistChanged:Object(u.default)(),onEnded:Object(u.default)(),sliderMove:y,sliderUp:O}}();window.audioplayer=Ui,window.Section=xe;var Vi=n("vR9X");var Wi=n("Weg4");function $i(e){var t=Object(J.classNames)("PhotoMarketItem__fave",{"PhotoMarketItem__fave--added":e.isFave}),n=["ItemsList._toggleFave",{event:"event",el:"this",type:e.type,typeInt:e.typeInt,ownerId:e.ownerId,itemId:e.itemId,href:e.href,faveHash:e.faveHash}];return{class:t,"data-is-fave":e.isFave?"fave":"",onclick:n,tag:"a"}}function qi(e){return{inner:[{src:e.thumb,class:"PhotoMarketItem__thumb",tag:"img"},{inner:[e.title],class:"PhotoMarketItem__title",tag:"div"},{inner:[e.price],class:"PhotoMarketItem__price",tag:"div"},$i({type:e.type,typeInt:e.typeInt,isFave:e.isFave,itemId:e.itemId,ownerId:e.ownerId,href:e.href,faveHash:e.faveHash})],class:"PhotoMarketItem","data-item-id":e.itemId,tag:"div"}}function zi(){for(var e=[],t=0;t<10;t++)e.push({class:"PhotoItemsList__item PhotoItemsList__item--filler",tag:"div"});return e}function Yi(e){var t=JSON.parse(unescape(e.itemsJSON));return{inner:[{inner:[{class:"PhotoItemsList__closeIcon",onClick:e.onClose,tag:"div"},Object(J.getLang)("mobile_photos_market_items_title")],class:"PhotoItemsList__header",tag:"div"},{inner:[t.map((function(e){return{inner:[qi({itemId:e.item_id,thumb:e.thumb,title:e.title,price:e.price,href:e.href,faveHash:e.fave_hash,type:e.type,typeInt:e.type_int,ownerId:e.owner_id,isFave:Yi._faveCache[e.item_id]||e.is_fave})],onClick:["ItemsList._goToItem",e],class:"PhotoItemsList__item",tag:"div"}})),zi()],class:"PhotoItemsList__body",tag:"div"}],class:"PhotoItemsList",tag:"div"}}var Gi={_faveCache:{},_itemsPopup:void 0,_onClose:function(){Gi._itemsPopup&&(Ln.default.close(Gi._itemsPopup),delete Gi._itemsPopup)},_goToItem:function(e){var t,n;(null===(t=window.cur.destroy)||void 0===t?void 0:t.includes(Gi._onClose))||null===(n=window.cur.destroy)||void 0===n||n.push(Gi._onClose),window.nav.go(e.url)},_toggleFave:function(e){var t=e.event,n=e.el,i=e.type,a=e.typeInt,r=e.ownerId,o=e.itemId,s=e.href,c=e.faveHash;t.stopPropagation();var l=n.dataset.isFave;window.ajax.post("/bookmarks.php",{_ajax:1,item_type:a,act:l?"bookmark_remove":"bookmark_add",hash:c,item_oid:r,item_id:o,link_url:s},{onDone:function(e){e&&(Gi._faveCache[o]=!l,Object(F.$)(".PhotoItemsList").$$(".PhotoMarketItem").forEach((function(e){e.dataset.itemId===o.toString()&&(e.$(".PhotoMarketItem__fave").outerHTML=d.default.html($i({type:i,typeInt:a,isFave:!l,ownerId:r,itemId:o,href:s,faveHash:c})))})))}})},_openItemsPopup:function(e){var t=Object(ie.default)({class:"Photo__marketItemsModal",body:Yi({itemsJSON:e,onClose:["ItemsList._onClose"]})});Gi._itemsPopup=Ln.default.open(d.default.elem(t),!0)}};window.ItemsList=Gi;var Ki=browser.meizu||browser.mi||browser.uc_mini||0!==browser.ios&&browser.ios<10||browser.chrome&&browser.version.split(".")[0]<53,Qi=!Ki&&!!c.default.getFlag(c.FLAG_MP4);onDOMReady((function(){Ji.onUpdate(),page.onChange((function(){Ji.onUpdate()}))}));var Xi={gifs:[],currentAutoplayElement:null,ignore:[]},Ji={isBadBrowser:Ki,isMp4Supports:function(){return Qi},openPopup:function(e,t,n){if(void 0===n&&(n={}),this.autoplayTest(),e&&cancelEvent(e),function(e){cur.loadedGifs||(cur.loadedGifs={});return!cur.loadedGifs[e.raw]}(n)&&n.needConfirm){var i=function(e){return Object(r.ceFromString)(d.default.html(Object(In.default)({scrollable:!0,header:{title:getLang("mobile_wall_gif_size_warning_popup_title")},content:[getLang("mobile_wall_gif_size_warning").replace("{size}",e.size),{class:"Popup__buttons",inner:[Object(qt.default)({onClick:'Gif.confirm(this, "'+e.raw+'")',use_native_onclick:!0,class:"Popup__button",theme:"regular",inner:d.default.wrap(getLang("mobile_continue"))}),Object(qt.default)({onClick:"Popup.close(this)",use_native_onclick:!0,class:"Popup__button",theme:"secondary",inner:d.default.wrap(getLang("mobile_cancel"))})]}]})))}(n,t.getAttribute("data-media"));return domInsertBefore(i,t),void In.default.open(i,!0)}var a=Object(B.default)({},nav.getQuery(),{z:"doc"+n.raw+"/"+(n.hash||"")});nav.path,Object(r.obj2qs)(a),nav.hash;photo.zopen(null,null,n.raw,"",{no_push:!1,isDoc:!0,hasVideo:n.hasVideo,hash:n.hash})},init:function(e){zlayer.create(Zi()),zlayer.open()},close:function(){var e=Object(B.default)({},nav.getQuery());delete e.z;var t=nav.path+Object(r.obj2qs)(e)+nav.hash;nav.go(t,null,{push_only:!1,nav_incr:!0})},confirm:function(e,t){cur.loadedGifs[t]=!0,In.default.close(e),Object(r.geBySel1)('[data-media="'+t+'"]').click()},autoplayTest:function(){c.default.detectAutoplay().then((function(e){Qi=c.default.getFeatures().mp4&&e&&c.default.getFlag(c.FLAG_MP4)&&!Ki}))},activateGIF:function(){if("/mail"!==nav.path){var e=scrollTop(),t=e+window.innerHeight,n=e+window.innerHeight/2,i={};Array.from(Xi.gifs||[]).forEach((function(a){var r=getXY(a)[1],o=r>=e&&r<=t,s=Math.abs(n-r);o&&(i[s]=a)}));var a=i[Math.min.apply(Math,Object.keys(i))];a?a.classList.contains("current_gif")||-1===Xi.ignore.indexOf(a)&&(post.toggleGif(a,!1,!1,!0),Xi.currentAutoplayElement=a):post.hidePlayingGifs(!1,!0)}},onUpdate:function(){c.default.getFlag(c.FLAG_GIF_AUTOPLAY)&&(Xi.gifs=[].concat(Array.from($$(".doc_preview_rows_1 .doc_preview_gif")||[])),onBodyScroll(Object(r.throttle)(Ji.activateGIF,200)))},getState:function(){return Xi},setState:function(e,t){Xi[e]=t}};function Zi(e){void 0===e&&(e=!1);var t='<img class="zpv_img" alt="">';return e&&(t='<video class="zpv_img" alt="" autoplay preload="metadata" crossorigin="anonymous" poster="/images/blank.gif" webkit-playsinline playsinline controls loop muted>'),'\n    <div id="z_photoview">\n      <div class="zpv_siblings">\n        <div id="zpv_left" class="zpv_thumb_item">\n          <img class="zpv_img" alt="">\n        </div>\n        <div id="zpv_right" class="zpv_thumb_item">\n          <img class="zpv_img" alt="">\n        </div>\n      </div>\n      <div class="zpv_body">\n        <div id="zpv_center" class="zpv_thumb_item">\n          '+t+'\n        </div>\n      </div>\n      <div class="zpv_close_msg_wrap">\n        <div class="zpv_close_msg"> '+lang.mobile_zphoto_move_to_close+'</div>\n      </div>\n      <div class="zpv_controls">\n        <div class="mhead zpv_header">\n          <a class="zpv_close_btn" onclick="return photoview.closePhoto(event);"><i class="zpv_close_icon"></i></a>\n          <div class="hb_wrap"><h1 id="zpv_summary" class="hb_btn mh_header"></h1></div>\n        </div>\n      </div>\n      <div class="zpv_tags"></div>\n      <div class="zpva zpv_crop"><div class="zpv_crop_box"></div><div class="zpv_crop_loading"></div></div>\n    </div>\'\n  '}window.Gif=Ji;var ea=n("wJa3");function ta(e){return void 0===e&&(e={}),Object(Ln.default)({on_overlay_click_native:"QRPhotoPosting.back();",class:"QRPhotoPosting",content:[{class:"QRPhotoPosting__img",inner:Wd.wrap(e.svg)},{class:"QRPhotoPosting__title",inner:Wd.wrap(e.title)}]})}function na(){return{inner:[Object(R.default)({icon:Object(ea.getQr24Icon)()})],class:"QRPhotoPosting__button",onclick:"QRPhotoPosting.show();",tag:"div"}}var ia,aa=n("wZQE"),ra=n.n(aa);function oa(e){var t=/photo(-?\d+)_(\d+)/i.exec(e||nav.cur);return Object(J.isArray)(t)||(t=["",0,0]),{album:Object(r.intval)(t[1]),photo:Object(r.intval)(t[2])}}function sa(e){return-86529522===oa(e).album&&Object(S.partConfigEnabled)("mvk_photo_fest_qr_sharing")?na():""}function ca(e){var t=Object(F.$)("#z_photoview .zpv_values"),n=d.default.elem(sa(e));Object(r.append)(n,t)}window.QRPhotoPosting=ta,Object(r.extend)(ta,{show:function(){var e=oa(),t="https://vk.com/fest?publish_photo="+e.photo,n=ra.a.createQR(t,271,"QRPhotoPosting__svg",{isShowLogo:!0});ia=Ln.default.open(d.default.elem(ta({svg:n,title:window.lang.mobile_photo_qr_popup_title})),!0),nav.go(nav.path+"?z=publish_photo"+e.photo,null,{push_only:!0,nav_init:!1,nav_incr:!0})},close:function(){ia&&Ln.default.close(ia)},back:function(){window.history?window.history.back():window.location="/"},getQRPhotoButton:sa,QRPhotoPosting:ta,QRPhotoPostingButton:na,appendQRPhotoButton:ca});var la=n("he4e"),ua=window.ajax,da=window.thover,_a=window.nav,fa=(window.page,window.PhotoLike),pa=window.zlayer,ha=window.photo,ma=function(){var e=!1,t=!1,n=!1,i=!1,a=!1,r=!1,o=!1,s=!1,c=!1,l=!1,_=!1,f=!1,p=!1,h=!1,m=!1,v=!1,g=!1,A=!1,b=!1,w=!1,y=!1,O=!1,S=!1,k=!0,C=!1,j={},E=1,T=3,I=1.5,M=20,P=250,D=0;function x(e){var t=getCw()/2,n=getCh()/2;if(e.touches){for(var i=0,a=0,r=0,o=Math.min(2,e.touches.length);i<o;i++)a+=e.touches[i].pageX,r+=e.touches[i].pageY;return o?{pageX:a/o-t,pageY:r/o-n}:{pageX:-t,pageY:-n}}return{pageX:e.pageX-t,pageY:e.pageY-n}}function L(e,t){var n=null,i=(domData(e,"fake-size")+"").split(",");if(i[0]>0&&i[1]>0)return{width:i[0],height:i[1]};var a=t?attr(_,"data-original-src")||_.src:e.src;if(j[a])return j[a];if(t&&(e=function(){var e=ce("img");return e.src=attr(_,"data-original-src")||_.src,e}()),void 0!==e.naturalWidth)n={width:e.naturalWidth,height:e.naturalHeight};else if("VIDEO"===e.tagName)n={width:e.clientWidth,height:e.clientHeight};else{(new Image).src=e.src,n={width:e.width,height:e.height}}return n.width&&n.height&&(j[a]=n),n}function N(e){var t=attr(e,"data-id");return F((an(Xt).tags||{})[t]||[])}function F(e){return e[0]?{coords:{x:e[0][0],y:e[0][1],w:e[0][2],h:e[0][3]},name:e[1],href:e[2],al:e[3]}:{}}function H(e){setStyle(t,"overflow",e?"visible":"hidden")}var U=null,V=null;function W(e,n,i,r,o,s,c,l,u){if(!D||u){var d=!1,f=!!l&&function(){d||(d=!0,l())};s?(t&&setStyle.animate(t,"transform",{duration:s,func:c},f),_&&setStyle.animate(_,!1===o?"transform":"transform, opacity",{duration:s,func:c},f),h&&setStyle.animate(h,!1===o?"transform":"transform, opacity",{duration:s,func:c},f),m&&setStyle.animate(m,!1===o?"transform":"transform, opacity",{duration:s,func:c},f),v&&setStyle.animate(v,!1===o?"transform":"transform, opacity",{duration:s,func:c},f),a&&setStyle.animate(a,!1===o?"transform":"transform, opacity",{duration:s,func:c},f),Fe=!0):Fe&&(t&&setStyle.animate(t),_&&setStyle.animate(_),h&&setStyle.animate(h),m&&setStyle.animate(m),v&&setStyle.animate(v),a&&setStyle.animate(a),Fe=!1),setStyle.transform(t,{translate:[n,0]}),setStyle.transform(_,e,[i,r]),Bt(e,i,r),!1!==o&&(setStyle(_,"opacity",o),ye||Oe?(setStyle(h,"opacity",o),Se=!0):(setStyle(m,"opacity",o),je=!0),setStyle(v,"opacity",o),function(e,t){var n=window.lang;if(e){var i=pa.height,r=i/5,o=i/3.5,s=Math.abs(e),c=s>20?e+(e>0?20-e:-20-e)/I:e,l=0===t?0:Math.max(0,Math.min((s-20)/r,.75));t>0&&setStyle.transform(a,{translate:[0,c]}),setStyle(a,"opacity",l);var u=s>o,d=u?"":e>0?" zpv_close_move_down":" zpv_close_move_up",_=u?n.mobile_zphoto_release_to_close:n.mobile_zphoto_move_to_close;val(a,'<div class="zpv_close_msg'+d+'">'+_+"</div>"),(a.is_down&&e<0||!a.is_down&&e>0)&&Pt(e>0)}else setStyle.transform(a,{translate:[0,0]}),setStyle(a,"opacity",0)}(r,o)),Mt(e)}else U=[e,n,i,r,o,s,c,l,!0],V||$()}function $(){U&&(W.apply(window,U),U=null),clearTimeout(V),V=D?setTimeout($,1e3/D):null}function q(e,t,n){pt(!0),W(le,ne,oe,se,He,e,t,n),He=!1}function z(e,t,n,i){W(e.currentScale,e.curBodyX,e.currentX,e.currentY,!1,t,n,i)}function Y(e){e=function(e){if(!e)return e;var t={width:_.width||_.clientWidth,height:_.height||_.clientHeight},n=t.width/2,i=t.height/2;return[e[0]+n,e[1]+i]}(e||[0,0]),setStyle.transformOrigin(_,e)}function G(){(C=Zt.max_src&&le>2)?_.src!==Zt.max_src&&(attr(_,"data-original-src",Zt.src),attr(_,"data-src",Zt.max_src),on(Zt.max_src)):C||_.src===Zt.src||!_||O||S||(attr(_,"data-src",Zt.src),sn(Zt.src),_.style.width="")}var K,Q,X,Z,ee,te,ne,ie,ae,re,oe,se,le,ue,de,_e,fe,pe,he,me,ve,Ae,be,we,ye,Oe,Se,ke,Ce,je,Ee,Te,Ie,Me,Pe,De,xe,Le,Be,Re,Ne,Fe,He,Ue=!1,Ve=!1,We=null;function $e(e){var t=e[1].pageX-e[0].pageX,n=e[1].pageY-e[0].pageY;return{distance:Math.sqrt(t*t+n*n),angle:180*Math.atan2(n,t)/Math.PI}}function qe(e){var t=$e(e);if(Ue){var n=t.distance/Ue.scale,i=t.angle-Ue.rotation;i<-180&&(i+=360),i>180&&(i-=360),extend(Ue,{startDistance:n,startAngle:i})}else Ue={startDistance:t.distance,startAngle:t.angle,scale:1,rotation:0}}function ze(e){return extend({originalEvent:e},e,function(e){if(!Ue)return{scale:1,rotation:0};if(e.length<2)return{scale:Ue.scale,rotation:Ue.rotation};var t=$e(e),n=t.distance/Ue.startDistance,i=t.angle-Ue.startAngle;i<-90&&(i+=360),i>270&&(i-=360);var a={scale:n,rotation:i};return extend(Ue,a),a}(e.touches),x(e))}function Ye(e){var t=e.touches;t&&(t.length>5||t.length<2?Ue&&(It(ze(e)),Ue=!1):(Ue||Et(ze(e)),qe(t)))}function Ge(e){var t=e.touches;t&&(t.length>5||t.length<2?Ue&&(It(ze(e)),Ue=!1):Ue&&Tt(ze(e)))}function Ke(e){var t=e.touches;t&&((t.length>5||t.length<2)&&Ue&&(It(ze(e)),Ue=!1),Ue&&qe(t))}function Qe(e){preventEvent(e);var t=(e.detail?e.detail:e.wheelDelta)>0?1.05:.95,n=extend({originalEvent:e},e);Ve||(Ve=1,kt(e),Et(extend(n,{scale:Ve}))),Ve*=t,Tt(extend(n,{scale:Ve})),clearTimeout(We),We=setTimeout((function(){It(extend(n,{scale:Ve})),jt(e),Ve=!1}),200)}function Xe(){K=0,Q=0,X=0,Z=0,ee=1,te=!0,ne=0,ie=0,ae=0,re=1,oe=0,se=0,le=1,ue=!1,de=!1,_e=!1,fe=!1,pe=!1,he=!1,me=!1,ve=!1,Ae=!1,Se=!1,ke=!1,Ce=!1,je=!1,Ee=!1,Te=!1,Ie=!1,!1,Le=!1,Be=!1,Re=!1,Ne=!1}function Je(){return{lastScale:ee,deltaX:K,deltaY:Q,pointX:X,pointY:Z,curScale:re,currentScale:le,curX:ie,curY:ae,currentX:oe,currentY:se,curBodyX:ne}}function Ze(e,t,n){n=n||Je(),e=e||{};var i=extend({},n,e);if(isUndefined(e.deltaX)||isUndefined(e.deltaY)?isUndefined(e.pointX)||isUndefined(e.pointY)?isUndefined(e.lastScale)?isUndefined(e.currentScale)?isUndefined(e.curScale)||(i.currentScale=i.lastScale*i.curScale,i.curX=i.pointX-i.deltaX*i.curScale,i.curY=i.pointY-i.deltaY*i.curScale,i.currentX=i.curX/i.currentScale,i.currentY=i.curY/i.currentScale):(i.curScale=i.currentScale/i.lastScale,i.curX=i.pointX-i.deltaX*i.curScale,i.curY=i.pointY-i.deltaY*i.curScale,i.currentX=i.curX/i.currentScale,i.currentY=i.curY/i.currentScale):(i.curScale=1,i.currentScale=i.curScale*i.lastScale):(i.curX=i.pointX-i.deltaX*i.curScale,i.curY=i.pointY-i.deltaY*i.curScale,i.currentX=i.curX/i.currentScale,i.currentY=i.curY/i.currentScale):(i.pointX=i.curX+i.deltaX*i.curScale,i.pointY=i.curY+i.deltaY*i.curScale),isUndefined(e.curX)||(i.curX=e.curX,i.currentX=i.curX/i.currentScale),isUndefined(e.curY)||(i.curY=e.curY,i.currentY=i.curY/i.currentScale),t)return i;K=i.deltaX,Q=i.deltaY,X=i.pointX,Z=i.pointY,ee=i.lastScale,re=i.curScale,le=i.currentScale,ie=i.curX,ae=i.curY,oe=i.currentX,se=i.currentY,ne=i.curBodyX}function et(){var e=pa.width||getCw(),t=pa.height||getCh();if(S)var n=e,i=Math.min(P,n-2*M),a=i,r=i;else a=e,r=t;return{width:a,height:r}}function tt(e){var t=et().width,n=((_.width||_.clientWidth)*e-t)/2,i=-n;return n<=0&&(i=n=0),{min:i,max:n}}function nt(e){var t=et().height,n=((_.height||_.clientHeight)*e-t)/2,i=-n;return n<=0&&(i=n=0),{min:i,max:n}}function it(){var e=1,t=T;if(S){e=1,t=(Kt?Kt[0]:{max_scale:T}).max_scale}else{var n=L(_,!0);e=E,t=Math.max(T,n.width/getCw(),(n.height||n.clientHeight)/getCh())}return Zt.restriction&&(e=1,t=1),{min:e,max:t}}function at(e){var t=pa.height||getCh(),i=Math.abs(Jt)>=10,a=Math.abs(e)>1,r=t/3.5,o=Math.abs(ae);return ae*e<0&&(i=!0),e=e||0,o>r||!i&&a?(function(e){var t=pa.height||getCh(),i=2*Math.abs(se)>t?.85:1.7;Ze({curY:(e>1?t:e<-1?-t:ae>0?t:-t)/i}),He=0,q(150,"ease-in",rt),setStyle(n,"width",0),De=!0}(e),!0):(yt()&&(He=1,q(300),fe=!1,Oe&&(Oe=!1,Nt(!0))),!1)}function rt(){w&&ma.close()}function ot(){!1!==Me&&(H(!1),dn(Me),setStyle.transform(f),setStyle.transform(p),W(1,0,0,0,1),Y(),Me=!1)}function st(){var e=1.05*(pa.width||getCw());oe-=(e+ne)/le,ne=-e,Me=Xt+1,Jt--,q(300,"ease-out",ot),qt(!1,!0),Oe=!1,ma.onPhotoChange&&ma.onPhotoChange(Xt+1,{no_open:!0,local:y,crop:S})}function ct(){var e=1.05*(pa.width||getCw());oe+=(e-ne)/le,ne=e,Me=Xt-1,Jt++,q(300,"ease-out",ot),qt(!1,!0),Oe=!1,ma.onPhotoChange&&ma.onPhotoChange(Xt-1,{no_open:!0,local:y,crop:S})}function lt(){if(!Be)return!1;var e=function(){if(!Be||Be.length<2)return[0,0,0];for(var e=vkNow(),t=!1,n=Be.pop(),i=Be.length-1;i>=0;i--){if((a=e-Be[i][0])>150)break;t=Be[i]}if(!t||!n)return[0,0,0];var a,r=n[1].pageX-t[1].pageX,o=n[1].pageY-t[1].pageY,s=Math.sqrt(r*r+o*o);return(a=n[0]-t[0])?[s/a,r/a,o/a]:[0,0,0]}(),t=e[0],n=e[1],i=e[2];if(dt(),!t)return!1;var a=_e||fe?5.1:4.7,r=t/a,o=n*r-a*r*r/2,s=i*r-a*r*r/2;if(r*=530,o*=140,s*=140,t<.1||!o&&!s)return!1;if(!fe){var c={};_e||(c.curX=ie+o,c.curY=ae+s),Ze(c);var l=tt(le);c={},ie<l.min?c.curBodyX=te?ie-l.min:0:ie>l.max&&(c.curBodyX=te?ie-l.max:0),Ze(c)}return _e?4.7*n:fe?4.7*i:r}function ut(e){Be||(Be=[]),Be.push([vkNow(),e]),Be=Be.slice(-20)}function dt(){Be=!1}function _t(e,t){var n,i,a,r,o,s,c,l,u,d=(n=[e.curX,e.curY],i=e.currentScale,a=[t.curX,t.curY],r=t.currentScale,o=n[0],s=n[1],c=a[0],l=a[1],1!=(u=r/i)&&[o+(o-c)/(u-1),s+(s-l)/(u-1)]);if(!d)return!1;var _=d[0],f=d[1];return e.deltaX=_-e.curX,e.deltaY=f-e.curY,e.currentX=e.curX/e.currentScale+_-_/e.currentScale,e.currentY=e.curY/e.currentScale+f-f/e.currentScale,t.deltaX=_-t.curX,t.deltaY=f-t.curY,t.currentX=t.curX/t.currentScale+_-_/t.currentScale,t.currentY=t.curY/t.currentScale+f-f/t.currentScale,d}function ft(e,t,n){var i,a,r,o,s,c,l,u,d,f,p,h,m,v,g,A=pa.width||getCw(),b=pa.height||getCh(),w=!1,y=(Math.min(50,A/7),L(_)),O=A/y.width,S=b/y.height,k=Math.min(1,O,S),C=N(e).coords,j=geByClass1("zpv_tl",e),E=getW(j),T=getH(j),I=(Math.min((A-30)/Math.max(C.w*y.width*k/100,E),(b-30)/(C.h*y.height*k/100+T+5)),function(){a=y.width*k*n.currentScale,r=y.height*k*n.currentScale,o=A/2-a/2+n.currentX*n.currentScale,s=b/2-r/2+n.currentY*n.currentScale,u=o+C.x*a/100,d=s+C.y*r/100,c=C.w*a/100,l=C.h*r/100,i=u+c/2-E/2,d+l+5,p=Math.min(u,i),f=Math.max(c,E),m=p+f,v=(h=d)+(l+T+5),g={}});return n=(n=Ze(g,t,n))||Je(),I(),p<15?(g.curX=n.curX+(15-p),w=!0):m>A-15&&(g.curX=n.curX-(m-A+15),w=!0),h<15&&(g.curY=n.curY+(15-h),w=!0),n=(n=Ze(g,t,n))||Je(),I(),v>b-15&&(g.curY=n.curY-(v-b+15),w=!0),n=Ze(g,t,n),t?n:w}function pt(e){Ne&&(Ne=!1,Y(),e||q(),Dt(ye,!0),xt(!ye,!0),setTimeout((function(){G()}),300))}function ht(e,t,n){var i={};return n=n||Je(),i.lastScale=e,n=Ze(i,t,n),!!t&&n}function mt(e,t,n){var i={};if(n=n||Je(),!St())return!!t&&n;i.curScale=e,n=(n=Ze(i,t,n))||Je();var a=it();return i={currentScale:n.currentScale},n.currentScale<a.min?i.currentScale=n.currentScale+(a.min-n.currentScale)/I:n.currentScale>a.max&&(i.currentScale=n.currentScale+(a.max-n.currentScale)/I),n=Ze(i,t,n),!!t&&n}function vt(e,t){if(!St())return!1;var n=!1,i={};t=t||Je();var a=it();return t.currentScale<a.min?(i.currentScale=a.min,n=!0):t.currentScale>a.max&&(i.currentScale=a.max,n=!0),t=Ze(i,e,t),e?t:n}function gt(e){if(!St())return!1;var t={pageX:0,pageY:0},n=Je(),i=null,a=_t(n,i=yt(!0,i=wt(t,!0,i=vt(!0,i=mt(e=1==e?1/ee:e,!0,i=bt(t,!0,n))))));a&&(Y(a),z(n),Ne=!0),Ne&&(Dt(!1,!0),xt(!1,!0)),bt(t),mt(e),vt(),wt(t),yt(),Ne?z(i,300,!1,pt):q(300),ht(le)}function At(e){if(!St())return!1;var t=Je(),n=null,i=_t(t,n=yt(!0,n=vt(!0,n=ft(e,!0,t))));i&&(Y(i),z(t),Ne=!0),ft(e)&&(Ce||(Ce=t)),Ne&&(Dt(!1,!0),xt(!1,!0)),vt(),yt(),Ne?z(n,300,!1,pt):q(300),ht(le)}function bt(e,t,n){var i={};return n=n||Je(),i.deltaX=(e.pageX-n.curX)/n.curScale,i.deltaY=(e.pageY-n.curY)/n.curScale,n=Ze(i,t,n),!!t&&n}function wt(e,t,n){var i={};n=n||Je(),i.pointX=e.pageX,i.pointY=e.pageY;var a=tt(n.currentScale),r=nt(n.currentScale),o=(!ue&&!r.max&&!r.min||_e||!St())&&!fe;(fe||S&&!ue&&!a.max&&!a.min)&&(i.curX=0),o&&(i.curY=n.curY),n=Ze(i,t,n),i={};var s=!1;return(n=n||Je()).curX<=a.min?pe?(s=!0,i.curBodyX=n.curX-a.min):(i.curX=n.curX+(a.min-n.curX)/I,i.curBodyX=te?i.curX-a.min:0):n.curX>=a.max&&(he?(s=!0,i.curBodyX=n.curX-a.max):(i.curX=n.curX+(a.max-n.curX)/I,i.curBodyX=te?i.curX-a.max:0)),n.curY<r.min?o?i.curY=r.min:fe||(i.curY=n.curY+(r.min-n.curY)/I):n.curY>r.max&&(o?i.curY=r.max:fe||(i.curY=n.curY+(r.max-n.curY)/I)),n=Ze(i,t,n),t?n:s}function yt(e,t){var n=!1,i={},a=tt((t=t||Je()).currentScale),r=nt(t.currentScale),o=!ue&&!r.max&&!r.min||_e||!St()&&!fe;return fe&&(i.curX=0),o&&(i.curY=t.curY),t.curX<a.min?(i.curX=a.min,i.curBodyX=0,n=!0):t.curX>a.max&&(i.curX=a.max,i.curBodyX=0,n=!0),t.curY<r.min?(i.curY=r.min,n=!0):t.curY>r.max&&(i.curY=r.max,n=!0),t=Ze(i,e,t),e?t:n}function St(){return!b&&(!!S||!Zt.restriction&&Qt[Zt.src])}function kt(e){if(scrollTop()||scrollTop(0),!De){if(e&&"mousedown"==e.type&&preventEvent(e),e.touches&&e.touches.length||!g){if(ot(),!de&&!ue){Le=x(e);var t=tt(le);ie<=t.min&&(pe=!1!==an(Xt+1)),ie>=t.max&&(he=!1!==an(Xt-1))}if(de||b)me=ve=Ae=!1,be=!1;else{clearTimeout(we);var n=x(e);me&&vkNow()-me<500&&ve&&(i=n,r=(a=ve).pageX-i.pageX,o=a.pageY-i.pageY,Math.sqrt(r*r+o*o)<50)?(Ae=vkNow(),be=!1):(me=vkNow(),ve=n,be=vkNow())}b||(de=!0)}var i,a,r,o;ue||(te=!0,H(!0)),Te=x(e),dt(),ut(Te),bt(Te)}}function Ct(e){if(!De&&(preventEvent(e),de)){if(me=ve=Ae=!1,be=!1,ut(Te=x(e)),Re){if(!(Re<vkNow()))return void dt();Re=!1,bt(Te),q()}if(Le&&!_e&&!fe){var t=Math.abs(Te.pageX-Le.pageX),n=Math.abs(Te.pageY-Le.pageY),i=nt(le);if(!(n>5||t>5))return;n>5&&t<=5&&(1!=le||ue||b||S?(i.max||i.min)&&(pe=he=!1):(fe=!0,ye&&(Oe=!0),Nt(!1),Pt(Te.pageY-Le.pageY>0))),Le=!1,bt(Te)}!wt(Te)||_e||fe||b||(_e=!0,Te.pageX),function(){if(!fe)return;var e=Math.abs(ae),t=pa.height/2;He=1-.5*e/t}(),q(),_e&&Math.abs(ne)>getCw()&&jt(extend({originalEvent:e},e,{touches:[]}))}}function jt(e){if(!De)if(xe)xe=!1;else{if(preventEvent(e),e.touches&&!e.touches.length||!g){var t=lt();if(_e)c=t,l=(pa.width||getCw())/2,c=c||0,((ne<-l||c<-1)&&pe?(st(),1):(ne>l||c>1)&&he?(ct(),1):(yt()&&q(300),0))&&(Xe(),H(!0));else if(fe)at(t);else if(Ae&&vkNow()-Ae<1e3){!function(e){if(!St())return!1;var t=it(),n={pageX:X,pageY:Z},i=(le>1?1:t.max)/ee,a=Je(),r=null;r=yt(!0,r=wt(n,!0,r=mt(i,!0))),e&&(r=yt(!0,r=ft(e,!0,r)));var o=_t(a,r);o&&(Y(o),z(a),Ne=!0),Ne&&(Dt(!1,!0),xt(!1,!0)),mt(i),wt(n),yt(),e&&(ft(e),yt()),Ne?z(r,300,!1,pt):q(300),ht(le),Ft()}(r=e&&Se&&(hasClass("zpv_tag",e.target)?e.target:gpeByClass("zpv_tag",e.target))),me=ve=Ae=!1}else yt()?q(300):t&&(yt(),q(t,"cubic-bezier(0, 1, 1, 1)"));if(setTimeout((function(){G()}),300),be)if(vkNow()-be>700||e&&"touchcancel"==e.type)be=!1;else{if(be=!1,e)var n=hasClass("zpv_header",e.target)?e.target:gpeByClass("zpv_header",e.target),i=hasClass("zpv_zoom_btns",e.target)?e.target:gpeByClass("zpv_zoom_btns",e.target),a=hasClass("zpv_bottom_body",e.target)?e.target:gpeByClass("zpv_bottom_body",e.target),r=Se&&(hasClass("zpv_tag",e.target)?e.target:gpeByClass("zpv_tag",e.target)),o=je&&e.target.closest(".Photo__marketTag"),s=Se&&e.target.closest(".Photo__marketShowMoreButton");e&&(n||i||a||r||o||s)?r?function(e,t){if(!Pe)return!1;if(!Se)return!0;N(e);if(hasClass("zpv_tag_selected",e))return hasClass("zpv_tl_wrap",t.target)||gpeByClass("zpv_tl_wrap",t.target)?_a.go(e,t):(At(e),cancelEvent(t),!1);ke&&(me=ve=Ae=!1),removeClass("zpv_tag_selected",ke),ke=e,Rt(e),addClass("zpv_tag_selected",ke);ye&&(Oe=!0);Nt(!1),At(e),cancelEvent(t)}(r,e):i?(me=ve=Ae=!1,hasClass("zpv_zoomin",e.target)||gpeByClass("zpv_zoomin",e.target)?function(e){!!Pe&&(da.highlight=!1,da.end(e),ue||_e||it().max<=le||(cancelEvent(e),gt(S?1.25:1.45)))}(e):function(e){!!Pe&&(da.highlight=!1,da.end(e),ue||_e||it().min>=le||(cancelEvent(e),gt(S?.8:1)))}(e)):o?_a.go(o.dataset.url):s&&Yi._openItemsPopup(s.dataset.itemsJson):ke?qt(e):S||(we=setTimeout((function(){Nt(),Dt(ye),xt(!ye)}),500))}de=!1,_e=pe=he=!1,dt()}var c,l;e.touches&&(e.touches.length>1||1==e.touches.length&&_e)&&bt(Te=x(e)),(e.touches&&!e.touches.length||!g)&&(Le=!1)}}function Et(e){if(!De&&(preventEvent(e),me=ve=Ae=!1,be=!1,dt(),!_e&&!fe)){re=1,ee=le,ue=!0,pe=he=!1;var t=tt(le);(t.min>=-5||t.max<=5)&&(te=!1,H(!1)),bt(x(e)),Dt(!1,!0),xt(!1,!0)}}function Tt(e){De||(preventEvent(e),me=ve=Ae=!1,be=!1,dt(),_e||fe||(Ie=x(e),mt(e.scale),wt(Ie),q(),Ft()))}function It(e){De||(preventEvent(e),me=ve=Ae=!1,be=!1,dt(),_e||fe||(vt()&&((e.touches&&e.touches.length||!g)&&wt(Ie),yt(),q(100),Re=vkNow()+100),ue=!1,Dt(ye,!0),xt(!ye,!0)))}function Mt(e){var t=it(),n=e<t.max,i=e>t.min;toggleClass("zpv_zb_disabled",c,!n),toggleClass("zpv_zb_disabled",l,!i)}function Pt(e){e?setStyle(a,{top:-35,bottom:"auto"}):setStyle(a,{top:"auto",bottom:-35}),a.is_down=e}function Dt(e,t){var n=Se;if(e){if(!St())return;if(!ye&&!Oe||ue)return}Se=e,e&&Bt(le,oe,se,t||n!==e),n!==e&&(e&&Rt(ke),Lt(h,e,t))}function xt(e,t){var n=je;Zt.restriction&&(e=!1,t=!0),je=e,e&&Bt(le,oe,se,t||n!==e),Lt(m,e,t)}function Lt(e,t,n){e&&setStyle.animate(e,!n&&"opacity",{duration:200,func:"linear"},(function(){setStyle(e,"visibility",t?"visible":"hidden")})),e&&setStyle(e,"visibility",t||!n?"visible":"hidden"),e&&setStyle(e,"opacity",t?1:0)}function Bt(e,t,n,i){if(!ue){var a=pa.width||getCw(),r=pa.height||getCh(),o=L(_),s=a/o.width,c=r/o.height,l=Math.min(1,s,c),u=o.width*l*e,d=o.height*l*e,f=a/2-u/2+t*e,p=r/2-d/2+n*e;Se&&(i&&h&&setStyle.animate(h),setStyle(h,{width:Math.round(u),height:Math.round(d)}),setStyle.transform(h,{translate:[Math.round(f),Math.round(p)]})),je&&(i&&m&&setStyle.animate(m),setStyle(m,{width:Math.round(u),height:Math.round(d)}),setStyle.transform(m,{translate:[Math.round(f),Math.round(p)]}),Ee||(!function(){function e(e,t){var n=e.getBoundingClientRect(),i=m.getBoundingClientRect();n.left<i.left+t?e.style.left=i.left-n.left+t+"px":n.right>i.left+i.width-t&&(e.style.left=i.left+i.width-n.right-t+"px")}m&&Array.from(m.children).forEach((function(t){if(t.classList.contains("Photo__marketTag")){var n=t.$(".Photo__marketTagInner"),i=t.$(".Photo__marketTagArrow");e(n,10),e(i,20)}}))}(),Ee=!0)),i&&v&&setStyle.animate(v),setStyle(v,{width:Math.round(u),height:Math.round(d)}),setStyle.transform(v,{translate:[Math.round(f),Math.round(p)]})}}function Rt(e){if(e){var t=L(_),n=pa.width||getCw(),i=pa.height||getCh(),a=n/t.width,r=i/t.height,o=Math.min(1,a,r),s=t.width*o*le,c=t.height*o*le,l=N(e).coords,u=geByClass1("zpv_tl",e),d=getW(u),f=getH(u),p=l.x*s/100,h=l.y*c/100,m=l.w*s/100,v=l.h*c/100,g=p+m/2-d/2,A=h+v+5,b=n>s?0-(n-s)/2:0,w=n>s?s+(n-s)/2:s,y=i>c?c+(i-c)/2:c,O=0,S=0;g<b+2?O=b+2-g:g+d>w-2&&(O=w-2-g-d),A+f>y-5&&(S=v>3*f?y-5-A-f:-v-f-10),setStyle.transform(u,{translate:[Math.ceil(O),Math.ceil(S)]})}}function Nt(e){if(void 0!==e){if(ye===e)return;ye=!e}else Oe=!1;setStyle(n,"width","auto"),n&&setStyle.animate(n,"opacity",{duration:200,func:"linear"},(function(){setStyle.animate(n),setStyle(n,"width",ye?"auto":0)})),ye?(setStyle(n,"opacity",0),ye=!1):(setStyle(n,"opacity",1),ye=!0)}function Ft(){pa.height<604&&!ke&&!S&&(le>1.25?(ye&&(Oe=!0),Nt(!1)):Oe&&(Oe=!1,Nt(!0)))}function Ht(e){Pe&&(de||ue||_e||e&&e.touches&&e.touches.length>1||(cancelEvent(e),ma.close()))}function Vt(e){if(!(de||ue||_e||!e||e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var t=tt(le);37==e.keyCode?(cancelEvent(e),ie>=t.max&&!1!==an(Xt-1)&&(H(!0),ct())):39==e.keyCode?(cancelEvent(e),ie<=t.min&&!1!==an(Xt+1)&&(H(!0),st())):27==e.keyCode&&Ht(e)}}function Wt(){S?fn():(ln(),dn(Xt),$t())}function $t(){Dt(Se,!0),xt(je,!0),Bt(le,oe,se)}function qt(e,t){return!(!Pe&&!t)&&(!ke||(removeClass("zpv_tag_selected",ke),ke=!1,Oe&&le<=1.25&&(Oe=!1,Nt(!0)),cancelEvent(e),!1))}function zt(e){"touchstart"==e.type?Pe=!e.touches||1==e.touches.length:"touchmove"==e.type?(Pe=!1,preventEvent(e)):"click"==e.type&&(Pe||(cancelEvent(e),Pe=!0))}function Yt(e){"touchstart"==e.type?De=!0:"touchmove"==e.type?(De=!0,preventEvent(e)):(De=e.touches&&e.length,xe=!De)}function Gt(){Kt&&Kt[Xt]&&Kt[Xt].restriction&&"blur"===Kt[Xt].restriction.type&&delete Kt[Xt].restriction,Wt()}var Kt=!1,Qt={},Xt=!1,Jt=!1,Zt=!1,en=!1,tn=!1;function nn(e,t,n,i){var a=t||len(e);if(e&&!n||(Kt=null),Kt||(Kt=new Array(a)),Kt.length!=a){var r=Kt;Kt=new Array(a),extend(Kt,r)}e=e.map((function(e){return e&&e.restriction&&"block"===e.restriction.type&&(e.src="/images/mobile/blank.gif"),e})),extend(Kt,e);var o=function(e){for(var t in Kt)if(Kt[t].id==e)return+t;return-1}(Zt.id);-1==o&&(o=Xt),i||dn(o)}function an(e){return!(e>=Kt.length)&&(!(e<0)&&(Kt[e]||{src:!0}))}function rn(e,t,n){var i=L(e),a=et();S&&(Kt[0].loaded=t,t&&(i.width>i.height?setStyle(e,{height:a.height}):setStyle(e,{width:a.width}),setStyle(e,{minWidth:0,maxWidth:"none"})),fn(!0));if(un()){if(2*i.width>=a.width){var r=a.width/(i.width||i.clientWidth);if(i.height*r>=a.height)return;re=r,ee=r,le=r,setStyle.transform(_,r)}"VIDEO"===e.tagName&&e.play()}show(e),_===e&&(Dt(t,!t),xt(t&&!ye,!t))}function on(e,t){if(void 0===t&&(t=!1),Qt[e])sn(e);else if(t){var n=ce("video",{src:e}),i=!1,a=function(){i||(i=!0,Qt[e]=!0,sn(e),n=null)};addEvent(n,"canplay",a),addEvent(n,"onload",a),n.load()}else{var r=new Image;r.addEventListener("load",(function t(){Qt[e]=!0,sn(e),ln(),$t(),r.removeEventListener("load",t),r=null}),!1),r.src=e}}function sn(e){[_,f,p].forEach((function(t){var n=gpeByClass("zpv_thumb_item",t),i=attr(t,"data-src");i===e&&(t.src=i,rn(t,!0),"VIDEO"!==t.tagName&&removeClass("zpv_ti_loading",n),attr(t,"data-src",!1),un()&&statlogsValueEvent("gif_play",0,"VIDEO"===t.tagName?"mp4":"gif"))}))}function cn(e,t,n,i){void 0===i&&(i=!1);var a=gpeByClass("zpv_thumb_item",e);i&&(addClass("zpv_ti_loading",a),setTimeout((function(){setStyle(_,{display:"block"})}))),i&&(n=!1),t?!0!==t?e.src===t?rn(e,!0):Qt[t]?(e.src=t,rn(e,!0)):(n?(e.src=n,rn(e,!1)):hide(e),attr(e,"data-src",t),on(t,i),addClass("zpv_ti_loading",a)):(n?(e.src=n,rn(e,!1)):hide(e),addClass("zpv_ti_loading",a)):hide(e)}function ln(){if(w){!function(){window.lang;var e="";if(un())e=getLang("mobile_gif_popup_title");else{e=getLang("mobile_photos_photoview_header")||"";var t=!1!==Me?Me:Xt;e=(e=e.replace("%s",t+1)).replace(/%s|{count}/,Kt.length)}val("zpv_summary",e)}(),Mt(le);var e,t=an(!1!==Me?Me:Xt);if(S||O||t&&!0!==t.src){if(!S&&!O){var n="";each(t.tags,(function(e,t){if(!e||0==e)return!0;var i=F(t),a=i.coords,r=i.href?' data-href="'+i.href+'" data-name="'+escapeAttr(i.name)+'"':"",o=i.al?(i.href?" al"+i.al:"")+" "+i.al:"";n+='<div class="zpv_tag'+o+'" style="left: '+a.x+"%; top: "+a.y+"%; width: "+a.w+"%; height: "+a.h+'%;" data-id="'+e+'"'+r+'><div class="fill"></div><div class="zpv_tl_wrap" id="zpv_tl_wrap"><div class="zpv_tl'+(i.href?"":" zpv_tl_plain")+'">'+htsc(i.name)+"</div></div></div>"}));var a,s="",c=t.market_tags&&t.market_tags.tags,l=c&&c.length&&!t.restriction,u="";l&&(u=d.default.html((e={items:escape(JSON.stringify(c))},{inner:[{inner:[Object(R.default)(Object(Wi.getMarket16Icon)())],class:"Photo__marketShowMoreButtonIcon",tag:"div"},Object(J.getLang)("mobile_photos_show_market_items")],class:"Photo__marketShowMoreButton","data-items-json":e.items,tag:"div"})),c.forEach((function(e){s+=d.default.html(function(e){var t=e.y<.5,n=100*e.x,i=100*e.y;return{inner:[{inner:[{inner:[e.title],class:"Photo__marketTagTitle",tag:"div"},{inner:[e.price],class:"Photo__marketTagPrice",tag:"div"},{inner:[Object(R.default)(Object(Vi.getGotoArrowBlackIcon)())],class:"Photo__marketTagIcon",tag:"div"}],class:"Photo__marketTagInner "+(t?"Photo__marketTagInner--down":""),tag:"div"},{class:"Photo__marketTagArrow "+(t?"Photo__marketTagArrow--down":""),tag:"div"}],class:"Photo__marketTag","data-url":e.url,style:"left: "+n+"%; top: "+i+"%",tag:"div"}}(e))})));var f=L(_);t.restriction&&"blur"===t.restriction.type&&!Object(la.isCleared)("photo"+t.id)?(Dt(!1,!0),xt(!1,!0),a=Object(Ut.default)(Object(B.default)({},t.restriction,{raw:"photo"+t.id,width:f.width,height:f.height}))):t.restriction&&"block"===t.restriction.type&&(a=Object(Ut.default)(t.restriction)),val(h,n),val(m,s),val(v,a?d.default.html(a):null),val(r,'<div class="zpv_photo_desc">'+(t.caption||"")+"</div>"+u+'<div class="zpv_bottom_bg"></div>'),toggle(r,!!t.caption||!!l);var p="";if(y||_a.getQuery("community")||!k)p="";else{var g=t.tags&&t.tags[0]||0;p="<tr>"+('<td class="row_table_column"><a href="'+t.like_url+'" class="item_button item_like'+(t.likes_me?" item_likes_me":"")+'" onclick="return photoview.likePhoto(this, \''+t.id+'\');"><i class="i_icon i_like"></i>'+(t.likes_cnt?'<b class="v_value v_like">'+formatNum(t.likes_cnt)+"</b>":"")+"</a></td>")+('<td class="row_table_column"><a href="'+t.photo_url+'#comments" class="item_button item_replies al_photo" onclick="return photoview.openPhoto(this, event, true);"><i class="i_icon i_replies"></i>'+(t.replies_cnt?'<b class="v_value v_replies">'+t.replies_cnt+"</b>":"")+"</a></td>")+('<td class="row_table_last_column"><a href="'+t.photo_url+'" class="item_button item_tags al_photo" onclick="return photoview.openPhoto(this, event);"><i class="i_icon i_tags"></i>'+(g?'<b class="v_value v_tags">'+g+"</b>":"")+"</a></td>")+"</tr>"}val(o,p),ca(t.photo_url),show(i)}}else hide(i)}}function un(){return Zt.isDoc}function dn(e){if(w){Xt=Math.max(0,Math.min(e||0,Kt.length)),Zt=an(Xt),tn=an(Xt-1),en=an(Xt+1),_.classList.toggle("zpv_img--blur",!!Zt.restriction&&"blur"===Zt.restriction.type&&!Object(la.isCleared)("photo"+Zt.id)),p.classList.toggle("zpv_img--blur",!!en.restriction&&"blur"===en.restriction.type&&!Object(la.isCleared)("photo"+en.id)),f.classList.toggle("zpv_img--blur",!!tn.restriction&&"blur"===tn.restriction.type&&!Object(la.isCleared)("photo"+tn.id));var t=et();[_,p,f].forEach((function(e,n){var i;0===n?i=Zt:1===n?i=en:2===n&&(i=tn);var a=i.restriction&&"blur"===i.restriction.type&&(!window.CSS||!CSS.supports("filter: blur(20px) brightness(0.75) contrast(1.25)"));e.classList.toggle("zpv_img--blurUnsupported",!a),e.classList.toggle("zpv_img--block",i.restriction&&"block"===i.restriction.type);var r,o,s=domData(e,"fake-size");i.restriction&&"block"===i.restriction.type?(o=Math.max(Math.min(t.width,600),400),r="600,600"):(s||i.restriction&&"blur"===i.restriction.type)&&(o=Math.max(Math.min(t.width,600),400),r=t.width+","+o),i.restriction&&"block"===i.restriction.type||i.restriction&&!Object(la.isCleared)("photo"+i.id)||(r=null,o=null),setStyle(e,{"min-height":o||null}),domData(e,"fake-size",r||null)})),cn(_,Zt.src,"/images/mobile/blank.gif",Zt.hasVideo),cn(p,en.src),cn(f,tn.src),ln(),$t(),ma.onUpdate&&ma.onUpdate()}}function _n(){if(w&&O&&Kt){var e=Kt[0];if(!e.loaded&&e.progress){var t=geByClass1("zpvu_progress","zpv_center");setStyle(t,{width:100*e.progress+"%",visibility:"visible"})}if(!e.read&&e.thumb){e.read=!0;var n=geByClass1("zpv_upload_box","zpv_center"),i=geByClass1("zpv_upload_img",n);setStyle(i,{backgroundImage:"url("+e.thumb+")"}),removeClass("zpv_thumb_uploading",n)}}}function fn(t){if(w&&S&&Kt){var n=Kt[0],i=!!n.saving;if(toggleClass("item_disabled","zpv_save_button",i||!n.loaded),toggleClass("item_disabled","zpv_cancel_button",i),toggleClass("zpv_crop_saving",e,i),b=i,t||cn(_,n.src,"/images/mobile/blank.gif"),n.loaded&&n.rect&&!n.rect_inited){n.rect_inited=!0;var a=et(),r=n.rect[0],o=n.rect[1],s=n.rect[2],c={};c.currentScale=1/s,Ze(c),vt(),yt(),c={};var l=(_.width||_.clientWidth)*le,u=(_.height||_.clientHeight)*le,d=r*l,f=o*u;c.curX=(l-a.width)/2-d,c.curY=(u-a.height)/2-f,Ze(c),yt(),q(0)}}}function pn(u,d){void 0===u&&(u=!1),void 0===d&&(d=!1),w||(be=!1,we=!1,ye=!0,Oe=!1,Me=!1,Pe=!0,De=!1,xe=!1,Fe=!1,He=!1,b=!1,y=!1,O=!1,S=!1,Xe(),function(u,d){void 0===u&&(u=!1),void 0===d&&(d=!1);var g=window.lang,A="";A=u?Zi(d):'<div id="z_photoview" scheme="space_gray"><div class="zpv_siblings"><div id="zpv_left" class="zpv_thumb_item"><img class="zpv_img" alt=""></div><div id="zpv_right" class="zpv_thumb_item"><img class="zpv_img" alt=""></div></div><div class="zpv_body"><div id="zpv_center" class="zpv_thumb_item"><img class="zpv_img" alt=""></div></div><div class="zpv_close_msg_wrap"><div class="zpv_close_msg">'+g.mobile_zphoto_move_to_close+'</div></div><div class="zpv_controls"><div class="mhead zpv_header"><a class="zpv_close_btn" onclick="return photoview.closePhoto(event);"><i class="zpv_close_icon"></i></a><div class="hb_wrap"><h1 id="zpv_summary" class="hb_btn mh_header"></h1></div></div><div class="zpv_zoom_btns"><a class="zpv_zoom_btn zpv_zoomin"><b class="zpv_zb_wrap"><i class="i_icon"></i></b></a><a class="zpv_zoom_btn zpv_zoomout"><b class="zpv_zb_wrap"><i class="i_icon"></i></b></a></div><div class="zpv_bottom"><div class="zpv_photo_desc_wrap"></div><div class="zpv_bottom_body"><table class="zpv_values like_box row_table"></table></div></div></div><div class="zpv_restriction"></div><div class="zpv_tags"></div><div class="zpv_market_tags"></div><div class="zpva zpv_crop"><div class="zpv_crop_box"></div><div class="zpv_crop_loading"></div></div></div>';var b="/images/mobile/zpv_icons"+(hasClass("x2",window.bodyNode)?"_2x":"")+".png?2";(new Image).src=b,pa.create(A,hn),e=ge("z_photoview"),geByClass1("zpv_body",e),t=geByClass1("zpv_siblings",e),n=geByClass1("zpv_controls",e),s=geByClass1("zpv_zoom_btns",e),a=geByClass1("zpv_close_msg_wrap",e),i=geByClass1("zpv_bottom",e),r=geByClass1("zpv_photo_desc_wrap",e),o=geByClass1("zpv_values",i),c=geByClass1("zpv_zoomin",s),l=geByClass1("zpv_zoomout",s),h=geByClass1("zpv_tags",e),m=geByClass1("zpv_market_tags",e),v=geByClass1("zpv_restriction",e),geByClass1("zpv_crop",e),_=geByClass1("zpv_img","zpv_center"),f=geByClass1("zpv_img","zpv_left"),p=geByClass1("zpv_img","zpv_right"),"VIDEO"===_.tagName&&(_.controls=!1)}(u,d),function(){if(g=void 0!==document.ontouchmove,A=!1,Ut.default.onClear(Gt),g){var t=geByClass1("zpv_header",e),n=geByClass1("zpv_bottom_body",e);addEvent(t,"touchstart touchmove touchend touchcancel",Yt),addEvent(n,"touchstart touchmove touchend touchcancel",Yt),addEvent(e,"touchstart touchmove click",zt),addEvent(e,"touchstart",kt),addEvent(e,"touchmove",Ct),addEvent(e,"touchend touchcancel",jt),A?(addEvent(e,"gesturestart",Et),addEvent(e,"gesturechange",Tt),addEvent(e,"gestureend",It)):(addEvent(e,"touchstart",Ye),addEvent(e,"touchmove",Ge),addEvent(e,"touchend touchcancel",Ke),addEvent(e,"gesturestart gesturechange gestureend",cancelEvent))}else addEvent(e,"mousedown",kt),addEvent(e,"mousemove",Ct),addEvent(window,"mouseup",jt),addEvent(window,"mousewheel",Qe),addEvent(window,"keydown",Vt)}(),w=!0,reflow(e),scrollTop()||scrollTop(0))}function hn(){w&&(!function(){if(Ut.default.onClear("__clear",Gt),g){var t=geByClass1("zpv_header",e),n=geByClass1("zpv_bottom_body",e);removeEvent(t,"touchstart touchmove touchend touchcancel",Yt),removeEvent(n,"touchstart touchmove touchend touchcancel",Yt),removeEvent(e,"touchstart touchmove click",zt),removeEvent(e,"touchstart",kt),removeEvent(e,"touchmove",Ct),removeEvent(e,"touchend touchcancel",jt),A?(removeEvent(e,"gesturestart",Et),removeEvent(e,"gesturechange",Tt),removeEvent(e,"gestureend",It)):(removeEvent(e,"touchstart",Ye),removeEvent(e,"touchmove",Ge),removeEvent(e,"touchend touchcancel",Ke),removeEvent(e,"gesturestart gesturechange gestureend",cancelEvent))}else removeEvent(e,"mousedown",kt),removeEvent(e,"mousemove",Ct),removeEvent(window,"mouseup",jt),removeEvent(window,"mousewheel",Qe),removeEvent(window,"keydown",Vt)}(),e=t=n=a=!1,i=o=!1,s=c=l=!1,_=f=p=h=!1,v=!1,w=!1,Kt=null)}return{onShow:Object(u.default)(),onHide:Object(u.default)(),likePhoto:function(e,t){return!!Pe&&(da.highlight=!1,da.end(),window.Unauthorized?(window.Unauthorized.onActionClick(null,"like","photo"+t),!1):(Zt.likes_me?(Zt.likes_me=!1,--Zt.likes_cnt):(Zt.likes_me=!0,++Zt.likes_cnt),ln(),ua.click(e,extend({photo_id:t},fa))))},openPhoto:function(e,t,n){var i=window.cur;if(!Pe)return!1;var a=i.replyNames,r=Ot.default.getStickerPanel(),o=Ot.default.getStickers(),s=_a.go(e,t,{local:!0,fast:!0,beforeAppend:function(e){val(geByClass1("mcont",e),'<div class="pcont"><div class="media_view photo_view"><div class="pv_summary"><div class="summary_loading" style="display: none;"><i class="i_loading"></i></div></div><div class="pv_tag_wrap"></div><div class="pv_body pv_touch pv_touch_full pv_hidden_icons"><a class="thumb_item"><div class="pv_photo_wrap" id="pv_photo_tags" onclick="return photo.closeTags(event);"><img src="/images/mobile/blank.gif" class="ph_img" alt="" /></div></a><div class="pv_nav"><table class="row_table pv_nav_cont"><tr><td class="pv_nav_left"><a class="pv_nav_link"><span class="pv_icon"><i class="i_icon"></i></span></a></td><td class="pv_nav_z"><a class="pv_nav_link"><span class="pv_icon"><i class="i_icon"></i></span></a></td><td class="pv_nav_right"><a class="pv_nav_link"><span class="pv_icon"><i class="i_icon"></i></span></a></td></tr></table></div></div><div class="pv_footer"></div></div></div>'),val("m",e.innerHTML)}});if(extend(i,{replyNames:a,sticker_panel:r,stickers:o,processNav:function(e){var t;if(t=/^\/photo(-?\d+_\d+)$/i.exec(e.nav.path)){var n=qs2obj(e.nav.params),i=qs2obj(_a.params);if(n.act)return!1;if(n.offset!=i.offset)return!1;if(n.list!=i.list&&!i.z)return!1;if(n.reply!==i.reply)return!1;if(n.reply_to!==i.reply_to)return!1;e.onPreNav&&e.onPreNav();var a=n.list||"",r=n.rev?"/rev":"";return!ha.open(t[1],a+r,null,n.from,!0)}return!1}}),i.destroy.push((function(){ha.clear()})),window.lang,!s&&!(s=_a.go(e,t,{force:!0}))){if(pa._lastNav){var c=pa._lastNav,l=qs2obj(c.params);delete l.z,c.path+obj2qs(l)+c.hash}ha.showIcons()}return!0},closePhoto:Ht,savePhoto:function(e,t){if(!Pe)return!1;if(da.highlight=!1,da.end(),hasClass("item_disabled",e))return!1;if(!S||!Kt)return!1;var n=Kt[0],i=et(),a=_.width*le,r=(_.height||_.clientHeight)*le,o=(a-i.width)/2-ie,s=(r-i.height)/2-ae,c=1/le,l=o/a,u=s/r;return n.onSelect&&n.onSelect(l,u,c),!1},cancelPhoto:function(e,t){return!!Pe&&(da.highlight=!1,da.end(),!hasClass("item_disabled",e)&&Ht())},onClose:null,onUpdate:null,onPhotoChange:null,saveSource:nn,_toggleTouches:function(e){ma.opened()&&(b=!e,e||(de=!1))},opened:function(){return w},openCrop:function(t,n){n=n||{};var a=!w;O?O=!1:pn(),S=!0,b=!1,Kt=[t],a&&(pa.open(),pa.onResize=Wt),function(){if(w&&S){var t=window.lang;val("zpv_summary",t.mobile_zphoto_owner_crop_header),removeClass("zpv_mode_[a-z]+",e,!0),addClass("zpv_mode_crop",e),Mt(le),_.parentNode||(val("zpv_center",""),append(_,"zpv_center"));var n='<tr><td class="row_table_column"><a class="item_button" id="zpv_save_button" onclick="return photoview.savePhoto(this);"><span class="v_value">'+t.mobile_zphoto_save_btn+'</span></a></td><td class="row_table_last_column" width="50%"><a class="item_button" id="zpv_cancel_button" onclick="return photoview.cancelPhoto(this);"><span class="v_value">'+t.mobile_zphoto_cancel_btn+"</span></a></td></tr>";val(o,n),o.classList.add("zpv_values--upload"),show(i),fn()}}()},updateCrop:function(e){if(!Kt)return!1;e=extend(Kt[0]||{},e),Kt=[e],fn()},openUpload:function(t,n){n=n||{},pn(),O=!0,b=!0,Kt=[t],pa.open(),pa.onResize=Wt,function(){if(w&&O){var t=window.lang;val("zpv_summary",t.mobile_zphoto_upload_header),removeClass("zpv_mode_[a-z]+",e,!0),addClass("zpv_mode_upload",e);remove(_),val("zpv_center",'<div class="zpva zpv_upload_box zpv_thumb_uploading"><div class="zpv_upload_img"></div><div class="zpvu_progress_wrap"><div class="zpvu_progress"></div></div></div>');var n='<tr><td class="row_table_column" width="50%"><a class="item_button item_disabled" onclick="return false;"><span class="v_value">'+t.mobile_zphoto_save_btn+'</span></a></td><td class="row_table_last_column" width="50%"><a class="item_button" onclick="return photoview.cancelPhoto(this);"><span class="v_value">'+t.mobile_zphoto_cancel_btn+"</span></a></td></tr>";val(o,n),o.classList.add("zpv_values--upload"),show(i),_n()}}()},updateUpload:function(e){if(!Kt)return!1;e=extend(Kt[0]||{},e),Kt=[e],Zt=!1,_n()},open:function(e,t,n){var i,r;ma.onShow(),pn((n=n||{}).isDoc,n.hasVideo),y=n.local||!1,k=!1!==n.showControls,t&&nn(t,!1,!1,!0),dn(e),Jt=0,pa.open(),pa.onResize=Wt,i=geByClass1("zpv_close_msg",a),r=getW(i),setStyle(a,{width:r||250})},close:function(){ma.onHide(),ma.onClose&&ma.onClose({local:y})||pa.close()}}}();window.photoview=ma;n("ldCb");window.FeedNotifications={webActionsAcceptHandlers:{reveal_bdya:function(e,t,n,i,a){var r=gpeByClass("_block",e);return ajax.post("profileEdit.php",{act:"reveal_birthday",from:"feed_assistance",hash:a},{onDone:function(e){var t=window.Snackbar;t&&t.init&&t.init({text:e.msg}),remove(r)}}),!0}},webActionsDeclineHandlers:{},withoutNavActions:["enable_browser_notifications","reveal_bdya"],hide:function(e){function t(t,n,i,a,r,o,s,c){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,n,i,a,r,o,s){var c={_ajax:1,act:"hide_internal_notification",reason:i,id:t,hash:n},l={},u=gpeByClass("_block",e),d=!0;if("decline"==i){var _=this.webActionsDeclineHandlers[r];d=this.runActionHandler(_,e,c,l,o,n),hide(u)}else{var f=this.webActionsAcceptHandlers[r];d=this.runActionHandler(f,e,c,l,o,n),lockButton(e),"add_custom_newsfeed"==r&&(Object(Nn.setCookie)("remixcustom_feed_added",o),c.action=r,c.action_section=o.section,c.action_hash=o.hash)}return l.onDone=function(){"compact"===s&&"accept"===i||cur.destroy.push((function(){return remove(u)})),~this.withoutNavActions.indexOf(r)||nav.go(e,a)}.bind(this),l.onFail=function(){unlockButton(e)},Promise.resolve(d).then((function(e){(e||isUndefined(e))&&ajax.post("/index.php",c,l)})),!1})),runActionHandler:function(e,t,n,i,a,r){return!isFunction(e)||e(t,n,i,a,r)},addWebActionAcceptHandler:function(e,t){this.webActionsAcceptHandlers[e]=t},addWebActionDeclineHandler:function(e,t){this.webActionsDeclineHandlers[e]=t}},function(){function e(){if(geByClass1("tabs_block_hideable")){var e=geByClass1("tabs_block");geByClass1("tabs_list").offsetHeight>geByClass1("tabs_list_more").offsetHeight?removeClass("tabs_block_without_show_more",e):addClass("tabs_block_without_show_more",e)}}onDOMReady(e),onBodyResize(e),window.Tabs={actualizeShowMoreVisibility:e,toggle:function(e){var t=gpeByClass("tabs_block",e);hasClass("tabs_block_opened",t)?Object(Nn.setCookie)("remixm_tabs_expanded","",-1):Object(Nn.setCookie)("remixm_tabs_expanded",1),toggleClass("tabs_block_opened",t)}}}(),window.Podcast={toggleFave:function(e,t,n){var i="snippet__favorite_active",a=hasClass(e,i);ajax.post("fave.php",{act:"fave_podcast",add:!a,hash:n,audio_id:t,ref:cur.module}),attr(e,"aria-label",a?lang.mobile_bookmarks_actions_add:lang.mobile_bookmarks_actions_remove),a?removeClass(e,i):addClass(e,i)},onOpenClick:function(e,t){var n=$(".snippet__popup",e.closest(".snippet")),i="";cur&&cur.module?i=cur.module:nav&&"/feed"===nav.cur?i="feed":!nav||"/feed?section=podcasts"!==nav.cur&&"/feed/podcasts"!==nav.cur||(i="feed_podcasts"),statlogsValueEvent("mvk_podcasts_actions","mvk_open_popup",t,i),Ln.default.open(n,!0)}};var va=n("p5n7");function ga(e,t){var n=Object(r.ge)("select-copyright"),i=Object(F.$)('input[name="copyright"]'),a=Object(F.$)(".create_post__source-option"),o=Object(F.$)(".Btn__text",a);e?(n.style.display="inline-block",n.onclick=function(n){return window.posting.openCopyright(n,!0,t,encodeURIComponent(e))},a.onclick=function(n){return window.posting.openCopyright(n,!0,t,encodeURIComponent(e))},o.innerHTML=Object(J.getLang)("mobile_wall_post_copyright_edit_button")):(a.onclick=function(n){return window.posting.openCopyright(n,!1,t,encodeURIComponent(e))},Object(r.setStyle)(a,"display","table"),o.innerHTML=Object(J.getLang)("mobile_wall_post_copyright_add_button"),Object(r.hide)(n)),Object(r.val)(i,e),window.post.checkCopyright()}var Aa={open:function(e,t,n){void 0===e&&(e=!1),void 0===n&&(n="");var i=new RegExp("{link}(.*){/link}"),a=i.exec(Object(J.getLang)("mobile_wall_post_copyright_mb_text"))[1],o="/@adminsclub-citation?from="+encodeURIComponent(nav.cur),s=Object(J.getLang)("mobile_wall_post_copyright_mb_text").replace(i,"<a onclick=\"Popup.close(this); nav.go('"+o+'\', null)" href="'+o+'">'+a+"</a>"),c=Object(In.default)({class:"AddCopyrightPopup",header:{title:e?Object(J.getLang)("mobile_wall_post_copyright_mb_title_text_edit"):Object(J.getLang)("mobile_wall_post_copyright_mb_title_text")},content:{inner:[!e&&{tag:"span",inner:Wd.wrap(s)},Object(va.default)({class:"AddCopyrightPopup__input",placeholder:Object(J.getLang)("mobile_post_copyright_input_placeholder"),value:decodeURIComponent(n),spellcheck:!1,on_key_down:["posting.saveSource",t]}),{class:"AddCopyrightPopup__error",style:"display: none;"},{class:"Popup__buttons",inner:[Object(qt.default)({class:"Popup__button",inner:e?Object(J.getLang)("mobile_wall_post_copyright_edit_button"):Object(J.getLang)("mobile_wall_post_copyright_add_button"),theme:"regular",use_native_onclick:!0,on_click:'posting.saveSource("'+t+'", this)'}),e?Object(qt.default)({class:"Popup__button",inner:Object(J.getLang)("mobile_delete"),theme:"secondary",use_native_onclick:!0,on_click:'posting.deleteSource(event, this, "'+t+'")'}):{}]}]}});In.default.open(Wd.elem(c),!0);var l=Object(F.$)(".AddCopyrightPopup__input input");l&&Object(r.elfocus)(l)},submit:function(e,t,n){var i=Object(F.$)(".Btn",n.parentNode);i.disabled=!0,window.ajax.post("/wall?act=check_copyright_link",{_ajax:1,link:e},{onDone:function(a){var o=Object(F.$)(".AddCopyrightPopup__error");a.status?(n.classList.remove("TextInput_error"),Object(r.hide)(o),ga(e,t),In.default.close(n)):(n.classList.add("TextInput_error"),Object(r.show)(o),Object(r.val)(o,a.error)),window.post.saveDraft(null,t),i.disabled=!1}})},remove:function(e,t){t&&In.default.close(t),ga("",e),e&&window.post.saveDraft(null,e)}};window.AddCopyrightPopup=Aa;var ba=Aa,wa={getHash:function(){var e=Object(F.$)("#feed_add_form"),t=qs2obj(e.action.split("?")[1]);return e.getAttribute("data-hash")||t.hash},openCopyright:function(e,t,n,i){cancelEvent(e);var a=!1;if("BUTTON"===e.target.tagName)a=e.target.disabled;else if("LABEL"===e.target.tagName){a=Object(F.$)("button",e.target).disabled}a||ba.open(t,n,i)},saveSource:function(e,t){if(t.target){if(13!==t.keyCode)return;t=t.target}var n=Object(F.$)(".AddCopyrightPopup__input",t.closest(".AddCopyrightPopup")),i=n.querySelector("input");ba.submit(i.value,e,n)},deleteSource:function(e,t,n){var i=Object(F.$)(".AddCopyrightPopup__input",t.closest(".AddCopyrightPopup"));event&&cancelEvent(e),ba.remove(n,i)},deleteObject:function(e){e&&cancelEvent(e);var t=nav.params,n=qs2obj(t);delete n.object,delete n.list,n.delete_object=1,post.saveDraft(null,wa.getHash(),""+nav.path+obj2qs(n))}};window.posting=wa;n("wyHI");var ya={},Oa=function(e,t,n,i){delete ya[t],1===i?Emoji.favorite.addFavoriteSticker(e,t,n):-1===i&&Emoji.favorite.deleteFavoriteSticker(e,t,n)};var Sa,ka={toggleFavorite:function(e,t,n){if(t&&t.stopPropagation(),!hasClass(e,"on")&&Emoji.stickers[Emoji.TAB_FAVORITE_STICKERS].stickers.length>=Emoji.favoriteLimit&&!Emoji.favoriteLimitNoticed){var i=langStr(getLang("purchases_stickers_favorite_limit_notice"),"%s",Emoji.favoriteLimit);return setTimeout(window.showFastBox(getLang("global_error"),i).hide,3e3),ajax.post("stickers.php",{act:"favorite_limit_noticed",value:1}),Emoji.favoriteLimitNoticed=!0,!1}var a=attr(e,"data-sticker-id"),r=attr(e,"data-hash");return!(!a||!r)&&(!ya[a]&&(ya[a]=1,toggleClass(e,"on"),void ajax.post("/stickers.php",{act:"toggle_favorite",sticker_id:a,hash:r},{onDone:Oa.pbind(n,a,e)})))},getStickerUrl:function(e,t){var n={id:e,size:t};if(window.isMVK){var i=String(t);return o.colorScheme.isDarkScheme()&&(i=i.replace(/b$/,"")+"b"),rs(window.store.stickers.url_template,{id:e,size:i})}return getTemplate("stickers_sticker_url",n)}},Ca=function(){var e,t,n,i=!1,a=!1,r={},o={},s={},c={};function l(e){var t=_(e),n=1;if(t){hasClass(e,"animation_play")||(hide(geByClass1("sticker_img",e)),addClass(e,"animation_play")),t.play();var i=attr(e,"data-loop-count");i=parseInt(i),isNaN(i)&&(i=3),-1!==i&&(!t._cbs.loopComplete||t._cbs.loopComplete&&0===t._cbs.loopComplete.length)&&t.addEventListener("loopComplete",(function a(r){n++;var o=!0;i>=n&&(o=!1),o&&(d(e,!1),""!==t._cbs.loopComplete&&t.removeEventListener("loopComplete",a),t.stop())}))}}function u(e){var t=attr(e,"data-uid");return t||(t=attr(e,"data-uid",Math.random().toString(32).substr(2))),t}function d(e,t){c[u(e)]=t}function _(e){var t=attr(e,"data-uniq-id");if(!geByClass1("svg_sticker_animation",e))return!1;var n=o[t];return n||!1}function f(e,t){var i=_(e);if(i)"function"==typeof t&&t(i);else{var a=attr(e,"data-uniq-id");if(!c[u(e)]){d(e,!0);var s=attr(e,"data-animation-path"),l=attr(e,"data-sticker-id"),f=!1;if(l&&(f=(r[l]||s)&&h(e)),f){var p=attr(e,"data-animation-class")||"",m={container:e,renderer:"svg",loop:!0,autoplay:!1,name:a,rendererSettings:{scaleMode:"noScale",progressiveLoad:!0,hideOnTransparent:!0,className:"svg_sticker_animation "+p}};r[l]?m.animationData=r[l]:m.path=s;var v=geByClass1("svg_sticker_animation",e);if(v&&re(v),i=n.loadAnimation(m),!r[l])return void i.addEventListener("data_ready",(function(){r[l]=i.animationData,o[a]=i,"function"==typeof t&&t(i)}))}"function"==typeof t&&(o[a]=i,"function"==typeof t&&t(i))}}}function p(){return t().then((function(e){return n=e,e}))}return{init:function(e){t=e.animatorLoader},checkSettingsAndLoadInWeb:function(e){if(StickersSettings.getAutoplay()){var t=ge("fc_msg"+e),n=geByClass1("sticker_animation",t);Ca.loadAndPlaySticker(n)}},checkSettingsAndLoad:function(e){if(StickersSettings.getAutoplay()){var t=$(".msg_id_"+e+" .sticker_animation");Ca.loadAndPlaySticker(t)}},loadStickerInMvkIMAndPlay:function(e,t){var n="_msg"+e;t&&(n="msg_id_"+e);var i=geByClass1("sticker_animation",geByClass1(n));Ca.loadAndPlayStickerWithTimer(i,500)},loadAutoplayAnimationStickers:function(e){if(n){if(e){if(a)return;a=!0}if(!i){i=!0;var t=geByClass("sticker_animation_autoplay");t&&each(t,(function(e,t){f(t,(function(){l(t)}))})),i=!1}}else p().then((function(){Ca.loadAutoplayAnimationStickers(e)}))},loadAndPlaySticker:function(e){e&&(n?requestAnimationFrame((function(){f(e,(function(){l(e)}))})):p().then((function(){Ca.loadAndPlaySticker(e)})))},loadAndPlayStickerWithTimer:function(e,t){if(e&&!s[e]){t||(t=1e3);var n=ge(e);hasClass(n,"sticker_animation_disabled_timer")||(s[e]=setTimeout((function(){!n&&(n=ge(e),hasClass(n,"sticker_animation_disabled_timer"))||(Ca.loadAndPlaySticker(n),clearTimeout(s[e]),s[e]=!1)}),t))}},reloadStickers:function(){o={}},touchStartSticker:function(t){t.addEventListener("contextmenu",Ca.preventContextMenu,!1),e=setTimeout((function(){Ca.loadAndPlaySticker(t)}),500)},touchEndSticker:function(){e&&clearTimeout(e)},preventContextMenu:function(e){e.preventDefault(),e.stopPropagation()}};function h(e){var t=e.getBoundingClientRect().top,n=e.getBoundingClientRect().bottom;return t<window.innerHeight&&n>=0&&isVisible(e)}}(),ja={autoplay:0,setAutoplay:function(e){this.autoplay=e},getAutoplay:function(){return ja.autoplay&&!ja.isPreventAutoplayByCalls()},isPreventAutoplayByCalls:function(){return window.Calls&&window.Calls.isInActiveCall}};function Ea(){return qs2obj(nav.params)}function Ta(e){return"dialogs"===e.tab||!e.q}function Ia(e){var t=nav.getQuery("community");return t?(e?"?":"&")+"community="+t:""}function Ma(){var e=window.lang;qsearch.init({init_once:!0,action:"/mail?act=write&fast=1",container:ge("ma_search_items"),field:ge("ma_search_field"),btn:ge("ma_search_btn"),top_items:[],_cache:{},item_tpl:function(e,t,n,i,a){return this.id>2e9||-1===this.id?'<a href="'+(e||"")+'" class="simple_item'+(-1==this.id?" simple_item_create":"")+'">'+(t||"")+'<div class="si_body"><span class="si_owner">'+this.highlight(n||"")+"</span>"+(i||"")+(a?'<div class="si_slabel">'+a+"</div>":"")+"</div></a>":'<a href="'+(e||"")+'" class="inline_item"><div class="ii_body">'+(t||"")+'<span class="ii_owner">'+this.highlight(n||"")+"</span>"+(i||"")+"</div></a>"},null_tpl:function(){return'<div class="service_msg_box"><div class="service_msg service_msg_null">'+e.mobile_mail_no_peers+"</div></div>"},need_invalid_keys:x.default.desktop,onLoaded:function(e){for(var t in e)mail.saveDialog(e[t][e[t].length-1],t)}})}Ca.init({animatorLoader:function(){return n.e(0).then(n.bind(null,"P3dz")).then((function(e){return e.default}))}}),window.Stickers=ka,window.StickersAnimation=Ca,window.StickersSettings=ja,window.StickersCache=Ot.default,im.clearSearchInput=function(e){if(preventEvent(e),Ta(Ea())){var t=ge("ma_search_field");val(t,""),im.onFilterKeyDown(t)}else nav.go("/mail"+Ia(!0))},im.onFilterKeyDown=function(e){setTimeout((function(){var t=window.lang,n=encodeURIComponent(e.value),i=Ea();if(toggle(geByClass1("mail_search_clear_button"),n),attr(geByClass1("tab_dialogs_search"),"href",n?"/mail?tab=dialogs&q="+n+Ia():"/mail"+Ia(!0)),attr(geByClass1("tab_messages_search"),"href","/mail?q="+n+Ia()),Ta(i)){var a,r=ge("mail_tabs"),o=ge("ma_search_items"),s=ge("dialogs"),c=i.offset;if(removeClass("mail_show_filtered",geByClass1("mail")),Sa&&clearTimeout(Sa),toggleClass("dialogs_filter_without_important",ge("dialogs_filter"),n||0===intval(val(geByClass1("dialogs_filter_button_important")))),n)show(r),show(o),hide(s),Sa=setTimeout((function(){a="/mail?tab=dialogs&q="+n+(c?"&offset="+c:"")+Ia(),"/mail"!==nav.path||Ea().act||nav.go(a,null,{push_only:!0})}),200);else{if(hide(r),hide(o),show(s),!nav.getQuery("community")){var l=geByClass1("mhb_back"),u=geByClass1("mh_header");val(u,t.mobile_mail_head_title),removeClass("mhi_back",u),l.outerHTML=l.outerHTML.replace("<a","<div").replace("</a>","</div>")}a="/mail"+(c?"?offset="+c:"")+Ia(!c),nav.go(a,null,{push_only:!0})}}}),40)},mail.onShowWritePageFromCache(Ma),mail.onShowDialogsPageFromCache(Ma);var Pa=n("vuIU"),Da="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=",xa=function(){function e(e){this.opts=e||{},this._trackOptions={},this._audioNodes=[],this._currentAudioEl=this._createAudioNode(),this._prefetchAudioEl=this._createAudioNode()}e.isSupported=function(e){var t=document.createElement("audio");return!!t.canPlayType&&(!('audio/mpeg; codecs="mp3"'!==(e=e||'audio/mpeg; codecs="mp3"')||!(browser.safari||browser.safari_mobile||browser.ios)||!browser.version.toString().startsWith("14"))||!!t.canPlayType(e).replace(/no/,""))};var t=e.prototype;return t.destroy=function(){},t.getPlayedTime=function(){for(var e=this._currentAudioEl.played,t=0,n=0;n<e.length;n++)t+=e.end(n)-e.start(n);return t},t._setAudioNodeUrl=function(e,t){window.data&&window.data(e,"setUrlTimesetUrlTime",t==Da?0:vkNow()),e.src=t},t._createAudioNode=function(e){var t=new Audio,n=this;return this.opts.onBufferUpdate&&addEvent(t,"progress",(function(){n._currentAudioEl==t&&n.opts.onBufferUpdate(n.getCurrentBuffered());var e=t.buffered;1==e.length&&0==e.start(0)&&e.end(0)==t.duration&&(t._fullyLoaded=!0)})),addEvent(t,"stalled",(function(){n._currentAudioEl==t&&n._isInvalidDuration()&&n._currentAudioEl.currentTime>=n.duration-1&&n._currentAudioEl.dispatchEvent(new Event("ended"))})),this.opts.onProgressUpdate&&addEvent(t,"timeupdate",(function(){n._currentAudioEl==t&&n.opts.onProgressUpdate(n.getCurrentProgress())})),this.opts.onEnd&&addEvent(t,"ended",(function(){n._currentAudioEl==t&&n.opts.onEnd()})),this.opts.onSeeked&&addEvent(t,"seeked",(function(){n._currentAudioEl==t&&n.opts.onSeeked()})),this.opts.onSeek&&addEvent(t,"seeking",(function(){n._currentAudioEl==t&&n.opts.onSeek()})),addEvent(t,"error",(function(){n._prefetchAudioEl==t?n._prefetchAudioEl=n._createAudioNode():n._currentAudioEl==t&&n.opts.onFail&&n.opts.onFail()})),addEvent(t,"canplay",(function(){n._prefetchAudioEl,n._currentAudioEl==t&&(n.opts.onCanPlay&&n.opts.onCanPlay(),n._seekOnReady&&(n.seek(n._seekOnReady),n._seekOnReady=!1))})),e&&(this._setAudioNodeUrl(t,e),t.preload="auto",t.volume=this._volume||1,t.load()),this._audioNodes.push(t),t},t.onReady=function(e){e(!0)},t.prefetch=function(e){this._prefetchAudioEl&&this._setAudioNodeUrl(this._prefetchAudioEl,Da),this._prefetchAudioEl=this._createAudioNode(e)},t.seek=function(e){var t=this._currentAudioEl;this.duration?t.currentTime=this.duration*e:this._seekOnReady=e},t.setVolume=function(e){void 0===e&&(e=this._currentAudioEl.volume),this._currentAudioEl.volume=e,this._prefetchAudioEl&&(this._prefetchAudioEl.volume=e),this._volume=e},t._isInvalidDuration=function(){var e=this._currentAudioEl;return isNaN(e.duration)||e.duration==1/0||0==e.duration},t.getCurrentProgress=function(){var e=this._currentAudioEl;return this.duration?Math.max(0,Math.min(1,e.currentTime/this.duration)):0},t.getCurrentBuffered=function(){var e=this._currentAudioEl;return e&&e.buffered.length?Math.min(1,e.buffered.end(0)/e.duration):0},t.isFullyLoaded=function(){return this._currentAudioEl._fullyLoaded},t.setUrl=function(t,n){var i=this._currentAudioEl;if(this._seekOnReady=!1,this._trackOptions={},n&&"object"==typeof n&&(this._trackOptions=n,n=n.callback),i.src==t)return this.opts.onCanPlay&&this.opts.onCanPlay(),n&&n(!0);if(this._prefetchAudioEl&&this._prefetchAudioEl.readyState>e.STATE_HAVE_NOTHING)if(this._prefetchAudioEl.src==t){this._currentAudioEl.pause(0),this._setAudioNodeUrl(this._currentAudioEl,Da);var a=this;this._prefetchAudioEl.readyState>=e.STATE_HAVE_FUTURE_DATA&&setTimeout((function(){a.opts.onCanPlay&&a.opts.onCanPlay()})),i=this._currentAudioEl=this._prefetchAudioEl,this._prefetchAudioEl=!1}else this._prefetchAudioEl.src&&this._setAudioNodeUrl(this._prefetchAudioEl,Da);return i.src!=t&&(this._setAudioNodeUrl(i,t),i.load()),n&&n(!0)},t.play=function(t){this._prefetchAudioEl.src==t&&this._prefetchAudioEl.readyState>e.STATE_HAVE_NOTHING&&(this._setAudioNodeUrl(this._currentAudioEl,Da),this._currentAudioEl=this._prefetchAudioEl,this._prefetchAudioEl=this._createAudioNode(),this.opts.onCanPlay&&this.opts.onCanPlay());var n=this._currentAudioEl;n.src&&ai(n).catch((function(){debugLog("Audio: url set failed (html5 impl)")}))},t.pause=function(){var e=this._currentAudioEl;e.src&&e.pause()},t.stop=function(){var e=this._currentAudioEl;this._setAudioNodeUrl(e,Da)},t._setFadeVolumeInterval=function(e){if(e){if(!this._fadeVolumeWorker&&window.Worker&&window.Blob){var t=new Blob(["\n        var interval;\n        onmessage = function(e) {\n          clearInterval(interval);\n          if (e.data == 'start') {\n            interval = setInterval(function() { postMessage({}); }, 20);\n          }\n        }\n      "]);try{this._fadeVolumeWorker=new Worker(window.URL.createObjectURL(t))}catch(e){this._fadeVolumeWorker=!1}}this._fadeVolumeWorker?(this._fadeVolumeWorker.onmessage=e,this._fadeVolumeWorker.postMessage("start")):this._fadeVolumeInterval=setInterval(e,60)}else this._fadeVolumeWorker&&(this._fadeVolumeWorker.terminate(),this._fadeVolumeWorker=null),this._fadeVolumeInterval&&clearInterval(this._fadeVolumeInterval)},t.fadeVolume=function(e,t){e=Math.max(0,Math.min(1,e));var n=this._currentAudioEl,i=0;if(i=e<n.volume?-.04:.001,Math.abs(e-n.volume)<=.001)return this._setFadeVolumeInterval(),t&&t();var a=n.volume;this._setFadeVolumeInterval(function(){i>0&&(i*=1.2),a+=i;if(i<0?a<=e:a>=e)return this.setVolume(e),this._setFadeVolumeInterval(),t&&t();this.setVolume(a)}.bind(this))},Object(Pa.default)(e,[{key:"type",get:function(){return"html5"}},{key:"loaded",get:function(){return!0}},{key:"duration",get:function(){var e=this._currentAudioEl,t=isNaN(e.duration)||e.duration==1/0?0:e.duration;return!t&&this._trackOptions.duration&&(t=parseInt(this._trackOptions.duration)),t}}]),e}();xa.STATE_HAVE_NOTHING=0,xa.STATE_HAVE_FUTURE_DATA=3,xa.HAVE_ENOUGH_DATA=4,xa.AUDIO_EL_ID="ap_audio";var La=function(){function e(e){this.opts=e||{},window._flashVoiceInstance=this}var t=e.prototype;return t.fadeVolume=function(e,t){return this.setVolume(e),t()},t.destroy=function(){re(e.PLAYER_EL_ID)},t.onReady=function(t){if(this._player)return t(!0);if(!1===this._player)return t(!1);this._onReady=t;ge(e.PLAYER_EL_ID)||document.body.appendChild(ce("div",{id:e.PLAYER_EL_ID,className:"fixed"}));var n=this;renderFlash(e.PLAYER_EL_ID,{url:"/swf/audio_lite.swf",id:"flash_voice_player",height:2},{swliveconnect:"true",allowscriptaccess:"always",wmode:"opaque"},{onPlayFinish:"VoicePlayerFlash.onAudioFinishCallback",onLoadProgress:"VoicePlayerFlash.onAudioLoadProgressCallback",onPlayProgress:"VoicePlayerFlash.onAudioProgressCallback"})&&setTimeout((function(){n._checkFlashLoaded()}),50)},t.setUrl=function(e,t){this._trackOptions={},t&&"object"==typeof t&&(this._trackOptions=t,t=t.callback),this._url!=e?(this._url=e,this._player&&this._player.loadAudio(e),t&&t(!0)):t&&t(!0)},t.setVolume=function(e){this._player&&this._player.setVolume&&this._player.setVolume(e)},t.play=function(){this._player&&this._player.playAudio()},t.seek=function(e){var t=(this._total||0)*e;this._player&&this._player.playAudio(t)},t.pause=function(){this._player&&this._player.pauseAudio()},t.isFullyLoaded=function(){return!1},t.getPlayedTime=function(){return 0},t.getCurrentProgress=function(){return this._currProgress||0},t.getCurrentBuffered=function(){return this._currBuffered||0},t.stop=function(){this._player&&this._player.stopAudio()},t._checkFlashLoaded=function(){var e=ge("flash_voice_player");if(this._checks=this._checks||0,this._checks++,this._checks>10){this._player=!1;var t=this._onReady;return t&&t(!1)}if(e&&e.paused){this._player=e;var n=this._onReady;n&&n(!0),this._onReady=null}else{var i=this;setTimeout((function(){i._checkFlashLoaded()}),100)}},e.onAudioFinishCallback=function(){var e=window._flashVoiceInstance;e.opts.onEnd&&e.opts.onEnd()},e.onAudioProgressCallback=function(e,t){var n=window._flashVoiceInstance;t&&(n._total=t,n._currProgress=e/t,n.opts.onProgressUpdate&&n.opts.onProgressUpdate(n._currProgress))},e.onAudioLoadProgressCallback=function(e,t){var n=window._flashVoiceInstance;n._currBuffered=e/t,n.opts.onBufferUpdate&&n.opts.onBufferUpdate(n._currBuffered)},Object(Pa.default)(e,[{key:"type",get:function(){return"flash"}},{key:"loaded",get:function(){return!!this._player}}]),e}();window.VoicePlayerFlash=La,La.PLAYER_EL_ID="flash_voice";void 0===window.isTouch&&(window.isTouch=!1);var Ba,Ra=function(){function e(e,t){if(!e)throw new Error("No element was provided for Slider");e=ge(e),this.options=t||{size:1},void 0===this.options.logfbase&&(this.options.logfbase=35),this.options.backValue=this.options.backValue||0;var n=100*this.options.backValue,i='<div class="slider_slide"><div class="slider_loading_bar" style="opacity: 0; display: none;"></div> '+(this.options.withBackLine?'<div class="slider_back" style="width:'+n+'%"></div>':"")+' <div class="slider_amount"></div> <div class="slider_handler"></div> </div>';this._el=ce("div",{innerHTML:i,className:"slider",id:e.getAttribute("id")||""});var a=this;if(e.classList)for(var r=e.classList,o=0,s=r.length;o<s;o++)addClass(this._el,r[o]);else this._el.className=e.className;each(this._el.attributes,(function(e,t){"id"==t.name&&"class"==t.name||a._el.setAttribute(t.name,t.value)})),e.parentNode.replaceChild(this._el,e),this._amountEl=geByClass1("slider_amount",this._el),this._handlerEl=geByClass1("slider_handler",this._el),this._slideEl=geByClass1("slider_slide",this._el),this._backEl=geByClass1("slider_back",this._el),this._progressEl=geByClass1("slider_loading_bar",this._el),this.options.color&&(setStyle(this._amountEl,{backgroundColor:this.options.color}),setStyle(this._handlerEl,{backgroundColor:this.options.color})),this.options.backColor&&setStyle(this._slideEl,{backgroundColor:this.options.backColor}),addClass(this._el,"slider_size_"+this.options.size),this.options.debounce&&(this._onValueChangeDebounced=Object(bi.debounce)(this._onValueChange,this.options.debounce)),!isTouch&&t.formatHint&&(addEvent(this._el,"mousemove",this._ev_onMouseOver=this._onMouseOver.bind(this)),addEvent(this._el,"mouseleave",this._ev_onMouseLeave=this._onMouseLeave.bind(this))),addEvent(this._el,isTouch?"touchstart":"mousedown",this._ev_onMouseDown=this._onMouseDown.bind(this)),addEvent(this._el,"click",cancelEvent),this.setValue(this.options.value||0,!this.options.fireChangeEventOnInit,!1),this.setBackValue(this.options.backValue)}var t=e.prototype;return t.toggleLoading=function(e){e=!!e,toggle(this._progressEl,e),setStyle(this._progressEl,"opacity",e?1:0)},t.destroy=function(){!isTouch&&this.options.formatHint&&(removeEvent(this._el,"mousemove",this._ev_onMouseOver),removeEvent(this._el,"mouseleave",this._ev_onMouseLeave),removeEvent(this._el,"mousedown",this._ev_onMouseDown));var e=window.re||window.remove;e(this._el),e(this._currHintEl)},t._updateHint=function(e,t){this._currHintEl||(this._currHintEl=ce("div",{className:"slider_hint",id:"slider_hint"}),this.options.hintClass&&addClass(this._currHintEl,this.options.hintClass),this._el.appendChild(this._currHintEl));var n=this._getPos(),i=Math.round((e.pageX||e.touches[0].pageX)-n[0]),a=this._width;if((i=t?Math.min(Math.max(0,i),a):i)>=0&&i<=a){var r=i/a;this._currHintEl.innerHTML=this.options.formatHint?this.options.formatHint.call(this,r):r;var o=this._currHintEl.getBoundingClientRect();setStyle(this._currHintEl,{left:this._slideEl.offsetLeft+i-(o.right-o.left)/2,top:this._slideEl.offsetTop-(o.bottom-o.top)-10}),!t&&this._toggleHint(!0)}else!t&&this._toggleHint(!1);this.options.formatHint||this._toggleHint(!1)},t._toggleHint=function(e){toggleClass(this._currHintEl,"visible",e)},t._onMouseOver=function(t){e._currenSliderDrag||hasClass(this._el,"active")||this._updateHint(t)},t._onMouseLeave=function(e){hasClass(this._el,"active")||this._toggleHint(!1)},t._onMouseDown=function(t){(0==t.button||t.touches)&&(delete cur._sliderMouseUpNowEl,addEvent(window,isTouch?"touchmove":"mousemove",this._ev_onMouseMove=this._onMouseMove.bind(this)),addEvent(window,isTouch?"touchend touchcancel":"mouseup",this._ev_onMouseUp=this._onMouseUp.bind(this)),this._onMouseMove(t),e._currenSliderDrag=this,addClass(this._el,"active"),cancelEvent(t))},t._onMouseUp=function(t){cur._sliderMouseUpNowEl=this._el,removeEvent(window,isTouch?"touchmove":"mousemove",this._ev_onMouseMove),removeEvent(window,isTouch?"touchend touchcancel":"mouseup",this._ev_onMouseUp),this._onValueChange(),removeClass(this._el,"active"),e._currenSliderDrag=!1,this._toggleHint(!1),this.options.onEndDragging&&this.options.onEndDragging(this._currValue),cancelEvent(t)},t._onMouseMove=function(e){var t=this._getPos(),n=t[0];n=void 0!==e.touches&&e.touches.length>0?e.touches[0].pageX:e.pageX,n=Math.max(n,t[0]),n=Math.min(n,t[0]+this._width),n-=t[0],this.setValue(n/this._width,!0,!0),this._onValueChangeDebounced?this._onValueChangeDebounced():this._onValueChange(),this._toggleHint(!0),this._updateHint(e,!0),cancelEvent(e)},t._getPos=function(){return this._slidePos=getXY(this._slideEl)},t._logf=function(e){if(!this.options.log)return e;var t=this.options.logfbase;return(Math.pow(t,e)-1)/(t-1)},t._unlogf=function(e){if(!this.options.log)return e;var t,n,i=this.options.logfbase;return t=i,n=1+e*(i-1),Math.log(n)/Math.log(t)},t.setValue=function(e,t,n){if(!hasClass(this._el,"active")||n){var i=n?this._logf(e):e;if(this._currValue!=i){this._currValue=i;var a=n?e:this._unlogf(e);a=100*a+"%",setStyle(this._amountEl,{width:a}),setStyle(this._handlerEl,{left:a}),!t&&this._onValueChange()}}},t.setBackValue=function(e){toggleClass(this._backEl,"slider_back_transition",e>this._backValue),this._backValue=e;var t=100*e+"%";setStyle(this._backEl,{width:t})},t._onValueChange=function(){this._lastValue=this._lastValue||0,this._lastValue!=this._currValue&&(this._lastValue=this._currValue,this.options.onChange&&this.options.onChange(this._currValue))},Object(Pa.default)(e,[{key:"_width",get:function(){if(!this._widthCache){var e=this._el.getBoundingClientRect();this._widthCache=e.right-e.left}return this._widthCache}}]),e}(),Na=window&&window.navigator&&"mediaSession"in window.navigator&&"MediaMetadata"in window;var Fa=!1,Ha=function(){function e(e){var t=this,n=(void 0===e?{}:e).onListened;this._reattach=!1,this._audioEl=null,this._playing=!1,this._timer=null,this._duration=0,this._detaching=!1;var i={onEnd:function(){t.detach()},onFail:function(){i.onEnd()},onCanPlay:function(){},onProgressUpdate:function(e){t._updateProgress(e)}};Ba=!1,xa.isSupported()?(xa.isSupported('audio/ogg;codecs="opus"')&&!xa.isSupported('audio/ogg;codecs="codec_check"')&&(Ba=!0),this._impl=new xa(i)):browser.flash&&window.renderFlash&&(this._impl=new La(i)),this.onPlayPause=function(e){return cancelEvent(e),t._clearMediaSession(),t.toggle()},this.onDurationClick=function(e){t.durationType=!t.durationType,cancelEvent(e)},this._onListened=function(){n&&n(t._audioEl)},this._initEvents()}var t=e.prototype;return t._updateProgress=function(e){this._audioEl&&(this._duration*e>=1||this._duration<1)&&!this._audioEl._listened&&(this._audioEl._listened=!0,this._onListened()),this._durationEl&&(this.durationType?this._durationEl.innerHTML="-"+formatTime(Math.round(this._duration*(1-e))):this._durationEl.innerHTML=formatTime(Math.round(this._duration*e))),this._progressSlider&&this._progressSlider.setValue(e)},t._initInterface=function(){var e=this;this._el=ce("div",{innerHTML:'<div class="audio-msg-player audio-msg-track"><button class="audio-msg-track--btn"></button><div class="audio-msg-track--duration"></div><div class="audio-msg-track--wave-wrapper"><div class="audio-msg-track--slider"></div></div></div>'}).firstChild,window.getLang&&attr(this._el,"aria-label",getLang("mail_audio_message")),this._playBtn=geByClass1("audio-msg-track--btn",this._el);var t=this._audioEl.getAttribute("id");if(t&&this._el.setAttribute("id","vmp_"+t),this._audioEl.classList.contains("audio-msg-track--preview")){this._el.classList.add("audio-msg-track--preview"),this._playBtn.classList.add("audio-msg-track--btnSvg");var n=geByClass1("audio-msg-track--btn",this._audioEl);this._playBtn.innerHTML=n.innerHTML}window.getLang&&attr(this._playBtn,"aria-label",getLang("global_audio_play")),this._durationEl=geByClass1("audio-msg-track--duration",this._el),this._durationEl.innerHTML=formatTime(this._duration),this._progressSlider=new Ra(geByClass1("audio-msg-track--slider",this._el),{value:0,size:0,hintClass:"audio_player_hint",formatHint:function(t){return formatTime(Math.round(t*e._duration))},onEndDragging:function(t){e._impl.seek(t)}});var i=geByClass1("audio-msg-track--wave-wrapper",this._el),a=geByClass1("audio-msg-track__transcriptionButton",this._audioEl),r=geByClass1("audio-msg-track__after",this._audioEl);r&&a&&(i.appendChild(a.cloneNode(!0)),this._el.appendChild(r.cloneNode(!0)),this._el.setAttribute("data-transcription-expanded",this._audioEl.getAttribute("data-transcription-expanded")));var o=geByClass1("audio-msg-track--wave-wrapper",this._audioEl).children[0];geByClass1("slider_slide",this._el).appendChild(o.cloneNode(!0)),geByClass1("slider_amount",this._el).appendChild(o.cloneNode(!0)),addEvent(this._playBtn,"click",this.onPlayPause),addEvent(this._durationEl,"click",this.onDurationClick),this._audioEl.parentNode.prepend(this._el),this._clearMediaSession()},t._clearMediaSession=function(){var e=this;Na&&(navigator.mediaSession.setActionHandler("play",(function(){return e.play()})),navigator.mediaSession.setActionHandler("pause",(function(){return e.pause()})),navigator.mediaSession.setActionHandler("seekbackward",null),navigator.mediaSession.setActionHandler("seekforward",null),navigator.mediaSession.setActionHandler("previoustrack",null),navigator.mediaSession.setActionHandler("nexttrack",null),navigator.mediaSession.metadata=new MediaMetadata({title:"",artist:"",album:"",artwork:[]}))},t._destroyInterface=function(){hide(this._el),this._audioEl.parentNode.contains(this._el)&&this._audioEl.parentNode.removeChild(this._el),removeEvent(this._playBtn,"click",this.onPlayPause),this._progressSlider&&(this._progressSlider.destroy(),this._progressSlider=null),this._playBtn=null,this._durationEl=null,this._el=null},t.attachTo=function(e){var t=this;if(this._audioEl!=e){null!=this._audioEl&&(this._reattach=!0),this.detach(),this._audioEl=e,addClass(this._audioEl,"audio-msg-track_player-attached"),this._duration=attr(e,"data-duration"),this._initInterface();var n=this._audioEl.id.split("_");if(n&&n.length>1&&(this._owner_id=n[1]),this._reattach=!1,!this._impl.loaded)return new Promise((function(n,i){t._impl.onReady((function(){t._impl.setUrl(attr(e,Ba?"data-ogg":"data-mp3"),{duration:t._duration,callback:n})}))}));this._impl.setUrl(attr(e,Ba?"data-ogg":"data-mp3"),{duration:this._duration})}return!0},t.detach=function(e){if(void 0===e&&(e=!1),this._audioEl&&this._el&&!this._detaching){if(e&&this.isAttached())return;this._detaching=!0,this.stop(),this._destroyInterface(),removeClass(this._audioEl,"audio-msg-track_player-attached"),this._audioEl._listened=!1,this._audioEl=null}this._detaching=!1},t.play=function(){this._audioEl&&(this._reattach||e.pauseGlobalMedia(),addClass(this._el,"audio-msg-track_playing"),window.getLang&&attr(this._playBtn,"aria-label",getLang("global_audio_pause")),this._playing=!0,this._createTimer(),this._owner_id&&Object(P.statlogsValueEvent)("audio_message_play",this._owner_id),this._impl.play())},t.pause=function(){this._audioEl&&(!this._reattach&&this._playing&&e.resumeGlobalMedia(),window.getLang&&attr(this._playBtn,"aria-label",getLang("global_audio_play")),removeClass(this._el,"audio-msg-track_playing"),this._playing=!1,this._impl.pause(),this._killTimer())},t.stop=function(){this.pause(),this._impl.stop()},t.toggle=function(){this._playing?this.pause():this.play()},t._createTimer=function(){var e=this;this._duration>0&&(this._killTimer(),this._timer=setInterval((function(){if(e._impl){var t=e._impl.getCurrentProgress();e._updateProgress(t)}}),100))},t._killTimer=function(){this._timer&&(clearInterval(this._timer),this._timer=null)},t._initEvents=function(){var e=this;window.ap?window.ap.on(this,[Gt.events.PLAY_REQUESTED,Gt.events.PLAY],(function(){delete window.ap.pausedByMsg,e.pause()})):window.audio&&window.audio.subscribe([Gt.events.PLAY_REQUESTED,Gt.events.PLAY],(function(){delete window.audio.pausedByMsg,e.pause()})),window.Notifier&&(window.Notifier.addRecvClbk("audio_start","audio_msg",(function(){e.pause()})),window.Notifier.addRecvClbk("video_start","audio_msg",(function(){e.pause()})))},t.isAttached=function(){if(this._audioEl){for(var e=this._audioEl;e.parentNode;)e=e.parentNode;return!!e.body}return!1},e.pauseGlobalMedia=function(){window.Notifier&&(Fa=!0,window.Notifier.lcSend("video_start")),window.ap&&window.ap.isPlaying()?(window.ap.pause(),window.ap.pausedByMsg=!0):window.audio&&window.audio.playing&&window.audio.playing()&&(window.audio.pause(),window.audio.pausedByMsg=!0)},e.resumeGlobalMedia=function(){window.Notifier&&Fa&&(Fa=!1,window.Notifier.lcSend("video_hide")),window.ap&&window.ap.pausedByMsg?(window.ap.play(),delete window.ap.pausedByMsg):window.audio&&window.audio.playing&&window.audio.pausedByMsg&&(ai(window.audio).catch((function(){})),delete window.audio.pausedByMsg)},Object(Pa.default)(e,[{key:"type",get:function(){return this._impl.type}},{key:"durationType",get:function(){return window.AudioPlayer?!!oi.default.get(AudioPlayer.LS_PREFIX+AudioPlayer.LS_DURATION_TYPE):"1"==oi.default.get("audio_time_left")},set:function(e){window.AudioPlayer?oi.default.set(AudioPlayer.LS_PREFIX+AudioPlayer.LS_DURATION_TYPE,!!e):oi.default.set("audio_time_left",e?"1":"0")}}]),e}(),Ua=n("7jDv"),Va=null;function Wa(e){for(var t=geByClass("audio-msg-track--wave-wrapper",e),n=Object(F.$)(".audio-msg-track__transcriptionButton",e),i=0,a=0;a<t.length;a++){try{var r=n&&parseInt(window.getComputedStyle(n,null).getPropertyValue("width"))||0;i=parseInt(window.getComputedStyle(t[a],null).getPropertyValue("width"))-r-8}catch(e){var o=n&&parseInt(n.currentStyle.width)||0;i=parseInt(t[a].currentStyle.width)-o-8}if(i>0)break}return i}function $a(e,t){t=Math.round(t),e.length!=t&&(e=Object(Ua.fastResample)(e,t));for(var n="",i=0,a=0;a<e.length;a++)0===(i=Math.floor(7.5*e[a]*.95))&&(i=.5),n+="M"+(4*a+1)+","+(10-i)+"v"+2*i+"Z";return'<svg class="audio-msg-track--wave" width="'+4*e.length+'px"><path d="'+n+'"></path></svg>'}function qa(){for(var e=geByClass("audio-msg-track"),t=0;t<e.length;t++){var n=Object(r.attr)(e[t],"data-wave");if(Object(r.hasClass)(e[t],"audio-msg-player")&&t>0){var i=e[t].getAttribute("id");if(i.startsWith("vmp_")){var a=document.getElementById(i.replace("vmp_",""));n=Object(r.attr)(a,"data-wave")}else n=Object(r.attr)(e[t-1],"data-wave")}var o=Wa(e[t]);if(n&&o){n=n.split(",");for(var s=geByClass("audio-msg-track--wave",e[t]),c=$a(n,o/4),l=0;l<s.length;l++){var u=Object(r.ce)("div",{innerHTML:c}).firstChild;s[l].parentNode.replaceChild(u,s[l])}}}}function za(){return Va||(Va=new Ha({onListened:function(e){AudioMessagePlayer.events.emit("listened",e)}})),Va}addEvent(window,"orientationchange",(function(){return setTimeout(qa,500)})),window.mail&&window.mail.onMessagesRepainted&&(onDOMReady(qa),window.mail.onMessagesRepainted(qa)),window.AudioMessagePlayer={loaded:!0,events:new EventEmitter,togglePlay:function(e,t,n){void 0===n&&(n=null);var i=za(),a=i.attachTo(e),r=function(){null!==n?n?i.play():i.pause():i.play()};!0===a?r():a.then((function(){r()}))},detachPlayer:function(e){za().detach(e)},getAttachedTrackPlayer:function(){return Object(F.$)(".audio-msg-track_player-attached")},pauseGlobalMedia:function(){Ha.pauseGlobalMedia()},resumeGlobalMedia:function(){Ha.resumeGlobalMedia()},redrawWaves:qa,getWave:$a,toggleTranscription:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),e&&(e.preventDefault(),e.stopPropagation());var i=t||e.target,a=i.closest(".audio-msg-player"),r=a?a.parentNode.querySelector("#"+a.id.replace("vmp_","")):i.closest(".audio-msg-track"),o=a?Object(F.$)(".audio-msg-track__transcriptionButton",r):i,s=null===n?"true"===o.getAttribute("aria-expanded"):!n;i.setAttribute("aria-expanded",s?"false":"true"),a&&o.setAttribute("aria-expanded",s?"false":"true"),r.setAttribute("data-transcription-expanded",s?"false":"true"),a&&a.setAttribute("data-transcription-expanded",s?"false":"true"),this.events.emit("transcription_toggle",!s,r)}};n("G0UO"),n("Mc5h");var Ya=n("O5lf"),Ga=n("9y81"),Ka=(n("AXyT"),n("gy8s")),Qa=(n("KMpi"),n("AgBx"),{_onCloseClick:function(e){e.stopPropagation(),e.preventDefault(),Object(r.remove)(Object(r.geByClass1)(Qa.class.btn))},class:{btn:"FloatBtn"}});Qa.class=Object(B.default)({},Qa.class,{open:Qa.class.btn+"_open"});var Xa=Qa,Ja={addContent:function(e,t){t&&Object(F.$$)(Za(e)).forEach((function(e){var n=e.$(er)||e;e.classList.remove(tr),n.insertAdjacentHTML("beforeend",t)}))}};window.Pad=Ja;var Za=function(e){return'.Pad[data-id="'+e+'"]'},er=".Pad__content",tr="Pad_empty";var nr=Object(r.need)("scrollToEl");Object(r.need)("page").onChange(ar);var ir=function(e){return".Anchor#"+e};function ar(){var e=window.nav&&window.nav.cur;if(e){var t=e.split("#")[1],n=t&&!~t.indexOf("=")&&Object(F.$)(ir(t));n&&nr(n)}}window.Select={},Select._onChange=or;var rr=function(e){return'.Select__option[value="'+e+'"]'};function or(e,t){var n=e.value,i=e.form,a=e.$(rr(n));d.default.handle(t,{$select:e,$option:a,$form:i,value:n,name:e.name,label:a.textContent})}var sr=n("Q8gl");window.LoadMore={setUrl:_r,destroy:fr},LoadMore._strategy={replace:{onFail:yr,onSuccess:function(e){var t=e.response;ur.outerHTML=t,fr()}},padsExtend:{onFail:yr,onSuccess:function(e){var t=e.response,n=t.pads,i=t.nextPageUrl;Object.keys(n).forEach((function(e){var t=n[e];Ja.addContent(e,t)})),i?_r(i):fr()}}},LoadMore._onButtonClick=pr,onDOMReady(hr),page.onChange(hr);var cr=".LoadMore",lr=".LoadMore__button",ur=null,dr=null;function _r(e){dr.setAttribute("href",e)}function fr(e){ur.remove(),ur=null,dr=null,vr()}function pr(){wr()||gr()}function hr(){if(ur=Object(F.$)(cr)){var e=window.cur;dr=ur.$(lr),mr(0),Object(r.onBodyScroll)(mr),e.destroy.push(vr)}}function mr(e){if(ur&&!wr()){var t=Object(r.getY)(ur),n=Object(r.getCh)();t-(e+n)<2*n&&gr()}}function vr(){Object(r.onBodyScroll)("__clear",mr)}function gr(){br(!0);var e=dr.getAttribute("href");L.default.post(e,{_ajax:1},{onDone:function(e){return Ar(e,!0)},onFail:function(e){return Ar(e,!1)}})}function Ar(e,t){if(br(!1),ur){var n=t?"data-success-handler":"data-fail-handler";n=ur.getAttribute(n),Wd.handle(n,{$loadMore:ur,response:e}),ur=null,dr=null,vr(),hr()}}function br(e){dr&&ur&&(qt.default.setLoading(dr,e),ur._loadMore_loading=e)}function wr(){return ur&&ur._loadMore_loading}function yr(e){console.error("LoadMore: failed to load more",e)}var Or=n("v+Uj");window.SliderTabs={},SliderTabs._onClick=xr,onDOMReady(Dr),page.onChange(Ir),page.onRestore(Mr);var Sr="SliderTabs",kr="Slider__scroll",Cr="SliderTabs__tab_selected",jr={active:".SliderTabs__tab_selected",tab:".SliderTabs__tab",scroll:"."+kr,container:"."+Sr},Er="",Tr=0;function Ir(){var e=Object(r.ge)(Er),t=Object(F.$)(jr.container);e?Object(F.$)(jr.scroll,e).scrollLeft=Tr:t?Pr():(Er="",Tr=0)}function Mr(){setTimeout((function(){var e=Object(r.ge)(Er);if(e){var t=Array.from(Object(F.$$)(jr.tab,e));if(t)t.some((function(e){return e.getAttribute("href")===nav.cur}))&&t.forEach((function(e){e.getAttribute("href")===nav.cur?e.classList.add(Cr):e.classList.remove(Cr)}))}}))}function Pr(){var e=Object(F.$$)(jr.container),t=Math.min(Object(r.getCw)(),882);e.forEach((function(e){var n=Object(F.$)(jr.scroll,e),i=Object(F.$)(jr.active,e);if(i){var a=i.offsetWidth,o=Object(r.getX)(i);o+a>t&&(n.scrollLeft=o-t+a,console.log("$scroll.scrollLeft scrollAllToActiveTab",n.scrollLeft))}}))}function Dr(){Pr()}function xr(e,t){var n=Object(r.gpeByClass)(Sr,t),i=Object(r.gpeByClass)(kr,t),a=Object(F.$)(jr.active,n);return a&&a.classList.remove(Cr),t.classList.add(Cr),Tr=i.scrollLeft,Er=Object(r.attr)(n,"id"),!0}window.SearchPanel={setQuery:function(e,t){var n=Object(F.$)(Nr(e));t=t||"",n.value!==t&&(n.value=t,Vr(n,t))}},SearchPanel._onInput=Hr,SearchPanel._onClearClick=Ur,SearchPanel._onFocus=Fr;var Lr="SearchPanel_hasQuery",Br=".SearchPanel",Rr=".SearchPanel__input",Nr=function(e){return'.SearchPanel[data-id="'+e+'"] .SearchPanel__input'};function Fr(){}function Hr(e,t){var n=e.value;Vr(e,n),d.default.handle(t,{query:n})}function Ur(e,t){var n=e.closest(Br).$(Rr);n.value="",n.oninput(),d.default.handle(t)}function Vr(e,t){e.closest(Br).classList.toggle(Lr,!!t)}window.TabRow={setSelectedTab:function(e,t){var n=Object(F.$)($r(e)),i=Object(F.$)(zr,n),a=Object(F.$)(qr(t),n);i&&i.classList.remove(Wr),a&&a.classList.add(Wr)},setTabUrl:function(e,t,n){var i=Object(F.$)($r(e)),a=Object(F.$)(qr(t),i);a&&a.setAttribute("href",n)}};var Wr="TabRow__tab_selected",$r=function(e){return'.TabRow[data-id="'+e+'"]'},qr=function(e){return'.TabRow__tab[data-id="'+e+'"]'},zr=".TabRow__tab_selected";window.SwitcherConfirm={},SwitcherConfirm._onSwitcherChange=Jr,SwitcherConfirm._onConfirmClick=Zr,SwitcherConfirm._onCancelClick=function(e){return eo(e.$btn)},SwitcherConfirm._onPopupOverlayClick=function(e){return eo(e.$popup)};var Yr=function(e){return"SwitcherConfirm_checked_"+(e?"yes":"no")},Gr=".SwitcherConfirm",Kr=".SwitcherConfirm__popup",Qr=".SwitcherConfirm__confirm",Xr=".SwitcherConfirm__cancel";function Jr(e){var t=e.$control,n=t.closest(Gr),i=Object(F.$)(Kr,n);Ln.default.open(i),n.$popup=i,n.$control=t,n.checked=e.checked}function Zr(e,t){var n=t.$btn.closest(Gr),i=Object(F.$)(Qr,n),a=Object(F.$)(Xr,n),r=n.checked;n.isSaving=!0,qt.default.setLoading(i,!0),qt.default.setDisabled(a,!0),Wd.handle(e,{checked:r,onSuccess:function(){n.isSaving=!1,Ln.default.close(n.$popup),qt.default.setLoading(i,!1),qt.default.setDisabled(a,!1),n.classList.toggle(Yr(!0),r),n.classList.toggle(Yr(!1),!r)}})}function eo(e){var t=e.closest(Gr);t.isSaving||(sr.default.setChecked(t.$control,!t.checked),Ln.default.close(t.$popup))}var to=n("gZry"),no=n("LBnd"),io=n("EKfs"),ao=n("rycc"),ro=function(e){var t=e.img?e.img:"",n=!!e.url&&e.url,i=e.title?e.title:"",a=e.subtitle?e.subtitle:"",r=e.verified?e.verified:"",o=e.mix?e.mix:"",s=e.type||null,c=e.online?e.online:"",u=!!e.actions&&e.actions,d=e.link?e.link:null,_=!!e.attrs&&e.attrs,f=!!e.linkAttrs&&e.linkAttrs,p=!!e.icon&&e.icon,h="artist"!==s||t?null:{inner:[Object(R.default)(Object(io.getMusicMicOutline28Icon)())],class:"OwnerRow__placeholderWrapper",tag:"div"};return{inner:[Object(ao.MaybeLink)({inner:[{inner:[p||{inner:[c?c.mobile?{inner:[{inner:[Object(R.default)({icon:Object(to.getOnlineMobileComposite16Icon)()})],class:"mlvi_default",tag:"span"},{inner:[Object(R.default)({icon:Object(no.getOnlineMobileCompositeMuted16Icon)()})],class:"mlvi_muted",tag:"span"}],class:"lvi mlvi OwnerRow__online OwnerRow__online--mobile","aria-label":Object(J.getLang)("mobile_accessibility_profile_online"),tag:"b"}:{class:"lvi OwnerRow__online","aria-label":Object(J.getLang)("mobile_accessibility_profile_online"),tag:"b"}:null,h],style:p?null:t?"background-image: url('"+t+"')":null,class:"OwnerRow__img",tag:"div"}],class:"OwnerRow__left",tag:"div"},{inner:[{inner:[{inner:[i],class:"OwnerRow__title",tag:"div"},r?{class:"OwnerRow__verified",tag:"div"}:null],class:l.default.class("OwnerRow__header",{verified:r},"_"),tag:"div"},{inner:[a],class:"OwnerRow__subtitle",tag:"div"}],class:"OwnerRow__right",tag:"div"},d?{inner:[d],class:"OwnerRow__link",tag:"div"}:null],class:"OwnerRow__content",href:n,attrs:f}),u?{inner:[u],class:"OwnerRow__actions",tag:"div"}:null],attrs:_,class:[l.default.class("OwnerRow",{actions:!!u},"_"),o],tag:"div"}};var oo=ro;window.OwnerRow=ro;var so=function(e){var t=e.items?e.items:[];return{inner:[(t=t.filter((function(e){return e}))).map((function(e){var t=l.default.class("OwnerInfo__row",{extraMargin:e.extraMargin,gray:e.gray,black:e.black});return{inner:[e.href?{inner:[{inner:[e.left],class:"OwnerInfo__rowLeft",tag:"div"},e.center?{inner:[e.center],class:"OwnerInfo__rowCenter",tag:"div"}:null],href:e.href,class:"OwnerInfo__rowInfo",tag:"a"}:{inner:[{inner:[e.left],class:"OwnerInfo__rowLeft",tag:"div"},e.center?{inner:[e.center],class:"OwnerInfo__rowCenter",tag:"div"}:null],class:"OwnerInfo__rowInfo",tag:"div"},e.right?{inner:[e.right],class:"OwnerInfo__rowRight",tag:"div"}:null],class:t,tag:"div"}}))],class:l.default.class("OwnerInfo",{noMargin:e.noMargin}),tag:"div"}};window.OwnerInfo=so;var co=function(e){return{inner:[{inner:[{inner:[(e.items?e.items:[]).map((function(e){return{inner:[Wd.wrap(e)],class:"OwnerPhotoGallery__item",tag:"div"}}))],class:"OwnerPhotoGallery__table",tag:"div"}],class:"OwnerPhotoGallery__wrap",tag:"div"}],class:"OwnerPhotoGallery",tag:"div"}};window.OwnerPhotoGallery=co;n("tlMv");var lo=function(){function e(){}var t=e.prototype;return t.findElement=function(){var e=document.getElementsByClassName("UnsupportedBrowser");return e.length?(this._element=e[0],this._element):null},t.getElement=function(){return this._element?this._element:this.findElement()},t.show=function(){var e,t;this._previousActiveElement=document.activeElement,null==(e=this.getElement())||e.classList.add("UnsupportedBrowser--active"),null==(t=this.getElement())||t.focus(),Object(P.statlogsValueEvent)("mvk_unsupported_browser_alert","shown")},t.hide=function(){var e,t;null==(e=this.getElement())||e.classList.remove("UnsupportedBrowser--active"),null==(t=this._previousActiveElement)||t.focus(),Object(P.statlogsValueEvent)("mvk_unsupported_browser_alert","hidden")},e}();window.UnsupportedBrowser=new lo;n("UWnA");var uo=function(){function e(){}return e.findButtonInEvent=function(e){return e.target.closest(".Btn")},e.onChange=function(t,n){if(void 0===n&&(n=""),"file"===n){var i=t.target.files;if(i&&i[0]){var a=Object(Ci.replaceEntities)(i[0].name),o=e.findButtonInEvent(t),s=Object(F.$)(".MobileInput__text",o);Object(r.val)(s,a)}}},e}();window.MobileInput=uo;var _o=n("QE8O");var fo=n("HsQo");n("QQoL"),n("rKUZ");var po=Object(r.need)("ajax"),ho=Object(r.need)("onDOMReady"),mo=Object(r.need)("onBodyResize");window.CookiePolicy={},ho(bo),CookiePolicy._onHideClick=yo;var vo="body",go="._hfixed",Ao=".CookiePolicy";function bo(){Object(F.$)(Ao)&&(wo(),mo(wo))}function wo(){if(Object(F.$)(go)){var e=Object(F.$)(vo),t=Object(F.$)(Ao).offsetHeight,n=parseInt(getComputedStyle(e).paddingBottom,10);e.style.paddingBottom=n+t+7+"px"}}function yo(e,t){e.preventDefault();var n=t.getAttribute("href");t.closest(Ao).style.display="none",mo("__clear",wo),po.post(n,{_ajax:1})}var Oo=Object(r.need)("Btn");window.PrivacyPolicy={},PrivacyPolicy._onAcceptToggle=ko;var So=".PrivacyPolicy__submit";function ko(e){var t=e.checked,n=Object(F.$)(So);Oo.setDisabled(n,!t)}n("/88W");onDOMReady((function(){window.page.onChange((function(){Object(F.$$)(".ConfirmPopup").forEach((function(e){return Ln.default.close(e)}))}))})),window.ConfirmPopup={onOverlayClick:function(e,t){var n=e.closest(".Popup");Object(F.$)('[data-key="no"]',n).click()},onButtonClick:function(e,t){t.preventDefault(),t.stopPropagation();var n=Object(Mt.parseURL)(e.href),i=n.pathname+n.search,a=Object(Mt.parseURL)(nav.prev_cur),o=a.pathname+a.search;if("no"===Object(r.domData)(e,"key")&&i===o&&"1"!==Object(r.domData)(e,"force")){var s=e.closest(".Popup");return history.back(),Ln.default.close(s)}nav.go(i)}};var Co=function(){function e(){}return e.hideDisclaimerAndPlay=function(){Object(F.$)(".VideoRestriction__boxWrap").remove(),Object(F.$)(".VideoRestriction__thumb").remove(),Object(F.$)(".vv_inline_video").play(),Object(F.$)(".VideoRestriction").setAttribute("class","")},e}();window.VideoRestriction=Co;n("Qg0H");var jo=function(e){var t=e.bcg,n=t.type;return{class:l.default.class("VotingBcg",{type:n},"_"),style:"photo"===n?Eo(t):"gradient"===n?To(t):"tile"===n?Io(t):null,inner:"photo"===n?Mo(e):null}};function Eo(e){return Po({"background-color":e.color})}function To(e){var t,n=[],i=e.points.length;for(t=0;t<i;t++){var a=e.points[t];n.push(a.color+" "+a.percent+"%")}return Po({background:"linear-gradient("+(e.angle-90)+"deg, "+(n=n.join(", "))+")"})}function Io(e){return Po({"background-image":"url('"+e.image+"')","background-position":"top center","background-size":e.width+"px "+e.height+"px"})}function Mo(e){var t=e.bcg,n=t.photo,i=t.color;return{class:"VotingBcg__photoBox",style:Po({height:e.photoHeight+"px"}),inner:[{class:"VotingBcg__photoImage",style:Po({"background-image":"url('"+n+"')"})},{class:"VotingBcg__photoGradient",style:Po({background:"linear-gradient(to bottom, rgba(255, 255, 255, 0), "+i+")"})}]}}function Po(e){var t,n=[],i=Object.keys(e),a=i.length;for(t=0;t<a;t++){var r=i[t],o=e[r];n.push(r+": "+o+";")}return n.join(" ")}var Do=jo;window.VotingBcg=jo;var xo=function(e,t){return{tag:"label",class:l.default.class("VotingForm__bcg",{light:"default"===t.type},"_"),inner:[{class:"VotingForm__bcgPreview",inner:[Do({bcg:t,photoHeight:48}),{class:l.default.class("VotingForm__bcgTextGhost",{0:!0},"_")},{class:l.default.class("VotingForm__bcgTextGhost",{1:!0},"_")},{class:l.default.class("VotingForm__bcgTextGhost",{2:!0},"_")},{class:l.default.class("VotingForm__bcgTextGhost",{3:!0},"_")},{class:l.default.class("VotingForm__bcgTextGhost",{4:!0},"_")},{class:l.default.class("VotingForm__bcgTextGhost",{5:!0},"_")}]},{tag:"input",class:"VotingForm__bcgRadio",type:"radio",name:e,checked:t.checked?"checked":null,value:t.id},{class:"VotingForm__bcgControl"}]}};var Lo=function(e){return{class:"VotingForm__option","data-created":e.is_created?"1":"0",inner:[Object(va.default)({class:"VotingForm__optionInput",name:e.name,value:e.value,on_key_down:"VotingForm._onOptionKeyDown"}),{class:"VotingForm__optionRemove",onclick:["VotingForm._onOptionRemoveClick","this"],inner:d.default.wrap(Object(Ga.default)({icon:"close16"}))}]}};var Bo=Object(r.need)("Slider");window.VotingForm={},VotingForm._onInit=Xo,VotingForm._onAddOptionClick=Qo,VotingForm._onExpireChange=Zo,VotingForm._onOptionRemoveClick=es,VotingForm._onTitleKeyDown=Yo,VotingForm._onTitleInput=Go,VotingForm._onOptionKeyDown=Ko,mediaUpload.onComplete(is),mediaUpload.onStart(as),mediaUpload.onError(os);var Ro="VotingForm_uploading",No="VotingForm_withExpire",Fo="VotingForm_maxOptions",Ho=".VotingForm",Uo=".VotingForm_maxOptions",Vo=".VotingForm__option",Wo=".VotingForm__options",$o=".VotingForm__upload",qo=".VotingForm__bcg",zo=".VotingForm__bcgRadio:checked";function Yo(e){13===e.keyCode&&e.preventDefault()}function Go(e){var t=+Object(r.attr)(e,"maxlength"),n=Object(F.$)(".VotingForm__count");t-e.value.length<=20?n.innerHTML=e.value.length+"/"+t:n.innerHTML=""}function Ko(e){if(Yo(e),13===e.keyCode){if(!Object(F.$)(Uo))if(Object(F.$)(".VotingForm__option:last-child input")===document.activeElement)return Jo(),void Object(F.$)(".VotingForm__option:last-child input").focus();if(document.activeElement){var t=document.activeElement.closest(".VotingForm__option"),n=t.nextElementSibling&&t.nextElementSibling.$("input");n&&(n.focus(),n.selectionStart=n.value.length,n.selectionEnd=n.value.length)}}else if(8===e.keyCode){if(1===Object(F.$$)(".VotingForm__option").length)return;var i=e.target;i.value||setTimeout((function(){var e=i.closest(".VotingForm__option"),t=e.previousElementSibling;if(e.outerHTML="",ns(),t){var n=t.$("input");n.focus(),n.selectionStart=n.value.length,n.selectionEnd=n.value.length}}))}}function Qo(){Jo(),Object(F.$)(".VotingForm__option:last-child input").focus()}function Xo(){var e=Object(F.$)(zo).closest(qo);Bo.scrollToElem(e)}function Jo(){var e=Object(F.$)(Wo),t=Lo({});e.insertAdjacentHTML("beforeend",Wd.html(t)),ts(),ns()}function Zo(e){var t=e.$control,n=e.checked;t.closest(Ho).classList.toggle(No,n)}function es(e){e.closest(Vo).outerHTML="",ts(),ns()}function ts(){Array.from(Object(F.$$)('.VotingForm__option[data-created="0"] input')).forEach((function(e,t){e.setAttribute("name","answers["+t+"]")}))}function ns(){var e=Object(F.$)(Ho),t=Number(e.getAttribute("data-max-options")),n=Object(F.$$)(Vo).length;e.classList.toggle(Fo,n===t)}function is(e){if(Object(F.$)(Ho)){var t=Object(F.$)($o),n=Wd.html(xo("poll_background_id",{id:"photo_"+e.photo_id,type:"photo",photo:e.src,color:e.color,checked:!0}));t.insertAdjacentHTML("beforebegin",n),ss()}}function as(){var e=Object(F.$)($o);e&&e.classList.add(Ro)}function os(e){var t=Object(F.$)(Ho);if(t){var n=t.getAttribute("data-upload-error-msg");ss(),alert(n)}}function ss(){var e=Object(F.$)(Ho);Object(F.$)($o).outerHTML=e.getAttribute("data-upload-html")}window.VotingStatsFilters={},VotingStatsFilters._onCountryChange=us;var cs=".VotingStatsFilters__section_country",ls=".VotingStatsFilters__section_city";function us(e){var t=e.$option,n=Object(F.$)(cs),i=Object(F.$)(ls),a=t.getAttribute("data-city-section-html");i&&(i.outerHTML=""),a&&n.insertAdjacentHTML("afterend",a)}var ds=window.Popup,_s=window.Btn;window.AuthCheck={},AuthCheck._onDropConfirmationClick=vs,AuthCheck._onResetSessionSubmit=gs,AuthCheck._onCurBrowserDropClick=As;var fs=function(e){return".AuthCheck__popup_index_"+e},ps=function(e){return'.AuthCheck__dropConfirmation[data-index="'+e+'"]'},hs=".AuthCheck__dropConfirmationSubmit",ms="AuthCheck__dropConfirmation_success";function vs(e){var t=Object(F.$)(fs(e));ds.open(t)}function gs(e,t){e.preventDefault();var n=e.target,i=Object(F.$)('iframe[name="'+e.target.target+'"]'),a=n.$(hs);n.submit(),_s.setLoading(a,!0),Object(r.addEvent)(i,"load",(function(){Object(F.$)(ps(t)).classList.toggle(ms),ds.close(),_s.setLoading(a,!1)}))}function As(e){var t=e.$btn;_s.setLoading(t,!0),window.ajax.click(t,{onDone:function(){Object(F.$)(ps("0")).classList.toggle(ms),ds.close(),_s.setLoading(t,!1)}})}function bs(){var e=Object(F.$)(ws.intro),t=new Scroller(e,{byPage:!0,ignoreMouseWheel:!0,noAutoScroll:!0});t.init(),cur.destroy.push((function(){return t.destroy()}))}window.AppPasswords=new function(){this.showPopup=function(){return Popup.open(Object(F.$)(".AppPasswordsPopup"))},this.hidePopup=function(){return Popup.close(Object(F.$)(".AppPasswordsPopup"))}},window.AuthCheckIntro={},AuthCheckIntro._onMount=bs;var ws={intro:".AuthCheckIntro"};function ys(){Object(F.$)(Os.self).classList.toggle(Ss.restCodesShown)}window.ReservedCodes={},ReservedCodes._onShowRestCodesClick=ys;var Os={self:".ReservedCodes"},Ss={restCodesShown:"ReservedCodes_restCodesShown"};window.Settings={_privacy:{}},Settings._privacy.onRadioChange=Ms;var ks=function(e){return'.Settings__privacyPad[data-privacy="'+e+'"]'},Cs=".Settings__privacySubmitRow",js=".Settings__privacyForm",Es=".Settings__privacySelectForbiddenLink",Ts="Settings__privacyPad_visible",Is="Settings__privacySubmitRow_visible";function Ms(e,t){if("none"===e)Ps("allowed",!1),Ps("forbidden",!1),Ds(!0);else if("allowed"===e)Ps("allowed",!0),Ps("forbidden",!1),Ds(!1);else if("forbidden"===e){Ps("allowed",!1),Ps("forbidden",!0),Ds(!0);var n=Object(F.$)(js),i=Object(F.$)(Es),a=t.name,r=t.value,o=n.getAttribute("action")+"&"+a+"="+r+"&forbid";i.setAttribute("href",o)}}function Ps(e,t){Object(F.$)(ks(e)).classList.toggle(Ts,t)}function Ds(e){Object(F.$)(Cs).classList.toggle(Is,e)}n("gNZk");window.LoginHistory={_onSubmit:function(e,t,n){var i=geByClass1("LoginHistory__iframe");preventEvent(e),t.submit(),addEvent(i,"load",(function(){return nav.go(n,null,{isForm:!0})}))},showResetSessionModal:function(e,t,n){var i=Object(ie.default)({close:!0,items:[Object(ae.ModalMenuBtn)({class:"ai_add",inner:Object(J.getLang)("mobile_settings_activity_session_reset_title"),onclick:"LoginHistory.resetSession('"+e+"', '"+t+"', '"+n+"');Popup.close(this);"})]});return ie.default.open(d.default.elem(i),!0),!1},resetSession:function(e,t,n){window.ajax.post(e,{reset_data:t,hash:n})}},window.SettingsMenu={onClick:function(e,t){return void 0===t&&(t=!1),Object(r.statlogsValueEvent)("settings_menu_click",e),t?he.default.hard_go(e):he.default.go(e),!1}};n("vOib"),n("4qEP"),n("0oUU");window.Subscriptions={editSubscription:function(e,t){if(t.context_actions){var n=Wd.html(t.context_actions.map((function(e){return Object(ve.ContextMenuItem)({title:e.title,href:e.href})}))),i=Wd.elem(Object(ve.ContextMenu)({list:n}));i.parentNode.id="container",ve.ContextMenu.open(i,"#container",{appendToBody:!0})}}};var xs,Ls,Bs=function(){function e(e){var t=e.selector,n=e.className;this.element=Object(F.$)(t),this.className=n}var t=e.prototype;return t.show=function(){this.element.classList.add(this.className)},t.hide=function(){this.element.classList.remove(this.className)},e}(),Rs=function(e){function t(){return e.call(this,{selector:".Appearance__fixedSchemes",className:"Appearance__fixedSchemes--active"})||this}return Object(Si.default)(t,e),t}(Bs),Ns=function(e){function t(){return e.call(this,{selector:".Appearance__autoSwitcher",className:"Appearance__autoSwitcher--active"})||this}return Object(Si.default)(t,e),t}(Bs);function Fs(e){var t=e.mode;o.ColorScheme.isSchemesAutoSwitchingSupported()?Ls.show():xs.show(),t===o.ColorSchemeMode.Auto&&o.ColorScheme.isSchemesAutoSwitchingSupported()?xs.hide():xs.show();var n=Object(F.$)("[name='mode'][value='"+t+"']");n&&(n.checked=!0)}function Hs(e,t){var n={mode:t,_ajax:1};L.default.post(e,n),o.colorScheme.setMode(t),Fs({mode:t})}window.Appearance={init:function(){if(o.ColorScheme.isSchemesSupported()){xs=new Rs,Ls=new Ns;var e=o.colorScheme.getMode();o.ColorScheme.isSchemesAutoSwitchingSupported()||e!==o.ColorSchemeMode.Auto||(e=o.ColorSchemeMode.Light),Fs({mode:e})}},switchOnChange:function(e,t){var n=t.checked,i=o.colorScheme.isDarkScheme()?o.ColorSchemeMode.Dark:o.ColorSchemeMode.Light;Hs(e,n?o.ColorSchemeMode.Auto:i)},radioOnChange:function(e,t){Hs(e,t.value)}};n("yVza"),n("0hva");var Us=n("EXR0"),Vs=n("GtpT"),Ws=n("k+Df");var $s=function(e){var t=window.lang,n=(e.albums||[]).map((function(e){var t=Object(Mt.makeUrl)(e.url,{act:"add"});return Object(Vs.default)({onClick:["AddPhotoModal.go",t,"this"],album:e})}));return{inner:[Object(Us.default)({inner:[t.mobile_photos_choose_album_modal_title],onClose:"AddPhotoModal.close(this)"}),n.length?Object(ae.ModalMenuContent)({inner:[e.link.createAlbum?Object(qt.default)({inner:[t.mobile_photos_choose_album_modal_create_album],class:"AddPhotoModal__createAlbum",theme:"secondary",stretch:!0,onClick:["AddPhotoModal.go",e.link.createAlbum]}):null,{inner:[n],class:"ScrollView",tag:"div"}],class:"AddPhotoModal__content"}):Object(Ws.default)({separator:!0,separator_desktop:!0,text:t.mobile_photos_choose_album_modal_empty_text,more_type:"primary",more_text:e.link.createAlbum?t.mobile_photos_placeholder_album_action:null,more_url:e.link.createAlbum,more_onclick:["AddPhotoModal.go",e.link.createAlbum]})],class:"AddPhotoModal",tag:"div"}},qs="AddPhotoModal";function zs(e){var t=e.closest("."+qs);ie.default.close(t)}window.AddPhotoModal={open:function(){var e=Object(J.getState)("upload_albums"),t=Object(J.getState)("AddPhotoModal"),n=Object(ie.default)({on_overlay_click:"AddPhotoModal.close(this)",class:qs,attached:!0,body:$s({link:{createAlbum:t.owner_id>0&&"/photos?act=select_album"},albums:e})});return ie.default.open(Wd.elem(n),!0,"",{expandable:!0})},close:zs,go:function(e,t){void 0===t&&(t=null),nav.go(e),t&&t.hasOwnProperty("$btn")?zs(t.$btn):zs(t)}},window.LovinaPromotion={click:function(e,t){var n=t?e?"https://trk.mail.ru/c/e3goc2":"https://trk.mail.ru/c/levhn2":"https://trk.mail.ru/c/i01uk8";Object(r.statlogsValueEvent)("lovina_promotion",t?1:0),window.nav.hard_go(n)}},window.AudioSpecialForYou={selector:".AudioSpecialForYou",setPlaying:function(e){var t=Object(F.$)(Ys.special);t&&t.classList.toggle(Gs,e)}};var Ys={special:window.AudioSpecialForYou.selector},Gs="AudioSpecialForYou_playing";var Ks=n("mMuO"),Qs=n("6Mr/"),Xs=function(){function e(){}return e.prototype.sendStoryAnalytic=function(e){var t={event_type:String(e),time:window.vk.ts+Math.floor(((new Date).getTime()-window.vk.started)/1e3),nav_screen:Be.NarrativeAnalyticNavScreen.storyArchive};Object(S.partConfigEnabled)("narratives_web_analytic_debug")&&console.log("-- story analytic",t),Object(Ks.saveStoryViewBaseStats)(t)},e.prototype.onSelectManyClick=function(e,t){return this.sendStoryAnalytic("select_some_story"),window.nav.go(e,t)},e.prototype.onActionsClick=function(e,t){return t.preventDefault(),Object(Qs.canShow)(Qs.TooltipHelpHints.ACCOUNT_HINT_MVK_STORIES_ARCHIVE_ACTIONS_HINT)&&Object(Qs.setHelpHintShown)(Qs.TooltipHelpHints.ACCOUNT_HINT_MVK_STORIES_ARCHIVE_ACTIONS_HINT),window.ContextMenu.open(e,".header__gear",{appendToBody:!0}),!1},e}();window.StoriesArchive=new Xs;var Js=function(){function e(e){this.store=window.Stories.getStore(),this.data=e,this.rawId=e.raw_id,this.canRemove=e.can_remove,this.canReport=e.canReport,this.canBookmark=e.canBookmark,this.canMarkNotInterested=e.canMarkNotInterested,this.isAds=e.isAds,this.trackCode=e.track_code,this.isBookmarked=e.isBookmarked,this.narrative=e.narrative,this.isNarrative=!!e.narrative,this.canAddToNarrative=e.canAddToNarrative&&!this.isNarrative,this.canEditNarrative=this.isNarrative&&e.canAddToNarrative,this.canRemoveFromNarrative=this.isNarrative&&e.canAddToNarrative,this.isPartOfNarrative=e.isPartOfNarrative,this.reportUrl=this.getReportUrl(),this.hideUrl=this.getHideUrl()}var t=e.prototype;return t.needMenu=function(){return this.canRemove||this.canReport||this.canBookmark||this.canMarkNotInterested||this.canAddToNarrative||this.canEditNarrative||this.canRemoveFromNarrative},t.getHideUrl=function(){var e=window.Stories.getHistoryURL(this.rawId),t=window.Stories.getFrom();return this.isAds&&Object(S.partConfigEnabled)("ads_new_reports_mvk_histories")?"/reports?act=hide_ad&object="+e+"&refrom="+t+"&track_code="+this.trackCode:""},t.getReportUrl=function(){var e=this.isNarrative?"narrative"+this.narrative.rawId:window.Stories.getHistoryURL(this.rawId),t=window.Stories.getFrom();return this.isAds&&Object(S.partConfigEnabled)("ads_new_reports_mvk_histories")?"/reports?act=add_ad&object="+e+"&refrom="+t+"&track_code="+this.trackCode:"/reports?act=add&object="+e+"&refrom="+t},t.render=function(){return Wd.html({inner:[{inner:[{class:"Story__icon Story__icon_menu",tag:"div"}],class:"StoryMenu__trigger",onClick:"Stories.showMenu();",tag:"div"},{inner:[this.canAddToNarrative?{inner:[{inner:[Object(J.getLang)("mobile_stories_menu_add_to_narrative")],class:"Btn Btn_theme_none StoryMenu__button",onClick:"Stories.manageStoryInNarratives();",tag:"button"}],class:"StoryMenu__row",tag:"div"}:null,this.canEditNarrative?{inner:[{inner:[Object(J.getLang)("mobile_stories_menu_edit_narrative")],class:"Btn Btn_theme_none StoryMenu__button",onClick:"return Stories.editCurrentNarrative(event);",tag:"button"}],class:"StoryMenu__row",tag:"div"}:null,this.canBookmark?{inner:[{inner:[this.isBookmarked?Object(J.getLang)("mobile_stories_menu_bookmarked_title"):Object(J.getLang)("mobile_stories_menu_bookmark_title")],class:"Btn Btn_theme_none StoryMenu__button",onClick:"Stories.toggleBookmark(this);",tag:"button"}],class:"StoryMenu__row",tag:"div"}:null,this.canRemoveFromNarrative?{inner:[{inner:[Object(J.getLang)("mobile_stories_menu_remove_from_narrative")],class:"Btn Btn_theme_none StoryMenu__button",onClick:"Stories.removeCurrentStoryFromNarrative();",tag:"button"}],class:"StoryMenu__row",tag:"div"}:null,this.canRemove?{inner:[{inner:[this.isNarrative?Object(J.getLang)("mobile_stories_menu_remove_narrative_title"):Object(J.getLang)("mobile_stories_menu_remove_title")],class:"Btn Btn_theme_none StoryMenu__button",onClick:"Stories.removeCurrentStory();",tag:"button"}],class:"StoryMenu__row",tag:"div"}:null,this.canReport?{inner:[{inner:[Object(J.getLang)("mobile_stories_menu_report_title")],class:"Btn Btn_theme_none StoryMenu__button",href:this.reportUrl,onClick:"return nav.go(this, event);",tag:"a"}],class:"StoryMenu__row",tag:"div"}:null,this.canMarkNotInterested?{inner:[{inner:[Object(J.getLang)("mobile_stories_menu_not_interested_title")],class:"Btn Btn_theme_none StoryMenu__button",onClick:"Stories.markCurrentStoryNotInterested('"+this.hideUrl+"');",tag:"button"}],class:"StoryMenu__row",tag:"div"}:null],class:"StoryMenu__container",tag:"div"}],class:"StoryMenu",tag:"div"})},e}(),Zs=n("my9s"),ec=n("rN7a"),tc=n("LRIm"),nc=n("jnUZ"),ic=n("Q+zI"),ac=n("TMW+"),rc=n("NElm"),oc=n("GzIP"),sc=function(){function e(e,t,n,i){var a,o;if(this.store=window.Stories.getStore(),this.state={authorIndex:n,storyIndex:i},this.date=e.date,this.preview=e.preview_url,this.type=e.type,this.photo_url=e.photo_url,this.video_url=e.video_url,this.first_frame=e.first_frame,this.loaded=!1,this.narrative=e.narrative,this.isNarrative=!!e.narrative,this.videoSupport=!!window.HTMLVideoElement,this.views=e.views,this.replies=e.replies,this.link=e.link,this.unread=e.unread,this.raw_id=e.raw_id,this.is_expired=e.is_expired,this.isPrivate=e.is_private,this.isDeleted=e.is_deleted,this.isAds=e.isAds,this.isPromo=e.isPromo,this.promoCaption=e.promoCaption,this.track_code=e.track_code,this.can_comment=e.can_comment,this.canLike=e.canLike,this.can_share=e.can_share,this.can_remove=e.can_remove,this.can_report=!e.can_manage,this.can_ask=e.can_ask,this.can_ask_anonymous=e.can_ask_anonymous,this.canPause="video"!==this.type,this.seeking=!1,this.progress=0,this.needShowEmptyStats=e.needShowEmptyStats,this.canAddToNarrative=e.canAddToNarrative,this.isPartOfNarrative=e.isPartOfNarrative,this.isNewQuestions=e.isNewQuestions,this.isLiked=e.isLiked,this.authorName=t.name,this.name=this.narrative?this.narrative.title:t.name,this.authorId=t.id,this.firstName=t.firstName,this.avatar=this.narrative?this.narrative.coverUrl:t.photo,this.href=t.href,this.prometheus=t.verify.includes("page_top_author"),this.verified=t.verify.includes("page_verified"),this.authorIcon=(this.prometheus||this.verified)&&!this.isNarrative,this.content=null,this.paused=!0,this.stats=e.stats,this.app=e.app,this.isMetaStory=!!e.is_groups_meta_story||!!e.is_apps_meta_story,this.isGroupsMetaStory=!!e.is_groups_meta_story,this.isAppsMetaStory=!!e.is_apps_meta_story,this.isOneTime=e.isOneTime&&t.id!==window.vk.id,this.isOneTimeSeen=e.isOneTimeSeen,this.seenProgress=this.isOneTime?e.seenProgress:null,this.onAutoPlay=Object(u.default)(),this.onDestroy=Object(u.default)(),this.onVideoBuffering=Object(u.default)(),this.onVideoData=Object(u.default)(),this.onVideoPlayEvent=Object(u.default)(),this.onVideoPauseEvent=Object(u.default)(),this.onVideoEndedEvent=Object(u.default)(),this.reply=e.reply_to,this.reply){var s=this.reply.list;this.reply=Object(r.extend)(this.reply,{onclick:'Stories.openReplies("'+s+'");'})}this.duration=8e3,this.clickable_stickers=e.clickable_stickers,this.stickers=[],this.StoryMenu=new Js(Object(r.extend)(e,{canReport:this.can_report,canBookmark:Boolean(null==(a=e.narrative)?void 0:a.bookmarkHash),isBookmarked:Boolean(null==(o=e.narrative)?void 0:o.isBookmarked)})),this.needMenu=this.StoryMenu.needMenu(),this.storyMenuHTML=this.StoryMenu.render()}var t=e.prototype;return t.update=function(e){var t=window.Stories.getCurrentStoryIndex(),n=window.Stories.getCurrentAuthorIndex();this.state.authorIndex===n&&this.state.storyIndex===t?(this.loadContent(e),window.Stories.setHistory(this.raw_id)):(this.destroy(),Object(r.val)(e,""))},t.setStartTime=function(){this.seenProgress&&(this.startTime=+(this.seenProgress/100*this.getDuration()).toFixed(1))},t.getStartTime=function(){return this.startTime||0},t.getProgressPercentByLeftTime=function(e){return 100-Math.min(Math.max(e,0)/this.getDuration()*100,100)||0},t.getDuration=function(){return this.duration},t.getPreview=function(){return this.preview},t.hasLink=function(){return!!this.link},t.getLinkUrl=function(){var e=this.link.url,t=window.Stories.getFrom(!1);return Mt.default.make(e,{from:t})},t.cantSee=function(){return this.isPrivate||this.is_expired||this.isOneTimeSeen||this.isDeleted},t.loadContent=function(e){var t=window.lang;if(this.cantSee()){window.Stories.hideLoading();var n="";this.is_expired?n=d.default.wrap(t.mobile_stories_error_expired):this.isDeleted?n=d.default.wrap(t.mobile_stories_error_deleted):this.isPrivate&&(n=d.default.wrap(t.mobile_stories_error_private));var i={class:"Story__contentError",inner:this.isOneTimeSeen?[Object(R.default)(Object(ec.getBombOutline56Icon)()),{tag:"span",class:"Story__contentErrorText Story__contentErrorText--oneTimeSeen",inner:n}]:n},a=window.Stories.getCurrentAuthorEl();Object(r.addClass)(a,dc),Object(r.val)(e,d.default.html(i)),window.Stories.restoreAudio()}else if("photo"===this.type){this.isMetaStory||window.Stories.showLoading(),this.img=new Image,this.onLoadImgBind=this.onLoadImg.bind(this),this.onLoadStory=this.onLoadStory.bind(this),Object(r.addEvent)(this.img,"load",this.onLoadImgBind),Object(r.addEvent)(this.img,"load",this.onLoadStory),this.img.src=this.photo_url;var o={style:"background-image: url("+this.photo_url+")",class:"Story__content_image"};this.isGroupsMetaStory?(Object(r.val)(e,""),e&&e.parentNode.insertAdjacentHTML("beforeend",d.default.html(this.renderGroupsMetaStory())),Object(r.addEvent)(Object(r.geByClass1)("MetaStory__recommendations-inner"),"scroll touchmove",this.handleRecommendationsScroll.bind(this)),window.Stories.hideLoading()):this.isAppsMetaStory?(Object(r.val)(e,""),e&&e.parentNode.insertAdjacentHTML("beforeend",d.default.html(this.renderAppsMetaStory())),Object(r.addEvent)(Object(r.geByClass1)("MetaStory__recommendations-inner"),"scroll touchmove",this.handleRecommendationsScroll.bind(this)),window.Stories.hideLoading()):Object(r.val)(e,d.default.html(o)),window.Stories.restoreAudio()}else if("video"===this.type)if(this.videoSupport&&window.Stories.isAutoplaySupport())window.Stories.showLoading(),this.video=Object(r.ce)("video",{src:this.video_url,className:"Story__content_video"}),Object(r.attr)(this.video,"playsinline","playsinline"),Object(r.attr)(this.video,"webkit-playsinline","webkit-playsinline"),Object(r.attr)(this.video,"muted",!0),this.video.muted=!0,this.video.setAttribute("x-yandex-pip","false"),this.video.setAttribute("disablePictureInPicture","true"),this.onCanPlayBind=this.onCanPlay.bind(this),this.onVideoWaitingBind=this.onVideoBuffer.bind(this),this.onVideoLoadedDataBind=this.onVideoLoadedData.bind(this),this.onVideoFirstDataLoadedBind=this.onVideoFirstDataLoaded.bind(this),this.onVideoPlayBind=this.onVideoPlay.bind(this),this.onVideoPlayingBind=this.onVideoPlay.bind(this),this.onVideoPauseBind=this.onVideoPause.bind(this),this.onVideoEndedBind=this.onVideoEnded.bind(this),this.onLoadStory=this.onLoadStory.bind(this),this.onVideoSeekingBind=this.onVideoSeeking.bind(this),this.onVideoSeekedBind=this.onVideoSeeked.bind(this),Object(r.addEvent)(this.video,"ended",this.onVideoEndedBind),Object(r.addEvent)(this.video,"play",this.onVideoPlayBind),Object(r.addEvent)(this.video,"pause",this.onVideoPauseBind),Object(r.addEvent)(this.video,"canplaythrough",this.onCanPlayBind),Object(r.addEvent)(this.video,"waiting",this.onVideoWaitingBind),Object(r.addEvent)(this.video,"loadedmetadata",this.onVideoLoadedDataBind),Object(r.addEvent)(this.video,"loadeddata",this.onVideoFirstDataLoadedBind),Object(r.addEvent)(this.video,"canplaythrough",this.onLoadStory),Object(r.addEvent)(this.video,"playing",this.onVideoPlayingBind),Object(r.addEvent)(this.video,"seeking",this.onVideoSeekingBind),Object(r.addEvent)(this.video,"seeked",this.onVideoSeekedBind),Object(r.append)(this.video,e),this.video.load(),window.Stories.restoreAudio(),window.Stories.pauseAudio();else{var s=window.Stories.getAuthorElems()[this.state.authorIndex];this.renderError(s,e,t.mobile_stories_inline_video_error)}},t.onLoadStory=function(){if(this.loaded=!0,this.clickable_stickers){var e=Object(r.geByClass1)("Story",this.authorElem);e&&this.renderStickersLayer.call(this,e)}if(this._loadingStartTime){this.loadingTime=Date.now()-this._loadingStartTime,window.Stories._sendViewerStartTime(this.raw_id,this.loadingTime),this._loadingStartTime=0;var t=this.isMetaStory?"group_feed_view":"view_story";window.Stories.sendAnalyticsEvent(t,{preloading_duration:this.loadingTime})}this.isMetaStory||this.isOneTime||window.Stories.markSeenStory()},t.isLoaded=function(){return this.loaded},t.onVideoSeeking=function(){this.seeking=!0,window.Stories.showLoading(),this.onVideoBuffer()},t.onVideoSeeked=function(){this.seeking=!1,this.onVideoPlay()},t.markSeen=function(){this.store.authors[this.state.authorIndex].items[this.state.storyIndex].unread=!1},t.pause=function(){!this.paused&&this.canPause&&(this.paused=!0,this.video&&!this.video.paused&&this.video.pause())},t.play=function(){this.paused&&(this.paused=!1,this.video&&this.video.play())},t.onVideoEnded=function(){this.onVideoEndedEvent()},t.onVideoPlay=function(){this.buffering=!1,window.Stories.hideLoading(),this.onVideoPlayEvent()},t.onVideoPause=function(){this.onVideoPauseEvent()},t.onLoadImg=function(){window.Stories.hideLoading(),this.setStartTime(),this.onVideoData({paused:this.paused,authorIndex:this.state.authorIndex,storyIndex:this.state.storyIndex})},t.onVideoBuffer=function(){this.buffering=!0,window.Stories.showLoading(),this.onVideoBuffering()},t.onVideoLoadedData=function(){if(0===this.video.duration){this.duration=16e3}else this.duration=1e3*this.video.duration+100;this.setStartTime(),this.onVideoData({paused:this.paused,authorIndex:this.state.authorIndex,storyIndex:this.state.storyIndex})},t.onVideoFirstDataLoaded=function(){var e=+(this.getStartTime()/1e3).toFixed(1);this.video.currentTime<e&&(this.video.currentTime=e)},t.onCanPlay=function(){window.Stories.hideLoading(),this.onAutoPlay({paused:this.paused,authorIndex:this.state.authorIndex,storyIndex:this.state.storyIndex}),this.store.isStopped&&this.video.pause()},t.getType=function(){return this.type},t.getVideoState=function(){return this.video?this.video.readyState:0},t.getVideo=function(){if(this.video)return this.video},t.renderError=function(e,t,n){var i=this,a={class:"Story__content_expired",inner:d.default.wrap(n)};Object(r.val)(t,d.default.html(a)),window.Stories.hideLoading(),this.type="broken",Object(r.addClass)(e,dc),requestAnimationFrame((function(){i.onVideoData({paused:i.paused,authorIndex:i.state.authorIndex,storyIndex:i.state.storyIndex})}))},t.hasSticker=function(e){var t=(this.clickable_stickers||{}).stickers;return!(!t||!Object(J.isArray)(t))&&t.some((function(t){return t.type===e}))},t.getSticker=function(e){var t=(this.clickable_stickers||{}).stickers;return!(!t||!Object(J.isArray)(t))&&t.find((function(t){return t.type===e}))},t.render=function(){var e,t,n=window,i=n.lang,a=n.winToUtf;Object(r.addEvent)(window,"resize",this._onResizeHandle.bind(this));var o=x.isTouch?"ontouchstart":"onmousedown",s=x.isTouch?"ontouchend":"onmouseup";this._onLoadingStart();var c=this.hasSticker(_c.storyReply),u=this.date;return this.isPromo?u=this.promoCaption:this.isAds?u=i.mobile_stories_is_promo_title:this.narrative&&(u=this.authorName+" · "+this.date),d.default.html({class:"Story",inner:[{class:"Story__header",inner:[this.reply&&!c?{class:"Story__reply",inner:this.reply.is_deleted||this.reply.is_private||this.reply.is_expired?{class:"Story__replyDeleted",inner:{class:"Story__replyDeletedContainer",inner:[{class:l.default.class("Story__icon",{deleted:this.reply.is_deleted,private:this.reply.is_private||this.reply.is_expired},"_")},{class:"Story__replyDeletedTitle",inner:this.reply.is_deleted?i.mobile_stories_reply_deleted_title:this.reply.is_expired?i.mobile_stories_reply_expired_title:i.mobile_stories_reply_private_title}]}}:{class:"Story__replyPreview",onclick:this.reply.onclick,style:"background-image: url("+this.reply.photo_url+")",inner:{class:"Story__replyTitle",inner:a(this.reply.name)}}}:null,{class:"Story__table",inner:[this.isGroupsMetaStory?null:{class:"Story__cell Story__cell_header",inner:[{class:"Story__table Story__link al_empty",href:this.href,onclick:"return Stories.clickAuthor();","data-skiponclick":1,inner:[{class:"Story__cell Story__cell_avatar",inner:{class:"Story__avatar",src:this.avatar,tag:"img"}},{class:"Story__cell Story__cell_title",inner:[{class:"Story__title",inner:[{class:"Story__name",inner:a(this.name)},this.authorIcon?{class:"Story__verified",inner:{class:l.default.class("Story__icon",{verified:this.verified,prometheus:this.prometheus},"_")}}:null]},{class:"Story__date",inner:u}]}]}]},this.isGroupsMetaStory?{class:"Story__cell Story__gridTitle Story__gridTitle--hide",inner:i.mobile_stories_groups_grid_title}:null,this.renderAddToNarrativeIcon(),{class:"Story__cell"+(this.isMetaStory?"":" Story__cell_close"),onclick:"return Stories.clickClose();",inner:{class:"Story__close"+(this.isMetaStory?" Story__close--grid":""),inner:{class:"Story__icon Story__icon_close"}}}]}]},this.renderStoryFooter(),this.can_comment?{class:"Story__form Story__form_comment",inner:[(e={class:"Story__formOverlay"},e[o]="cancelEvent(event);",e[s]="cancelEvent(event);",e.ontouchmove="cancelEvent(event);",e),{class:"Story__formPopout",ontouchmove:"cancelEvent(event);",onmousedown:"event.stopPropagation();",ontouchend:"event.stopPropagation();",inner:[{class:"Story__formHeader",inner:this.narrative?i.mobile_stories_comment_narrative_title:i.mobile_stories_comment_title},{class:"Story__formBody",inner:{class:"Story__formTextarea Story__commentTextarea",tag:"textarea",placeholder:i.mobile_stories_comment_textarea,oninput:"Stories.onInputComment(this);"}},{class:"Story__formFooter",inner:[{class:"Story__formSend Story__commentSend",onclick:"Stories.sendComment();",inner:i.mobile_stories_comment_ok},{class:"Story__formCancel",inner:i.mobile_stories_comment_cancel,onclick:"Stories.hideComment();"}]}]}]}:null,this.can_ask?this.renderAskForm():null,(t={class:"Story__overlay"},t[o]="cancelEvent(event);",t[s]="cancelEvent(event); Stories.hideMenu();",t.ontouchmove="cancelEvent(event);",t),this.clickable_stickers?{class:"Story__stickers"}:null,{class:"Story__body",style:"background-image: url("+this.preview+")"}]})},t.renderAddToNarrativeIcon=function(){if(!this.canAddToNarrative||this.narrative)return!1;var e=l.default.class("Story__toNarrative",{active:this.isPartOfNarrative});return{inner:[{inner:[this.isPartOfNarrative?Object(R.default)({icon:Object(oc.getNarrativeActiveOutline24Icon)()}):Object(R.default)({icon:Object(rc.getNarrativeOutline24Icon)()}),Object(Qs.canShow)(Qs.TooltipHelpHints.ACCOUNT_HINT_NARRATIVES_ADD_TOOLTIP)?Object(Qs.default)({inner:[Object(J.getLang)("mobile_stories_add_stories_to_narrative_hint_text")],"tooltip-id":Qs.TooltipHelpHints.ACCOUNT_HINT_NARRATIVES_ADD_TOOLTIP,onboarding:!0,pos:"bottom_right"}):null],class:e,tag:"div"}],class:"Story__cell",onClick:"return Stories.manageStoryInNarratives();",tag:"div"}},t.renderStoryFooterStatsReplies=function(){return{class:"Story__replies Story__cell",onclick:'Stories.showViews("'+this.raw_id+'")',inner:[{class:"Story__cell",inner:{class:"Story__icon Story__icon_replies Story__repliesIcon"}},{class:"Story__cell Story__repliesText",inner:this.replies}]}},t.renderStoryFooterStatsViews=function(){return{class:"Story__views Story__cell",onclick:"Stories."+(this.needShowEmptyStats?"showEmptyStats":"showViews")+'("'+this.raw_id+'")',inner:[{class:"Story__cell",inner:{class:"Story__icon Story__icon_views Story__viewsIcon"}},this.views?{class:"Story__cell Story__viewsText",inner:this.views}:null]}},t.renderStoryFooterStats=function(){return{class:l.default.class("Story__cell",{empty:Boolean(this.link)&&!this.replies&&!this.views,hidden:!(this.replies||this.views||this.link||this.needShowEmptyStats),stats:!0},"_"),inner:this.replies||this.views||this.needShowEmptyStats?{class:l.default.class("Story__stats",{new_questions:this.isNewQuestions,new_hint:!this.isNewQuestions&&this.needShowEmptyStats},"_"),inner:[this.replies?this.renderStoryFooterStatsReplies():null,this.views||this.needShowEmptyStats?this.renderStoryFooterStatsViews():null]}:null}},t.renderStoryFooterComments=function(){return{class:"Story__cell Story__cell_comment",inner:{class:"Story__commentButton",inner:{class:"Story__commentButtonText",inner:window.lang.mobile_stories_comment_placeholder},onclick:"Stories.showComment();"}}},t.renderStoryFooterMoreLink=function(){return{class:"Story__cell Story__cell_moreLink",inner:{class:"Story__moreLink",inner:[{class:"Story__moreLinkText",inner:Object(J.winToUtf)(this.link.text)},{class:"Story__icon Story__icon_topArrow"}],href:this.getLinkUrl(),onclick:"Stories.openCustomButton(event, this); return;","data-skiponclick":1}}},t.renderStoryFooterShare=function(){return{class:"Story__cell Story__cell_share",inner:{class:"Story__share",onclick:'Stories.share("'+(this.narrative?this.narrative.ownerId+"_"+this.narrative.id:this.raw_id)+'", '+!!this.narrative+");",inner:{class:"Story__icon Story__icon_share","data-skiponclick":1}}}},t.renderStoryFooterVerticalButtons=function(e){return{class:"Story__verticalButtons",inner:[e?{class:"Story__verticalButton Story__app "+(e.hasNewInteractions?"has_new":""),onclick:"Stories.clickToApp();",inner:Object(R.default)(Object(tc.getServices48Icon)())}:null,this.canLike?{class:"Story__verticalButton Story__like"+(this.isLiked?" Story__like--set":""),onclick:"Stories.toggleLikeForCurrentStory(this)",inner:Object(R.default)(this.isLiked?Object(ic.getLikeShadow48Icon)():Object(ac.getLikeOutlineShadow48Icon)())}:null]}},t.renderStoryFooter=function(){var e=this.getSticker(_c.app);return{class:"Story__footer",inner:this.isMetaStory||this.is_expired?null:{class:"Story__table",inner:[this.renderStoryFooterStats(),this.link&&this.link.text?this.renderStoryFooterMoreLink():this.can_comment?this.renderStoryFooterComments():null,this.can_share?this.renderStoryFooterShare():null,this.needMenu?{class:"Story__cell Story__cell_menu",inner:d.default.wrap(this.storyMenuHTML)}:null,e||this.canLike?this.renderStoryFooterVerticalButtons(e):null]}}},t.renderAskForm=function(){var e,t=window.lang,n=x.isTouch?"ontouchstart":"onmousedown",i=x.isTouch?"ontouchend":"onmouseup";return{class:"Story__form Story__form_question",onClick:"Stories.toggleQuestionTooltip(event, true);",inner:[(e={class:"Story__formOverlay"},e[n]="cancelEvent(event);",e[i]="Stories.toggleQuestionTooltip(event, true);",e.ontouchmove="cancelEvent(event);",e),{class:"Story__formPopout",ontouchmove:"cancelEvent(event);",onmousedown:"event.stopPropagation();",ontouchend:"event.stopPropagation();",inner:[{class:"Story__formHeader",inner:{class:"Story__formHeaderInner",inner:[{tag:"button",class:"Btn Btn_theme_none Story__formHeaderBtn Story__questionSelect",inner:t.mobile_stories_ask_question_author_only,onclick:"Stories.changeAskAnonymous(event);","data-selected":1},{class:"QuestionSupport Icon Icon_menu_support",onclick:"Stories.toggleQuestionTooltip(event);",inner:{class:"QuestionSupport__tooltip"}}]}},{class:"Story__formBody",inner:{class:"Story__formTextarea Story__questionTextarea",tag:"textarea",placeholder:t.mobile_stories_ask_question_placeholder,oninput:"Stories.onInputQuestion(this);",maxlength:80}},{class:"Story__formFooter",inner:[Object(qt.default)({class:"Story__questionSend",theme:"regular",inner:t.mobile_stories_ask_question_ok,on_click:["Stories.sendQuestion"],disabled:!0}),Object(qt.default)({class:"Story__questionSend",theme:"link",inner:t.mobile_stories_ask_question_cancel,on_click:["Stories.hideAskQuestion"]})]}]}]}},t._getStickerStyle=function(e,t){var n=this.clickable_stickers,i=n.original_width,a=n.original_height,o=e.top,s=e.left,c=e.width,l=e.height,u=e.rotate,d=Object(r.getSize)(t),_=d[0],f=d[1],p=_,h=f;return f/_>1.77?p=i*f/a:h=a*_/i,"\n      top: "+(o*h-(h-f)/2)+"px;\n      left: "+(s*p-(p-_)/2)+"px;\n      width: "+c*p+"px;\n      height: "+l*h+"px;\n      transform: rotate("+u+"deg);\n    "},t.renderStickersLayer=function(e){var t,n,i=this,a=Object(r.geByClass1)("Story__stickers",e),o=(Object(r.isObject)(this.clickable_stickers)?this.clickable_stickers:{}).stickers,s=x.isTouch?"ontouchstart":"onmousedown",c=x.isTouch?"ontouchend":"onmouseup";a&&(a.innerHTML=""),a.appendChild(d.default.elem(((t={class:"Story__stickersDisableArea Story__stickersDisableArea--left"})[s]="Stories.onTouchStart(event);",t[c]="Stories.onTouchEnd(event, true);",t.ontouchcancel="Stories.onTouchEnd(event, true);",t))),a.appendChild(d.default.elem(((n={class:"Story__stickersDisableArea Story__stickersDisableArea--right"})[s]="Stories.onTouchStart(event);",n[c]="Stories.onTouchEnd(event);",n.ontouchcancel="Stories.onTouchEnd(event);",n))),o.forEach((function(t){var n,o=t.id,l=t.type,u=t.style;if([_c.hashtag,_c.mention,_c.question,_c.place,_c.music,_c.storyReply,_c.owner,_c.link,_c.marketItem,_c.post,_c.poll,_c.app,_c.sticker,_c.situationalTheme].includes(l)){var _=d.default.elem(((n={class:"Story__sticker"})[s]="Stories.onTouchStart(event);",n[c]="Stories.onTouchEnd(event);",n.ontouchcancel="Stories.onTouchEnd(event);",n.style=""+i._getStickerStyle(t,e),n));switch(Object(r.domData)(_,"id",o),Object(r.domData)(_,"type",l),u&&Object(r.domData)(_,"style",u),l){case _c.hashtag:Object(r.domData)(_,"hashtag",t.hashtag);break;case _c.mention:Object(r.domData)(_,"mentioned_photo_url",t.mentionedPhotoUrl),Object(r.domData)(_,"mentioned_owner_href",t.mentionedOwnerHref),Object(r.domData)(_,"mentioned_text",t.mentionedText);break;case _c.question:Object(r.domData)(_,"question",t.question);break;case _c.place:if(i.store.list==="place"+t.placeId)return;Object(r.domData)(_,"place_id",t.placeId);break;case _c.music:var f=window.Stories.getCurrentStory(),p=t.audioId,h=t.audioData,m=t.audioRestriction;if(m){var v=i.getVideo();if(v&&f.needMute){var g=window.Stories.getAuthorElems()[i.state.authorIndex];Object(r.removeClass)(g,uc),v.muted=!0}a.appendChild(d.default.elem({class:"StoryRestriction",inner:{class:"StoryRestriction__inner",inner:[{class:"StoryRestriction__title",inner:m.title},m.buttonUrl?{class:"StoryRestriction__link",href:m.buttonUrl,inner:m.buttonText}:null]}})),Object(r.domData)(_,"disabled",1)}Object(r.addClass)(_,"audio_item"),Object(r.addClass)(_,"audio_item_"+p),Object(r.domData)(_,"id",p),Object(r.domData)(_,"audio",h);try{Object(r.domData)(_,"track-code",JSON.parse(h).track_code)}catch(e){}_.setAttribute("id","audio"+p);break;case _c.storyReply:Object(r.domData)(_,"owner-id",t.ownerId),Object(r.domData)(_,"story-id",t.storyId),Object(r.domData)(_,"link",t.link);break;case _c.owner:Object(r.domData)(_,"owner-id",t.ownerId),Object(r.domData)(_,"link",t.link);break;case _c.link:Object(r.domData)(_,"link",t.link),Object(r.domData)(_,"tooltip-text",t.tooltipText);break;case _c.marketItem:Object(r.domData)(_,"photoUrl",t.photoUrl),Object(r.domData)(_,"link",t.link),t.isRestricted&&Object(r.domData)(_,"isRestricted","isRestricted");break;case _c.post:Object(r.domData)(_,"post-owner-id",t.postOwnerId),Object(r.domData)(_,"post-id",t.postId);break;case _c.poll:Object(r.domData)(_,"pollId",t.pollId),Object(r.domData)(_,"pollOwnerId",t.pollOwnerId);break;case _c.app:Object(r.domData)(_,"app-id",t.appId),Object(r.domData)(_,"app-ref",t.appRef),Object(r.domData)(_,"app-hash",t.appHash);break;case _c.sticker:Object(r.domData)(_,"link","/stickers?stickers_id="+t.stickerPackId),Object(r.domData)(_,"tooltip-text",t.tooltipText);break;case _c.situationalTheme:Object(r.domData)(_,"situational-app-id",t.situationalAppId),Object(r.domData)(_,"situational-theme-id",t.situationalThemeId)}a.appendChild(_),i.stickers.push(_)}}))},t._onResizeHandle=function(){var e=this,t=Object(r.geByClass1)("Story",this.authorElem),n=(Object(r.isObject)(this.clickable_stickers)?this.clickable_stickers:{}).stickers;Object(J.isArray)(n)&&n.forEach((function(n,i){e.stickers[i]&&Object(r.setStyle)(e.stickers[i],e._getStickerStyle(n,t))}))},t._createStickerLink=function(e,t){void 0===t&&(t={});var n=Object(r.intval)(Object(r.domData)(e,"disabled")),i=window.lang;if(t.type&&!n){var a,o,s,c="a",l=!0,u="Stories__tooltipLink",_=function(){},f={type:t.type,style:Object(r.domData)(e,"style")};switch(t.type){case _c.hashtag:var p=Object(r.domData)(e,"hashtag")||"",h=p.replace("#","%23");a="/feed?section=search&q="+h,o=i.mobile_stories_show_hashtag_link,s="search",f.text=p;break;case _c.mention:var m=Object(r.domData)(e,"mentioned_photo_url"),v=Object(r.domData)(e,"mentioned_owner_href"),g=Object(r.domData)(e,"mentioned_text");u+=" Stories__tooltipLink--mention",a=v,o=d.default.html([{class:"StoriesTooltipMention",inner:[{class:"StoriesTooltipMention__avatar",style:"background-image: url("+m+")"},{class:"StoriesTooltipMention__text",inner:g}]}]),s="profile";break;case _c.place:var A=Object(r.domData)(e,"place_id"),b=window.Stories.getFrom();a="/place"+A,o=i.mobile_stories_go_to_place,this.store.list.includes("place")?l=!0:(a+="?from="+b,_=function(){c="div",l=!1,window.Stories._hideTooltips(!0),window.Stories.showLoading(),nav.go(a)}),s="place";break;case _c.music:c="div",o=i.mobile_stories_music_more,_=function(){var t=Object(r.domData)(e,"id"),n=Object(r.domData)(e,"audio");window.Stories.openMusicStickerActions(t,n)};break;case _c.storyReply:case _c.owner:var w=this.reply,y=w.is_expired,O=w.list;if(t.type===_c.owner||y)o=Object(r.domData)(e,"owner-id")>0?i.mobile_stories_go_to_profile:i.mobile_stories_go_to_group,a=Object(r.domData)(e,"link"),s="profile";else c="div",o=i.mobile_stories_go_to_story,_=function(){window.Stories.openReplies(O)};break;case _c.link:o=Object(r.domData)(e,"tooltip-text"),a=Object(r.domData)(e,"link");break;case _c.marketItem:var S=Object(r.domData)(e,"photoUrl"),k=!!Object(r.domData)(e,"isRestricted");k&&(_=function(e){e.preventDefault(),window.AlertBox(Object(J.getLang)("mobile_stories_market_access_error_text"),Object(J.getLang)("mobile_stories_market_access_error_title"))}),o=d.default.html([S&&!k?{class:"Stories__marketItemThumb",tag:"img",src:S}:{class:"Stories__marketItemThumb Stories__marketItemThumb--stub",inner:Object(R.default)(Object(nc.getItemStubIcon)())},{class:"Stories__marketItemText",tag:"span",inner:Object(J.getLang)("mobile_stories_market_item_more")}]),a=Object(r.domData)(e,"link");break;case _c.post:var C=Object(r.domData)(e,"post-owner-id"),j=Object(r.domData)(e,"post-id");o=i.mobile_stories_go_to_post,a="/wall"+C+"_"+j;break;case _c.sticker:o=Object(r.domData)(e,"tooltip-text"),a=Object(r.domData)(e,"link")}return window.Stories._requestStickerStat("click",f),Object(r.ce)(c,{href:"a"===c?a:null,target:l?"_blank":null,innerHTML:o+d.default.html({inner:[Object(R.default)({icon:Object(Zs.getGotoArrow8Icon)()})],class:"Stories__tooltipLinkIcon",tag:"span"}),className:u,onclick:function(e){_&&_(e),s&&window.Stories._requestStickerStat(s,f),[_c.hashtag,_c.mention,_c.place,_c.storyReply,_c.post,_c.link,_c.sticker,_c.situationalTheme].includes(t.type)&&window.Stories.sendAnalyticsEvent("click_to_tooltip",{clickable_sticker:{id:t.id,type:fc[t.type]}})}})}},t._onLoadingStart=function(){this._loadingStartTime=new Date},t.renderAppsMetaStory=function(){var e="apps",t=window.lang;window.store.stories[e]||(window.store.stories[e]=window.Stories._forceSetStore(this.raw_id+"/"+e,e,window.store.storiesLists[e]));var n=window.store.stories[e]&&window.store.stories[e].authors,i=Math.max(document.documentElement.clientHeight,window.innerHeight||0),a=[];return n&&(this.coverItems=n,this.coverCount=this.coverItems?this.coverItems.length:0,this.coverRowsCount=Math.ceil(this.coverCount/3),this.scrollOffset=0,this.metaStoryGridMarginTop=40.8*i/100,this.coverItems.forEach((function(t){var n=t.items.filter((function(e){return e.unread})),i=!!n.length,r=t.items[0],o=t.id?"{ id: '"+t.id+"' }":"{}";i&&(r=n[0]);var s={tag:"span",class:"GridStoryPreview",style:"background-image: url("+r.preview_url+")",onclick:'Stories.openNarrative("'+r.raw_id+"/"+e+'", '+o+")",inner:[{class:"GridStoryPreview__inner",style:"background-image: url("+r.small_preview+")",inner:[{tag:"a",href:t.author.href,attrs:{"data-author-id":t.author.id},class:"GridStoryPreview__author"+(i?" GridStoryPreview__author--unread":""),style:"background-image: url("+t.author.photo+")"},{tag:"span",class:"GridStoryPreview__title",innerHTML:t.author.name}]}]};a.push(s)}))),{class:"MetaStory MetaStory--apps",inner:[{class:"MetaStory__infoWrapper",inner:[{class:"MetaStory__info",inner:[{tag:"a",href:this.app.url,target:"_blank",class:"MetaStory__appWrapper",inner:[{class:"MetaStory__appIcon",style:"background-image: url("+this.app.photoUrl+")"},{class:"MetaStory__appName",innerHTML:this.app.name},{class:"MetaStory__separator"},{tag:"span",class:"MetaStory__appLink",innerHTML:t.mobile_stories_go_to_app}]}]}]},a.length?{class:"MetaStory__recommendations",inner:[{class:"MetaStory__recommendations-inner",inner:[{class:"MetaStory__recommendations-items",inner:a}]}]}:null]}},t.renderGroupsMetaStory=function(){var e="groups",t=window.lang;window.store.stories[e]||(window.store.stories[e]=window.Stories._forceSetStore(this.raw_id+"/"+e,e,window.store.storiesLists[e]));var n=window.store.stories[e]&&window.store.stories[e].authors,i=Math.max(document.documentElement.clientHeight,window.innerHeight||0),a=[];return n&&(this.coverItems=n,this.coverCount=this.coverItems?this.coverItems.length:0,this.coverRowsCount=Math.ceil(this.coverCount/3),this.scrollOffset=0,this.metaStoryGridMarginTop=40.8*i/100,this.coverItems.forEach((function(t){var n=t.items.filter((function(e){return e.unread})),i=!!n.length,r=t.items[0],o=t.id?"{ id: '"+t.id+"' }":"{}";i&&(r=n[0]);var s={tag:"span",class:"GridStoryPreview",style:"background-image: url("+r.preview_url+")",onclick:'Stories.openNarrative("'+r.raw_id+"/"+e+'", '+o+")",inner:[{class:"GridStoryPreview__inner",style:"background-image: url("+r.small_preview+")",inner:[{tag:"a",href:t.author.href,attrs:{"data-author-id":t.author.id},class:"GridStoryPreview__author"+(i?" GridStoryPreview__author--unread":""),style:"background-image: url("+t.author.photo+")"},{tag:"span",class:"GridStoryPreview__title",innerHTML:t.author.name}]}]};a.push(s)}))),{class:"MetaStory MetaStory--groups",inner:[{class:"MetaStory__infoWrapper",inner:[{class:"MetaStory__info",inner:[{class:"MetaStory__infoTitle",inner:t.mobile_stories_groups_grid_title},{class:"MetaStory__infoDescription",inner:t.mobile_stories_groups_grid_text}]}]},a.length?{class:"MetaStory__recommendations",inner:[{class:"MetaStory__recommendations-inner",inner:[{class:"MetaStory__recommendations-items",inner:a}]}]}:null]}},t.handleRecommendationsScroll=function(){window.event.stopPropagation&&window.event.stopPropagation(),window.event.stopImmediatePropagation&&window.event.stopImmediatePropagation();var e=Object(r.geByClass1)("MetaStory__recommendations"),t=Object(r.geByClass1)("MetaStory__recommendations-inner");if(t&&e){var n=Math.min(t.scrollTop/(this.scrollOffset/100),70)/100;Object(r.setStyle)(e,{backgroundColor:"rgba(0, 0, 0, "+n+")"}),t.scrollTop?(Object(r.addClass)(e,"scroll"),window.Stories.pauseStory()):(window.Stories.playStory(),Object(r.removeClass)(e,"scroll")),this.isGroupsMetaStory&&(this.blockHeaderEl||(this.blockHeaderEl=Object(r.geByClass1)("Story__gridTitle")),t.scrollTop>this.metaStoryGridMarginTop?Object(r.removeClass)(this.blockHeaderEl,"Story__gridTitle--hide"):Object(r.addClass)(this.blockHeaderEl,"Story__gridTitle--hide"))}},t.pauseAudio=function(){window.Stories.pauseAudio()},t.destroy=function(){this.img&&Object(r.removeEvent)(this.video,"load",this.onLoadImgBind),this.video&&(Object(r.removeEvent)(this.video,"ended",this.onVideoEndedBind),Object(r.removeEvent)(this.video,"play",this.onVideoPlayBind),Object(r.removeEvent)(this.video,"pause",this.onVideoPauseBind),Object(r.removeEvent)(this.video,"canplaythrough",this.onCanPlayBind),Object(r.removeEvent)(this.video,"waiting",this.onVideoWaitingBind),Object(r.removeEvent)(this.video,"loadedmetadata",this.onVideoLoadedDataBind),Object(r.removeEvent)(this.video,"playing",this.onVideoPlayingBind),Object(r.removeEvent)(this.video,"seeking",this.onVideoSeekingBind),Object(r.removeEvent)(this.video,"seeked",this.onVideoSeekedBind),this.video.src="",this.video.load()),this.onDestroy(),this.onAutoPlay.off(),this.onDestroy.off(),this.onVideoBuffering.off(),this.onVideoData.off(),this.onVideoPlayEvent.off(),this.onVideoPauseEvent.off(),this.onVideoEndedEvent.off(),window.Stories._hideTooltips()},e}(),cc=function(){function e(e,t){var n=Object.assign({},{tick:100,onEnd:function(){},onTick:function(){},onStart:function(){},onPause:function(){},onStop:function(){}},t);this.left=e,this.initialTime=e,this.tick=n.tick,this.onEnd=n.onEnd,this.onTick=n.onTick,this.onStart=n.onStart,this.onPause=n.onPause,this.onStop=n.onStop,this.started=!1}var t=e.prototype;return t.stop=function(e){void 0===e&&(e=!1),this.started&&(this.pause(e),this.left=this.initialTime,e||this.onStop())},t.pause=function(e){void 0===e&&(e=!1),this.timer&&(this.timer=clearInterval(this.timer),this.started=!1,e||this.onPause())},t.start=function(){var e=this;if(this.started)return!1;var t=new Date(Date.now()+this.left).getTime();this.started=!0,this.timer=setInterval((function(){var n=(new Date).getTime();e.left=t-n,e.left<=0?(e.onTick(0),e.onEnd(),e.stop(!0)):e.onTick(e.left)}),this.tick),this.onStart()},t.isStarted=function(){return this.started},t.getTimeLeft=function(){return this.left},e}(),lc=n("0hlj"),uc="StoryAuthor_videoMuted",dc="StoryAuthor--error",_c={hashtag:1,mention:2,question:3,place:4,music:5,storyReply:6,owner:7,link:8,marketItem:9,post:10,poll:11,sticker:12,app:13,situationalTheme:14},fc=Object.entries(_c).reduce((function(e,t){return e[t[1]]=t[0],e}),{}),pc=function(){function e(e,t){var n=this;this.store=window.Stories.getStore(),this.data=t,this.state={authorIndex:e};var i=this.getCurrentStoryIndex();this.setCurrentStoryIndex(i),this.story=new sc(this.data.items[i],this.data.author,e,i),this.authorStoriesHTML=d.default.html(this.story.render()),this.progressItemElems=null,window.Stories.onRender((function(){n.updateStory()}))}var t=e.prototype;return t.getCurrentStory=function(){if(this.story)return this.story},t.destroy=function(){this.story&&this.story.destroy()},t.update=function(){var e=this.data.index;this.destroy(),this.story=new sc(this.data.items[e],this.data.author,this.state.authorIndex,e),this.authorStoriesHTML=d.default.html(this.story.render())},t.updateHeader=function(){this.authorElems=window.Stories.getAuthorElems(),this.authorElem=this.authorElems[this.state.authorIndex],this.progressItemElems=Array.from(Object(r.geByClass)("StoryAuthor__progressItem",this.authorElem)),this.drawFilledProgressItems()},t.updateStory=function(){var e=this;this.authorElems=window.Stories.getAuthorElems(),this.authorElem=this.authorElems[this.state.authorIndex];var t=Object(r.geByClass1)("Story__body",this.authorElem);this.story.update(t),this.story.onVideoData((function(n){n.authorIndex,n.storyIndex;var i=e.story.getDuration(),a=e.story.getType(),o=e.store.isStopped,s=e.story.getStartTime(),c=e.story.getProgressPercentByLeftTime(i-s);if(e.drawCurrentProgress(c),Object(r.removeClass)("StoryAuthor__progress--hide",Object(F.$)(".StoryAuthor__progress",e.authorElem)),e.countdown=new cc(i-s,{tick:13,onTick:function(t){var n=e.story.getProgressPercentByLeftTime(t);e.drawCurrentProgress(n)},onEnd:function(){"video"!==a&&(e.drawCurrentProgress(100),window.Stories.nextStory(!0),Object(r.removeClass)(e.authorElem,"StoryAuthor_paused"))},onPause:function(){e.story.pause(),Object(r.addClass)(e.authorElem,"StoryAuthor_paused")},onStart:function(){e.story.play(),Object(r.removeClass)(e.authorElem,"StoryAuthor_videoHold"),Object(r.removeClass)(e.authorElem,"StoryAuthor_paused")}}),"photo"!==a&&"broken"!==a||o){if("video"===a){var l=e.story.getVideoState(),u=e.story.getVideo();Object(r.addClass)(t,"Story__body_video"),4!==l||o||u.paused||e.countdown.start()}}else e.countdown.start()})),this.story.onVideoEndedEvent((function(){e.drawCurrentProgress(100),e.story.progress=100,window.Stories.nextStory(!0)})),this.story.onVideoPauseEvent((function(){e.countdown&&e.countdown.pause()})),this.story.onVideoBuffering((function(){e.countdown&&e.countdown.pause()})),this.story.onVideoPlayEvent((function(){e.countdown&&!e.store.isStopped&&e.countdown.start()})),this.story.onAutoPlay((function(){var t=window.lang,n=e.story.getVideo();window.Stories.pauseAudio();var i=Object(r.geByClass1)("Story__body",e.authorElem),a=window.Stories.isGoodBrowser(),o=n.play();o?o.then((function(){e.story.canPause=!0})):e.story.canPause=!0,n.paused&&!a?e.story.renderError(e.authorElem,i,t.mobile_stories_inline_video_error):!e.countdown||e.store.isStopped||n.paused||e.story.buffering?a&&n.paused&&Object(r.addClass)(e.authorElem,"StoryAuthor_videoHold"):e.countdown.start(),n.muted&&Object(r.addClass)(e.authorElem,uc)})),this.story.onDestroy((function(){e.countdown&&(e.countdown.stop(),e.countdown=null)}))},t.getCountDown=function(){if(this.countdown)return this.countdown},t.getFirstUnreadStoryIndex=function(){if(window.Stories._hasContext("all"))return 0;var e=this.data.items.findIndex((function(e){return!0===e.unread}));return-1!==e?e:0},t.getCurrentStoryIndex=function(){if(!this.data.index){var e=this.getFirstUnreadStoryIndex();this.setCurrentStoryIndex(e)}return this.data.index},t.drawCurrentProgress=function(e){if(this.progressItemElems){var t=this.progressItemElems[this.data.index],n=Object(r.geByClass1)("StoryAuthor__progressItemCurrent",t),i=Object(r.geByClass1)("StoryAuthor__wick",t),a=e/100*t.clientWidth;r.setStyle.transform(n,void 0,[a,0]),this.story.isOneTime&&r.setStyle.transform(i,void 0,[a,0])}},t.drawFilledProgressItems=function(){var e=this.data.index;if(this.progressItemElems)for(Object(r.each)(this.progressItemElems,(function(e,t){Object(r.removeClass)(t,"StoryAuthor__progressItem_filled")}));e>=0;)Object(r.addClass)(this.progressItemElems[--e],"StoryAuthor__progressItem_filled")},t.setCurrentStoryIndex=function(e){this.data.index=e,this.drawFilledProgressItems()},t.renderEmpty=function(){var e=this.story.getPreview(),t=window.Stories.getWidth();return d.default.html({class:"StoryAuthor StoryAuthor_empty",style:"width: "+t+"px;",attrs:{"data-src":e}})},t.render=function(){var e,t,n,i=this,a=window.lang,r=window.Stories.getWidth(),o=x.isTouch?"ontouchstart":"onmousedown",s=x.isTouch?"ontouchend":"onmouseup";return d.default.html({class:"StoryAuthor StoryAuthor_inited",style:"width: "+r+"px;",inner:[{class:"StoryAuthor__header",inner:{class:"StoryAuthor__progress"+(this.story.isOneTime?" StoryAuthor__progress--isOneTime StoryAuthor__progress--hide":""),inner:this.data.items.map((function(){return{class:"StoryAuthor__progressItem",inner:[{class:"StoryAuthor__progressItemBar",inner:{class:"StoryAuthor__progressItemCurrent"}},i.story.isOneTime?{class:"StoryAuthor__wick"}:null]}}))}},(e={class:"StoryAuthor__muted"},e[o]="Stories.unMute(this, event);",e.inner=[{class:"Story__icon_unmute",inner:Object(R.default)(Object(lc.getVolumeUnmuted24Icon)())},{class:"StoryAuthor__muted_text",inner:a.mobile_stories_unmute}],e),(t={class:"StoryAuthor__next"},t[o]="Stories.onTouchStart(event);",t[s]="Stories.onTouchEnd(event);",t.ontouchcancel="Stories.onTouchEnd(event);",t),(n={class:"StoryAuthor__prev"},n[o]="Stories.onTouchStart(event);",n[s]="Stories.onTouchEnd(event, true);",n.ontouchcancel="Stories.onTouchEnd(event, true);",n),{class:"StoryAuthor__body",inner:this.authorStoriesHTML}]})},e}(),hc=n("t2Vq"),mc=n("c9MT"),vc=n("AWZS");var gc=function(e){void 0===e&&(e={});var t=e.mode||"tint",n=e.size||"s",i=e.imageTheme||"dark",a="image"===t&&"dark"===i,r=l.default.class("Banner",{md:t,sz:n,aside:e.asideMode,inverted:a}),o="image"===t&&e.background,s=null;return e.link&&(s={href:e.link,onClick:"nav.go('"+e.link+"', event);",class:"Banner__link",tag:"a"}),{inner:[{inner:[o?{inner:[e.background],class:"Banner__bg",tag:"div"}:null,e.before?{inner:[e.before],class:"Banner__before",tag:"div"}:null,{inner:[e.link&&s,e.header?{inner:[e.header],class:"Banner__header",tag:"div"}:null,e.subheader?{inner:[e.subheader],class:"Banner__subheader",tag:"div"}:null,e.text?{inner:[e.text],class:"Banner__text",tag:"div"}:null,e.actions?{inner:[e.actions],class:"Banner__actions",tag:"div"}:null],class:"Banner__content",tag:"div"},"expand"===e.asideMode?{inner:[Object(R.default)({icon:Object(hc.getChevron24Icon)()})],class:"Banner__expand Btn Btn_theme_none",onClick:e.onExpand,tag:"button"}:null,"dismiss"===e.asideMode?{inner:[Object(R.default)({icon:a?Object(vc.getDismissDark24Icon)():Object(mc.getDismiss24Icon)()})],class:"Banner__dismiss Btn Btn_theme_none",onClick:e.onDismiss,tag:"button"}:null],class:"Banner__in",tag:"div"}],onClick:e.onClick,class:r,tabindex:"0",role:"button",tag:"div"}},Ac=n("lmbN"),bc=n("Q8TZ"),wc=n("xTMR"),yc=n("zJPW"),Oc=function(){function e(e){var t=window.lang;this.store=window.Stories.getStore(),this.viewers=this.store.viewers[e]||[],this.viewersState=this.store.viewersState[e]||[],this.questions=this.store.questions[e]||[],this.replies=this.store.replies[e]||[],this.poll=this.store.polls[e],this.extendedStats=this.store.extendedStats[e];var n=this.viewersState,i=n.count,a=n.repliesCountText,r=n.authorCountText,o=n.hiddenReason,s=n.privacyHint;this.raw_id=e,this.count=i,this.countText=Object(J.langNumeric)(this.count,t.mobile_stories_views_title),this.hiddenReason=o,this.repliesCountText=a,this.repliesAuthorCountText=r,this.privacyHint=s||{},this.questions.length||this.privacyHint.showEmptyStatsPrivacyHint||this.extendedStats?this.title=t.mobile_stories_views_title_interactions:this.count&&this.replies.length?this.title=t.mobile_stories_views_title_replies_and_views:this.count?this.title=this.countText:this.replies.length&&(this.title=t.mobile_stories_views_title_replies)}var t=e.prototype;return t.render=function(){var e=this,t=window,n=t.winToUtf,i=t.lang,a=this.store.questions[this.raw_id]||[],r=this.needShowOnlyHiddenViewersInfo(),o=this.viewersState.privacyHint||{};return d.default.html({class:l.default.class("Views",{short:!(this.viewers.length||!this.replies.length||this.hiddenReason)},"_"),inner:[{class:"Views__overlay",onclick:"Stories.hideViews();"},{class:"Views__header",inner:[{class:"Views__table",inner:[{class:"Views__cell",inner:{class:"Views__title",inner:this.title}}]},{class:"Views__close",onclick:"Stories.hideViews();"}]},{class:"Views__body ScrollView"+(r?" Views__body--centerAlign":""),onscroll:'Stories.onScrollViews(this, "'+this.raw_id+'")',ontouchmove:"event.stopPropagation();",inner:[this.extendedStats?this.renderExtendedStatsBanner():null,o.showEmptyStatsPrivacyHint?{class:"ViewsEmptyStatsBlock",inner:[{class:"ViewsEmptyStatsBlock__icon",inner:Object(R.default)(Object(wc.getHideOutline56Icon)())},{class:"ViewsEmptyStatsBlock__text",inner:i.mobile_stories_feedback_empty_stats_hint},{class:"ViewsEmptyStatsBlock__link",inner:{tag:"a",class:"link",inner:i.mobile_stories_go_to_privacy_settings,href:"/settings?act=privacy&privacy_edit=stories",onclick:["Stories.goToSettingsFromPrivacyHint",this.raw_id,"this","event"]}}]}:null,o.showPrivacyHint?{class:"ViewsPrivacyHint",inner:gc({subheader:i.mobile_stories_feedback_privacy_hint,asideMode:"dismiss",before:Object(R.default)(Object(yc.getLockOutline28Icon)()),actions:{tag:"a",class:"link",inner:i.mobile_stories_go_to_settings,href:"/settings?act=privacy&privacy_edit=stories",onclick:["Stories.goToSettingsFromPrivacyHint",this.raw_id,"this","event"]},onDismiss:["Stories.hidePrivacyHint",this.raw_id]})}:null,this.replies.length?{class:"Views__replies StoryViewsSeparator",inner:[{class:"Views__table Views__repliesHeader",inner:[{class:"Views__cell Views__repliesCount",inner:this.repliesCountText},this.repliesAuthorCountText?{class:"Views__cell Views__repliesAuthorCount",inner:this.repliesAuthorCountText}:null]},{class:"Views__repliesBody",onscroll:'Stories.onRepliesScroll(event, "'+this.raw_id+'")',inner:{class:"Views__repliesScroll",inner:this.replies.map((function(t){return{class:"Views__reply "+(t.has_new?"Views__reply_new":""),onclick:'Stories.openReplies("'+t.owner_id+"/"+t.list+'", "'+e.raw_id+'");',inner:[{class:"Views__replyAvatarWrap",inner:{class:"Views__replyAvatar",src:t.photo_owners_data[0].owner_photo_url,tag:"img"}},{class:"Views__replyName",inner:t.name?n(t.name):i.mobile_stories_reply_you}]}}))}}]}:null,this.poll?{class:"Views__poll StoryViewsSeparator",inner:[{class:"Views__pollHeader",inner:i.mobile_wall_poll_head_title},{class:"Views__pollBody",inner:{class:"StoryFeedbackPoll"+("default"===this.poll.background.type?" StoryFeedbackPoll--default":""),inner:[this.getBackgroundElementForPoll(this.poll),{class:"StoryFeedbackPoll__question",inner:this.poll.question},{class:"StoryFeedbackPoll__countVoters",inner:this.poll.votersCountText},{class:"StoryFeedbackPoll__showResult",onclick:"Stories.openPoll("+this.poll.ownerId+", "+this.poll.pollId+", "+this.raw_id+")",inner:i.mobile_voting_show_result}]}}]}:null,a.length?{class:"Views__questions StoryViewsSeparator",inner:[{class:"Views__table Views__questionsHeader",inner:[{class:"Views__cell Views__questionsTitle",inner:i.mobile_stories_question_title},{class:"Views__cell Views__questionsLink",inner:i.mobile_stories_question_show_all,onclick:'Stories.showQuestions("'+this.raw_id+'")'}]},{class:"Views__questionsBody",inner:{class:"Views__questionsScroll",inner:a.slice(0,10).map((function(e){return{class:"Question","data-id":e.id,inner:[{class:"Question__content",inner:[{href:e.author.link,class:"Question__author",inner:e.isAnonymous?i.mobile_stories_question_anonymous:e.author.name,onClick:"Stories.sendAnalyticsEvent('question_go_to_author', { questionId: "+e.id+" });"},{class:l.default.class("Question__text",{small:e.text.length>40},"_"),inner:e.text}]},{class:l.default.class("Question__actions",{published:e.isPublished},"_"),inner:i.mobile_stories_question_actions,onclick:["Stories.openQuestionActions",e.id]}]}}))}}]}:null,{class:"Views__viewers",inner:[this.count&&(a.length||this.replies.length||this.extendedStats)?{class:"Views__viewersHeader",inner:this.countText}:null,{class:"Views__viewersBody",inner:[this.viewers.map((function(e){return{class:"Views__viewer",href:e.href,inner:{class:"Views__table",inner:[{class:"Views__cell Views__cell_avatar",inner:{class:"Views__avatar",inner:[{class:"Views__avatarPhoto",src:e.photo,tag:"img"},e.isLiked?d.default.wrap(Object(Ga.default)({mix:"Views__avatarBadgeIcon",icon:"notify_mini_like"})):null]}},{class:"Views__cell Views__cell_name",inner:{class:"Views__name",inner:e.name}}]}}})),this.hiddenReason?{class:"Views__viewersHiddenReason",inner:[{class:"Views__viewersHiddenReasonIcon",inner:Object(R.default)(Object(wc.getHideOutline56Icon)())},{class:"Views__viewersHiddenReasonText",inner:this.hiddenReason}]}:null]}]},this.viewersState.nextFrom?{class:"Views__viewersLoader",onclick:'Stories.loadViews("'+this.raw_id+'")'}:null]}]})},t.renderExtendedStatsBanner=function(){var e=window.lang;return{inner:[{inner:[Object(R.default)({icon:Object(Ac.getStatistic28Icon)()})],class:"ViewsExtendedStatsBanner__before",tag:"div"},{inner:[{inner:[e.mobile_stories_feedback_extended_stats],class:"ViewsExtendedStatsBanner__title",tag:"div"},{inner:[this.extendedStats.preview],class:"ViewsExtendedStatsBanner__subtitle",tag:"div"}],class:"ViewsExtendedStatsBanner__content",tag:"div"},{inner:[Object(R.default)({icon:Object(bc.getChevron16Icon)()})],class:"ViewsExtendedStatsBanner__after",tag:"div"}],class:"ViewsExtendedStatsBanner StoryViewsSeparator",onClick:["Stories.showExtendedStats",this.raw_id],tag:"button"}},t.needShowOnlyHiddenViewersInfo=function(){var e=this.store.questions[this.raw_id]||[];return this.count&&this.hiddenReason&&!this.viewers.length&&!this.replies.length&&!e.length},t.getBackgroundElementForPoll=function(e){var t=e.background,n=null,i="";if("photo"===t.type)n={class:"StoryFeedbackPoll__photo",style:"background-image: url("+t.photoUrl+")"},i="background: #"+t.backgroundColor;else if("gradient"===t.type){i="background: linear-gradient("+(t.angle-90)+"deg, "+t.points.map((function(e){return"#"+e.color+" "+Math.round(100*e.position)+"%"})).join(", ")+")"}return{class:"StoryFeedbackPoll__background",style:i,inner:n}},e}(),Sc=function(){function e(e){this.store=window.Stories.getStore(),this.questions=this.store.questions[e]||[]}return e.prototype.render=function(){var e=window.lang;return d.default.elem({class:l.default.class("Questions"),inner:[{class:"Questions__header",inner:[{class:"Questions__table",inner:[{class:"Questions__cell",inner:{class:"Questions__title",inner:e.mobile_stories_question_title}}]},{class:"Questions__close",onclick:"Stories.hideQuestions();"}]},{class:"Questions__body",inner:[{class:"Questions__inner",ontouchmove:"event.stopPropagation();",inner:this.questions.map((function(t){return{class:"Question","data-id":t.id,inner:[{class:"Question__content",inner:[{href:t.author.link,class:"Question__author",inner:t.isAnonymous?e.mobile_stories_question_anonymous:t.author.name},{class:l.default.class("Question__text",{small:t.text.length>40},"_"),inner:t.text}]},{class:l.default.class("Question__actions",{published:t.isPublished},"_"),inner:e.mobile_stories_question_actions,onclick:["Stories.openQuestionActions",t.id]}]}}))}]}]})},e}(),kc=n("9b/I"),Cc=n("mP7y"),jc=function(){function e(e){this.store=window.Stories.getStore(),this.extendedStats=this.store.extendedStats[e]}var t=e.prototype;return t.render=function(){var e=this,t=window.lang;return d.default.elem({inner:[{inner:[{inner:[{inner:[{inner:[t.mobile_stories_extended_stats_title],class:"StoryExtendedStats__title",tag:"div"}],class:"StoryExtendedStats__cell",tag:"div"}],class:"StoryExtendedStats__table",tag:"div"},{inner:[Object(R.default)({icon:Object(kc.getBackOutline28Icon)()})],class:"StoryExtendedStats__back Btn Btn_theme_none",onClick:"Stories.hideExtendedStats();",tag:"button"}],class:"StoryExtendedStats__header",tag:"div"},{inner:[{inner:[this.extendedStats.achievement?{inner:[{inner:[Object(R.default)({icon:Object(Cc.getStatisticGrow28Icon)()})],class:"StoryExtendedStatsAchievement__before",tag:"div"},{inner:[{inner:[this.extendedStats.achievement],class:"StoryExtendedStatsAchievement__label",tag:"div"},{inner:[this.extendedStats.achievementSubtitle],class:"StoryExtendedStatsAchievement__subtitle",tag:"div"}],class:"StoryExtendedStatsAchievement__content",tag:"div"}],class:"StoryExtendedStatsAchievement StoryViewsSeparator",tag:"div"}:null,this.extendedStats.categories.map((function(t){return e.renderCategory(t)}))],class:"StoryExtendedStats__inner",onTouchMove:"event.stopPropagation();",tag:"div"}],class:"StoryExtendedStats__body",tag:"div"}],class:"StoryExtendedStats",tag:"div"})},t.renderCategory=function(e){var t=this;return{inner:[{inner:[e.title],class:"StoryExtendedStatsCategory__title",tag:"div"},{inner:[e.lines.map((function(e){return t.renderCategoryLine(e)}))],class:"StoryExtendedStatsCategory__lines",tag:"div"}],class:"StoryExtendedStatsCategory StoryViewsSeparator",tag:"div"}},t.renderCategoryLine=function(e){return{inner:[{inner:[e.name],class:"StoryExtendedStatsCategoryLine__name",tag:"div"},{inner:[e.counter],class:"StoryExtendedStatsCategoryLine__counter",tag:"div"}],class:"StoryExtendedStatsCategoryLine",tag:"div"}},e}();function Ec(){var e=navigator.connection;if(!e)return"";var t=e.effectiveType,n=e.downlink;switch(t){case"slow-2g":return"GPRS";case"2g":return"EDGE";case"3g":return"3G";case"4g":return n>8?"wi-fi":"LTE"}return""}var Tc=[];var Ic=[];var Mc;!function(e){e.Add="add",e.Delete="delete"}(Mc||(Mc={}));var Pc,Dc,xc,Lc,Bc=n("xU72"),Rc=n("vk58"),Nc=!1;function Fc(e){var t,n=this;this.pauseStory(),this._hideTooltips();var i=function(){qt.default.setLoading(Object(F.$)("#AddToNarrativeFromStoryViewSaveBtn"),!1),Nc=!1,Ln.default.close(Dc),n.hideMenu(),n.playStory()},a=Object(Rc.BtnStack)({inner:[Object(qt.default)({inner:Object(J.getLang)("mobile_narratives_create_popup_save_button_text"),disabled:!0,attrs:{id:"AddToNarrativeFromStoryViewSaveBtn"},onClick:function(){Nc||(qt.default.setLoading(Object(F.$)("#AddToNarrativeFromStoryViewSaveBtn"),!0),Nc=!0,window.ajax.post("narratives",{act:"publish",owner_id:e.ownerId,hash:e.publishNarrativeHash,cover_story_id:e.storyId,story_ids:e.storyId,title:t},{onDone:function(e){N.init({type:N.SNACKBAR_TYPE_SUCCESS,avatar:e.coverUrl,text:Object(J.getLangReplace)(Object(J.getLang)("mobile_narratives_success_added_to_narrative"),{narrative_title:e.title})}),Object(Be.sendNarrativeAnalytic)(Be.NarrativeAnalyticEventType.publishNarrative,e.ownerId,e.id,Be.NarrativeAnalyticNavScreen.storyViewer),i()},onFail:function(e){return N.init({text:e||Object(J.getLang)("global_error"),type:N.SNACKBAR_TYPE_ERROR}),i(),!0}}))}}),Object(qt.default)({theme:"secondary",inner:Object(J.getLang)("mobile_narratives_create_popup_cancel_button_text"),onClick:function(){return i()}})]}),r=d.default.preactElem(Ln.default,{on_overlay_click_native:function(){return i()},scrollable:!0,header:{title:Object(J.getLang)("mobile_narratives_create_popup_title")},footer:a,inner:[{inner:Object(J.getLang)("mobile_narratives_create_popup_description"),style:"margin-bottom: 10px"},Object(va.default)({placeholder:Object(J.getLang)("mobile_narratives_create_popup_title"),maxlength:e.narrativeTitleMaxLength,on_change:function(e){t=e.currentTarget.value.trim(),qt.default.setDisabled(Object(F.$)("#AddToNarrativeFromStoryViewSaveBtn"),!t.length)}})]});Dc=Ln.default.open(r,!0,{withoutCloning:!0})}function Hc(){var e,t=this;this.pauseStory(),this._hideTooltips();var i=function(){qt.default.setLoading(Object(F.$)(".NarrativesListActions__action--save"),!1),Nc=!1,Ln.default.close(Pc),t.hideMenu(),t.playStory()},a=[],o=this.getCurrentStory(),s=null===(e=null==o?void 0:o.raw_id)||void 0===e?void 0:e.split("_").map(Number),c=s[0],l=s[1],u=function(){var e=null,n=d.default.preactElem(Bc.default,{contentId:"StoriesArchiveNarrativeSelector",title:Object(J.getLang)("mobile_narratives_selector_page_title"),onLeftActionClick:function(){return i()}});d.default.mountPreactComponent(Lc,{ownerId:c,selectedStoryId:l,isCreateBtnVisible:!0,disablePreview:!0,forceActionsVisible:!0,customOnScrollForAutoScroller:function(t){return e=t},onNarrativeCheckChanged:function(e,t){var n,i=null===(n=e.stories)||void 0===n?void 0:n.some((function(e){return e.id===l}));a=a.filter((function(t){return t.narrative_id!==e.id})),t?i||a.push({op:Mc.Add,story_id:l,narrative_id:e.id,narrative_title:e.title,narrative_cover_url:e.coverUrl}):i&&a.push({op:Mc.Delete,story_id:l,narrative_id:e.id,narrative_title:e.title,narrative_cover_url:e.coverUrl}),qt.default.setDisabled(Object(F.$)(".NarrativesListActions__action--save"),Boolean(!a.length))},onCreateBtnClick:function(){return Ln.default.close(Pc),Object(Be.sendNarrativeAnalytic)(Be.NarrativeAnalyticEventType.createNarrative,c,0,Be.NarrativeAnalyticNavScreen.storyViewer),Fc.call(t,{storyId:l,ownerId:c,publishNarrativeHash:xc.publishNarrativeHash,narrativeTitleMaxLength:xc.narrativeTitleMaxLength})},isSelectActionAvailable:!0,isSaveActionAvailable:!0,forceFirstLoading:!0,onSaveClick:function(){if(!Nc){qt.default.setLoading(Object(F.$)(".NarrativesListActions__action--save"),!0),Nc=!1;var e=a.map((function(e){return{op:e.op,story_id:e.story_id,narrative_id:e.narrative_id}}));window.ajax.post("narratives.php",{act:"batch_edit",owner_id:c,operations:JSON.stringify(e),hash:xc.editNarrativeHash},{onDone:function(){var e=[],t=[];a.forEach((function(n){switch(n.op){case Mc.Add:e.push(n);break;case Mc.Delete:t.push(n)}}));var n=e.length,r=t.length,o="",s=null;if(n)if(1===n){var l=e[0];s=l.narrative_cover_url,o=Object(J.getLangReplace)(Object(J.getLang)("mobile_narratives_success_added_to_narrative"),{narrative_title:l.narrative_title})}else o=Object(J.getLangNumeric)(n,Object(J.getLang)("mobile_narratives_story_added_to_narratives","raw"));else r&&(o=Object(J.getLangNumeric)(r,Object(J.getLang)("mobile_narratives_story_removed_from_narratives","raw")));o&&N.init({type:N.SNACKBAR_TYPE_SUCCESS,avatar:s,text:o}),Object(Be.sendNarrativeAnalytic)(Be.NarrativeAnalyticEventType.addStoryToNarrative,c,0,Be.NarrativeAnalyticNavScreen.storyViewer),i()},onFail:function(e){return N.init({text:e||Object(J.getLang)("global_error"),type:N.SNACKBAR_TYPE_ERROR}),i(),!0}})}}},Object(F.$)("#StoriesArchiveNarrativeSelector",n)),Pc=Ln.default.open(n,!0,{withoutCloning:!0});var o=Object(F.$)(".ModalPage__content",n);null==o||o.addEventListener("scroll",(function(t){null==e||e(Object(r.getY)(t.currentTarget)+t.currentTarget.scrollTop)}))};(function(e){return new Promise((function(t,n){xc?t(xc):window.ajax.post("narratives.php",{act:"choose_box_data",owner_id:e},{onDone:function(e){t(xc=e)},onFail:function(e){return n(e),!0}})}))})(c).then((function(e){var t;return Promise.all([Promise.all([n.e("vendor"),n.e("icons"),n.e("sortable"),n.e("narratives_list")]).then(n.bind(null,"MM3i")).catch((function(e){return Object(r.statlogsValueEvent)("mvk_narratives_event",null,"chunk_error",e.name)})),Object(f.addStatic)((t={},t[e.narrativesCssPath]=null,t))]).then((function(e){var t=e[0];Lc=t&&(null==t?void 0:t.NarrativesList),u()}))})).catch(console.error)}var Uc=n("zouF"),Vc=!1;function Wc(){var e,t=this,n=this.getCurrentAuthorIndex(),i=this.getCurrentStoryIndex(),a=(null===(e=this.store.authors[n])||void 0===e?void 0:e.items)||[],r=this.getCurrentStory(),o=r.narrative,s=r.id,c=null;if(o&&!Vc){this.pauseStory();var l=function(e){void 0===e&&(e=!0),c&&Ln.default.close(c),t.hideMenu(),e&&t.playStory(),Vc=!1};c=Object(Uc.Confirm)(Object(J.getLang)("mobile_stories_remove_only_from_narrative_warning"),(function(){var e,n,r,u,d,_;if(!Vc){qt.default.setLoading(Object(F.$)(".Popup__buttons .Popup__button:first-child",c),!0),qt.default.setDisabled(Object(F.$)(".Popup__buttons .Popup__button:last-child",c),!0),Vc=!0;var f=null===(e=o.stories)||void 0===e?void 0:e.filter((function(e){return e.id!==s})),p=null==f?void 0:f.map((function(e){return e.id})),h=o.customCover?null:p.includes(o.coverStoryId)?o.coverStoryId:p[0]||s;window.ajax.post("narratives",{act:"update",owner_id:o.ownerId,hash:o.editHash,cover_story_id:h,custom_cover_photo_id:null===(n=o.customCover)||void 0===n?void 0:n.photoId,story_ids:p.join(","),title:o.title,narrative_raw_id:o.rawId,crop_x:null===(r=o.coverCrop)||void 0===r?void 0:r.x,crop_y:null===(u=o.coverCrop)||void 0===u?void 0:u.y,crop_width:null===(d=o.coverCrop)||void 0===d?void 0:d.width,crop_height:null===(_=o.coverCrop)||void 0===_?void 0:_.height},{onDone:function(e){var n,r;window.Stories.sendAnalyticsEvent("delete_from_narrative"),N.init({type:N.SNACKBAR_TYPE_SUCCESS,avatar:e.coverUrl,text:Object(J.getLangReplace)(Object(J.getLang)("mobile_narratives_success_updated"),{narrative_title:e.title})}),null===(r=null===(n=window.Narratives)||void 0===n?void 0:n.onNarrativeChangedFromStoryView)||void 0===r||r.call(n,e),l(!1),a.splice(i,1),a.forEach((function(t){return t.narrative=e})),a.length?(t.setCurrentStory(i-1),t.nextStory()):(t.close(),location.reload())},onFail:function(){return l(),!0}})}}),l,{yes_label:Object(J.getLang)("mobile_stories_remove_only_from_narrative_submit_label")})}}var $c,qc=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),a=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,a++)i[a]=r[o];return i},zc=0,Yc=1,Gc=3,Kc={opened:!1,init:function(e,t){var n=this;void 0===t&&(t={}),this.params=Object(r.extend)({replace:!1,reply:!1,replyTo:!1,restore:!1,forceAuthorIndex:!0},t);var i=this._parseList(e).split("/"),a=i[0],o=i[1],s=i[2],c=a.split("_")[0];t&&t.id?c=t.id:t&&t.narrativeId&&(c=t.narrativeId),this.initRaw=e,this.storyOwner=c,this.storyRaw=a,this.storyExtra=s,this.storyList=o,this.extra=this.parseExtra(this.storyExtra),this.needAudioRestore=window.audio.playing(),this.Views={},this.popoutOpen=!1,this.slideTimer=null,this.createLayer(),this._initStore(),this.detectAutoplay().then((function(){n.isRestored?n._init():n._checkPreloadedList()?(n._initPreloadedList(),n._init()):n._requestList().then((function(e){var t=e.items,i=e.list;t&&(n.store.authors=t,n.store.listLoaded=!0,n.store.list=i,n.store.inited=!0,n._init())}),(function(){}))}))},parseExtra:function(e){var t={},n=String(e).split(";");return n.forEach((function(e,i){if(n.hasOwnProperty(i)){var a=n[i].split(":"),r=a[0],o=a[1];r&&o&&(t[r]=o)}})),t},_checkPreloadedList:function(){return!!(window.store&&window.store.storiesLists&&window.store.storiesLists[this.storyList])},_initPreloadedList:function(){var e=window.store.storiesLists[this.storyList];e&&(this.store.authors=e,this.store.listLoaded=!0,this.store.list=this.storyList,this.store.inited=!0)},pushPreloadedList:function(e){var t=Object(r.parseJSON)(e);window.store||(window.store={}),window.store.storiesLists||(window.store.storiesLists={}),Object(r.extend)(window.store.storiesLists,t),window.store.stories||(window.store.stories={}),Object.keys(t).forEach((function(e){window.store&&window.store.storiesLayers&&window.store.storiesLayers.includes(e)||delete window.store.stories[e]}))},_init:function(){var e=this;this.createAuthors();var t=this.getFirstStoryIndex();this.setCurrentStory(t);var n=this.getCurrentStory();this.params.restore||this.setHistory(n.raw_id,{nav_init:!0,replace:this.params.replace}),this.sliderEl=Object(r.ge)("StoriesSlider"),this.slider=Dn(this.sliderEl,{speed:300,startSlide:this.getCurrentAuthorIndex(),onSlideChange:function(t){t=e.slider&&Object(r.intval)(e.slider.getCurrentPos());var n=e.getCurrentAuthorIndex(),i=e.getCurrentAuthor().data;clearTimeout(e.slideTimer),void 0!==t&&t!==n&&(e.markSeenAllOwners(),!1===e.isTap&&(t>n?e.sendAnalyticsEvent("go_to_next_author"):e.sendAnalyticsEvent("go_to_previous_author"),i.is_groups||i.is_apps||e.markSeenStory(!0)),e.setCurrentAuthor(t),e.slideTimer=setTimeout((function(){e.renderStory()}),300)),delete e.isTap},onSetup:function(){Object(r.addClass)(e.layer,"Stories_inited"),e.renderStory()}}),this.Authors&&1===this.Authors.length&&(Object(r.addClass)(this.layer,"Stories_inited"),this.renderStory()),this.store.showViews&&this.showViews(n.raw_id,!0),this._initViewerSource(),this._sendOpeningEvents()},_initStore:function(){window.store||(window.store={stories:{},storiesLayers:[]}),window.store.stories||(window.store.stories={}),window.store.storiesLayers||(window.store.storiesLayers=[]),window.store.stories[this.storyList]&&window.store.stories[this.storyList].inited?(this.store=window.store.stories[this.storyList],this.isRestored=!0):(this.store={authors:[],listLoaded:!1,readedStories:{},_requests:[],viewers:{},questions:{},viewersState:{},extendedStats:{},replies:{},polls:{},showMenu:!1,storyList:this.storyList,initRaw:this.initRaw,storyIndex:0,authorIndex:0,isReply:this.params.reply,replyTo:this.params.replyTo,inited:!1},window.store.stories[this.storyList]=this.store,this.isRestored=!1),this.params.restore||window.store.storiesLayers.push(this.store.storyList)},_initViewerSource:function(){var e=this._getSource();switch(e){case"reply":this.viewerSource="replies_list";break;case"feed":this.viewerSource=window.cur.module;break;default:this.viewerSource=e}},_sendOpeningEvents:function(){var e=this._getSource();if(e){var t;switch(e){case"narrative_story":t="narrative_open_stories";break;case"narrative_snippet":case"narrative_link":t="narrative_open";break;case"narrative_recommendations":t="narrative_other"}if(t&&this._sendNavigationStatEvents(t),"narrative_fave"===e){var n=(this.getCurrentStory()||{}).narrative||{},i=n.ownerId,a=n.id;if(!i||!a)return;Object(r.statlogsValueEvent)("bookmarks_product_analytics",{item_type:"narrative",item_owner_id:Object(r.intval)(i),item_id:Object(r.intval)(a),time:window.vk.ts+Math.floor(((new Date).getTime()-window.vk.started)/1e3)})}}},_abortRequests:function(){Object(J.isArray)(this.store._requests)&&Object(r.each)(this.store._requests,(function(e,t){t.abort()})),this.store._requests=[]},_saveRequest:function(e){this.store._requests.push(e)},getStore:function(){return this.store},setAllAuthorStoriesReaded:function(e){var t=this;this.store.authors[e].items.forEach((function(e){if(e.unread){var n=e.raw_id;e.track_code&&(n+="_"+e.track_code),t.store.readedStories[n]=!0}}))},markSeenAllOwners:function(){var e=this.getCurrentAuthor().data;if(e.is_groups||e.is_apps){var t=window.store.stories[e.is_groups?"groups":"apps"];if(t){t.authors.forEach((function(e){return e.items.forEach((function(e){return e.unread=!1}))}));var n=t.authors.map((function(e){return e.author.id}));window.ajax.post("stories.php",{_ajax:1,act:"mark_owners_seen",hash:this.store.authors[0].read_hash,owners_ids:n.join(",")}),this._needFeedUpdate=!0}}},createAuthors:function(){var e=this,t="";this.Authors=[];var n=this.getCurrentAuthorIndex();this.isRestored&&!this.params.forceAuthorIndex||(n=this.getFirstAuthorIndex());var i=this.store.authors[n],a=i.items[i.items.length-1].unread;if(this.extra)switch(this.extra.context){case"new":a=!0;break;case"all":a=!1}Object(r.each)(this.store.authors,(function(n,i){var r=i.items;if(!n||!a||r[r.length-1].unread){var o=new pc(n,i);e.Authors.push(o),t+=o.renderEmpty()}})),Object(r.val)(Object(r.geByClass1)("Stories__authors",this.layer),t),this.authors=Array.from(Object(r.geByClass)("StoryAuthor",this.layer)),Object(r.each)(this.Authors,(function(e,t){t.updateHeader()})),this.setCurrentAuthor(n)},getFirstStoryIndex:function(){var e=this,t=this.store.authors[this.getCurrentAuthorIndex()];if(this._hasContext("all"))return 0;if(!this._hasContext("new")){var n=t.items.findIndex((function(t){return t.raw_id===e.storyRaw}));return-1!==n?n:0}return this.getCurrentStoryIndex()},getFirstAuthorIndex:function(){var e=this,t=this.store.authors.findIndex((function(t){var n=t.author.id;return t.is_narrative&&(n=t.items[0].narrative.id),t.id&&(n=t.id),String(n)===String(e.storyOwner)}));return-1!==t?t:0},getCurrentAuthorIndex:function(){return this.store.authorIndex},getCurrentStoryIndex:function(){return this.store.authors[this.getCurrentAuthorIndex()].index},getCurrentStory:function(){return this.store.authors[this.getCurrentAuthorIndex()].items[this.getCurrentStoryIndex()]},setCurrentAuthor:function(e){this.store.authorPrevIndex=this.store.authorIndex,this.store.authorIndex=e,this.updateCurrentAuthor()},setCurrentStory:function(e){this.store.authors[this.getCurrentAuthorIndex()].index=e},drawSiblingPreview:function(){for(var e=this.getCurrentAuthorIndex(),t=-2;t<=2;t++){var n=e+t;this.authors[n]&&n!==e&&this.drawPreview(this.authors[n])}},drawPreview:function(e){Object(r.setStyle)(e,"background-image","url("+Object(r.attr)(e,"data-src")+")")},updateCurrentAuthor:function(){var e=this.authors[this.store.authorIndex];Object(r.each)(this.authors,(function(e,t){Object(r.removeClass)(t,"StoryAuthor_current")})),Object(r.addClass)(e,"StoryAuthor_current")},getSizes:function(){var e,t,n=window.innerHeight,i=window.innerWidth;return i<540?(e=i,t=n,window.zlayer.open(),window.zlayer.onResize=this.onResize.bind(this)):(e=Math.floor(Math.min(540,Math.max(320,.563*n))),t=Math.floor(1.78*e),Object(r.addClass)(document.body,"vk__story_open")),[e,t]},createLayer:function(){window.innerWidth<540?(window.zlayer.open(),window.zlayer.onResize=this.onResize.bind(this)):Object(r.addClass)(document.body,"vk__story_open"),Kc.opened=!0;var e=this.getSizes(),t=e[0],n=e[1];this.storyW=t;var i=d.default.html({id:"StoriesView",class:"Stories__layer _preventMenuOpen",style:"max-width: "+t+"px; max-height: "+n+"px",inner:[{class:"Stories__loading",inner:{class:"Stories__loadingInner"}},{id:"StoriesSlider",class:"Stories__authors peppermint peppermint-inactive",ontouchmove:"Stories.onTouchMove(event);",inner:""},{class:"Stories__layerClose",inner:{class:"Story__icon Story__icon_close"},onclick:"return Stories.clickClose();"},{class:"Stories__popout"},{class:"Stories__flash",onclick:"Stories.hideFlashPopup()",inner:{class:"Stories__flashText"}},{class:"Stories__swipeText Stories__swipeText_top"}]});this.layer=Object(r.append)(Object(r.ce)("div",{className:"Stories",innerHTML:i}),document.body),Object(r.attr)(this.layer,"ontouchmove","event.preventDefault();"),this.loader=Object(r.geByClass1)("Stories__loading",this.layer),this.popout=Object(r.geByClass1)("Stories__popout",this.layer),this.swipeTextTop=Object(r.geByClass1)("Stories__swipeText_top",this.layer)},onResize:function(){var e=Object(r.ge)("StoriesView"),t=this.getSizes(),n=t[0],i=t[1];Object(r.attr)(e,"style","max-width: "+n+"px; max-height: "+i+"px"),this.storyW=n,this.authors.forEach((function(e){Object(r.setStyle)(e,"width",n+"px")})),this.Authors&&this.Authors.length>1&&this.slider&&this.slider.recalcWidth()},getWidth:function(){return this.storyW},renderStory:function(){var e=this.store.authorPrevIndex,t=this.getCurrentAuthorIndex(),n=this.authors[t],i=this.Authors[t];if(i.update(),!isNaN(e)&&e!==t){var a=this.Authors[e],o=this.authors[e];a.update();var s=a.renderEmpty(),c=Object(r.ceFromString)(s);Object(r.replace)(c,o)}var l=Object(r.ceFromString)(i.render());Object(r.replace)(l,n),this.authors=Array.from(Object(r.geByClass)("StoryAuthor",this.layer)),this.updateCurrentAuthor(),i.updateHeader(),this.onRender(),this.drawSiblingPreview(),"open"===this.extra.replies&&this.showViews(this.getCurrentStory().raw_id)},getCurrentAuthor:function(){var e=this.getCurrentAuthorIndex();return(this.Authors||[])[e]},getCurrentAuthorEl:function(){return this.getCurrentAuthor().authorElem},getAuthorElems:function(){return this.authors},prevStory:function(){var e=this;this.stopStory(),this.store.isStopped=!1,requestAnimationFrame((function(){var t=e.getCurrentStoryIndex(),n=e.getCurrentAuthorIndex();if(t-1<0)if(n-1<0)e.setCurrentStory(0),e.renderStory();else{e.slider.slideTo(n-1);var i=e.store.authors[n-1].items.length-1;e.setCurrentStory(i)}else e.setCurrentStory(t-1),e.renderStory()}))},nextStory:function(e){var t=this;this.stopStory(),this.markSeenAllOwners(),this.store.isStopped=!1,this.markSeenStoryIfNeeded(),requestAnimationFrame((function(){var n=t.store.authors[t.getCurrentAuthorIndex()],i=t.getCurrentStoryIndex(),a=t.getCurrentAuthorIndex(),r=n.items.length;if(t.Authors){var o=t.Authors.length;r-1<=i?o-1<=a?requestAnimationFrame((function(){e&&t.sendAnalyticsEvent("close_auto_by_time"),t.close()})):(e&&t.sendAnalyticsEvent("go_to_next_story_auto_by_time"),t.slider.slideTo(a+1),t.setCurrentStory(0)):(e&&t.sendAnalyticsEvent("go_to_next_story_auto_by_time"),t.setCurrentStory(i+1),t.renderStory())}}))},stopStory:function(){this.store.isStopped=!0,this.pauseStory()},pauseStory:function(e){var t=this.getCurrentAuthor();if(t){var n=t.getCountDown();e&&Object(r.addClass)(this.layer,"Stories_paused"),n&&n.pause()}},playStory:function(){this.store.isStopped=!1;var e=this.getCurrentAuthor();if(e){var t=e.getCountDown();Object(r.removeClass)(this.layer,"Stories_paused"),t&&t.start()}},pauseAudio:function(){var e=window.audio;this.getCurrentStory().noSound||e&&e.pause()},restoreAudio:function(){var e=window.audio;this.needAudioRestore&&e&&e.play()},showMenu:function(){this.store.showMenu=!0,this._hideTooltips(),this.stopStory(),Object(r.addClass)(this.layer,"Stories_menuOpened")},hideMenu:function(e){void 0===e&&(e=!0),this.store.showMenu=!1,Object(r.removeClass)(this.layer,"Stories_menuOpened"),e&&this.playStory()},showLoading:function(){var e=this;this.loader&&(clearTimeout(this.loaderTimer),this.loaderTimer=setTimeout((function(){Object(r.show)(e.loader)}),100))},hideLoading:function(){this.loader&&(clearTimeout(this.loaderTimer),Object(r.hide)(this.loader))},onRepliesScroll:function(e,t){this.Views[t]&&(this.store.viewersState[t].repliesScrollLeft=e.target.scrollLeft)},goToSettingsFromPrivacyHint:function(e,t,n){var i=this.store.viewersState[e]||[];return this.sendAnalyticsEvent("go_to_settings",{nav_screen:i.count?"feedback":"feedback_without_viewers"}),nav.go(t,n)},showEmptyStats:function(e){this.sendAnalyticsEvent("open_empty_feedback"),this.showViews(e)},showViews:function(e,t){var n=this;if(void 0===t&&(t=!1),this.hideMenu(),this.store.showViews=!0,this.stopStory(),this._hideTooltips(),this.Views[e]){var i=this.Views[e].render();this.popoutOpen=!0,Object(r.val)(this.popout,i);var a=Object(r.geByClass1)("Views__repliesBody",this.popout);a&&(a.scrollLeft=0),t||this.sendAnalyticsEvent("open_replies_list")}else{var o=this.store.viewersState[e],s=this.store.viewers[e];if(o&&s)return void this.createViews(e,t);this.showLoading(),this._requestFeedback(e).then((function(){n.markQuestionsAsViewed(),n.createViews(e,t),n.hideLoading()}))}},showExtendedStats:function(e){var t=new jc(e).render();this.popout.appendChild(t),this.sendAnalyticsEvent("open_advanced_statistic")},hideExtendedStats:function(){Object(r.re)(Object(r.geByClass1)("StoryExtendedStats",this.popout))},markQuestionsAsViewed:function(){(this.getCurrentStory()||{}).isNewQuestions=!1,Object(r.removeClass)(Object(r.geByClass1)("Story__stats"),"Story__stats_new_questions")},createViews:function(e,t){void 0===t&&(t=!1);var n=this.store.viewersState[e],i=new Oc(e),a=i.render();this.popoutOpen=!0,Object(r.val)(this.popout,a),this.Views[e]=i;var o=Object(r.geByClass1)("Views__repliesBody",this.popout);o&&(o.scrollLeft=n.repliesScrollLeft),t||this.sendAnalyticsEvent("open_replies_list")},hideViews:function(e){void 0===e&&(e=!0),e&&this.playStory(),this.store.showViews=!1,this.popoutOpen=!1,Object(r.val)(this.popout,"")},loadViews:function(e){var t=this,n=this.store.viewersState[e],i=n.loading,a=n.nextFrom;!i&&a&&(n.loading=!0,this.showLoading(),this._requestFeedback(e,a).then((function(){var i=new Oc(e),a=i.render();t.popoutOpen=!0;var o=Object(r.geByClass1)("Views__body",t.layer).scrollTop;Object(r.val)(t.popout,a),Object(r.geByClass1)("Views__body",t.layer).scrollTop=o,t.Views[e]=i,t.hideLoading(),n.loading=!1})))},showComment:function(){var e=this,t=this.authors[this.store.authorIndex],n=Object(r.geByClass1)("Story__commentTextarea",t);this.store.showComment=!0,this.stopStory(),Object(r.addClass)(this.layer,"Stories_commentOpened"),this._hideTooltips(),requestAnimationFrame((function(){e.sendAnalyticsEvent("comment_tap"),n&&n.focus()}))},hideComment:function(e){void 0===e&&(e=!0),this.store.showMenu=!1,Object(r.removeClass)(this.layer,"Stories_commentOpened"),e&&this.playStory()},onInputComment:function(e){var t=this.authors[this.store.authorIndex],n=Object(r.geByClass1)("Story__commentSend",t),i=String(Object(r.val)(e)).trim();Object(r.toggleClass)("Story__commentSend_active",n,!!i)},sendComment:function(){var e=this.authors[this.store.authorIndex],t=Object(r.geByClass1)("Story__commentTextarea",e),n=Object(r.geByClass1)("Story__commentSend",e),i=Object(r.val)(t);if(Object(r.hasClass)("Story__commentSend_active",n)){Object(r.val)(t,""),Object(r.removeClass)(n,"Story__commentSend_active");var a=this.getCurrentAuthorIndex(),o=this.getCurrentStory(),s=o.raw_id,c=o.narrative,l=this.store.authors[a],u=l.send_hash,d=l.author.id,_=void 0;_=c?"narrative"+c.ownerId+"_"+c.id:"story"+s,this._sendMessage(u,_,i,d),this.hideComment()}},manageStoryInNarratives:function(e){void 0===e&&(e=!1);var t=this.getCurrentStory(),n=t.owner_id,i=t.narrative;return Object(Qs.canShow)(Qs.TooltipHelpHints.ACCOUNT_HINT_NARRATIVES_ADD_TOOLTIP)&&this.hideStoriesNarrativesFeatureHint(),Object(Be.sendNarrativeAnalytic)(e?Be.NarrativeAnalyticEventType.addToNarrativeFromActionSheet:Be.NarrativeAnalyticEventType.clickToAddToNarrative,n,(null==i?void 0:i.id)||0,Be.NarrativeAnalyticNavScreen.storyViewer),Hc.call(this)},hideStoriesNarrativesFeatureHint:function(){Object(Qs.setHelpHintShown)(Qs.TooltipHelpHints.ACCOUNT_HINT_NARRATIVES_ADD_TOOLTIP)},showFlashPopup:function(e,t){var n=this;void 0===t&&(t=!0);this.stopStory();var i=Object(r.geByClass1)("Stories__flash",this.layer);Object(r.val)(Object(r.geByClass1)("Stories__flashText",i),e),setTimeout((function(){Object(r.addClass)(i,"Stories__flash_show")})),clearTimeout(this.flashTimer),clearTimeout(this.flashHideTimer),this.flashTimer=setTimeout((function(){Object(r.removeClass)(i,"Stories__flash_show"),n.flashHideTimer=setTimeout((function(){n.hideFlashPopup(t)}),1500)}),1500)},hideFlashPopup:function(e){e&&this.playStory(),clearTimeout(this.flashTimer),clearTimeout(this.flashHideTimer);var t=Object(r.geByClass1)("Stories__flash",this.layer);Object(r.removeClass)(t,"Stories__flash_show")},removeCurrentStory:function(){var e=this,t=this.getCurrentAuthor();if(t){var n=t.getCurrentStory(),i=n.narrative?Object(J.getLang)("mobile_stories_delete_narrative"):Object(J.getLang)("mobile_stories_delete_story"),a=null,r=function(){a&&Ln.default.close(a),e.hideMenu(),e.playStory()};a=Object(Uc.Confirm)(i.replace(/(<([^>]+)>)/gi,"\n"),(function(){qt.default.setLoading(Object(F.$)(".Popup__buttons .Popup__button:first-child",a),!0),qt.default.setDisabled(Object(F.$)(".Popup__buttons .Popup__button:last-child",a),!0);var i=t.data.remove_hash,o=n.can_remove,s=n.raw_id;if(o){e.pauseStory();var c=function(){e._requestFeedBlock(),0===e.getCurrentStoryIndex()?(e.close({closeAll:!1}),location.reload()):(e.store.authors[e.getCurrentAuthorIndex()].items.splice(e.getCurrentStoryIndex(),1),e.hideMenu(),e.prevStory())};n.narrative?e._requestRemoveNarrative(n.narrative.rawId,i).then((function(){var e,t,i;r(),c(),null===(t=null===(e=window.Narratives)||void 0===e?void 0:e.onNarrativeRemovedFromStoryView)||void 0===t||t.call(e,null===(i=n.narrative)||void 0===i?void 0:i.id)}),(function(){})):e._requestRemoveStory(s,i).then((function(){r(),e.sendAnalyticsEvent("delete"),c()}),(function(){}))}else r()}),r,{yes_label:Object(J.getLang)("mobile_stories_delete_submit_label")})}},removeCurrentStoryFromNarrative:function(){return Wc.call(this)},editCurrentNarrative:function(e){var t=this.getCurrentStory().narrative,n=Object(J.makeUrl)("narratives",{act:"edit",owner_id:null==t?void 0:t.ownerId,narrative_id:null==t?void 0:t.id,from:window.nav.cur});return window.nav.go(n,e,{replace:!0})},onScrollViews:function(e,t){var n=this.store.viewersState[t],i=n.loading,a=n.nextFrom;if(!i&&a){e.scrollHeight-e.offsetHeight-400<=e.scrollTop&&this.loadViews(t)}},unMute:function(e,t){var n=this.getCurrentAuthor().story.getVideo();Object(r.cancelEvent)(t),n&&n.muted&&(n.muted=!1,Object(r.removeClass)(Object(r.gpeByClass)(uc,e),uc))},onTouchStart:function(e){var t=this,n=this.getCurrentAuthor().story;if(n&&"video"===n.getType()){var i=n.getVideo();if(i&&i.paused)return void(this.preventedTap=!0)}this.isTap=!0,clearTimeout(this.isTapTimer),n.isOneTime||(this.pauseStory(!0),"touchstart"===e.type?(this.tapStartX=e.changedTouches[0].clientX,this.tapStartY=e.changedTouches[0].clientY):(this.tapStartX=e.clientX,this.tapStartY=e.clientY),this.isYmove=null,Object(r.removeClass)(this.layer,"Stories_touchMove"),this.isTapTimer=setTimeout((function(){t.isTap=!1,t.sendAnalyticsEvent("pause_long_tap")}),200))},onTouchMove:function(e){var t=0,n=0;"touchmove"===e.type&&(t=this.tapStartX-e.changedTouches[0].clientX,n=this.tapStartY-e.changedTouches[0].clientY),null===this.isYmove&&(this.isYmove=Math.abs(t)<Math.abs(n),this.isYmove&&Object(r.addClass)(this.layer,"Stories_touchMove")),this.isYmove?this.onVerticalSwipe(-n/1.5):this.onVerticalSwipe(0)},onTouchEnd:function(e,t){clearTimeout(this.isTapTimer);var n=this.getCurrentAuthor();if(n){var i=n.story;this.isTap||this.sendAnalyticsEvent("resume_release");var a,o;"touchend"===e.type?(a=e.changedTouches[0].clientX,o=e.changedTouches[0].clientY):(a=e.clientX,o=e.clientY),(Math.abs(this.tapStartX-a)>20||Math.abs(this.tapStartY-o)>20)&&(this.isTap=!1),Object(r.removeClass)(this.layer,"Stories_touchMove"),Object(r.setStyle)(this.sliderEl,"opacity",1),r.setStyle.transform(this.sliderEl,1,[0,0]),r.setStyle.transform(Object(r.geByClass1)("Story__moreLink"),1,[0,0]);var s=e.target&&e.target.classList.contains("Story__sticker"),c=Object(r.domData)(e.target,"id"),l=Number(Object(r.domData)(e.target,"type"));if(s&&this.sendAnalyticsEvent("click_on_clickable_sticker",{clickable_sticker:{id:c,type:fc[l]}}),this.needGoToLink){var u=this.getCurrentAuthor().story;if(this.needGoToLink=!1,u&&u.hasLink())return void this.openCustomButton(e)}if(this.needClose)return this.sendAnalyticsEvent("close_swipe_down"),void this.close();if(this.tooltip)this._hideTooltips();else{if(this.isTap){var d=this.getCurrentAuthor();if(!d)return;var _=d.getCurrentStory();if(s){var f=Object(r.domData)(e.target,"app-id"),p=Object(r.domData)(e.target,"pollId"),h=Object(r.domData)(e.target,"pollOwnerId"),m=Object(r.domData)(e.target,"situational-app-id"),v=Object(r.domData)(e.target,"situational-theme-id");if(Object(r.removeClass)(this.layer,"Stories_paused"),Object(r.domData)(e.target,"question"))this.askQuestionBox(e);else if(f)Kc.clickToApp();else if(p&&h)Kc.openPoll(h,p,i.raw_id);else if(m&&v)Kc.openSituationalApp(m,v);else{var g=i._createStickerLink(e.target,{id:c,type:l});this.tooltip?this._hideTooltips():this._showTooltip(e,g)}return}if(t){if(_.isOneTime)return;this.sendAnalyticsEvent("go_to_previous_story"),this.prevStory()}else{if(this.sendAnalyticsEvent("go_to_next_story_tap"),_.isOneTime)return this.close(),void Object(r.cancelEvent)(e);this.nextStory()}}this._hideTooltips(!0),this.hideMenu()}}},openCustomButton:function(e){e.preventDefault(),e.stopPropagation();var t=this.getCurrentAuthor().story,n=t.getLinkUrl(),i=n.match(/\/narrative(-?\d+)_(\d+)/);if(i){var a={ownerId:i[1],narrativeId:i[2]},r=a.ownerId,o=a.narrativeId;if(!r||!o)return!1;this.openNarrative(r+"/narrative"+r+"_"+o,{source:"narrative_story"})}else if(this.stopStory(),this.showLoading(),this.sendAnalyticsEvent("link_click"),t.stats&&t.stats.url_view){var s=t.stats.url_view,c=s.event_type,l=s.rhash;this._requestClickStat(t.raw_id,c,l,t.track_code,(function(){nav.go(n)}))}else nav.go(n);return!1},onVerticalSwipe:function(e){if(this.needClose=!1,this.needGoToLink=!1,e){var t=e>0,n=this.sliderEl.offsetHeight,i=n/3.5,a=Math.abs(e)>i;if(t){var o=a?window.lang.mobile_zphoto_release_to_close:window.lang.mobile_zphoto_move_to_close,s=a?"":t?"zpv_close_move_down":"zpv_close_move_up",c=Math.max(1-.75*e/n,.6);Object(r.val)(this.swipeTextTop,'<div class="zpv_close_msg '+s+'">'+o+"</div>"),Object(r.setStyle)(this.sliderEl,"opacity",c),r.setStyle.transform(this.sliderEl,1,[0,e/1.5]),Object(r.setStyle)(this.swipeTextTop,"opacity",Math.abs(c-1-.6)),r.setStyle.transform(this.swipeTextTop,1,[0,e/1.5*.85]),this.needClose=a}else{var l=Math.min(1-.5*e/n,1.1);Object(r.setStyle)(this.sliderEl,"opacity",1),r.setStyle.transform(this.sliderEl,1,[0,0]),r.setStyle.transform(Object(r.geByClass1)("Story__moreLink"),l,[0,Math.max(e/(1.5*1.6),-90)]),this.needGoToLink=a}}else Object(r.setStyle)(this.sliderEl,"opacity",1),r.setStyle.transform(this.sliderEl,1,[0,0]),r.setStyle.transform(Object(r.geByClass1)("Story__moreLink"),1,[0,0]),this.needClose=!1,this.needGoToLink=!1},preventScroll:function(){return this.popoutOpen},_requestRemoveStory:function(e,t){return new Promise((function(n,i){window.ajax.post("stories.php",{_ajax:1,act:"remove_story",hash:t,story_raw:e},{onDone:function(){n()},onFail:function(){i()}})}))},_requestRemoveNarrative:function(e,t){return new Promise((function(n,i){window.ajax.post("stories.php",{_ajax:1,act:"remove_narrative",hash:t,narrative_raw:e},{onDone:function(){n()},onFail:function(){i()}})}))},_requestList:function(){var e=this;return new Promise((function(t,n){var i={storyOwner:e.storyOwner,list:e.storyList,storyRaw:e.storyRaw,extra:e.storyExtra};if(!e.storyRaw)return n();var a=window.ajax.post("stories.php",{_ajax:1,act:"get_list",list:i.list,story_raw:i.storyRaw,extra:i.extra},{onDone:function(e){i.items=e,t(i)},onFail:function(){n()}});e._saveRequest(a)}))},_removeList:function(){window.store&&window.store.storiesLists&&window.store.storiesLists[this.storyList]&&delete window.store.storiesLists[this.storyList],window.store&&window.store.stories[this.storyList]&&delete window.store.stories[this.storyList]},_forceSetStore:function(e,t,n){return{authors:n,listLoaded:!0,list:t,readedStories:{},_requests:[],questions:{},viewers:{},viewersState:{},extendedStats:{},replies:{},polls:{},showMenu:!1,storyList:t,initRaw:e,storyIndex:0,authorIndex:0,isReply:!1,replyTo:!1,inited:!0}},_requestFeedback:function(e,t){var n=this;void 0===t&&(t=0);var i=this.store;return new Promise((function(a,o){var s=window.ajax.post("stories.php",{_ajax:1,act:"feedback",offset:t,story_raw:e},{onDone:function(t,n,o,s,c,l,u,d,_,f,p){s&&s.length&&(i.replies[e]=s),i.viewers[e]=qc(i.viewers[e]||[],t).filter((function(e,t,n){return t===n.findIndex((function(t){return t.viewerId===e.viewerId}))})),i.viewersState[e]?Object(r.extend)(i.viewersState[e],{count:n,nextFrom:o}):i.viewersState[e]={count:n,nextFrom:o,repliesCountText:c,authorCountText:l,repliesScrollLeft:0,hiddenReason:d},u.length&&(i.questions[e]=u),c&&(i.viewersState[e].repliesCountText=c),l&&(i.viewersState[e].authorCountText=l),_&&(i.polls[e]=_),f&&(i.extendedStats[e]=f),i.viewersState[e].privacyHint=p,a({viewers:t,count:n,nextFrom:o,repliesCountText:c,authorCountText:l,questions:u})},onFail:function(){o()}});n._saveRequest(s)}))},markSeenStoryIfNeeded:function(e){var t=this.getCurrentAuthor();t&&(t.getCurrentStory().isOneTime&&this.markSeenStory(e))},markSeenStory:function(e){var t,n,i=this.getCurrentAuthor(),a=this._getSource(),o=i.getCountDown(),s=i.getCurrentStory(),c=0;!o||this.store.readedStories[s.raw_id]&&!e||(s.isOneTime&&(c=s.progress?s.progress:Math.max(Math.round(s.getProgressPercentByLeftTime(o.left)),1)),window.ajax.post("stories.php",{_ajax:1,act:"read_stories",hash:this.store.authors[0].read_hash,story_id:s.raw_id,track_code:s.track_code?s.track_code:"",all:Object(r.intval)(e),source:a,progress:c,navigation_stats:(n=Tc.map((function(e){return[e.ownerId,e.storyId,e.source,e.action].join(",")})).join(";"),Tc=[],n),loading_stats:(t=Ic.map((function(e){return[e.ownerId,e.storyId,e.source,e.time].join(",")})).join(";"),Ic=[],t),connection_type:Ec()}),this.store.readedStories[s.raw_id]=!0,e?this.setAllAuthorStoriesReaded(this.getCurrentAuthorIndex()):this.store.authors[this.getCurrentAuthorIndex()].items[this.getCurrentStoryIndex()].unread=!1)},_requestUpdateFeedBlock:function(){var e=this.store,t=Object.keys(e.readedStories),n=this._getSource();(t.length||this._needFeedUpdate)&&"feed"===n&&(this._needFeedUpdate=!1,setTimeout((function(){Kc._requestFeedBlock()})))},_getSource:function(){if(this.params&&this.params.source)return this.params.source;var e=this.store&&this.store.list||"",t="";return e.includes("feed")?t="feed":e.includes("replies")&&(t="reply"),t},_sendNavigationStatEvents:function(e){var t=this.getCurrentStory(),n=t&&t.raw_id;n&&function(e){var t=e.storyRawId,n=e.source,i=e.action,a=t.split("_");"reply"===n&&(n="replies_list");var r={ownerId:a[0],storyId:a[1],source:n,action:i};Tc.push(r)}({storyRawId:n,source:this._getSource(),action:e})},_sendViewerStartTime:function(e,t){!function(e){var t=e.storyRawId,n=e.source,i=e.time,a=t.split("_"),r={ownerId:a[0],storyId:a[1],source:n,time:i};Ic.push(r)}({storyRawId:e,source:this.viewerSource,time:t})},_requestFeedBlock:function(){var e=nav.getQuery();window.store.storiesLayers.length||window.ajax.post("stories.php",{_ajax:1,act:"feed_block",q:e.q},{onDone:function(e,t){var n=Object(r.ge)("StoriesFeedBlock");n&&Object(r.replace)(Object(r.ceFromString)(e),n),Kc.pushPreloadedList(t)}})},_requestClickStat:function(e,t,n,i,a){window.ajax.post("stories.php",{_ajax:1,act:"stat",source_story:e,event_type:t,rhash:n,track_code:i},{onDone:function(){a&&a()}})},_requestStickerStat:function(e,t){var n=this.getCurrentStory(),i=n.raw_id,a=n.clickable_stickers;i&&a&&window.ajax.post("stories.php",Object(r.extend)({act:"stickers_stat",story_raw_id:i,action:e,hash:a.hash},t))},_sendMessage:function(e,t,n,i){var a=window.ajax.post("mail.php",{_ajax:1,act:"send",entrypoint:"stories_comment",hash:e,media:t,message:n,to:i},{onDone:function(){Kc.showFlashPopup(window.lang.mobile_stories_comment_success),Kc.sendAnalyticsEvent("comment_send")}});this._saveRequest(a)},_requestFave:function(e,t,n,i){window.ajax.post("bookmarks.php",{_ajax:1,act:e,item_type:31,item_oid:t,item_id:n,hash:i,ref:window.cur.module},{onDone:function(){"bookmark_add"===e&&Object(Be.sendNarrativeAnalytic)(Be.NarrativeAnalyticEventType.addToBookmarks,t,n,Be.NarrativeAnalyticNavScreen.storyViewer)}})},_parseList:function(e){var t=(e=decodeURIComponent(e)).match(/^story(-?\d+)_(\d+)(\/([a-z0-9\_\-]+))?(\/([a-z0-9\_\:\;\-]+))?$/i);if(t){var n=t[1],i=t[2],a=t[4],r=t[6],o=n+"_"+i;return e.match(/from_feed\=1/)?a="feed":e.match(/profile\=1/)?a="profile":a||(a=o),o+"/"+a+"/"+r}return e},setHistory:function(e,t){void 0===t&&(t={nav_init:!1,replace:!0});var n=window.nav,i=this.getHistoryURL(e),a=n.getQuery();if(i.match(/narrative(-?\d+_\d+(?:_\d+)?)$/)){var o=this.getCurrentStory(),s=o.narrative,c=o.raw_id.split("_")[1];i="narrative"+(null==s?void 0:s.rawId)+"_"+c}a.z=i;var l=n.path+Object(r.obj2qs)(a)+n.hash,u={push_only:!0,replace:t.replace,nav_init:!t.no_open,nav_incr:!0};n.go(l,null,u)},getFrom:function(e){void 0===e&&(e=!0);var t=window.nav,n=this.store.list,i=t.getQuery(),a="z="+i.z,r="";return"/write"===t.path.substr(0,6)?r="write"+t.path.substr(0,6)+"?"+a:"/mail"===t.path?r="write"+i.peer+"?"+a:"/feed"===t.path?r=i.section&&"notifications"===i.section?"feed?section=notifications&"+a:"feed?"+a:n.startsWith("archive")?r=t.path+"?act=stories":i.from&&(r=i.from),e?encodeURIComponent(r):r},getHistoryURL:function(e){var t=this.store.list;return"story"+e+(t?"/"+t:"")},getParams:function(){return this.params||{}},toggleBookmark:function(e,t){var n,i;void 0===t&&(t=!1);var a=this.getCurrentAuthor();if(a){var o=a.getCurrentStory(),s=Boolean(null===(n=o.narrative)||void 0===n?void 0:n.isBookmarked),c=null===(i=o.narrative)||void 0===i?void 0:i.bookmarkHash;Object.keys(window.store.stories).forEach((function(e){var t=window.store.stories[e];if(t.authors){var n=!1;t.authors.forEach((function(e){n||(n=e.items.find((function(e){return!!e.narrative&&(e.narrative.bookmarkHash===c&&e.raw_id===o.raw_id)})))})),n&&n.narrative&&(n.narrative.isBookmarked=!s)}})),Object(r.val)(e,s?window.lang.mobile_stories_menu_bookmark_title:window.lang.mobile_stories_menu_bookmarked_title);var l=s?"bookmark_remove":"bookmark_add",u=o.narrative,d=u.ownerId,_=u.rawId,f=u.id;t||this._requestFave(l,d,f,c),o.narrative&&window.Share.setBookmarkState(_,!s)}},share:function(e,t){var n,i,a,r,o=this,s=this.getCurrentAuthor();if(s){var c=s.getCurrentStory(),l=null===(n=c.narrative)||void 0===n?void 0:n.isOwnerClosedGroup,u=null===(i=c.narrative)||void 0===i?void 0:i.isGroupEditor;this.stopStory(),this.getFrom();var d=t?"narrative":"story";this.stopStory(),window.Share(e,{mail_hash:this.getCurrentStory().share_hash,object:d+e,is_bookmarked:null===(a=c.narrative)||void 0===a?void 0:a.isBookmarked,bookmark_hash:null===(r=c.narrative)||void 0===r?void 0:r.bookmarkHash,bookmark_type:31,can_bookmark:t,can_to_own:t&&!l,can_to_club:t&&(!l||u)}),window.cur.share.onClose((function(){o.playStory()}))}},_requestMarkNotInterested:function(e,t){var n=this;window.ajax.post("stories.php",{act:"mark_not_interested",story_raw_id:e.raw_id,track_code:e.track_code,hash:e.canMarkNotInterestedHash},{onDone:function(){n.sendAnalyticsEvent("mark_not_interested"),"function"==typeof t&&t()}})},markCurrentStoryNotInterested:function(e){var t=this.getCurrentStory();t?e&&Object(S.partConfigEnabled)("ads_new_reports_mvk_histories")?this._requestMarkNotInterested(t,(function(){return nav.go(e)})):(N.init({text:Object(J.getLang)("mobile_stories_thanks_feedback"),type:N.SNACKBAR_TYPE_SUCCESS}),this.hideMenu(),this._requestMarkNotInterested(t)):Object(A.logError)(new Error("Fail: markNotInterested"),{environment:"mobile_stories"})},openReplies:function(e,t){void 0===t&&(t=!1),this.playStory(),t||this.sendAnalyticsEvent("open_parent_story"),this.destroy();var n=e.split("/")[1];if(n)if(~window.store.storiesLayers.indexOf(n)){var i=this.store.list,a=n;this.restore(i,a)}else this.init(e,{reply:!0,replyTo:t});else this.close()},hidePrivacyHint:function(e){var t=this.store.viewersState[e];if(t&&t.privacyHint){var n=t.privacyHint.privacyHintHash;t.privacyHint=null,n&&window.ajax.post("stories.php",{act:"hide_privacy_hint",privacy_hint_hash:n})}var i=Object(F.$)(".ViewsPrivacyHint");i&&i.remove(),this.sendAnalyticsEvent("hide_privacy_block")},openNarrative:function(e,t){this.playStory(),this.destroy();var n=e.split("/")[1];if(n)if(~window.store.storiesLayers.indexOf(n)){var i=this.store.list,a=n;this.restore(i,a)}else this.init(e,t);else this.close()},clickClose:function(){var e=this;requestAnimationFrame((function(){e.sendAnalyticsEvent("close_tap"),e.close()}))},close:function(e){if(void 0===e&&(e={}),Object(r.extend)({isPopState:!1,storyRaw:!1,closeAll:!1},e),this.store&&this.store.list&&this._getSource().indexOf("narrative")>-1&&this._sendNavigationStatEvents("narrative_close"),!e.isPopState){var t=window.nav,n=t.getQuery();if(window.store.storiesLayers[window.store.storiesLayers.length-1-1]){var i=window.store.storiesLayers[window.store.storiesLayers.length-1-1],a=window.store.stories[i],o=a.authorIndex,s=a.authors[o].index,c=a.authors[o].items[s];n.z=this.getHistoryURL(c.raw_id)}else delete n.z;var l=t.path+Object(r.obj2qs)(n)+(t.hash||"");t.go(l,null,{push_only:!0,replace:this.params.isReplaceNavAfterClose})}if(this.destroy(),e.isPopState&&e.storyRaw){var u=this._parseList(e.storyRaw).split("/")[1];this.store?this.restore(this.store.storyList,u,e.storyRaw,e):this.init(e.storyRaw,{replace:!0})}else this.store&&this.store.storyList&&this.restore(this.store.storyList,!1,!1,e)},hideAllViews:function(){window.store&&(window.store.storiesLayers=[],window.store.stories&&Object.keys(window.store.stories).forEach((function(e){window.store.stories[e].showViews=!1,window.store.stories[e].isStopped=!1})))},restore:function(e,t,n,i){if(void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===i&&(i={}),window.store.storiesLayers){var a=window.store.storiesLayers.indexOf(e);window.store.storiesLayers.splice(a,1)}if(window.store.storiesLayers.length||t||n){t=t||window.store.storiesLayers[window.store.storiesLayers.length-1];var o=window.store.stories[e],s=window.store.stories[t];if(o&&s){var c=Object.keys(o.readedStories);Object(r.each)(c,(function(e,t){var n=t.split("_")[0],i=s.replies[o.replyTo];if(i){var a=i.filter((function(e){return e.owner_id==n}))[0];a&&(a.has_new=!1)}})),this.init(s.initRaw,{restore:!0,forceAuthorIndex:!1,reply:!0})}else n&&this.init(n,{restore:!0,forceAuthorIndex:!1,reply:!0})}else this.hideAllViews();i.closeAll&&window.store.storiesLayers.length&&this.close(i)},clearStore:function(){this.store=this._initStore()},destroy:function(){var e=this;if(this.restoreAudio(),this.store){this.slider=null,this.hideMenu(!1),this.markSeenStoryIfNeeded(),this._abortRequests(),Object(r.removeClass)(this.layer,"Stories_inited");var t=this.getCurrentAuthorIndex(),n=this.getCurrentAuthor(),i=n&&n.getCurrentStory();if(i&&i.isOneTime&&this._removeList(),void 0!==t&&this.Authors)this.Authors[t].destroy();this.onRender.off(),Object(r.remove)(this.layer),this._requestUpdateFeedBlock(),Object.keys(this).forEach((function(t){"store"!==t&&"supportAutoplay"!==t&&"function"!=typeof e[t]&&(e[t]=null,delete e[t])})),window.zlayer.close(),Object(r.addClass)(Object(r.ge)("StoriesFeedBlock"),"StoriesFeedBlock_been-open"),Object(r.removeClass)(document.body,"vk__story_open"),Kc.opened=!1;var a=Object(r.geByClass1)("Question__popup"),o=Object(r.geByClass1)("Popup__overlay",a);o&&ae.default.close(o)}},isAutoplaySupport:function(){return this.supportAutoplay},isGoodBrowser:function(){return x.default.ios&&x.default.safari_mobile&&parseInt(x.default.version,10)>=10},detectAutoplay:function(){var e=this;return new Promise((function(t){if(e.supportAutoplay)t();else{if(e.isGoodBrowser())return e.supportAutoplay=!0,void t();e.supportAutoplay=!1;var n=Object(r.ce)("video"),i=Object(r.ce)("source");i.src="data:video/mp4;base64,AAAAFGZ0eXBNU05WAAACAE1TTlYAAAOUbW9vdgAAAGxtdmhkAAAAAM9ghv7PYIb+AAACWAAACu8AAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAnh0cmFrAAAAXHRraGQAAAAHz2CG/s9ghv4AAAABAAAAAAAACu8AAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAFAAAAA4AAAAAAHgbWRpYQAAACBtZGhkAAAAAM9ghv7PYIb+AAALuAAANq8AAAAAAAAAIWhkbHIAAAAAbWhscnZpZGVBVlMgAAAAAAABAB4AAAABl21pbmYAAAAUdm1oZAAAAAAAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAVdzdGJsAAAAp3N0c2QAAAAAAAAAAQAAAJdhdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAFAAOABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAAEmNvbHJuY2xjAAEAAQABAAAAL2F2Y0MBTUAz/+EAGGdNQDOadCk/LgIgAAADACAAAAMA0eMGVAEABGjuPIAAAAAYc3R0cwAAAAAAAAABAAAADgAAA+gAAAAUc3RzcwAAAAAAAAABAAAAAQAAABxzdHNjAAAAAAAAAAEAAAABAAAADgAAAAEAAABMc3RzegAAAAAAAAAAAAAADgAAAE8AAAAOAAAADQAAAA0AAAANAAAADQAAAA0AAAANAAAADQAAAA0AAAANAAAADQAAAA4AAAAOAAAAFHN0Y28AAAAAAAAAAQAAA7AAAAA0dXVpZFVTTVQh0k/Ou4hpXPrJx0AAAAAcTVREVAABABIAAAAKVcQAAAAAAAEAAAAAAAAAqHV1aWRVU01UIdJPzruIaVz6ycdAAAAAkE1URFQABAAMAAAAC1XEAAACHAAeAAAABBXHAAEAQQBWAFMAIABNAGUAZABpAGEAAAAqAAAAASoOAAEAZABlAHQAZQBjAHQAXwBhAHUAdABvAHAAbABhAHkAAAAyAAAAA1XEAAEAMgAwADAANQBtAGUALwAwADcALwAwADYAMAA2ACAAMwA6ADUAOgAwAAABA21kYXQAAAAYZ01AM5p0KT8uAiAAAAMAIAAAAwDR4wZUAAAABGjuPIAAAAAnZYiAIAAR//eBLT+oL1eA2Nlb/edvwWZflzEVLlhlXtJvSAEGRA3ZAAAACkGaAQCyJ/8AFBAAAAAJQZoCATP/AOmBAAAACUGaAwGz/wDpgAAAAAlBmgQCM/8A6YEAAAAJQZoFArP/AOmBAAAACUGaBgMz/wDpgQAAAAlBmgcDs/8A6YEAAAAJQZoIBDP/AOmAAAAACUGaCQSz/wDpgAAAAAlBmgoFM/8A6YEAAAAJQZoLBbP/AOmAAAAACkGaDAYyJ/8AFBAAAAAKQZoNBrIv/4cMeQ==";var a=Object(r.ce)("source");a.src="data:video/webm;base64,GkXfo49CgoR3ZWJtQoeBAUKFgQEYU4BnAQAAAAAAF60RTZt0vE27jFOrhBVJqWZTrIIQA027jFOrhBZUrmtTrIIQbE27jFOrhBFNm3RTrIIXmU27jFOrhBxTu2tTrIIWs+xPvwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFUmpZuQq17GDD0JATYCjbGliZWJtbCB2MC43LjcgKyBsaWJtYXRyb3NrYSB2MC44LjFXQY9BVlNNYXRyb3NrYUZpbGVEiYRFnEAARGGIBc2Lz1QNtgBzpJCy3XZ0KNuKNZS4+fDpFxzUFlSua9iu1teBAXPFhL4G+bmDgQG5gQGIgQFVqoEAnIEAbeeBASMxT4Q/gAAAVe6BAIaFVl9WUDiqgQEj44OEE95DVSK1nIN1bmTgkbCBULqBPJqBAFSwgVBUuoE87EQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB9DtnVB4eeBAKC4obaBAAAAkAMAnQEqUAA8AABHCIWFiIWEiAICAAamYnoOC6cfJa8f5Zvda4D+/7YOf//nNefQYACgnKGWgQFNANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgQKbANEBAAEQEAAYABhYL/QACIhgAPuC/rKgnKGWgQPoANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgQU1ANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgQaDANEBAAEQEAAYABhYL/QACIhgAPuC/rKgnKGWgQfQANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgQkdANEBAAEQEBRgAGFgv9AAIiGAAPuC/rOgnKGWgQprANEBAAEQEAAYABhYL/QACIhgAPuC/rKgnKGWgQu4ANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgQ0FANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgQ5TANEBAAEQEAAYABhYL/QACIhgAPuC/rKgnKGWgQ+gANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgRDtANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgRI7ANEBAAEQEAAYABhYL/QACIhgAPuC/rIcU7trQOC7jLOBALeH94EB8YIUzLuNs4IBTbeH94EB8YIUzLuNs4ICm7eH94EB8YIUzLuNs4ID6LeH94EB8YIUzLuNs4IFNbeH94EB8YIUzLuNs4IGg7eH94EB8YIUzLuNs4IH0LeH94EB8YIUzLuNs4IJHbeH94EB8YIUzLuNs4IKa7eH94EB8YIUzLuNs4ILuLeH94EB8YIUzLuNs4INBbeH94EB8YIUzLuNs4IOU7eH94EB8YIUzLuNs4IPoLeH94EB8YIUzLuNs4IQ7beH94EB8YIUzLuNs4ISO7eH94EB8YIUzBFNm3SPTbuMU6uEH0O2dVOsghTM",Object(r.append)(a,n),Object(r.append)(i,n),n.style.position="fixed",n.style.left="5000px",Object(r.attr)(n,"id","base64testvideo"),Object(r.attr)(n,"playsinline","playsinline"),Object(r.attr)(n,"webkit-playsinline","webkit-playsinline"),Object(r.attr)(n,"muted","muted"),n.muted=!0,Object(r.attr)(n,"autoplay","autoplay"),Object(r.attr)(n,"loop","loop"),Object(r.append)(n,document.body);var o=Object(r.ge)("base64testvideo");if(x.default.android&&x.default.chrome)return e.supportAutoplay=!0,Object(r.remove)(n),t(),void clearTimeout(e.autoDetectTimeout);if(x.default.mobile&&x.default.ios&&x.default.ios<10)return e.supportAutoplay=!1,Object(r.remove)(n),t(),void clearTimeout(e.autoDetectTimeout);if(!x.default.safari_mobile||x.default.safari_mobile&&parseInt(x.default.version,10)>=10){var s=n.play();void 0!==s&&s.then((function(){e.supportAutoplay=!0,Object(r.remove)(n),t(),clearTimeout(e.autoDetectTimeout)})).catch(console.error)}o.onplay=function(){e.supportAutoplay=!0,Object(r.remove)(n),t(),clearTimeout(e.autoDetectTimeout)},e.autoDetectTimeout=setTimeout((function(){o.paused||(e.supportAutoplay=!0),Object(r.remove)(n),t()}),250)}}))},narrativeReply:function(){this.setCurrentStory(0),this.renderStory(),this._sendNavigationStatEvents("narrative_replay")},narrativeGoToStories:function(){this.nextStory(),this._sendNavigationStatEvents("narrative_go_to_stories")},_showTooltip:function(e,t){if(this.hideMenu(!1),this.hideFlashPopup(!1),e&&t)if(this.tooltip)this._hideTooltips();else{var n=this.getCurrentAuthorEl();this.tooltip=Object(r.ce)("div",{className:"StoriesTooltip"},{top:0,left:0}),this.tooltipArrow=Object(r.ce)("span",{className:"StoriesTooltip__arrow"}),this.tooltip.appendChild(t),this.tooltip.appendChild(this.tooltipArrow),n.appendChild(this.tooltip);var i=0,a=0;"touchend"===e.type?(i=e.changedTouches[0].clientX,a=e.changedTouches[0].clientY):(i=e.clientX,a=e.clientY);var o=n.getBoundingClientRect(),s=o.top,c=o.left,l=o.width,u=Object(r.getSize)(this.tooltip),d=u[0],_=a-(s+u[1]+10),f=i-(c+d/2);Object(r.setStyle)(this.tooltip,{top:Math.max(_,2),left:Math.min(Math.max(f,2),l-d-2)}),Object(r.setStyle)(this.tooltipArrow,{left:Math.max(Math.min(i-c-Math.min(Math.max(f,0),l-d),d-15),15)}),this.pauseStory()}else this.playStory()},_hideTooltips:function(e){this.tooltip&&(e||this.playStory(),Object(r.remove)(this.tooltip),delete this.tooltip)},_hasContext:function(e){return!(!this.extra||!this.extra.context||this.extra.context!==e)},sendAnalyticsEvent:function(e,t){void 0===t&&(t={});var n=Kc.getCurrentStory(),i=n.narrative,a=Kc.getCurrentAuthor(),o=Kc.getCurrentStoryIndex(),s=Kc._getSource(),c=n.is_groups_meta_story,l=n.raw_id.split("_"),u=l[0],d=l[1],_=0;c&&(u=0,d=0),"groups"===this.storyList&&(_=1);var f={event_type:e,story_owner_id:u,story_id:d,time:window.vk.ts+Math.floor(((new Date).getTime()-window.vk.started)/1e3),view_entry_point:s,nav_screen:window.cur.module,story_type:c?"group_feed":"",is_grouped:_,track_code:n.track_code,narrative_id:"view_story"===e&&i?i.id:void 0};if(a){var p=a.data,h=a.getCountDown();h&&p&&Object(r.extend)(f,{stories_author_before:o,stories_author_after:p.items.length-o,view_event_timeline_position:h.initialTime-h.left})}Object.assign(f,t),Object(S.partConfigEnabled)("web_stats_transport_story_view")?Object(Ks.saveStoryViewStats)(f):Object(r.statlogsValueEvent)("story_product_analytics",f)},clickAuthor:function(){this.sendAnalyticsEvent("go_to_author")},askQuestionBox:function(e){Object(r.cancelEvent)(e);var t=this.getCurrentStory().can_ask;if(this.hideFlashPopup(!1),this._hideTooltips(),!t)return Kc.showFlashPopup(window.lang.mobile_stories_ask_question_forbidden),!1;this.stopStory(),Object(r.addClass)(this.layer,"Stories_questionOpened");var n=this.authors[this.store.authorIndex],i=Object(r.geByClass1)("Story__questionTextarea",n);requestAnimationFrame((function(){i&&i.focus()}))},changeAskAnonymous:function(e){e.preventDefault();var t=document.querySelector(".Story__questionSelect");if(t){var n=+Object(r.domData)(t,"selected"),i=this.getCurrentStory();if(i){var a=[Object(ae.ModalMenuBtn)({inner:window.lang.mobile_stories_ask_question_author_only,onclick:["Stories.changeQuestionMode","this",Yc],class:n===Yc?"selected":""}),Object(ae.ModalMenuBtn)({inner:window.lang.mobile_stories_ask_question_public,onclick:["Stories.changeQuestionMode","this",zc],class:n===zc?"selected":""})];i.can_ask_anonymous&&a.splice(1,0,Object(ae.ModalMenuBtn)({inner:window.lang.mobile_stories_ask_question_anonymous,onclick:["Stories.changeQuestionMode","this",Gc],class:n===Gc?"selected":""}));var o=Object(ae.default)({class:"Story__questionSelectModal",close:!0,closeText:window.lang.mobile_stories_ask_question_cancel,items:a});Ln.default.open(d.default.elem(o),!0)}}},changeQuestionMode:function(e,t){var n=document.querySelector(".Story__questionSelect");switch(t){case zc:Object(r.val)(n,window.lang.mobile_stories_ask_question_public),Object(r.domData)(n,"selected",zc);break;case Yc:Object(r.val)(n,window.lang.mobile_stories_ask_question_author_only),Object(r.domData)(n,"selected",Yc);break;case Gc:Object(r.val)(n,window.lang.mobile_stories_ask_question_anonymous),Object(r.domData)(n,"selected",Gc)}ae.default.close(e)},hideAskQuestion:function(e){void 0===e&&(e=!0),Kc.store.showMenu=!1,Object(r.removeClass)(Kc.layer,"Stories_questionOpened"),e&&Kc.playStory()},onInputQuestion:function(e){Object(F.$)(".Story__questionSend").disabled=!Object(r.trim)(Object(r.val)(e))},sendQuestion:function(){var e=Kc.getCurrentAuthorEl();if(e){var t=Object(r.geByClass1)("Story__questionTextarea",e),n=Object(r.geByClass1)("Story__questionSend",e),i=Kc.getCurrentStory(),a=i.raw_id,o=i.askQuestionHash,s=a.split("_"),c=s[0],l=s[1],u=Object(r.trim)(Object(r.val)(t)),d=document.querySelector(".Story__questionSelect"),_=+Object(r.domData)(d,"selected"),f=!1,p=!1;_===zc?f=!0:_===Gc&&(p=!0),Object(r.val)(t,""),n.disabled=!0;var h=window.ajax.post("stories.php",{_ajax:1,act:"ask_question",story_owner_id:c,story_id:l,question_text:u,is_anonymous:+p,with_mention:+f,hash:o},{onDone:function(e){if(!e)return Kc.showFlashPopup(window.lang.mobile_stories_question_error),!1;var t=Kc.getCurrentAuthor().data.author;switch(Kc.showFlashPopup(window.lang.mobile_stories_question_sent.replace("{name}",t.first_name_ins)),_){case zc:Kc.sendAnalyticsEvent("question_reply_publish");break;case Yc:Kc.sendAnalyticsEvent("question_reply");break;case Gc:Kc.sendAnalyticsEvent("question_reply_anonymous")}}});Kc._saveRequest(h),Kc.hideAskQuestion()}},getQuestionById:function(e){var t=this.getCurrentStory();return this.store.questions[t.raw_id].find((function(t){return t.id===e}))},openQuestionActions:function(e){var t=this.getQuestionById(e);if(t){var n=t.canAnswer,i=t.isOwnerBlocked,a=t.canBlocked,r=[Object(ae.ModalMenuBtn)({inner:window.lang.mobile_stories_question_delete,onclick:["Stories.removeQuestion","this",t.id]})];a&&(r.push(Object(ae.ModalMenuBtn)({inner:i?window.lang.mobile_stories_question_unban:window.lang.mobile_stories_question_ban,onclick:["Stories.banQuestion","this",t.id]})),r.push(Object(ae.ModalMenuBtn)({inner:window.lang.mobile_stories_question_report,onclick:["Stories.reportQuestion","this",t.id]}))),n&&r.unshift(Object(ae.ModalMenuBtn)({inner:window.lang.mobile_stories_question_reply,onclick:["Stories.replyQuestionBox","this",t.id]}));var o=Object(ae.default)({class:"Question__popup",items:r});Ln.default.open(d.default.elem(o),!0)}},removeQuestion:function(e,t){var n=this,i=this.getQuestionById(t),a=i.storyOwnerId,o=i.storyId,s=i.id,c=i.removeHash;window.ajax.post("stories.php",{_ajax:1,act:"remove_question",story_owner_id:a,story_id:o,question_id:s,remove_hash:c},{onDone:function(i){var c=a+"_"+o;if(ae.default.close(e),!i)return requestAnimationFrame((function(){return n.showFlashPopup(window.lang.mobile_stories_question_error)})),!1;Object(F.$$)('.Question[data-id="'+t+'"]').forEach((function(e){return Object(r.re)(e)})),n.store.questions[c]=n.store.questions[c].filter((function(e){return e.id!==t})),Object(F.$$)(".Question").length<1&&Object(r.re)(Object(r.geByClass1)("Views__questions")),Kc.sendAnalyticsEvent("question_delete",{questionId:s})}})},replyQuestionBox:function(e,t){var n=this.getCurrentStory(),i=this.getQuestionById(t),a=i.author,r=i.text,o=window.lang.mobile_stories_question_reply_title.replace("{name}",a.nameGen),s=d.default.elem({class:"QuestionReplyPopup",inner:[{class:"QuestionReplyPopup__inner",inner:[{class:"QuestionReplyPopup__header",inner:[{class:"QuestionReplyPopup__preview",style:"background-image: url("+n.small_preview+")"},{class:"QuestionReplyPopup__top",inner:[{class:"QuestionReplyPopup__title",inner:o},{class:"QuestionReplyPopup__question",inner:r}]}]},{class:"QuestionReplyPopup__content",inner:[{class:"QuestionReplyPopup__textarea",tag:"textarea",placeholder:window.lang.mobile_stories_comment_textarea,oninput:"Stories.onInputReplyQuestion(this);"}]},{class:"QuestionReplyPopup__footer",inner:[Object(qt.default)({class:"QuestionReplyPopup__send",theme:"regular",inner:window.lang.mobile_stories_question_reply_to_message,on_click:["Stories.sendReplyQuestion",t],disabled:!0}),Object(qt.default)({class:"QuestionReplyPopup__cancel",theme:"link",inner:window.lang.mobile_stories_comment_cancel,on_click:["Stories.hideReplyQuestion"]})]}]}]});this.popout.appendChild(s),ae.default.close(e)},hideReplyQuestion:function(){Object(r.re)(Object(r.geByClass1)("QuestionReplyPopup",Kc.popout))},onInputReplyQuestion:function(e){Object(F.$)(".QuestionReplyPopup__send").disabled=!Object(r.trim)(Object(r.val)(e))},sendReplyQuestion:function(e){var t=Object(r.trim)(Object(r.val)(Object(r.geByClass1)("QuestionReplyPopup__textarea"))),n=Kc.getQuestionById(e),i=n.id,a=n.ownerId,o=n.storyOwnerId,s=n.storyId,c=n.sendHash,l="story"+o+"_"+s,u=t+"\n\n🗣 "+n.text,d=window.ajax.post("mail.php",{_ajax:1,act:"send",hash:c,media:l,message:u,to:a},{onDone:function(e){var t=e&&e.error?e.message:window.lang.mobile_stories_comment_success;Kc.showFlashPopup(t,!1),Kc.sendAnalyticsEvent("question_send_message",{questionId:i})}});Kc._saveRequest(d),Kc.hideReplyQuestion()},showQuestions:function(e){var t=new Sc(e).render();this.popout.appendChild(t),Kc.sendAnalyticsEvent("question_show_all")},hideQuestions:function(){Object(r.re)(Object(r.geByClass1)("Questions",this.popout))},banQuestion:function(e,t){var n=this.getQuestionById(t),i=n.storyOwnerId,a=n.storyId,r=n.banHash,o=n.isOwnerBlocked;window.ajax.post("stories.php",{_ajax:1,act:"ban_question",story_raw:i+"_"+a,question_id:t,ban_hash:r,is_blocked:+o},{onDone:function(i){if(!i)return ae.default.close(e),void Kc.showFlashPopup(window.lang.mobile_stories_question_error,!1);if(!o){var a="question_ban_author";n.isAnonymous&&(a="question_ban_anonymous_author"),Kc.sendAnalyticsEvent(a,{questionId:t})}ae.default.close(e),n.isOwnerBlocked=!o,Kc.showFlashPopup(o?window.lang.mobile_stories_question_author_unblocked:window.lang.mobile_stories_question_author_blocked,!1)}})},reportQuestion:function(e,t){var n=this.getQuestionById(t),i=this.getFrom();ae.default.close(e);var a="story_question"+n.storyOwnerId+"_"+n.id;nav.go("/reports?act=add&object="+a+"&refrom="+i)},toggleQuestionTooltip:function(e,t){var n=this.getCurrentAuthor().getCurrentStory(),i=Object(F.$)(".QuestionSupport"),a=Object(F.$)(".Story__questionSelect"),o=+Object(r.domData)(a,"selected");if(Object(r.cancelEvent)(e),i){var s=n.firstName;n.authorId<0&&(s=window.lang.mobile_stories_ask_question_group_owner);var c="";switch(o){case zc:c=window.lang.mobile_stories_ask_question_public_tooltip;break;case Yc:c=window.lang.mobile_stories_ask_question_author_only_tooltip;break;case Gc:c=window.lang.mobile_stories_ask_question_anonymous_tooltip}Object(F.$)(".QuestionSupport__tooltip").innerText=c.replace("{name}",s),t?Object(r.removeClass)(i,"QuestionSupport--active"):Object(r.toggleClass)(i,"QuestionSupport--active")}},openMusicStickerActions:function(e,t){var n=Object(r.ge)("audio"+e),i=Object(r.hasClass)("ai_added",n),a=Object(ae.default)({close:!0,items:[Object(ae.ModalMenuBtn)({class:"ai_add",inner:i?window.lang.global_delete_audio:window.lang.global_add_to_audio,onclick:'Stories.addMusic(this, "'+e+'", '+i+");"}),Object(ae.ModalMenuBtn)({class:"ai_add",inner:window.lang.mobile_stories_music_next,onclick:"Stories.nextMusic(this, "+t+");"})]}),o=d.default.elem(a);o.setAttribute("id","ai_menu_"+e),Ln.default.open(o,!0)},addMusic:function(e,t,n){window.audioplayer.add(t),ae.default.close(e),Kc._hideTooltips(!0),Kc.showFlashPopup(n?window.lang.mobile_stories_music_deleted:window.lang.mobile_stories_music_added)},nextMusic:function(e,t){var n=window.audio,i=window.audioplayer,a=ni(t);if(n.getCurrentId()){var r=n.playlist().map((function(e){return e.id})).indexOf(n.getCurrentId())+1;n.addToPlaylist([a],r)}else i.playPause(!1,a.fullId,!0),n.pause();ae.default.close(e),Kc._hideTooltips()},toggleLikeForCurrentStory:function(e){var t=this,n=Kc.getCurrentStory(),i=Kc.getCurrentAuthor().story,a=n.raw_id,o=n.isLiked,s=n.likeHash,c={act:o?"delete_like":"like",hash:s,story_raw_id:a};i.isLiked=!o,n.isLiked=!o,e.innerHTML=o?d.default.html(Object(R.default)(Object(ac.getLikeOutlineShadow48Icon)())):d.default.html(Object(R.default)(Object(ic.getLikeShadow48Icon)())),Object(r.toggleClass)("Story__like--set",e,n.isLiked),window.ajax.post("stories.php",c,{onDone:function(a){a?(i.isLiked=o,n.isLiked=o,e.innerHTML=o?d.default.html(Object(R.default)(Object(ic.getLikeShadow48Icon)())):d.default.html(Object(R.default)(Object(ac.getLikeOutlineShadow48Icon)())),Object(r.toggleClass)("Story__like--set",e,n.isLiked)):t.sendAnalyticsEvent(o?"click_to_unlike":"click_to_like")}})},clickToApp:function(){var e=Kc.getCurrentStory(),t=e.raw_id,n=void 0===t?"":t,i=e.clickable_stickers,a=i&&i.stickers.find((function(e){return e.type===_c.app}));if(a&&a.appId){var r=n.split("_"),o=r[0],s=r[1];a.hasNewInteractions&&window.ajax.post("stories.php",{act:"mark_app_notifications_seen",owner_id:o,story_id:s,sticker_id:a.id,hash:a.hash},{onDone:function(){a.hasNewInteractions=!1;var e=document.querySelector(".Story__app");e&&e.classList.contains("has_new")&&e.classList.remove("has_new")}}),this.pauseStory(),this.showLoading(),nav.go("/app"+a.appId+"?ref="+a.appRef+"&hash="+a.appHash)}},openPoll:function(e,t,n){var i="/poll"+e+"_"+t+"?from=story"+n+"&story_raw="+n;nav.go(i),Kc.showLoading()},openSituationalApp:function(e,t){this.pauseStory(),Kc.showLoading();var n="/app"+e+"#"+t;window.location.href=n},onRender:Object(u.default)()};window.page&&window.page.onChange((function(){window.store.storiesLayers=[],window.store.stories={}})),window.Stories=Kc,window.showNarrative=function(e,t,n,i,a){void 0===n&&(n=0),void 0===i&&(i=""),void 0===a&&(a={});var r=""+e+(n=n?"_"+n:"")+"/"+(i=i||"narrative"+e+"_"+t);Object.assign(a,{narrativeId:t}),Kc.init(r,a)},function(e){e.IMAGE="image",e.VIDEO="video"}($c||($c={}));var Qc=n("WWJR"),Xc=function(e){var t="width: "+e.artboardWidth+"px; height: "+e.artboardHeight+"px",n=e.background_type===$c.IMAGE?{class:"StoryPublisher__canvasLayer",width:"1080",height:"1920",style:t,tag:"canvas"}:{inner:[{src:e.src,tag:"source"}],class:"StoryPublisher__video",preload:"metadata",controls:!0,controlsList:"nodownload",onContextMenu:"cancelEvent(); return false;",tag:"video"},i=d.default.wrap(Object(J.getLang)("mobile_apps_story_publisher_description").replace("{service_name}",e.miniAppName));return{inner:[{inner:[Object(qt.default)({inner:[Object(R.default)({icon:Object(Qc.getCancelOutline28Icon)()})],theme:"header",class:"StoryPublisher__headerButton",onClick:"StoryPublisher.closePopup()",use_native_onclick:!0,is_icon:!0})],class:"StoryPublisher__header",tag:"div"},{inner:[d.default.wrap(Object(Ya.default)({mix:"al_loading StoryPublisher__spinner",type:"pageLoader",isFixed:!0})),{inner:[n],class:"StoryPublisher__canvas",style:t,tag:"div"},{inner:[i],class:"StoryPublisher__description",tag:"div"},Object(qt.default)({inner:[d.default.wrap(Object(J.getLang)("mobile_apps_story_publisher_publish_btn_text"))],onClick:"StoryPublisher.save(this)",use_native_onclick:!0})],class:"StoryPublisher__content",tag:"div"}],class:"Popup StoryPublisher",tag:"div"}};Object.assign(Xc,{init:function(e,t,n){var i=this;void 0===t&&(t=W.noop),void 0===n&&(n=W.noop),this.successHandler=this.successHandler.bind(this),this.errorHandler=this.errorHandler.bind(this),e.artboardHeight=e.artboardHeight||(window.innerHeight<357?window.innerHeight-100:357),e.artboardWidth=e.artboardWidth||e.artboardHeight/1.78,this.props=e,this.props.src=e.src||e.url||e.blob,this.onClickSave=t,this.cb=n,this.popup=Ln.default.open(d.default.elem(Xc(this.props)),!0);var a=function(){return Ya.default.hide(document.querySelector(".StoryPublisher__spinner"))};switch(this.props.background_type){case $c.IMAGE:Object(W.loadImage)(this.props.src).then((function(e){a(),i.drawImage(e)})).catch((function(){return i.errorHandler(new Error("Can't upload image"))}));break;case $c.VIDEO:this.validateVideo(this.props).then(a).catch(this.errorHandler)}return this},drawImage:function(e){if(this.canvas=document.querySelector(".StoryPublisher__canvasLayer"),!this.canvas)return this.errorHandler();var t=this.canvas.getContext("2d");if(!t)return this.errorHandler();var n,i,a=+(e.height/e.width).toFixed(2);if(a>1.77?(i=this.canvas.height,n=this.canvas.height/a):(n=this.canvas.width,i=this.canvas.width*a),t.save(),t.clearRect(0,0,this.canvas.width,this.canvas.height),t.filter="blur(135px)",t.drawImage(e,0,0,this.canvas.width,this.canvas.height),t.restore(),"none"!==t.filter){var r=Object(W.getAverageRGB)(t);t.fillStyle="rgb("+r.r+", "+r.g+", "+r.b+")",t.fillRect(0,0,this.canvas.width,this.canvas.height)}t.drawImage(e,this.canvas.width/2-n/2,this.canvas.height/2-i/2,n,i)},closePopup:function(e){void 0===e&&(e=!0),e&&this.cb(),Ln.default.close(this.popup),this.popup=null},successHandler:function(e){this.cb(!0,e),this.isLoading=!1,this.closePopup(!1)},errorHandler:function(e){void 0===e&&(e={}),this.props.closeAfterError&&this.closePopup(!1),this.cb(!1,{error:e}),this.isLoading=!1,qt.default.setLoading(this.shareButton,!1),N.init({type:N.SNACKBAR_TYPE_ERROR,text:e.message||Object(J.getLang)("mobile_apps_story_publisher_unexpected_error")})},save:function(e){var t=this;if(!this.isLoading){this.onClickSave(),qt.default.setLoading(e,!0),this.shareButton=e,this.isLoading=!0;var n=this.props,i=n.background_type,a=n.miniAppId,r=n.entrypoint,o=n.storyUploadUrlHash,s=n.storySaveHash;Promise.all([this.getBlob(),Object(Z.getStoryUploadUrl)({mini_app_id:a,story_type:i===$c.IMAGE?Z.StoryType.PHOTO:Z.StoryType.VIDEO,hash:o,entry_point:r,ref:window.cur.module})]).then((function(e){var n=e[0],i=e[1];return t.uploadStoryBlobToServer(n,i)})).then((function(e){var t=e.response;return Object(Z.saveStoryOnServer)(t&&t.upload_result,s)})).then(this.successHandler).catch(this.errorHandler)}},uploadStoryBlobToServer:function(e,t){return new Promise((function(n,i){var a=Object(W.getBlobType)(e),o=9e5*Math.random(),s=new FormData,c=encodeURIComponent("story_"+o+"."+a);s.append("file0",e,c);var l=Object(r.uploadFile)(t,s,{onComplete:function(){var e=Object(r.parseJSON)(l.response);e&&e.response&&e.response.upload_result||i(),n(e)},onError:i})}))},getBlob:function(){var e=this;return this.props.background_type===$c.IMAGE?new Promise((function(t,n){try{e.canvas.toBlob(t,"image/jpeg")}catch(e){n()}})):Object(W.getMediaBlob)(this.props.src)},validateVideo:function(e){return new Promise((function(t,n){Object(W.getVideoDuration)(e.src).then((function(i){if(e.maxVideoDuration&&i>e.maxVideoDuration)return n(new Error("The duration of the video file must not exceed 15 seconds"));t(i)})).catch((function(){return n(new Error("Can't upload video"))}))}))}}),window.StoryPublisher=Xc;var Jc=function(){this.onNarrativeChangedFromStoryView=Object(u.default)(),this.onNarrativeRemovedFromStoryView=Object(u.default)()};window.Narratives=new Jc;var Zc={rollback:{onDone:function(e){var t=e.html,n=e.post;e.hash;cur.restored=0;var i=Object(r.ge)(n+"__message-archived");if(t){var a=n+"__message-rollback",o=Object(r.ce)("div",{className:["post_message_item",i.className].join(" "),innerHTML:t,id:a});Object(r.hide)(i),Object(r.ge)(o)||Object(r.after)(o,i)}else{var s=Object(r.ge)(n+"__message-rollback");Object(r.show)(i),Object(r.remove)(s)}}},set:{onStart:function(){var e=this.link;e.classList.contains("wia_item")&&Object(r.addClass)(e,"wia_item--loading")},onDone:function(e){var t=e.html,n=e.post,i=e.restored,a=e.rollback_hash,o=this.link;cur.restored||(cur.restored=0),i&&"profile"===cur.module&&cur.restored++,Object(r.removeClass)(o,"wia_item--loading");var s=Object(r.ge)(n),c=Object(r.ge)(n+"_replies");if(t){if(cur.restored>3){var l=s.id+"?act=rollback_archive&hash="+a;t+=Wd.html({class:"service_msg_row",inner:{tag:"a",href:l,onclick:"return ajax.click(this, Archive.rollback)",inner:Object(J.getLang)("mobile_archive_restore_bulk")}})}var u=s.id+"__message-archived",d=Object(r.ce)("div",{className:["post_message_item",s.className].join(" "),innerHTML:t,id:u});Object(r.hide)(s),Object(r.hide)(c),Object(r.ge)(u)||Object(r.after)(d,s)}else if(n){var _=Object(r.ge)(n+"__message-archived"),f=Object(r.ge)(n+"_replies");Object(r.show)(n),Object(r.show)(f),Object(r.remove)(_)}}}};window.Archive=Zc;var el=function(e,t){Object(r.cancelEvent)(e);var n=t.getAttribute("href"),i=Object(J.getLang)("mobile_wall_prometheus_edit_warn");Object(Uc.Confirm)(i,'Popup.close(this); nav.go("'+n+'");',"",{title:Object(J.getLang)("mobile_prometheus_edit_warn_popup_title")})};window.PrometheusEditConfirm=el,window.CopyrightPopup={open:function(e,t,n,i){var a=Object(In.default)({class:"CopyrightPopup",header:{title:Object(J.getLang)("mobile_wall_post_copyright_source")},content:{inner:[t,{class:"Popup__buttons",inner:[Object(qt.default)({class:"Popup__button",inner:Object(J.getLang)("mobile_wall_post_copyright_go"),theme:"regular",use_native_onclick:!0,on_click:"CopyrightPopup.go(this, '"+n+"', "+(i?1:0)+")"})]}]}});In.default.open(Wd.elem(a),!0)},go:function(e,t,n){var i;if(In.default.close(e),t.startsWith("/story"))window.Stories.init(t.substr(1),{source:"view_source"});else if(i=/^\/?narrative(-?\d+)_(\d+)(?:_(\d+))?(\/?([a-z0-9_-]+))?$/i.exec(t)){var a=i,r=a[0],o=a[1],s=a[2];window.showNarrative(r,o,s,{source:"view_source"})}else{if(/^@-?[\d\w._]+-[\d\w.-]+/.test(t.substr(1))&&(t+="?from="+nav.cur),!n)return nav.go(t,null);window.open(t,"post_copyright")}}};var tl=n("UvyM");function nl(){var e=window.lang,t=Object(F.$)(".pcont .service_msg_box");if(t){var n=Object(F.$)(".service_msg",t).innerHTML;Object(r.remove)(t);var i=Object(In.default)({class:"CopyrightPopup",content:[{inner:d.default.wrap(n)},{class:"Popup__buttons",inner:[Object(tl.default)({class:"Popup__button",inner:e.mobile_zphoto_close,theme:"regular",on_click:"Popup.close(this)",use_native_onclick:!0})]}]});In.default.open(d.default.elem(i),!0)}}window.ZeroVKPopup={open:nl,init:function(){window.onDOMReady((function(){nl()}))}};n("B9v3"),n("2fMF"),n("PssS");window.initSharePage=function(e,t){var n=Object(r.ge)("SharePageInput__to"),i="";n&&(i=n.value);var a={};if("mail"===e&&""!==n.value&&(a=i.split(",").reduce((function(e,t){return e[t]=!0,e}),{})),"club"===e){var o=Object(F.$)(".SharePage .qsearch_wrap"),s=Object(F.$)(".hp_block",o);Object(r.show)(o),Object(r.show)(s)}var c=Object(F.$)(".SharePage .SharePanel.MessagePanel"),l=Object(F.$)(".SharePage .SharePanel.ActionsPanel");Object(r.extend)(cur,{publishTo:e,refreshSelected:function(e,t,i){var a;void 0===i&&(i=!0),Object(r.isUndefined)(e)||(cur.publishSelected=e),t=cur.publishTo,e=cur.publishSelected,"group"===t?a=Object(r.ge)("club"+e):"mail"===t&&(a=Object(r.ge)("peer"+e));var o=!!cur.selectedMap[e];a&&(a.classList.toggle("inline_item_selected",i?!o:o),cur.like_search.toggleAttach(e,!o),i&&(cur.selectedMap[e]=!o),n.value=Object.keys(cur.selectedMap).filter((function(e){return cur.selectedMap[e]})).join(","));var s=Object.keys(cur.selectedMap).length>0&&Object.keys(cur.selectedMap).some((function(e){return!!cur.selectedMap[e]}));return c.classList.toggle("SharePanel--active",s),l.classList.toggle("SharePanel--active",!s),!1},selectedMap:a,selectPeer:function(e,t){return cur.refreshSelected(t,"mail"),!1}}),Object.keys(a).forEach((function(t){cur.refreshSelected(t,e,!1)}))};var il=function(e,t,n,i,a,r,o,s){n?Object(Uc.Confirm)(t,"ReportConfirm.submit('"+a+"', false, "+i+", '"+r+"', "+JSON.stringify(o)+")","",{title:e,id:"confirm-"+i}):rl(a,!0,i,r,JSON.stringify(o),s)};function rl(e,t,n,i,a,o){"string"==typeof a&&(a=JSON.parse(a));var s=Object(F.$)("#mcont");Object(r.setStyle)(s,{"pointer-events":"none"}),window.ajax.post(e,Object(B.default)({_ajax:1,reason:n,onDone:function(){Object(r.isVkWebView)()&&history.back()}},a)),"story"===a.type&&window.Stories.sendAnalyticsEvent("claim"),window.Snackbar.init({text:o||Object(J.getLang)("mobile_msg_reported")}),Object(F.$$)(".Confirm").forEach((function(e){return In.default.close(e)}))}Object(r.extend)(il,{submit:rl}),window.ReportConfirm=il;var ol=function(e){return{class:"ModalMenuUserList",inner:Object(Or.default)({inner:e.users})}},sl=n("WE4r");var cl=function(e){var t="animation-duration: "+e.duration+"s;";return{inner:[{inner:[Object(R.default)({icon:Object(sl.getCancel16Icon)()})],class:"CancelTimer__cross",tag:"div"},{inner:[{inner:[{class:"CancelTimer__line",style:t,tag:"span"}],class:"CancelTimer__hand",tag:"div"},{inner:[{class:"CancelTimer__line",style:t,tag:"span"}],class:"CancelTimer__hand",tag:"div"}],class:"CancelTimer__timer",tag:"div"}],class:"CancelTimer",tag:"div"}},ll=n("JlTo");window.Replies={init:function(e,t){void 0===t&&(t=0);!function(e){e&&function(){var e=Object(r.geByClass1)("wall_replies"),t=Object(r.domLC)(e);if(!t||!Object(r.hasClass)("RepliesThreadNext",t))return;var n=Object(r.geByClass1)("RepliesThreadNext__link",t);Object(r.autoScroll)((function(){if(Object(r.domPN)(t)&&!Object(r.hasClass)("RepliesThreadNext_loading",t))return n}),window.RepliesNext,{no_cache:!0})}();(function(){var e=Object(r.ge)("reply_field");if(!e||Object(r.hasClass)("RepliesField_static",e))return;var t=window.onBodyScroll,n=!1;t(Object(r.throttle)((function(t){var i=t+Object(r.getCh)(),a=Object(r.getH)(e),o=i<Object(r.getY)(e)+a;o&&!n?(Object(r.setStyle)(e,{height:a}),Object(r.addClass)("RepliesField_fixed",e)):!o&&n&&(Object(r.removeClass)("RepliesField_fixed",e),Object(r.setStyle)(e,{height:null})),n=o}),10)),Object(r.onBodyScrollForce)()})(),function(e){var t=Object(r.ge)("replies_to_last"),n=Object(r.geByClass1)("RepliesWrap"),i=Object(r.geByClass1)("RepliesField_wrap");if(!t||!n)return;var a=Object(r.ge)("reply_field"),o=Object(r.hasClass)("RepliesField_static",a),s=Object(r.getY)(n),c=window.onBodyScroll,l=!1;_l(),c(Object(r.throttle)((function(e){var c=e+Object(r.getCh)(),u=a&&!o?Object(r.getY)(a)-50:s+Object(r.getH)(n)-Object(r.getH)(i),d=s<e&&c<u;d!==l&&(Object(r.toggleClass)("Replies_last_shown",t,d),t.setAttribute("tabindex",d?0:-1),l=d)}),10))}()}(e);var n=Object(r.ge)("reply_field"),i=Object(r.ge)("reply_field_text");window.mediaUpload&&n&&(window.mediaUpload.onStart(fl),window.mediaUpload.onRemove((function(){fl(),i.focus()})));if(Ot.default.checkStickers(),n){var a=window.cur;a.onStickersToggleCallbacks=a.onStickersToggleCallbacks||[],a.onStickersToggleCallbacks.push((function(e){if(Object(r.onBodyScrollForce)(),dl(),e){var t=Object(r.geByTag1)("a","stickers_panel");t&&t.focus()}else i.focus()})),function(e){var t=Object(J.getState)("mention_items_"+e);t&&window.Mention.init({appendTo:Object(F.$)(".MentionContainer"),items:t})}(t),ul()}window.post.stickersInit()},replyTo:function(e,t,n,i,a){void 0===a&&(a="wall_reply");if(Object(r.checkEvent)(e))return!0;if(window.cur.replyTo!==n&&Al)return jl(),!0;n=n||0,Object(r.geByClass)("ReplyItem_active").forEach((function(e){Object(r.removeClass)("ReplyItem_active",e)}));var o,s=Object(r.ge)("reply_field"),c=Object(r.ge)("reply_field_text"),l=Object(r.hasClass)("RepliesField_static",s),u=!!window.post&&window.post.replyNamesRE(),d=Object(r.val)(c),_="";if(n){if(o=Object(r.ge)(a+t+"_"+n))if(l||Object(r.addClass)("ReplyItem_active",o),!Object(r.hasClass)("ReplyItem_deleted",o)&&i){var f=window.cur.replyNames[i]||{},p=f[0]||"";_=f[1]||"",d=d?u?d.replace(u,p):d:p,window.post&&window.post.onReplyClick(!0,p)}else d=u?d.replace(u,""):d}else d=u?d.replace(u,""):d;Object(r.val)(c,Object(r.replaceEntities)(d));var h=Object(r.ge)("reply_field_to"),m=Object(r.geByClass1)("RepliesField__infoName",h);Object(r.val)(m,Object(r.htsc)(_)),Object(r.toggleClass)("RepliesField__infoItem_shown",h,n&&_),Object(r.toggleClass)("RepliesField__infoItem_shown","reply_field_to_empty",n&&!_);var v=Object(r.ge)("reply_field_info"),g=Object(r.ge)("reply_field_from");if(Object(r.toggleClass)("RepliesField__info_shown",v,n||g),Object(r.toggleClass)("RepliesField__info_single",v,n&&!g||!n&&g),Object(r.val)("field_reply_to",n),Object(r.val)("field_reply_to_name",n&&_?"1":""),window.cur.replyTo=n,Object(r.val)("field_timestamp",Ol()),l)if(o)Ka.default.changePosition(Ka.default.getByName("attaches"),!0,!1),Object(r.domInsertAfter)(s,o);else{Ka.default.changePosition(Ka.default.getByName("attaches"),!0,!0);var A=Object(r.geByClass1)("wall_replies");Object(r.domInsertBefore)(s,A)}return dl(),ul(),Object(r.elfocus)(c),Object(r.cancelEvent)(e)},showMoreActions:function(e,t){var n=Object(r.ge)("reply_more_"+e);if(!n)return;var i=Object(r.geByClass)("ReplyItem__action",n),a=[];i.forEach((function(e){a.push(Object(ae.ModalMenuBtn)({inner:Object(r.val)(e),onclick:"Replies.onClickMoreAction('"+e.id+"', event)"}))}));var o=Object(ae.default)({close:!0,items:a}),s=Object(r.ceFromString)(d.default.html(o));s=Ln.default.open(s,!0,{oncloseCallback:function(){var t=Object(r.ge)("reply_more"+e);t&&t.focus()}});var c=Object(r.geByClass1)("ModalMenu__btn",s);c&&c.focus();return Object(r.cancelEvent)(t)},onClickMoreAction:function(e,t){t&&Ln.default.close(t.target);var n=Object(r.ge)(e);if(!n)return;n.click()},onFieldInput:ul,toggleStickers:function(e,t){if(Al)return Object(r.cancelEvent)(t);return window.post.stickersToggle(e),Object(r.cancelEvent)(t)},replyAsShow:function(e,t,n){void 0===n&&(n=!1);var i,a=!!window.cur.replyAs;kl("editing"),a?i=ml(window.cur.replyAs):(i=d.default.wrap(Object(me.default)({large:!0})),function(e,t){void 0===t&&(t=!1);if(window.cur.replyAsLoading)return;var n=window.ajax;window.cur.replyAsLoading=!0,n.post("/wall.php",{act:"get_reply_clubs_list",only_this_group:t?1:0,post_oid:e,modal:1},{onDone:function(e){window.cur.replyAs=e;var t=Object(r.ge)("reply_as_users_list");if(t){var n=ml(e);Object(r.val)(t,d.default.html(n));var i=Object(r.geByClass1)("ModalMenuUserList__item",t);i&&i.focus()}delete window.cur.replyAsLoading},onFail:function(){delete window.cur.replyAsLoading}})}(t,n));var o=Object(ae.default)({title:Object(r.getLang)("mobile_wall_reply_as_title"),close:!0,items:[{id:"reply_as_users_list",inner:i}]}),s=Object(r.ceFromString)(d.default.html(o));if(Ln.default.open(s,!0),a){var c=Object(r.geByClass1)("ModalMenuUserList__item",Object(r.ge)("reply_as_users_list"));c&&c.focus()}return Object(r.cancelEvent)(e)},replyAsChange:function(e,t,n,i){var a=Object(r.ge)("reply_field_from"),o=Object(r.geByClass1)("RepliesField__infoName",a);return Object(r.val)(o,Object(r.htsc)(i)),Object(r.val)("field_from_oid",n),ae.default.close(t),Object(r["ge"])("reply_field_text").focus(),Object(r.cancelEvent)(e)},checkSendButton:function(e){if(!hl())return Object(r.cancelEvent)(e);window.cur.needTrackMyTracker&&Object(ll.tmrTrackCustomGoal)("comment_in_sport_broadcast")},onClickLastReplies:function(e,t){var n=Object(r.geByClass1)("wall_replies"),i=Object(r.domLC)(n),a=i&&Object(r.hasClass)("RepliesThreadNext",i);if(a){var o=Object(r.geByClass1)("Loading",i);o||(o=Object(r.ceFromString)(Object(me.default)({})),Object(r.append)(o,i)),Object(r.addClass)("RepliesThreadNext_loading",i)}if(Object(r.removeClass)("RepliesWrap_last_shown",e),window.scrollTo(0,document.body.scrollHeight),a)return i.focus(),window.ajax.click(e,window.RepliesLast);i&&(Object(r.hasClass)("RepliesThread",i)&&(i=Object(r.domPS)(i)),Object(r.hasClass)("ReplyItem",i)&&Object(r.geByClass1)("ReplyItem__name",i).focus());return Object(r.cancelEvent)(t)},onSubmitForm:function(e,t){if(Ol())jl();else{if(e.preventDefault(),bl)return;var n=Object(F.$)('textarea[name="message"]',t),i=n?n.value:"";if(!i)return Sl(-1),void jl();bl=!0;var a=location.pathname.match(/^\/wall(-?[0-9]+)_([0-9]+)$/),o=a[1],s=a[2];window.ajax.post("/wall.php",{act:"check_comment",oid:o,post_oid:s,text:i},{onDone:function(e){if(bl=!1,Sl(e.timestamp),e.delay){var t,n=1e3*e.delay,i=Object(F.$)("#reply_field");Object(r.hasClass)("RepliesField_fixed",i)?t=Object(r.getH)(i)+5:Object(r.hasClass)("RepliesField_static",i)||(t=Object(r.getH)(Object(F.$)("body"))-Object(r.getY)(i)+5),gl=window.Snackbar.init({type:N.SNACKBAR_TYPE_BULLYING,text:e.description,bottom:t,duration:n}),vl=setTimeout((function(){Cl(),jl()}),n),function(e){var t=Object(F.$)("#nc_submit"),n=Object(F.$)(".RepliesField__field"),i=d.default.elem({class:"RepliesField__action RepliesField__action_cancel",inner:cl({duration:e/1e3}),onclick:["Replies.abortTimer","button"]});Al=!0;var a=Object(F.$)(".RepliesField__action_attach"),o=Object(F.$)(".RepliesField__action_smile");a&&a.classList.add("RepliesField__action_disabled"),o&&o.classList.add("RepliesField__action_disabled"),n.appendChild(i),Object(r.hide)(t)}(n)}else jl()},onFail:function(){bl=!1,jl()}})}},abortTimer:kl,setCurrentTimestamp:Sl,getCurrentTimestamp:Ol};function ul(){var e=Object(r.ge)("reply_field_text"),t=Object(r.ge)("reply_field_text_fake");if(e&&t){var n=e.value;t.innerText=n,"\n"===Object(r.last)(n)&&(t.innerHTML+="&nbsp;");var i=Object(r.getH)(t);Object(r.getH)(e)!==i&&(Object(r.setStyle)(e,{height:i}),dl()),pl(),kl("editing")}}function dl(){var e=Object(r.ge)("reply_field");Object(r.hasClass)("RepliesField_static",e)||Object(r.hasClass)("RepliesField_fixed",e)&&(Object(r.setStyle)(e,{height:Object(r.getH)(Object(r.geByClass1)("RepliesField_wrap",e))}),_l(),Object(r.onBodyScrollForce)())}function _l(){var e=Object(r.ge)("replies_to_last"),t=Object(r.ge)("reply_field");if(e&&t&&!Object(r.hasClass)("RepliesField_static",t)){var n=Object(r.domData)(e,"bottom");n||(n=parseInt(Object(r.getStyle)(e,"bottom"))||20,Object(r.domData)(e,"bottom",n)),Object(r.setStyle)(e,"bottom",Object(r.getH)(t)+parseInt(n))}}function fl(){pl(),dl();var e=(window.mediaUpload?window.mediaUpload.getAttachesCount():0)<2;["photo_device","photo","video","audio","doc"].forEach((function(t){Ka.default.toggleItemEnabled(Ka.default.getByName("attaches"),t,e)}))}function pl(){var e=Object(r.ge)("nc_submit");e&&Object(r.toggleClass)("RepliesField__action_send_active",e,hl())}function hl(){var e=(Object(r.ge)("reply_field_text")||{}).value;return Object(r.trim)(e)||window.mediaUpload&&window.mediaUpload.getAttachesCount()}function ml(e){var t=[];return e.forEach((function(e){var n;t.push({class:"ModalMenuUserList__item",href:(n={href:e[2],image:e[1],name:e[3],onclick:"return Replies.replyAsChange(event, this, "+parseInt(e[0])+", '"+e[4]+"')"}).href,onclick:n.onclick?n.onclick:null,inner:[{tag:"img",class:"ModalMenuUserList__itemAvatar",src:n.image},{class:"ModalMenuUserList__itemName",inner:n.name}]})})),ol({users:t})}var vl,gl,Al=!1,bl=!1,wl={};function yl(){Al=!1,clearTimeout(vl),window.Snackbar.close(gl),Cl()}function Ol(){return wl[""+window.cur.replyTo]}function Sl(e){wl[""+window.cur.replyTo]=e,Object(r.val)("field_timestamp",e)}function kl(e){if(Al){var t=location.pathname.match(/^\/wall(-?[0-9]+)_([0-9]+)$/),n=t[1],i=t[2],a=Ol();window.ajax.post("/wall.php",{act:"cancel_check_comment",oid:n,post_oid:i,reason:e,timestamp:a})}yl()}function Cl(){var e=Object(F.$)("#nc_submit"),t=Object(F.$)(".RepliesField__action_cancel"),n=Object(F.$)(".RepliesField__action_attach"),i=Object(F.$)(".RepliesField__action_smile");n&&n.classList.remove("RepliesField__action_disabled"),i&&i.classList.remove("RepliesField__action_disabled"),Object(r.remove)(t),Object(r.show)(e)}function jl(){var e=Object(F.$)("#nc_submit");Sl(Ol()),nav.go(e,window.event),Sl(0)}nav.onBeforeGo((function(e,t){var n=location.pathname.substr(1,4);Object(r.isString)(e)&&e.substr(1,4)!==n&&"wall"===n&&(wl={})})),window.page&&window.page.onChange((function(e,t){yl()}));n("8k8e");function El(){Object(F.$$)(".WallSearchBtn__wrapper").forEach((function(e){var t=e.querySelector(".Slider__scroll"),n=null==t?void 0:t.getBoundingClientRect(),i=e.querySelector(".Slider__line"),a=null==i?void 0:i.getBoundingClientRect(),r=e.querySelector(".WallSearchBtn");(null==n?void 0:n.width)<(null==a?void 0:a.width)?null==r||r.classList.add("WallSearchBtn--divided"):(null==r?void 0:r.classList.contains("WallSearchBtn--divided"))&&(null==r||r.classList.remove("WallSearchBtn--divided"))}))}window.PostDraftReminder={openContextMenu:function(e,t,n){var i=window.lang;e.preventDefault(),e.stopPropagation();var a=Wd.html([Object(ve.ContextMenuItem)({title:i.mobile_wall_draft_delete,href:n.remove_url,ref:"wall_draft_reminder"})]),r=Wd.elem(Object(ve.ContextMenu)({list:a}));r.parentNode.id="post_draft_reminder_container",ve.ContextMenu.open(r,"#post_draft_reminder_container",{appendToBody:!0})}},window.onDOMReady((function(){El(),Object(r.onBodyResize)(El)})),window.page.onChange(El),window.WallSearch={onSearch:function(e,t){e.preventDefault(),Object(P.statlogsValueEvent)("mvk_wall_search_button"),nav.go(t)},checkOverflow:El};var Tl=n("8bHZ");function Il(e){void 0===e&&(e={});var t="",n="",i=null;return e.isOwner?(t=Object(J.getLang)(e.isOnlyForBestFriends?"mobile_post_privacy_modal_best_friends_owner_title":"mobile_post_privacy_modal_friends_owner_title"),n=Object(J.getLang)(e.isOnlyForBestFriends?"mobile_post_privacy_modal_best_friends_owner_description":"mobile_post_privacy_modal_friends_owner_description"),e.isOnlyForBestFriends&&0===e.bestFriendsCount&&(t=Object(J.getLang)("mobile_post_privacy_modal_no_one_will_see_title"),n=Object(J.getLang)("mobile_post_privacy_modal_no_one_will_see_description"),i=e.onChooseBestFriendsClick&&{text:Object(J.getLang)("mobile_post_privacy_modal_choose_best_friends_button_title"),theme:"link",onClick:e.onChooseBestFriendsClick})):(t=Object(r.langSex)(e.ownerSex,Object(J.getLang)(e.isOnlyForBestFriends?"mobile_post_privacy_modal_best_friends_title":"mobile_post_privacy_modal_friends_title","raw")).replace("{user_first_name}",e.ownerFirstName),n=Object(J.getLang)(e.isOnlyForBestFriends?"mobile_post_privacy_modal_best_friends_description":"mobile_post_privacy_modal_friends_description"),i=e.onCreatePostClick&&{text:Object(J.getLang)("mobile_post_privacy_modal_create_post_button_title"),theme:"link",onClick:e.onCreatePostClick}),function(e){void 0===e&&(e={});var t=window.lang,n=e.icon,i=e.actions||[],a=i.length||e.needCloseButton;e.inner&&1===e.inner.length&&null===e.inner[0]&&(e.inner=null);var r=i.map((function(e){return Object(qt.default)({inner:[e.text],theme:e.theme,onClick:e.onClick,use_native_onclick:!0})}));e.needCloseButton&&r.push(Object(qt.default)({inner:[t.mobile_close],stretch:!0,onClick:"ModalMenu.close(this)",use_native_onclick:!0,theme:"secondary"}));var o={inner:[e.needCloseIcon?Object(ie.ModalMenuHeaderCloseButton)({onClose:e.onClose}):null,n?{inner:[n],class:"ModalCard__icon",tag:"div"}:null,{inner:[e.title],class:"ModalCard__title",tag:"h2"},e.subhead?{inner:[e.subhead],class:"ModalCard__subhead",tag:"div"}:null,e.inner?{inner:[e.inner],class:"ModalCard__content",tag:"div"}:null,a?Object(Rc.BtnStack)({btns:r,mode:e.actionsLayout||"horizontal",stretch:!0}):null],class:"ModalCard__in",tag:"div"};return Object(ie.default)({class:"ModalCard",body:o})}({title:t,icon:Object(R.default)({icon:Object(Tl.getLockOutline56Icon)()}),needCloseIcon:!0,subhead:n,actions:i?[i]:null})}var Ml=new(function(){function e(){}return e.prototype.openPostPrivacyModal=function(e){var t=Il(e);window.ModalMenu.open(d.default.elem(t),!0)},e}());window.PostPrivacy=Ml,window.TextliveFeedBanner={close:function(e){return function(){var e=window.lang;if(!Object(Qs.canShow)(Qs.TooltipHelpHints.ACCOUNT_HINT_TEXTLIVE_HIDE))return;var t=Object(F.$)(".BottomMenu__cell:nth-child(4) .BottomMenu__icon"),n=Wd.elem(Object(Qs.default)({pos:"top_right",theme:"accent",inner:e.mobile_textlive_notifications_tooltip,onboarding:!0,"tooltip-id":Qs.TooltipHelpHints.ACCOUNT_HINT_TEXTLIVE_HIDE}));t.appendChild(n)}(),ajax.click(e,window.Comment)},restore:function(e){return ajax.click(e,window.Comment)},onTextliveOpen:function(){Object(r.statlogsValueEvent)("textlive_banner_action",null,"open")}};n("ionu");var Pl=n("VzJG");window.MainMenu={showMenuItems:Pl.showMenuItems},_.default.getRouter().addRoute(/^\/menu([\?#].*)?$/,Pl.rebuildNotifications),window.PostAttachVideoLink={},PostAttachVideoLink._onInit=Fl,PostAttachVideoLink._onPlayClick=Ul,PostAttachVideoLink._onReplayClick=Ul,PostAttachVideoLink._onSoundClick=Hl,PostAttachVideoLink._onVideoClick=Vl,PostAttachVideoLink._onVideoPlay=function(e){return Wl(e.target,"play")},PostAttachVideoLink._onVideoPause=function(e){return Wl(e.target,"pause")},PostAttachVideoLink._onVideoEnded=function(e){return Wl(e.target,"end")};var Dl="PostAttachVideoLink_muted",xl=function(e){return"PostAttachVideoLink_state_"+e},Ll=".PostAttachVideoLink",Bl=".PostAttachVideoLink__video",Rl=window.MutationObserver,Nl=null;function Fl(){Rl&&!Nl&&(Nl=new Rl($l)).observe(document.body,{childList:!0,subtree:!0})}function Hl(e){var t=e.closest(Ll),n=Object(F.$)(Bl,t);n.muted=!n.muted,t.classList.toggle(Dl,n.muted)}function Ul(e){var t=e.closest(Ll);Object(F.$)(Bl,t).play()}function Vl(e){e.paused||e.pause()}function Wl(e,t){var n=e.closest(Ll);n.classList.remove(xl("play")),n.classList.remove(xl("pause")),n.classList.remove(xl("end")),n.classList.add(xl(t))}function $l(e){e.forEach((function(e){e.removedNodes.forEach((function(e){e.nodeType===HTMLElement.ELEMENT_NODE&&Object(F.$$)(Bl,e).forEach((function(e){e.src="",e.load()}))}))})),Object(F.$)(Bl)||(Nl.disconnect(),Nl=null)}n("bRFj");var ql,zl,Yl,Gl,Kl,Ql=function(){function e(e,t,n,i,a,r){var o="/club"+t+obj2qs({act:e,hash:n,id:t,from:i});ajax.post(o,{_ajax:1},{onDone:a,onFail:r})}return{enter:function(t,n,i,a,r){void 0===a&&(a=null),void 0===r&&(r=null),e("enter",t,n,i,a,r)},leave:function(t,n,i,a,r){void 0===a&&(a=null),void 0===r&&(r=null),e("leave",t,n,i,a,r)},init:function(e,t){var n,i,a;void 0===t&&(t={}),t&&t.hasOwnProperty("add_recent_hash")&&(n=e,i=t.add_recent_hash,a={act:"add_recent",group_id:n,hash:i},L.default.post("/groups",a))}}}();window.Groups=Ql,window.FeedAssistanceStats=((ql={register:Du,forceRegister:function(e,t){e[Xl]=Lu(e),e[Zl]=t,mu.push(e)},onScroll:throttle(Ru,50),onStartViewElement:Object(u.default)("element"),onEndViewElement:Object(u.default)("element"),onStopTrackElement:Object(u.default)("element"),onViewedElement:Object(u.default)("element"),onBeforePageChange:Uu,onPageChanged:Vu,getElementType:Lu,registerElements:Mu,registerTrackingCls:function(e){Eu.push(e)},unregisterTrackingCls:Iu}).unregisterTrackingCls=Iu,ql.setParenViewableX=function(e,t){e._feedAssistanceStatsParentViewableX=t},ql.forceProcessTrack=xu,ql.dispatchElementEvent=function(e,t){var n=function(e){return _u[e]}(_d(t[Xl]||Lu(t),e));qu({type:e,data:n(t)})},ql.dispatchEvent=function(e){qu(e)},ql.serializeEventData=Bu,ql.clearElemsCache=function(){mu.forEach((function(e){e[iu]=!1,e[au]=!1}))},ql._debug=function(){return{started:vu,tracking:mu,events:ju,blindTop:Au,blindBottom:bu}},ql.getFromRef=wd,ql.getRoot=yd,ql.BLOCKS={},ql.EVENTS={},ql);var Xl="_feedAssistanceStatsType",Jl="_feedAssistanceStatsIdled",Zl="_feedAssistanceStatsModule",eu="_feedAssistanceStatsStarted",tu="_feedAssistanceStatsProcessed",nu="_feedAssistanceStatsEventTs",iu="_feedAssistanceStatsCachedY",au="_feedAssistanceStatsCachedX",ru="_feedAssistanceStatsLeft",ou="_feedAssistanceStatsHeight",su="_feedAssistanceStatsWidth",cu="_feedAssistanceStatsTop",lu="_feedAssistanceStatsBottom",uu=((zl={}).BLOCK_TYPE_RECOMMENDED_SLIDER="view_block",zl.BLOCK_TYPE_RECOMMENDED_GROUPS_SLIDER="view_block",zl.BLOCK_TYPE_PROMO_BUTTON="view_block",zl.BLOCK_TYPE_EXPLORE_BAIT="explore_bait",zl.BLOCK_TYPE_PROFILE_PHOTO="feed_assistance",zl.BLOCK_TYPE_IMPORT_CONTACTS="feed_assistance",zl.BLOCK_TYPE_PUSH_SWITCH="feed_assistance",zl),du=((Yl={}).BLOCK_TYPE_RECOMMENDED_SLIDER=500,Yl.BLOCK_TYPE_EXPLORE_BAIT=500,Yl.BLOCK_TYPE_PROFILE_PHOTO=500,Yl.BLOCK_TYPE_IMPORT_CONTACTS=500,Yl.BLOCK_TYPE_PUSH_SWITCH=500,Yl),_u=((Gl={})[_d("BLOCK_TYPE_RECOMMENDED_SLIDER","view_block")]=function(e){var t=geByClass1("Slider__scroll",e),n=domData(t,"code");return Bu("view_block","",e,domData(t,"ref"),n)},Gl[_d("BLOCK_TYPE_RECOMMENDED_GROUPS_SLIDER","view_block")]=function(e){var t=e.querySelector(".Slider__scroll");return Bu("view_block","",e,"",domData(t,"code"))},Gl[_d("BLOCK_TYPE_PROMO_BUTTON","view_block")]=function(e){return Bu("view_block",geByClass1("feedAssistancePromoButtonInstallApp__button",e)?"promo_install_app":"promo_button",e)},Gl[_d("BLOCK_TYPE_EXPLORE_BAIT","explore_bait")]=function(){return Bu("SUB_EXPLORE_BAIT","view")},Gl[_d("BLOCK_TYPE_PROFILE_PHOTO","feed_assistance")]=function(e){return Bu("feed_assistance",e,"m_ph","seen")},Gl[_d("BLOCK_TYPE_IMPORT_CONTACTS","feed_assistance")]=function(e){return Bu("feed_assistance",e,"m_mp","seen")},Gl[_d("BLOCK_TYPE_PUSH_SWITCH","feed_assistance")]=function(e){return Bu("feed_assistance",e,"m_push_switch","seen")},Gl),fu=((Kl={}).view_block=function(e,t,n,i){return n=n||wd(t),[e,domChildIndex(t),Od(t),n,i].join("|")},Kl.SUB_EXPLORE_BAIT=function(e){return e},Kl.feed_assistance=function(e,t,n){return[t,n,wd(e)].join("|")},Kl.hide=function(e,t){return[e,Od(t),domChildIndex(t),wd(t)].join("|")},Kl.SUB_PROMO_BUTTON=function(e,t,n){return[domChildIndex(e),t,n||""].join("|")},Kl),pu="feedAssistanceStat.events",hu="feedAssistanceStat.idled",mu=[],vu=[],gu=Date.now(),Au=0,bu=0,wu=!1,yu=null,Ou=null,Su=null,ku=null,Cu=null,ju=[],Eu=[],Tu=!1;function Iu(e){md(Eu,e)}function Mu(){var e=[];each(Eu,(function(){e=e.concat(geByClass(this))})),each(e,(function(){Du(this,"feed")}))}function Pu(){Mu();var e=cd();e.length&&(ad(e),ld()),xu(),Xu()}function Du(e,t){!e[Xl]&&function(e){return!~mu.indexOf(e)}(e)&&(e[Xl]=Lu(e),e[Zl]=t,mu.push(e))}function xu(){Wu(scrollGetY(),getCh())}function Lu(e){return e[Xl]?e[Xl]:hasClass("feedAssistance_recommendedFriends",e)?"BLOCK_TYPE_RECOMMENDED_SLIDER":e.classList.contains("feedAssistance_recommendedGroups")?"BLOCK_TYPE_RECOMMENDED_GROUPS_SLIDER":hasClass("post_exploreBait",e)?"BLOCK_TYPE_EXPLORE_BAIT":hasClass("feedAssistance_profilePhoto",e)?"BLOCK_TYPE_PROFILE_PHOTO":hasClass("feedAssistance_promoButton",e)?"BLOCK_TYPE_PROMO_BUTTON":hasClass("feedAssistance_importContacts",e)?"BLOCK_TYPE_IMPORT_CONTACTS":hasClass("feedAssistance_pushNotificationsSwitch",e)?"BLOCK_TYPE_PUSH_SWITCH":"BLOCK_TYPE_DEFAULT"}function Bu(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return fu[e].apply(fu,n)}function Ru(e,t){var n,i=Ru;Wu(e||scrollGetY(),t||getCh()),wu||Tu?(clearTimeout(i.timer),i.timer=setTimeout(Nu,150),Tu=!1):(wu=!0,Qu(),n=ge("vk_head"),Au=n&&n.offsetHeight,bu=0)}function Nu(){Qu(),Ku(),wu=!1}function Fu(){Qu(),bd(vu),ad(ju.concat(dd(vu))),gd(vu),ju=[],vu=[],Ju()}function Hu(){vu.forEach((function(e){e[eu]=Date.now()})),rd(null),od(null),Ku(),Ju(),Xu()}function Uu(){Qu(),bd(vu),ju=ju.concat(dd(vu)),gd(vu),vu=[],Tu=!0,Ku()}function Vu(){Mu(),xu()}function Wu(e,t){var n=[];mu.forEach((function(i){hd(i)?n.push(i):!function(e,t,n){return!e[eu]&&Yu(e,.5,t,n)&&Gu(e,.5)}(i,e,t)?!function(e,t,n){return e[eu]&&(!Yu(e,.25,t,n)||!Gu(e,.25))}(i,e,t)?zu(i)&&($u(i),FeedAssistanceStats.onViewedElement(i)):(i[Jl]?delete i[Jl]:($u(i),FeedAssistanceStats.onEndViewElement(i)),delete i[eu]):(i[eu]=Date.now(),vu.push(i),FeedAssistanceStats.onStartViewElement(i))})),n.forEach((function(e){md(mu,e),FeedAssistanceStats.onStopTrackElement(e)}))}function $u(e){md(vu,e),Ad(e),qu(pd(e)),vd(e)}function qu(e){e&&ju.push(e)}function zu(e){return!!e[eu]&&Math.min(3e5,Date.now()-e[eu])>function(e){var t=Lu(e);return du[t]||500}(e)}function Yu(e,t,n,i){if(!e)return!1;e[iu]||(e[iu]=!0,e[ou]=e.offsetHeight,e[cu]=n+e.getBoundingClientRect().top,e[lu]=e[cu]+e[ou]);var a=i-Au-bu,r=n+Au,o=n+i-bu,s=e[ou],c=e[cu],l=e[lu];return(l>r&&c<o?Math.min(o,l)-Math.max(r,c):0)>=Math.min(a*t,s*t)}function Gu(e,t){var n=e._feedAssistanceStatsParentViewableX;n&&!n[au]&&~mu.indexOf(n)&&(n[au]=!0,n[su]=n.clientWidth,n[ru]=n.getBoundingClientRect().left+n.clientLeft),e[au]||(e[au]=!0,e[su]=e.offsetWidth);var i=n?n[su]||n.clientWidth:getCw(),a=n?n[ru]||n.getBoundingClientRect().left+0:0,r=i+a,o=e[su],s=e.getBoundingClientRect().left,c=o+s,l=o*t,u=o*Math.max(0,1-t);return s+l>=a&&c-u<=r}function Ku(){yu=setTimeout(Zu,2500),Ou=setTimeout(ed,1e4),Su=setTimeout(td,6e3),ku=setTimeout(nd,2e4)}function Qu(){clearTimeout(yu),clearTimeout(Ou),clearTimeout(Su),clearTimeout(ku)}function Xu(){Cu=setInterval(id,3e4)}function Ju(){clearInterval(Cu)}function Zu(){ju.length&&rd(ju)}function ed(){ad(ju),ju=[],rd(null)}function td(){vu.length&&(od(dd(vu)),Su=setTimeout(td,5e3))}function nd(){clearTimeout(Su),bd(vu),ad(dd(vu)),gd(vu),vu.forEach((function(e){e[Jl]=!0})),vu=[],od(null)}function id(){ju.length>=100&&ed()}function ad(e){if(e&&e.length){var t={act:"assistance_stats"};t=extend(t,(n={},each(e,(function(){n[this.type]?n[this.type].push(this.data):n[this.type]=[this.data]})),n)),ajax.post("/feed",t)}var n}function rd(e){sd(pu,e)}function od(e){sd(hu,e)}function sd(e,t){var n=lsGet(e)||{};t?n[gu]=t:delete n[gu],lsSet(e,n)}function cd(){var e=cd,t=[],n=lsGet(pu)||{},i=lsGet(hu)||{};return e.iterator||(e.iterator=function(e){return function(n){ud(n)&&(t=t.concat(e[n]))}}),Object.keys(n).forEach(e.iterator(n)),Object.keys(i).forEach(e.iterator(i)),t}function ld(){var e=ld,t=lsGet(pu)||{},n=lsGet(hu)||{};e.iterator||(e.iterator=function(e){return function(t){ud(t)&&delete e[t]}}),Object.keys(t).forEach(e.iterator(t)),Object.keys(n).forEach(e.iterator(n)),lsSet(pu,t),lsSet(hu,n)}function ud(e){var t=Number(e);return t!==gu&&Date.now()-t>=36e4}function dd(e){var t=[];return e.forEach((function(e){var n=pd(e);n&&t.push(n)})),t}function _d(e,t){return e+"_"+t}function fd(e,t){return(0,_u[_d(e[Xl],t)])(e)}function pd(e){if(hd(e))return null;if(!zu(e))return null;var t=function(e){return uu[e[Xl]]}(e);return{type:t,data:fd(e,t)}}function hd(e){return e[tu]||!document.body.contains(e)}function md(e,t){var n=e.indexOf(t);n>=0&&e.splice(n,1)}function vd(e){hd(e)||zu(e)&&(e[tu]=!0)}function gd(e){each(e,(function(){vd(this)}))}function Ad(e){e[nu]=Date.now()}function bd(e){e.forEach(Ad)}function wd(e){return(e=yd(e))&&domData(e,"from-ref")||"feed_other"}function yd(e){return hasClass(e,"feedAssistance")||(e=domCA(e,".feedAssistance")),e}function Od(e){var t=(new Date).getTime();return e&&(e[nu]||e[eu])||t}FeedAssistanceStats.BLOCKS={BLOCK_TYPE_RECOMMENDED_SLIDER:"BLOCK_TYPE_RECOMMENDED_SLIDER",BLOCK_TYPE_RECOMMENDED_GROUPS_SLIDER:"BLOCK_TYPE_RECOMMENDED_GROUPS_SLIDER",BLOCK_TYPE_EXPLORE_BAIT:"BLOCK_TYPE_EXPLORE_BAIT",BLOCK_TYPE_PROFILE_PHOTO:"BLOCK_TYPE_PROFILE_PHOTO",BLOCK_TYPE_PROMO_BUTTON:"BLOCK_TYPE_PROMO_BUTTON",BLOCK_TYPE_IMPORT_CONTACTS:"BLOCK_TYPE_IMPORT_CONTACTS"},FeedAssistanceStats.EVENTS={EVENT_EXPLORE_BAIT:"explore_bait",EVENT_EXPLORE_BAIT_SUB:"SUB_EXPLORE_BAIT",EVENT_FEED_ASSISTANCE:"feed_assistance",SUB_EVENT_EXPLORE_BAIT_VIEW:"view",SUB_EVENT_EXPLORE_BAIT_LIKE:"like",SUB_EVENT_EXPLORE_BAIT_COMMENT:"comment",SUB_EVENT_EXPLORE_BAIT_OPENED:"opened",SUB_EVENT_EXPLORE_BAIT_SUBSCRIBE:"subscribe",SUB_EVENT_EXPLORE_BAIT_UNSUBSCRIBE:"unsubscribe",SUB_EVENT_EXPLORE_BAIT_OPEN_USER:"open_user",SUB_EVENT_EXPLORE_BAIT_OPEN_GROUP:"open_group",SUB_EVENT_EXPLORE_BAIT_HIDE:"hide",SUB_EVENT_EXPLORE_BAIT_REPORT:"report",SUB_EVENT_SEEN:"seen",SUB_EVENT_FILLED:"filled",EVENT_HIDE_BLOCK:"hide",SUB_EVENT_ENABLE_PUSH:"enable_push",SUB_EVENT_DECLINE_PUSH:"decline_push",EVENT_PROMO_BUTTON:"promo_button",EVENT_PROMO_BUTTON_SUB:"SUB_PROMO_BUTTON",SUB_EVENT_PROMO_BUTTON_CLICK:"clicked"},addEvent(window,"blur",Fu),addEvent(window,"focus",Hu),onDOMReady((function(){setTimeout(Pu,500)})),addEvent(window,"scroll",(function(){Ru(scrollGetY(),getCh())}),{passive:!0}),nav.onBeforeGo((function(){return Uu()})),page.onChange((function(){return Vu()}));n("yuVR");function Sd(e){return Object.keys(e).map((function(t){return t+":"+e[t]+";"})).join("")}function kd(e){return e+"-"+Date.now()+"-"+Math.round(999999*Math.random())}var Cd=[];function jd(e){Cd.push(e),Ed()}var Ed=Object(r.debounce)((function(){var e=Cd.map((function(e){return Object(F.$)("#"+e)})).filter((function(e){return e})).map((function(e){var t=Math.round(e.getBoundingClientRect().left),n="skeleton-gradient-slide-"+t;return function(e,t){if(Id[e])return;var n=function(e,t){return["@"+Td()+"keyframes "+e+" {",t.map((function(e,n){return["\t"+n/(t.length-1)*100+"% {",Object.keys(e).map((function(t){return"\t\t"+t+": "+e[t]+";"})).join("\n"),"\t}"].join("\n")})).join("\n"),"}"].join("\n")}(e,t);Id[e]=n,Md.appendChild(document.createTextNode(n))}(n,[{"background-position-x":-600-t+"px"},{"background-position-x":window.innerWidth-t+"px"}]),{el:e,prop:n+" 1.2s infinite cubic-bezier(0.4, 0.0, 0.2, 1)"}}));requestAnimationFrame((function(){e.forEach((function(e){var t=e.el,n=e.prop;t.style[Td()+"animation"]=n})),Cd=[]}))}),100);function Td(){var e="";document&&(e=null!=(document.documentElement||document.createElement("div")).style.animation?"":"-webkit-");return e}var Id={},Md=document.createElement("style");function Pd(e){void 0===e&&(e={});var t=kd("skeleton-circle"),n=Sd({width:e.size+"px",height:e.size+"px"})+(e.style||""),i=["SkeletonComponent__item",l.default.class("SkeletonCircle",{header:e.header}),e.class].filter((function(e){return e})).join(" ");return jd(t),{id:t,class:i,style:n,tag:"div"}}document.head.appendChild(Md);function Dd(e){void 0===e&&(e={});var t=kd("skeleton-line"),n=Sd({})+(e.style||""),i=["SkeletonComponent__item",l.default.class("SkeletonLine",{small:e.small,header:e.header}),e.class].filter((function(e){return e})).join(" ");return jd(t),{id:t,class:i,style:n,tag:"div"}}function xd(e){void 0===e&&(e={});var t=[l.default.class("SkeletonRow",{justifyContent:e.justify,alignItems:e.align}),e.class].filter((function(e){return e}));return{inner:[e.inner],class:t.join(" "),tag:"div"}}function Ld(e){void 0===e&&(e={});var t=[l.default.class("SkeletonCol",{auto:e.auto,grow:e.grow,flexColumn:e.flexColumn}),e.class].filter((function(e){return e})).join(" ");return{inner:[e.inner],class:t,tag:"div"}}function Bd(e){void 0===e&&(e={});var t=[l.default.class("SkeletonOffset",{small:e.small}),e.class].filter((function(e){return e}));return{inner:[e.inner],class:t.join(" "),tag:"div"}}function Rd(e){void 0===e&&(e={});var t,n,i=Sd({opacity:e.opacity});return{inner:[xd({inner:[Ld({inner:[Pd({size:(t={s:32,modern:40,l:48},n=null,Object(r.getCw)()<=270&&null!=t.xs&&(n=t.xs),Object(r.getCw)()<=319&&null!=t.s&&(n=t.s),Object(r.getCw)()>=320&&null!=t.modern&&(n=t.modern),Object(r.getCw)()>=400&&null!=t.l&&(n=t.l),Object(r.getCw)()>=480&&null!=t.xl&&(n=t.xl),Object(r.getCw)()<=881&&null!=t.mobile&&(n=t.mobile),Object(r.getCw)()>=882&&null!=t.xxl&&(n=t.xxl),Object(r.getCw)()>=882&&null!=t.desktop&&(n=t.desktop),n),style:i})],auto:!0}),Ld({inner:[xd({inner:[Ld({inner:[Dd({style:i})],grow:3}),Ld({grow:4})]}),xd({inner:[Ld({inner:[Dd({small:!0,style:i})]}),Ld({grow:3})]})],flexColumn:!0})]}),Bd(),xd({inner:[Ld({inner:[Dd({style:i})],grow:4}),Ld({inner:[Dd({style:i})],grow:3})]}),Bd(),xd({inner:[Ld({inner:[Dd({style:i})],grow:4}),Ld({grow:1})]}),Bd(),xd({inner:[Ld({inner:[Dd({style:i})],grow:4}),Ld({grow:3})]}),Bd(),Bd(),xd({inner:[Ld({inner:[Pd({size:24,style:i})],auto:!0}),Bd(),Ld({inner:[Pd({size:24,style:i})],auto:!0}),Bd(),Ld({inner:[Pd({size:24,style:i})],auto:!0}),Ld({grow:1}),Ld({inner:[Pd({size:24,style:i})],auto:!0})]})],class:"SkeletonWallBlock Post__rowPadding",tag:"div"}}function Nd(e){void 0===e&&(e={});var t=kd("skeleton-search"),n=Sd({})+(e.style||""),i=["SkeletonComponent__item",l.default.class("SkeletonSearch",{small:e.small,header:e.header}),e.class].filter((function(e){return e})).join(" ");return jd(t),{id:t,class:i,style:n,tag:"div"}}function Fd(e){return{inner:[xd({inner:[Ld({inner:[xd({inner:[Ld({inner:[Nd({header:!0})]}),Bd({small:!0}),Ld({inner:[Pd({class:"SkeletonSearchHeader__icon",header:!0,size:28})],auto:!0})]})],flexColumn:!0})]})],class:"SkeletonSearchHeader",tag:"div"}}var Hd=n("g3t9");function Ud(e){for(var t=Math.ceil((window.innerHeight-56)/210),n=[],i=0;i<t;i++)n.push(Rd());return{inner:[Fd(),Object(Hd.Separator)(),n],class:"SkeletonComponent__page SkeletonRecommended Skeleton",tag:"div"}}function Vd(e){void 0===e&&(e={});var t=Sd({opacity:e.opacity});return{inner:[xd({inner:[Ld({inner:[Pd({size:50,style:t})],auto:!0}),Ld({inner:[xd({inner:[Ld({inner:[Dd({style:t})],grow:3}),Ld({grow:4}),Ld({inner:[Dd({style:t})]})],justify:"center"}),xd({inner:[Ld({inner:[Dd({style:t})]}),Ld({inner:[Dd({style:t})],grow:5}),Ld({grow:3,style:t})]})],flexColumn:!0})]})],class:"SkeletonChatBlock Post__rowPadding",tag:"div"}}function $d(e){void 0===e&&(e={});var t={};e.hideIcon&&(t.visibility="hidden");var n=Sd(t);return{inner:[xd({inner:[Ld({inner:[xd({inner:[Ld({inner:[Dd({header:!0})],grow:5}),Ld({grow:5}),Ld({inner:[Pd({class:"SkeletonHeader__icon",header:!0,size:28,style:n})],auto:!0})]})],flexColumn:!0})]})],class:"SkeletonHeader Post__rowPadding",tag:"div"}}function qd(e){return{inner:[Nd()],class:"SkeletonSearchBlock Post__rowPadding",tag:"div"}}function zd(e){for(var t=Math.ceil((window.innerHeight-56)/70),n=[],i=0;i<t;i++)n.push(Vd());return{inner:[$d(),qd(),n],class:"SkeletonComponent__page SkeletonMessages Skeleton",tag:"div"}}function Yd(e){void 0===e&&(e={});var t=Sd({opacity:e.opacity});return{inner:[Pd({class:"SkeletonStory__avatar",size:56,style:t}),xd({inner:[Bd({small:!0}),Ld({inner:[Dd({small:!0,style:t})]}),Bd({small:!0})]})],class:"SkeletonStory",tag:"div"}}function Gd(e){void 0===e&&(e={});for(var t=Math.ceil(window.innerWidth/76),n=[],i=0;i<t;i++)n.push(Ld({inner:[Yd()],auto:!0}));return{inner:[xd({inner:[n]})],class:"SkeletonStoriesBlock Post__rowPadding",tag:"div"}}function Kd(e){return{inner:[xd({inner:[Ld({inner:[Pd({size:40})],auto:!0}),Ld({inner:[Nd()]})],justify:"center"})],class:"SkeletonNewPostBlock Post__rowPadding",tag:"div"}}function Qd(e){for(var t=Math.ceil((window.innerHeight-56-180)/210),n=[],i=0;i<t;i++)n.push(Rd());return{inner:[$d({hideIcon:!0}),Kd(),Gd(),n],class:"SkeletonComponent__page SkeletonFeed Skeleton",tag:"div"}}function Xd(e){void 0===e&&(e={});var t=kd("skeleton-line"),n=Sd({width:e.size+"px",height:e.size+"px"})+(e.style||""),i=["SkeletonComponent__item",l.default.class("SkeletonSquare"),e.class].filter((function(e){return e})).join(" ");return jd(t),{id:t,class:i,style:n,tag:"div"}}function Jd(e){return{inner:[xd({inner:[Ld({inner:[Pd({size:48}),Pd({size:20,class:"SkeletonNotificationBlock__badge"})],auto:!0,class:"SkeletonNotificationBlock__avatar"}),Ld({inner:[Bd({small:!0}),xd({inner:[Ld({inner:[Dd()]})]}),xd({inner:[Ld({inner:[Dd()],grow:2}),Ld()]}),xd({inner:[Ld({inner:[Dd({small:!0})]}),Ld({grow:5})]})],grow:6}),Ld(),Ld({inner:[Xd({size:48})],auto:!0})],align:"flex-start"}),Bd(),Bd(),xd({inner:[Ld({inner:[Pd({size:48})],auto:!0}),Ld({inner:[Bd({small:!0}),xd({inner:[Ld({inner:[Dd()]})]}),xd({inner:[Ld({inner:[Dd({small:!0})]}),Ld({grow:5})]}),Bd()],grow:4}),Ld({inner:[Bd()]})],align:"flex-start"})],class:"SkeletonNotificationBlock Post__rowPadding",tag:"div"}}function Zd(e){for(var t=Math.ceil((window.innerHeight-56)/170),n=[],i=0;i<t;i++)n.push(Jd());return{inner:[$d({hideIcon:!0}),Object(Hd.Separator)(),{inner:[xd({inner:[Ld({inner:[Dd()],grow:3}),Ld({grow:2}),Ld({inner:[Dd()],grow:2})]})],class:"SkeletonNotifications__info Post__rowPadding",tag:"div"},n],class:"SkeletonComponent__page SkeletonNotifications Skeleton",tag:"div"}}var e_=n("UY6c"),t_=function(){var e,t=Math.max(window.innerHeight,window.innerWidth),n=["feed","recommend","messages","notification","menu"],i="",a={},o=((e={}).feed=0,e.recommend=0,e.messages=0,e.notification=0,e.menu=0,e);function s(e){var t=geBySel1('[data-tabbar="'+e+'"]');return attr(t,"data-default")}function c(e){each(geBySel("[data-tabbar]"),(function(t,n){var i=geByClass1("_BottomMenu__icon_js",n),a=geByClass1("BottomMenu__counter",i),r=attr(n,"data-counter"),o=attr(n,"data-tabbar");e({i:t,tabId:o,counter:r,$link:n,$icon:i,$counter:a})}))}function l(){c((function(e){var t=e.$counter,n=e.$icon,i=(e.$link,e.tabId),a=o[i],r=n.outerHTML.includes("Tooltip");if(a&&0!==a||r)if(t&&!r)val(t,a);else{var s,c=ceFromString(n.outerHTML),l=ce("div",{className:"BottomMenu__counter",innerHTML:a});if(r)val(n,null==(s=$(".Tooltip",c))?void 0:s.outerHTML);a&&append(l,n)}else val(n,"")}))}function u(e){setTimeout((function(){d()}),0);var t=Wd.html({class:"pcont bl_cont",inner:{id:"al_loading",class:"BottomMenu__preloader"}});val(geByClass1("mcont",e),t)}function d(){var e=$(".BottomMenu__updateButton");remove(e)}return{setCurrentId:function(e){i=e},setHistory:function(e){a=extend({},e)},setCounter:function(e,t){o[e]=t?parseInt(t,10):0,l()},getCurrentId:function(){return i},getDefaultURL:s,getTabCounter:function(e){return o[e]?o[e]:0},drawUI:function(){c((function(e){var t=e.$icon,n=e.$link,r=e.tabId,o=a[r];if(o){var c=o.filter((function(e){return!0===e.current}))||[];c.length&&"messages"!==r&&attr(n,"href",c[0].a);var l=attr(n,"href");r!==i||!c.length||c[0].a!==l&&c[0].d!==l||attr(n,"href",s(r))}toggleClass("BottomMenu__icon_active",t,r===i)})),l()},drawUICounters:l,drawLoader:u,drawSkeletonLoader:function(e,t){if(hasClass(document.querySelector(".vk"),"vk_flex_yes"))switch(setTimeout((function(){d()}),0),t){case"feed":$(".mcont",e).innerHTML=Wd.html(Qd());break;case"messages":$(".mcont",e).innerHTML=Wd.html(zd());break;case"notification":$(".mcont",e).innerHTML=Wd.html(Zd());break;case"recommend":$(".mcont",e).innerHTML=Wd.html(Ud());break;case"menu":default:u(e)}else u(e)},showUpdateButton:function(e){var t=window.lang,n=Wd.html({class:"BottomMenu__updateButton",inner:{class:"BottomMenu__updateButton_container",inner:{class:"BottomMenu__updateButton_wrap",onclick:["nav.updateCurrentPage"],inner:[{class:"BottomMenu__updateButton_icon",inner:Object(R.default)(Object(e_.getUpUpdate16Icon)())},{class:"BottomMenu__updateButton_text",inner:t.mobile_menu_refresh_button}]}}}),i=hasClass("vk_custom_scroll",geByTag1("body")),a=e.$(i?".basis":".upanel");a.$(".BottomMenu__updateButton")||a.insertBefore(ceFromString(n),a.firstChild)},removeUpdateButton:d,onFocusIn:function(e){var t=geBySel1(".BottomMenu"),n=e&&e.target;if(n&&t&&browser.android){var i=!1;"textarea"===n.tagName.toLowerCase()&&(i=!0),"input"!==n.tagName.toLowerCase()||["checkbox","radio"].includes(n.type)||(i=!0),"select"===n.tagName.toLowerCase()&&(i=!0),i&&t.classList.add("vk_tabbar_hidden")}},onFocusOut:function(){var e=geBySel1(".BottomMenu");e&&e.classList.remove("vk_tabbar_hidden")},onResize:function(){var e=window.bodyNode;$(".Skeleton")&&($(".mcont").innerHTML='<div class="pcont bl_cont"><div id="al_loading"></div></div>',Object(r.alLoadingFix)()),e&&e.classList.contains("vk_tabbar_bottom")&&0===Math.abs(window.orientation)&&t-180>window.innerHeight?e.classList.add("vk_tabbar_hidden"):e&&e.classList.remove("vk_tabbar_hidden")},setDefaultCounters:function(){c((function(e){var t=e.tabId,n=e.counter;o[t]=n?parseInt(n,10):0})),l()},TAB_ID_FEED:"feed",TAB_ID_RECOMMEND:"recommend",TAB_ID_MESSAGES:"messages",TAB_ID_NOTIFICATION:"notification",TAB_ID_MENU:"menu",TAB_IDS:n}}();window.Tabbar=t_;var n_=t_;window.page&&page.onRestore(t_.drawUI),window.page&&page.onChange(t_.drawUI),onDOMReady((function(){var e;t_.setDefaultCounters(),addEvent(window,"resize",(function(){t_.onResize(),clearTimeout(e),e=setTimeout((function(){t_.onResize()}),300)}))}));var i_=!1;page.onChange(s_),photoview.onHide(s_),photoview.onShow(c_),o.colorScheme.onInit((function(){i_||o_()})),o.colorScheme.subscribe((function(){i_||o_()}));var a_,r_=Object(F.$)('meta[name="theme-color"]');function o_(){o.colorScheme.isDarkScheme()?l_("#050505"):l_("#ffffff")}function s_(){i_=!1,o_()}function c_(){i_=!0,l_("#050505")}function l_(e){a_||(a_=Object(F.$)("#theme_color_shim")),r_&&r_.setAttribute("content",e),a_&&(a_.style.backgroundColor=e)}n("U34x");var u_,d_,__,f_,p_,h_=[".basis__header_unauthorized"],m_=!1;function v_(){m_||(u_={vk:geByClass1("vk"),basis:geByClass1("basis"),header:geByClass1("basis__header"),headerTitle:geByClass1("mh_header",geByClass1("basis__header")),headerFirstIcon:geByClass1("GroupCoverIcons__icon--back_outline_28",geByClass1("basis__header")),headerSecondIcon:geByClass1("GroupCoverIcons__icon--back_outline_white_28",geByClass1("basis__header")),cover:geByClass1("groupCover"),coverImage:geByClass1("groupCover__image"),coverDimmer:geByClass1("groupCover__dimmer")}).cover&&(m_=!0,addClass(u_.vk,"groupCover-vk_animationYes"),d_=!x.default.chrome||Number(x.default.version.split(".")[0])>50,__="fixed"===getStyle(u_.header,"position"),f_=getH(u_.header),p_=getH(u_.cover),onBodyScroll(A_),onBodyResize(b_),A_(),window.cur.destroy=window.cur.destroy.filter((function(e){return e!==g_})),window.cur.destroy.push(g_))}function g_(){(!0||menu.opened())&&(removeClass(u_.vk,"groupCover-vk_animationStep"),removeClass(u_.vk,"groupCover-vk_animationYes")),onBodyScroll("__clear",A_),onBodyResize("__clear",b_),m_=!1}function A_(){var e=scrollTop();if(__)if(e<0)setStyle(u_.header,"top",-e),y_(),setStyle(u_.coverDimmer,"opacity",0),setStyle(u_.coverImage,"top",0);else{var t=document.body,n=Math.min(1,e/(p_-f_)),i=t&&t.classList.contains("vk_tabbar_top")&&!u_.header.classList.contains("basis__header_noBottomMenu")?48:0;setStyle(u_.header,"top",i),setStyle(u_.headerTitle,"display","block"),setStyle(u_.headerFirstIcon,"display","block"),setStyle(u_.headerSecondIcon,"display","block"),n<=.9?(y_(),d_&&setStyle(u_.coverImage,"top",.5*e),setStyle(u_.coverDimmer,"opacity",n/.9),setStyle(u_.headerTitle,"opacity",0),setStyle(u_.headerFirstIcon,"opacity",0),setStyle(u_.headerSecondIcon,"opacity",1)):(setStyle(u_.headerTitle,"opacity",1),setStyle(u_.headerFirstIcon,"opacity",1),setStyle(u_.headerSecondIcon,"opacity",0),w_())}else Math.min(1,e/p_)<1?(y_(),setStyle(u_.coverDimmer,"opacity",0),d_&&setStyle(u_.coverImage,"top",.5*e),setStyle(u_.headerTitle,"display","none"),setStyle(u_.headerFirstIcon,"display","none"),setStyle(u_.headerSecondIcon,"display","block")):w_()}function b_(){g_(),v_()}function w_(){h_.map((function(e){return $(e)})).some((function(e){return e}))||removeClass(u_.vk,"groupCover-vk_animationStep")}function y_(){h_.map((function(e){return $(e)})).some((function(e){return e}))||addClass(u_.vk,"groupCover-vk_animationStep")}onDOMReady((function(){(x.default.chrome||x.default.safari&&x.default.ios>=9)&&(v_(),page.onChange(v_),zlayer.onClose((function(){setTimeout(v_,0)})))}));n("l51W"),n("BLcx"),n("nXjO");var O_,S_,k_=function(){return Object(r.geByClass1)("tabs_block")},C_=function(){return Object(r.geByClass1)("tab_item_top")},j_=!0,E_=0;function T_(){S_&&S_(),O_&&O_()}function I_(e){Object(r.stopEvent)(e),Object(r.preventEvent)(e),E_=300,j_&&(Object(r.toggleClass)("TopMenu__switcher_on",Object(r.geByClass1)("TopMenu__switcher")),"touchstart"===e.type&&setTimeout((function(){nav.go(C_(),null)}),130))}function M_(e){Object(r.gpeByClass)("tabs_block",e.target)||Object(r.gpeByClass)("mhb_back",e.target)||(Object(r.stopEvent)(e),Object(r.preventEvent)(e),Object(r.removeClass)("TopMenu_open",k_()),P_(),T_())}function P_(){T_(),Object(r.removeEvent)(window,"touchstart mousedown click",M_)}window.TopMenu={onHeaderClick:function(e){if(!j_)return;var t=k_();Object(r.stopEvent)(e),Object(r.preventEvent)(e);var n=Object(r.geByClass1)("mhb_back");if(Object(r.hasClass)("TopMenu_open",t))Object(r.removeClass)("TopMenu_open",t),T_();else{var i=C_();Object(r.addClass)("TopMenu_open",t),Object(r.geByClass1)("_hfixed")&&Object(r.setStyle)(t,"max-height",window.innerHeight-70),Object(r.append)(t,n),Object(r.addEvent)(window,"touchstart mousedown click",M_),Object(r.addEvent)(i,"touchstart mousedown",I_),Object(r.addEvent)(i,"click",(function(e){Object(r.stopEvent)(e),Object(r.preventEvent)(e)})),S_=Object(s.expandPopup)(Object(r.geByClass1)("al_back")),(O_=Object(s.setMenuNavigation)(t))&&(O_.exitIntent=function(){Object(r.removeClass)("TopMenu_open",t),T_()}),cur.destroy.push(P_),cur.destroy.push((function(){return Object(r.removeEvent)(i,"touchstart mousedown",I_)}))}}},nav.onBeforeGo((function(){j_=!1,setTimeout((function(){E_=0,j_=!0,T_()}),E_)}));var D_=function(){var e,t,n,i=!1;function a(e){for(var t=!1;e;){var n=getStyle(e,"overflow-y");if(("scroll"===n||"auto"===n)&&e.offsetHeight<e.scrollHeight){e===document.documentElement||e===document.body?e=null:t=!0;break}e=e.parentElement}return{cursor:e,isOverflowYContainer:t}}function r(e){for(var t=!1;e;){var n=getStyle(e,"overflow-x"),i=hasClass(e,"Slider__scroll");if("scroll"===n||"auto"===n||i){t=!0;break}e=e.parentElement}return{cursor:e,isOverflowXContainer:t}}function o(){if(e&&t){var n=geByClass1("i_pointer",e);if(document.body.contains(n))a(n).isOverflowYContainer?setStyle(t,"top",n.getBoundingClientRect().top):setStyle(t,"top",getY(n)),r(n).isOverflowXContainer?setStyle(t,"left",function(e){return e.getBoundingClientRect().left}(n)-getW(t)):setStyle(t,"left",getX(n)-getW(t))}}function c(e){e&&"A"===e.target.tagName&&requestAnimationFrame((function(){o()}))}function l(l){!function(n){e=gpeByClass("ai_menu_wrap",n),t=geByClass1("ai_menu",e)}(l),addClass("ai_menu_opened",e),append(t,document.body),(n=Object(s.setFocusTrap)(t))&&(n.exitIntent=function(){u()}),i=u,tooltip.addHandler(i),tooltip.show(e,t),addEvent(window,"resize",o),addEvent(t,"click",c);var d=geByClass1("i_pointer",e),_=a(d);_.isOverflowYContainer&&addEvent(_.cursor,"scroll",o);var f=r(d);f.isOverflowXContainer&&addEvent(f.cursor,"scroll",o),o()}function u(){removeClass("ai_menu_opened",e),append(t,e),tooltip.removeHandler(i),tooltip.hide(),n&&(n(),n=null),removeEvent(window,"resize",o),removeEvent(t,"click",o);var s=geByClass1("i_pointer",e),c=a(s);c.isOverflowYContainer&&removeEvent(c.cursor,"scroll",o);var l=r(s);l.isOverflowXContainer&&removeEvent(l.cursor,"scroll",o)}return{closeMenu:u,toggleMenu:function(t,n){cancelEvent(t),hasClass("ai_menu_opened",e)?u():l(n)},update:function(){!function(){if(t){var e=geByClass("wia_item",t);e&&each(e,(function(e,t){var n=clone(t);before(n,t),remove(t),addClass("unhover",n),setTimeout((function(){removeClass("unhover",n)}),100)}))}}(),o()}}}();window.ActionMenu=D_;n("zHNa"),n("wCFN");var x_=function(){var e=38,t=40,n=13,i=27,a={},r={},o=!1;function s(){a={ignoredTerm:null,curValue:"",curTerm:"",curPos:"",input:{}},r={container:null,scroll:null,index:{},cache:{},shown:[],lastQ:null,text:null,requestTimer:null,opts:{}}}s();var c=!0;function l(){c=!1}function d(){var e=val(a.input),t=Math.max(e.lastIndexOf("@"),e.lastIndexOf("*")),n=!1;if(t>-1){var i=function(e){if(void 0!==e.selectionStart)return e.selectionStart!==e.selectionEnd?e.selectionEnd:e.selectionStart;if(void 0!==window.getSelection){var t=window.getSelection();if(!t||!t.rangeCount)return 0;var n=t.getRangeAt(0),i=n.cloneRange(),a=ce("div");return i.selectNodeContents(e),i.setEnd(n.startContainer,n.startOffset),a.appendChild(i.cloneContents()),val(a).replace(/\n$/,"").length}return 0}(a.input),o=e.substr(0,i);t=Math.max(o.lastIndexOf("@"),o.lastIndexOf("*"));var s=o.match(/(^|[\s.,:\'\"\u00BB\u00AB;>\)\(]|\#[\w_\.\u0400-\u04FF]+)[@\*]([^,@\*\(\)\?\!\s\n\r \u00A0]*)$/);s&&"."!==s[2].substr(-1)&&(n=s[2])}!1===n&&delete a.ignoredTerm,void 0!==a.ignoredTerm&&n==a.ignoredTerm&&(n=!1),a.curValue=e,a.curTerm=n,a.curPos=t,r.text=n,!1===a.curTerm?p():(w(!1,a.curTerm),f(),function(){var e=ge("mhead").offsetHeight,t=r.container.getBoundingClientRect(),n=a.input.offsetHeight,i=parseInt(getStyle(r.scroll,"maxHeight"),10),o=!1;o=hasClass("Mention_openToBottom",r.container)?t.top-n-i<e:t.bottom-i<e,getXY(a.input)[1]>=e+i&&(o=!1),toggleClass("Mention_openToBottom",r.container,o),toggleClass("Mention_openToBottom",r.opts.appendTo,o)}())}function _(e){a.input=e}function f(){j(),document.addEventListener("click",h,!0),addClass("MentionContainer_opened",r.opts.appendTo),show(r.container),function(){if(!o){var e=browser.ipad?"touchend":"click";o=!0,addEvent(window,e,p),addEvent(window,"touchmove",l),nav.onBeforeGo(p)}}()}function p(e){!browser.ipad||c?e&&e.target&&gpeByClass("Mention_inited",e.target)&&!gpeByClass("uMailWrite__button",e.target)&&!hasClass("uMailWrite__button",e.target)||hasClass("MentionContainer_opened",r.opts.appendTo)&&(removeClass("MentionContainer_opened",r.opts.appendTo),hide(r.container),function(){if(o){var e=browser.ipad?"touchend":"click";removeEvent(window,e,p),removeEvent(window,"touchmove",l),nav.onBeforeGo.off(p),o=!1}}()):c=!0}function h(e){var t=e.target;t&&!gpeByClass("Mention_inited",t)&&(e.preventDefault(),e.stopImmediatePropagation(),p()),document.removeEventListener("click",h,!0)}function m(e){void 0===e&&(e={}),r.opts=extend(r.opts,e),v(),w(!0)}function v(){var e,t,n=r.opts.defaultItems,i=r.opts.items,a=[];for(e=0,t=n.length;e<t;++e)a.push(e);for(r.cache[""]=a,e=0,t=i.length;e<t;++e)g(e,i[e])}function g(e,t){var n,i,a,o="",s=r.opts.searchKeys,c={};for(n=0,a=s.length;n<a;++n)o+=" "+(t[s[n]]||"").replace(r.opts.delimeter," ").replace(/<[^>]*>/g,"");for(o+=(parseLat(o)||"")+(parseCyr(o)||""),o=trim(o.toLowerCase()).split(/\s+/),n=0;n<o.length;n++)for(i=1;i<=r.opts.wholeIndex;i++){var l=o[n].substr(0,i);c[l]||(r.index[l]||(r.index[l]=[]),r.index[l].push(e),c[l]=1)}}function A(){var e=trim(r.text);e&&ajax.post(r.opts.url,extend({str:e,mobile:1},r.opts.params||{}),{onDone:function(t){r.cache[e]=b(e).concat(t),y(r.cache[e],!0)}})}function b(e){if(!(e=trim(e.toLowerCase().replace(r.opts.delimeter," "))))return r.cache[""];var t=r.opts.wholeIndex;if(e.length<=t&&-1===e.indexOf(" "))return r.index[e]||[];var n,i,a=0,o="";for(n=0,i=(e=e.split(" ")).length;n<i;++n){var s=e[n].substr(0,t),c=r.index[s];if((!o||!c||c.length<a)&&(a=c?c.length:0,o=s),!a)return[]}var l=[],u=r.opts.searchKeys,d=u.length,_=e.length;for(n=0,i=r.index[o].length;n<i;++n){for(var f=r.index[o][n],p=r.opts.items[f],h=!1,m="",v=0;v<d;++v)m+=" "+(p[u[v]]||"").replace(r.opts.delimeter," ").replace(/<[^>]*>/g,"");m=(m+=(parseLat(m)||"")+(parseCyr(m)||"")).toLowerCase();for(var g=0;g<_;++g)if(-1===m.indexOf(" "+e[g])){h=!0;break}h||l.push(f)}return l}function w(e,t){if(r.cache[""])if(t=void 0!==t?t:trim(r.text),r.lastQ!==t||e){r.lastQ=t,clearTimeout(r.requestTimer);var n=r.cache[t];n?y(n,!0):(y(n=b(t),!r.opts.url),r.opts.url&&(r.requestTimer=setTimeout(A,r.opts.requestWait)))}else f()}function y(e,t){var n=[];r.shown=[];for(var i=e.slice(0,r.opts.maxItems),a=0,o=i.length;a<o;++a){var s=i[a];isArray(s)||(s=r.opts.items[s]),r.shown[s[0]]||(r.shown[s[0]]=s,n.push(O(s)))}r.container&&r.opts.appendTo.contains(r.container)||(r.container=ce("div"),addClass("Mention",r.container),r.scroll=ce("div"),addClass("ScrollView Mention__scroll",r.scroll),Object(vt.setScrollView)(r.scroll,{topBanner:!1}),r.opts.appendTo.appendChild(r.container),r.container.appendChild(r.scroll),addEvent(r.scroll,"touchmove",(function(e){hasClass("Mention_noScroll",r.scroll)&&preventEvent(e)}))),toggleClass("Mention_empty",r.container,!n.length),val(r.scroll,n.join("")),r.scroll.scrollTop=0,k(),setTimeout((function(){toggleClass("Mention_noScroll",r.scroll,!function(){if(!browser.ios&&!browser.ipad)return!0;if(r.scroll.scrollHeight>r.scroll.offsetHeight)return!0;return!1}())}),0)}function O(e){var t=e[0],n=e[1],i=e[2],a=e[3],r=e[10];return'<div class="MentionItem" onclick="Mention.onSelect(\''+t+'\');" onmouseover="Mention.onItemHover(this);">\n              <div class="MentionItem__cell">\n                '+(r||'<img src="'+a+'" class="MentionItem__img"/>')+'\n              </div>\n              <div class="MentionItem__cell MentionItem__cell_name">\n                <div class="MentionItem__name">'+n+'</div>\n                <div class="MentionItem__tag">'+i+"</div>\n              </div>\n            </div>"}function S(){var e=geByClass1("MentionItem_active",r.container),t=e.offsetTop;r.scroll.scrollTop=t-e.offsetHeight-parseInt(getStyle(r.scroll,"paddingTop"),10)}function k(e){void 0===e&&(e=null);var t=geByClass("MentionItem",r.container);if(t.length){var n=t.find((function(e){return hasClass("MentionItem_active",e)}));e?(removeClass("MentionItem_active",n),addClass("MentionItem_active",e)):n||addClass("MentionItem_active",t[0])}}function C(e,t){setTimeout((function(){_(t),d()}),0)}var j=Object(u.default)();return{onKeyUp:function(n,i){n.keyCode!==e&&n.keyCode!==t&&(w(!0),_(i),d())},onKeyDown:function(a,o){var s;hasClass("MentionContainer_opened",r.opts.appendTo)&&(a.keyCode===e?(!function(){var e=geByClass1("MentionItem_active",r.container);if(e){var t=domPS(e);t&&(k(t),S())}else k(),S()}(),a.preventDefault()):a.keyCode===t?(!function(){var e=geByClass1("MentionItem_active",r.container);if(e){var t=domNS(e);t&&(k(t),S())}else k(),S()}(),a.preventDefault()):a.keyCode===n?(s=geByClass1("MentionItem_active",r.container))&&(s.click(),1)&&a.preventDefault():a.keyCode===i&&(p(),a.preventDefault()))},onFocus:C,onClick:C,onSelect:function(e){var t=r.shown[e];t&&function(e){if(!e)return!1;var t,n=e[2].replace("@",""),i=a.curValue.substr(0,a.curPos),o=a.curValue.substr(a.curPos),s=!!i.match(/\#[\w_\.\u0400-\u04FF]+$/i);r.opts.preferDomain&&e[9]&&(s=!0);s||(t=replaceEntities(e[8]||e[1]));var c=new RegExp("^(@|\\*)"+escapeRE(a.curTerm)+"(?:\\s+\\((?:(.*?)\\))?\\s*)?","");o=o.replace(c,(function(e,i,a){var r=i+n+" ";return s||(r+="("+t.replace(/[\(\)\]\[]/g,"")+") "),r})),s||!i||i.match(/[\.\(\)\?\!\s\n\r\'\"\u00BB\u00AB \u00A0]$/)||(o=" "+o);p(),val(a.input,i+o),elfocus(a.input),r.opts.afterInsert&&r.opts.afterInsert(a.input)}(t),p()},onItemHover:function(e){k(e)},onOpen:j,init:function(e){void 0===e&&(e={}),s(),r.opts=extend({appendTo:document.body,url:"hints",params:{act:"a_json_friends",from:"composer"},delimeter:/[\s\(\)\.,\-]+/g,requestWait:300,wholeIndex:2,maxItems:51,searchKeys:[1,4],preferDomain:!1,defaultItems:[],items:[],afterInsert:function(){}},e),addClass("Mention_inited",r.opts.appendTo),r.scroll&&removeClass("Mention_noScroll",r.scroll),v()},update:m,addItems:function(e){if(r.opts.defaultItems){e=r.opts.defaultItems.concat(e);var t={};e.filter((function(e){return!t[e[0]]&&(t[e[0]]=!0,!0)})),m({defaultItems:e,items:e})}}}}();window.Mention=x_;n("OGWK"),n("ciqL");var L_={cachedProgress:{}},B_={init:function(e,t){return void 0===e&&(e=Object(r.srand)()),void 0===t&&(t=20),this.radius=t,{component:this._getLoader(e,L_.cachedProgress[e]),id:e}},update:function(e,t){var n=$('[data-loader-id="'+e+'"] circle');if(n){var i=this.radius,a=Math.PI*(2*i);L_.cachedProgress[e]=t;var r=(100-Math.max(5,t))/100*a;n.setAttribute("stroke-dashoffset",r)}},ready:function(e){var t=$('[data-loader-id="'+e+'"]');re(t)},_getLoader:function(e,t){void 0===t&&(t=0);var n=this.radius,i=Math.PI*(2*n);return{class:"Loader",inner:[{class:"Loader__progress","data-loader-id":e,inner:{tag:"svg",viewPort:"0 0 100 100",inner:{tag:"circle",r:n,cx:"30",cy:"30","stroke-dashoffset":(100-Math.max(5,t))/100*i,"stroke-dasharray":i}}}]}}},R_=(n("tqja"),n("aiw/")),N_=function(){function e(){window.isCustomScroll&&(document.body.classList.contains("vk__page_mail")||vt.restoreDocumentScroll())}return{init:function(){if(window.isCustomScroll&&!document.body.classList.contains("vk__page_mail")){var t=ge("mcont");t&&t.classList.contains("ScrollView")?vt.init():e(),R_.onClose()}},restore:e}}();onDOMReady((function(){N_.init(),page.onChange((function(){N_.init()}))})),window.ContentScrollView=N_;var F_,H_,U_,V_,W_,$_=!1,q_=Object(r.scrollTop)(),z_=56,Y_=!1,G_=!1,K_=[];function Q_(e){void 0===e&&(e=ef());var t=document.body;t&&"fixed"===Object(r.getStyle)(t,"position")||e.classList.remove("basis__header_hidden")}function X_(){var e=Object(r.scrollTop)();if(F_){Z_(F_,e);var t,n=Object(r.ge)("mcont");if(n){var i=$(".BottomMenu__updateButton"),a=Math.max(n.scrollHeight,parseInt(Object(r.getStyle)(n,"height"),10));if(G_&&e)return;if(Math.abs(q_-e)<=z_)return;F_.classList.contains("basis__header_nohide")||(e>q_+20&&e>z_?(void 0===(t=F_)&&(t=ef()),t.classList.add("basis__header_hidden"),i&&i.classList.add("BottomMenu__updateButton_offset"),G_=!0,setTimeout((function(){G_=!1}),200)):e+window.innerHeight<a&&(Q_(F_),i&&i.classList.remove("BottomMenu__updateButton_offset")))}var o=document.body;o&&"fixed"!==Object(r.getStyle)(o,"position")&&(q_=e)}}function J_(){if($_&&(clearInterval(W_),Object(r.onBodyScroll)("__clear",H_),removeEvent(window,"touchend",U_),K_.forEach((function(e){removeEvent(e,"blur",U_)})),$_=!1),!$_){F_=ef(),z_=parseInt(Object(r.getStyle)(F_,"height"),10),q_=Object(r.scrollTop)();var e=$(".BottomMenu__updateButton");F_&&(F_.classList.add("basis__header_noTransition"),Q_(F_),e&&e.classList.remove("BottomMenu__updateButton_offset")),Z_(F_,Object(r.scrollTop)()),H_=function(){Y_=!0},U_=function(){clearInterval(V_),V_=setTimeout((function(){var t=Object(r.ge)("mcont");if(t){var n=Math.max(t.scrollHeight,parseInt(Object(r.getStyle)(t,"height"),10));window.innerHeight>n&&n&&(Q_(F_),e&&e.classList.remove("BottomMenu__updateButton_offset"))}}),100)},setTimeout((function(){Y_=!1}),0),setTimeout((function(){F_&&F_.classList.remove("basis__header_noTransition")}),200),$_||(W_=setInterval((function(){Y_&&(X_(),Y_=!1)}),250),Object(r.onBodyScroll)(H_),addEvent(window,"touchend",U_,{passive:!0}),(K_=Array.from($$("input, textarea")||[])).forEach((function(e){addEvent(e,"blur",U_)})),$_=!0)}}function Z_(e,t){e&&e.classList.contains("basis__header_nohide")||(t<=5&&e&&e.classList.contains("basis__header_noshadow")?e.classList.add("basis__header_noshadowAnim"):e&&e.classList.remove("basis__header_noshadowAnim"))}function ef(){return $(".basis__header")}function tf(){(F_=ef())&&(Q_(F_),Z_(F_,Object(r.scrollTop)()))}onDOMReady((function(){J_(),window.page.onChange(J_),onBodyResize(tf),addEvent(window,"orientationchange",tf),addEvent(window,"blur",tf)}));var nf={URL:"special-event",ACT:"getPopup",start:function(e,t){var n=this;if(t.stopPropagation(),t.preventDefault(),this.id=window.domData(e,"id"),this.id&&(this.sendStats("click"),!this.timeoutHandle)){var i=Number(window.domData(e,"v"))||0;this.duration||(this.duration=Number(window.domData(e,"duration"))||0),this.animationUrl||(this.animationUrl=String(atob(window.domData(e,"animation-url")))||0),this.duration&&this.animationUrl&&(this.hasPopup=Boolean(window.domData(e,"popup")),!this.animationData||!this.animationData.v||"number"==typeof this.v&&this.v!==i?(this.v=i,Promise.all([this._getAnimation(),this._loadAnimator()]).then((function(e){var t=e[0],i=e[1];n.animationData=JSON.parse(t),n.animator=i,n._play()}))):this._play())}},_getAnimation:function(){var e=this;return new Promise((function(t){var n=new XMLHttpRequest;n.open("GET",e.animationUrl,!0),n.send(),n.onreadystatechange=function(){4===n.readyState&&t(n.responseText)}}))},_showPopup:function(){window.ImageStatus&&window.ImageStatus.open&&window.ImageStatus.open({user_id:vk.id,special_id:this.id})},_play:function(){var e=this;if(this.animator){this.frame||(this.frame=document.createElement("div"),this.frame.className="special_event_frame",document.body.appendChild(this.frame)),this.frame.style.display="block";var t=this.animator.loadAnimation({container:this.frame,renderer:"svg",loop:!1,autoplay:!0,animationData:this.animationData});0,this.timeoutHandle=setTimeout((function(){t.stop(),t.destroy(),e.frame.style.display="none",e.timeoutHandle=null,e.sendStats("showed"),e._showPopup()}),this.duration)}},init:function(e){var t=e.platform,n=e.animatorLoader;this.platform=t,this._loadAnimator=n},sendStats:function(e){e&&Object(C.saveStatlogEvents)({name:"special_event",value:e,keys:[this.platform,this.id]})}};nf.init({platform:"mvk",animatorLoader:function(){return n.e(0).then(n.bind(null,"P3dz")).then((function(e){return e.default}))}}),window.SpecialEvent=nf;var af={onIframeReady:Object(u.default)("{ is_api, check_transfer_url, on_success_url }"),onPostMessage:Object(u.default)(),onAcceptCookieClick:Object(u.default)()};function rf(e){var t;if(e.origin.match(/^https?:\/\/([a-zA-Z0-9\-\.]+\.)?money\.mail\.ru$/)){try{t=JSON.parse(e.data)}catch(e){t={}}"billing"===t.type&&af.onPostMessage(t.action,t.action_params)}}af.onIframeReady((function(){addEvent(window,"message",rf),window.cur.destroy.push((function(){removeEvent(window,"message",rf)}))})),window.BasisMoneyTransfer=af;var of=af;of.onPostMessage((function(e){"waiterStart"!==e&&"3dsPage"!==e||document.activeElement&&document.activeElement.blur()}));of.onPostMessage((function(e,t){"resizeFrame"===e&&setStyle(geByClass1("pageMoneyTransfer__iframe"),"height",t.height+40)}));var sf=["touchstart","touchend","touchmove","touchcancel"];of.onIframeReady((function(e){e.is_api&&registeredEvents.forEach((function(e){var t=e[0],n=e[1],i=e[2];sf.indexOf(n)>=0&&removeEvent(t,n,i)}))})),of.onPostMessage((function(e){"resizeFrame"!==e&&"pageLoad"!==e||window.scrollTop(0)}));var cf,lf,uf,df="pageMoneyTransfer_error";of.onIframeReady((function(e){ff(),lf={checkUrl:e.check_transfer_url,onSuccessUrl:e.on_success_url},hf(),window.cur.destroy.push(mf)})),of.onPostMessage((function(e,t){if("paySuccess"===e)addClass("pageMoneyTransfer_success",geByClass1("pageMoneyTransfer"));else if("payError"===e)mf(),addClass(df,geByClass1("pageMoneyTransfer")),val(geByClass1("pageMoneyTransfer__errorText"),t.descr);else if("session_fail"===e){if(_f)return void pf();mf(),addClass(df,geByClass1("pageMoneyTransfer")),addClass("pageMoneyTransfer_errorCookie",geByClass1("pageMoneyTransfer"))}else if("putPixel"===e&&"page_load"===t.alias){var n=null;Object(r.isVkWebView)()&&(Object(r.isIosWebView)()?n="iphone":isAndroidWebView()&&(n="android")),n||(n=""),Object(r.statlogsValueEvent)("money_transfers",0,"iframe_loaded",n)}}));var _f=0;function ff(){var e=geByClass1("pageMoneyTransfer__iframe");if(e){var t=e.contentWindow.document;t.open("text/html","replace"),t.write(attr(e,"data-html")),t.close()}else setTimeout(ff,2e3)}function pf(){var e=geByClass1("pageMoneyTransfer__iframe");if(e){var t=ce("div",{innerHTML:attr(e,"data-html")});hide(e),geByClass1("pageMoneyTransfer").appendChild(t),ge("payment_form").submit()}else setTimeout(pf,2e3)}function hf(){var e=lf,t=e.checkUrl,n=e.onSuccessUrl;cf=setInterval((function(){uf=ajax.post(t,{},{onDone:function(e,t,i){if(1===e||3===e){if(mf(),i)return void nav.go(i,null,{replace:!0});"/"===n[0]?nav.go(n,null,{replace:!0}):location.href=n}else 2===e&&(mf(),addClass(df,geByClass1("pageMoneyTransfer")),val(geByClass1("pageMoneyTransfer__errorText"),t))}})}),2e3)}function mf(){cf&&(clearInterval(cf),cf=null),uf&&(uf.abort(),uf=null)}of.onAcceptCookieClick((function(){var e=window.open("https://top-fwz1.mail.ru/counter2?id=1;","","width=300; height=300");setTimeout((function(){e.close();var t=geByClass1("pageMoneyTransfer__iframe"),n=clone(t);removeClass(df,geByClass1("pageMoneyTransfer")),replace(n,t);var i=n.contentWindow.document;i.open("text/html","replace"),i.write(attr(t,"data-html")),i.close(),hf()}),500),_f++}));var vf={_onMouseDown:Object(u.default)(),_onCancelClick:Object(u.default)()};window.MoneyTransferButton=vf;var gf=vf;gf._onMouseDown((function(e){for(var t=e;!(!(t=gpeByClass("msg_item",t))||t&&attr(t,"data-id")););t&&(setStyle(t,"-webkit-tap-highlight-color","transparent"),setTimeout((function(){return function(e){setStyle(e,"-webkit-tap-highlight-color","initial")}(t)}),400))}));var Af,bf,wf=!1,yf=null;function Of(){yf&&Btn.setLoading(yf,!1),Af&&(clearInterval(Af),Af=null),bf&&(bf.abort(),bf=null)}gf._onCancelClick((function(e,t){var n,i;t?(wf=!1,preventEvent(e),cancelEvent(e),lockButton(t)):(wf=!0,t=e.$btn,e=null,yf=t,Btn.setLoading(t,!0)),n={cancelUrl:attr(t,"href")},i=n.cancelUrl,Af=setInterval((function(){bf=ajax.post(i,{_ajax:1},{onDone:function(e){if(1===e){if(wf){var t=arguments[1];return yf.closest(".BtnStack").outerHTML='\n            <div class="notification__tempText">'+t+"</div>\n          ",void Of()}var n=window.scrollTop();nav.go(location.pathname+location.search,null,{replace:!0}),cur.destroy.push((function(){window.scrollTop(n)})),Of()}}})}),1500),window.cur.destroy.push(Of)}));need("attr"),need("geByClass1");var Sf=need("preventEvent"),kf=need("Popup");window.SendMoneyForm={},SendMoneyForm._onAmountChange=Wf,SendMoneyForm._onSubmit=Gf,SendMoneyForm._onRecommAmountChange=$f,SendMoneyForm._onAutoAcceptToggle=Kf,SendMoneyForm._onNoAmountToggle=Qf,SendMoneyForm._onChooseCardClick=Vf,SendMoneyForm._onChooseCardCancelClick=Uf,SendMoneyForm._onChooseCardContinueClick=Ff,SendMoneyForm._onCardSelect=Hf;var Cf="sendMoneyForm_error_min",jf="sendMoneyForm_error_max",Ef="sendMoneyForm_addCardVisible",Tf="sendMoneyForm_requestedVisible",If="sendMoneyForm_recommErrorMin",Mf="sendMoneyForm_recommErrorMax",Pf="sendMoneyForm_noAmount",Df="sendMoneyForm_autoAccept",xf=".sendMoneyForm",Lf=".sendMoneyForm__cardsPopup",Bf=".sendMoneyForm__input_amount",Rf=".sendMoneyForm__recommAmountInput input",Nf=".sendMoneyForm__amountNote_requestAmount";function Ff(){var e=Object(F.$)('.Control__native[name="card"]:checked').value,t=Object(F.$)('.Control__native[name="card"]:checked ~ .Control__label').innerText;Object(F.$)('input[name="accept_card"]').value=e,Object(F.$)('input[name="accept_card"]').setAttribute("data-value",e),Object(F.$)(".sendMoneyForm__chooseCard").innerText=t,kf.close()}function Hf(e){var t="-1"===e.value;Object(F.$)(xf).classList.toggle(Ef,t)}function Uf(){kf.close()}function Vf(){var e=Object(F.$)(Lf);kf.open(e)}function Wf(e){e||(e=Object(F.$)('input[name="amount"]')),zf(e),Yf(e,6);var t=e.closest(xf),n="1"===t.getAttribute("data-is-chat-request"),i=Number(e.value),a=Number(t.getAttribute("data-max-amount"));if(t.classList.remove(Cf),t.classList.remove(jf),n||i>a&&t.classList.add(jf),n){var r=qf(),o=Number(t.getAttribute("data-min-amount"))*(r?2:1),s=function(e,t){var n=Object(F.$)('input[name="amount"]').closest(xf),i=Number(n.getAttribute("data-min-amount")),a=Number(n.getAttribute("data-max-amount")),r=Number(n.getAttribute("data-chat-members-count")),o=Math.ceil(e/(r-(t?0:1)));return Math.min(a,Math.max(i,o))}(i,r);if(Object(F.$)(Rf).value=s,t.classList.remove(Mf),t.classList.remove(If),!o||i>=o){var c=r?i-s:i;Object(F.$)(Nf).innerText=c,t.classList.add(Tf)}else t.classList.remove(Tf)}}function $f(e){zf(e),Yf(e,6);var t=e.closest(xf),n=Number(e.value),i=t.getAttribute("data-max-amount");t.classList.remove(Mf),t.classList.remove(If),n>i&&t.classList.add(Mf)}function qf(){var e=Object(F.$)('input[name="participiate"]');return e&&e.checked}function zf(e){e.value=parseInt(e.value,10)||""}function Yf(e,t){e.value=e.value.slice(0,t)}function Gf(e,t){var n=t.$(Bf).value,i=Number(n),a=Number(t.getAttribute("data-min-amount")),r=Number(t.getAttribute("data-max-amount")),o="1"===t.getAttribute("data-is-chat-request"),s=!1;(t.classList.remove(Cf),t.classList.remove(jf),o&&(t.classList.remove(Mf),t.classList.remove(If)),Object(F.$)(xf).classList.contains(Pf))||(i<a*(!!o&&qf()?2:1)||!n||n!==i.toString()?(t.classList.add(Cf),s=!0):i>r&&!o&&(t.classList.add(jf),s=!0));if(o){var c=t.$(Rf).value,l=Number(c);l<a||!c||c!==l.toString()?(t.classList.add(If),s=!0):l>r&&(t.classList.add(Mf),s=!0)}if(s)Sf(e),stopEvent(e);else{Sf(e),stopEvent(e),t.insertAdjacentHTML("beforeend",'<input id="submit" type="submit" style="display: none" />');var u=Object(F.$)("#submit");ajax.click(u)}}function Kf(e){Object(F.$)(xf).classList.toggle(Df,e.checked),e.checked?Object(F.$)('input[name="accept_card"]').value=Object(F.$)('input[name="accept_card"]').getAttribute("data-value"):Object(F.$)('input[name="accept_card"]').value=""}function Qf(e){Object(F.$)(xf).classList.toggle(Pf,e.checked)}window.MoneyLink={copy:function(e){var t=e.$btn,n=t.nextElementSibling,i=geByClass1("TextInput__native",gpeByClass("Pad__content",t));copyToClipboard(i)&&(MoneyLink.lastCopyLabel&&hide(MoneyLink.lastCopyLabel),MoneyLink.lastCopyLabel=n,show(n))},genQRCode:function(e,t){var n=arguments,i=this;if(!MoneyLink.qrcode){var a,r,s=o.colorScheme.isDarkScheme();t?(a=geByClass1("snippet__icon",geByClass1(t)),r=s?128:80):(a=ge("money_link_qr"),r=200);var c={isShowLogo:!0};s&&(c.isShowBackground=!0,c.backgroundColor="#fff"),val(a,ra.a.createQR(e,r,"qr-code",c));var l=o.colorScheme.subscribe((function(){l(),i.genQRCode.apply(i,n)}))}}};var Xf=need("Voting"),Jf=function(){var e,t,n=[],i=!1,a=!1,r={};function o(e){return function(){if(!i)return e.apply(this,arguments)}}function s(e){return"A"===e.tagName}function c(){a=n.length>0,toggleClass("vk_messages_actions_visible",document.body,a)}function l(){a&&(r={},each(n,(function(e,t){removeClass("mi_selected",geByClass1("_msg"+t))})),i=!1,n=[],c())}function u(){return!!window.getSelection&&window.getSelection().toString().length>0}function d(e,t,a,r){void 0===r&&(r=!1),i=!0,lockButton(e),im.off(),ajax.click("/mail",{},{url_params:{act:r?"spam":"delete",peer:t,hash:a,ids:n.join(","),community:Zf()}})}function _(){return Boolean(e)}function f(){ge("dialogs")&&_()?addClass("vk_dialogs_forwarding",document.body):e="",l()}return page.onChange(f),mail.onShowDialogsPageFromCache(f),mail.onShowDialogFromCache(f),mail.onShowDialogsPageFromCache(Q_),mail.onShowDialogFromCache(Q_),mail.onMessagesRepainted((function(){each(n,(function(e,t){addClass("mi_selected",geByClass1("_msg"+t))}))})),{onMessageClick:o((function(e){var t=e.target,i=e.currentTarget,a=s(t)||s(t.parentNode);t.closest("."+Xf.cls)?e.stopPropagation():(a&&l(),browser.uc_mini||u()||a||setTimeout((function(){var e,t,a;u()||(e=i,t=attr(e,"data-id"),(a=n.indexOf(t))>=0?(n.splice(a,1),removeClass("mi_selected",e),delete r[t]):(n.push(t),addClass("mi_selected",e),r[t]=hasClass("msg_item_important",e)),c(),function(){var e=window.lang,t=Math.max(n.length,1);val(geByClass1("messagesActions__row_counter"),langNumeric(t,e.mobile_mail_messages_selected).replace("{count}",t))}())}),40))})),remove:o(d),reply:o((function(e,t,a){i=!0,lockButton(e),ajax.click("/attachments",{},{url_params:{act:"add",target:"mail"+t,hash:a,object:"mail"+n.join(";"),community:Zf()}})})),forward:o((function(a,r){i=!0,lockButton(a),e="mail"+n.join(";"),t=r;var o=Zf(),s=o?"?community="+o:"";nav.go(location.pathname+s,null,{ignore_cur_process:!0})})),spam:o((function(e,t,n){d(e,t,n,!0)})),close:o(l),toggleImportant:o((function(e){var t,i=n.length,a=0;for(t=0;t<i;t++)if(!r[n[t]]){a=1;break}for(t=0;t<i;t++)toggleClass("msg_item_important",geByClass1("_msg"+n[t]),1===a);ajax.post("/mail",{_ajax:1,act:"mark_important",ids:n,val:a,hash:e}),l()})),hasFwdMessages:_,attachFwdMessages:function(n){ajax.click("/attachments",{},{url_params:{act:"add",target:"mail"+n,hash:t,object:e,community:Zf()}}),e=""}}}();function Zf(){return nav.getQuery("community")}window.MessagesActions=Jf;var ep=n("TxR4"),tp=n("S6+Z"),np=Object.entries(tp.EMOJI_HINTS).map((function(e){var t=e[0],n=e[1],i=(n[0],n[1]);return[new RegExp("(\\s|^)("+Object(Ci.escapeRE)(i)+(i.endsWith(")")||i.endsWith("(")?"+":"")+")([\\s\\.,]|$)","gi"),t]})),ip={q:"й",w:"ц",e:"у",r:"к",t:"е",y:"н",u:"г",i:"ш",o:"щ",p:"з","[":"х","]":"ъ",a:"ф",s:"ы",d:"в",f:"а",g:"п",h:"р",j:"о",k:"л",l:"д",";":"ж","'":"э",z:"я",x:"ч",c:"с",v:"м",b:"и",n:"т",m:"ь",",":"б",".":"ю","/":"."};browser.mac?ip["\\"]="ё":ip["`"]="ё";var ap=new RegExp("["+Object(Ci.escapeRE)(Object.keys(ip).join(""))+"]","gi"),rp=function(e){return e.replace(ap,(function(e){return ip[e]}))},op=Object.entries(ip).reduce((function(e,t){var n=t[0];return e[t[1]]=n,e})),sp=new RegExp("["+Object(Ci.escapeRE)(Object.keys(op).join(""))+"]","gi"),cp=function(e){return e.replace(sp,(function(e){return op[e]}))},lp=function(){function e(e){this.config={mvk:!1,peerId:null,maxInputLength:256},this.setConfig(e)}var t=e.prototype;return t.setConfig=function(e){Object.assign(this.config,e)},t.getQueries=function(e){if(!e||e.length>this.config.maxInputLength)return[""];var t=window.Wall&&window.Wall.replyNamesRE||window.post&&window.post.replyNamesRE;if(t){var n=t();n&&(e=e.replace(n,""))}e=e.toLowerCase(),e=(e=np.reduce((function(e,t){var n=t[0],i=t[1];return e.replace(n,(function(e,t,n,a){return(t||"")+Object(ep.emojiByteHexToSymbol)(i)+(a||"")}))}),e)).replace(/^[\s\uFEFF\xA0]+|\n+$/g,"");for(var i=[e=Object(ep.emojiRemoveSkinToneModifiers)(e)],a=0,r=[].concat(i);a<r.length;a++){var o=r[a];i.push(rp(o)),i.push(cp(o))}for(var s=0,c=[].concat(i);s<c.length;s++){var l=c[s];i.push(l.replace(/ё/g,"е")),i.push(l.replace(/е/g,"ё"))}for(var u=0,d=[].concat(i);u<d.length;u++){var _=d[u];i.push(_.replace(/[.!?]+$/,""))}return Object.keys(i.reduce((function(e,t){return e[t]=1,e}),{}))},t.isBotLinkEnabled=function(){return Object(S.partConfigEnabled)("stickers_bot_link")&&-184940019!==this.config.peerId},t.getBotLinkUrl=function(){return this.config.mvk?"/mail?act=show&peer=-184940019":"/im?sel=-184940019"},t.getBotLinkImageUrl=function(e,t){return void 0===t&&(t="light"),"/images/stickers_suggestions_bot_"+t+"_"+e+".png"},t.getBotLinkClickStatName=function(){return"stickers_suggestions_bot_link"},t.getBotLinkClickStatKeys=function(){return[]},t.isMoneyTransferEnabled=function(){return Object(S.partConfigEnabled)("stickers_money_transfer_suggestions")&&(this.isMoneySendEnabled()||this.isMoneyRequestEnabled())},t.isMoneySendEnabled=function(){return Boolean(this.config.moneyTransfer&&this.config.moneyTransfer.send)},t.isMoneyRequestEnabled=function(){return Boolean(this.config.moneyTransfer&&this.config.moneyTransfer.request)},e}();window.StickersHints=function(){var e,t,n,i,a,s,c=!0,l=0,u=new lp({mvk:!0});tp.EMOJI_HINTS;function d(e){var r=window.cur;if(n=geByTag1("textarea",gpeByTag("form",geByClass1("cp_sticker_btn"))),u.setConfig(e),n&&!n.initialized){var o=function(e){var t=n.value.length;t-l>1,l=t,_(),c&&(!function(){g()&&vkNow()-A()>864e5*(2+Math.random())&&f();e=function(e){e*=1e3,g()&&e>A()&&f()},ajax.post("/attachments",{_ajax:1,act:"stickers_hints_change_date"},{onDone:e});var e}(),c=!1)};n.initialized=!0,a=geByClass1("stickersHints"),i=geByClass1("stickersHints__content"),addEvent(n,"focus",_),addEvent(n,"input",o),addEvent(document,"click",p),onBodyResize(h),onBodyResize(w),r.destroy.push((function(){a=null,i=null,n=null,removeEvent(n,"focus",_),removeEvent(n,"input",o),removeEvent(document,"click",p),onBodyResize("__clear",h),onBodyResize("__clear",w),t&&t.destroy(),l=0})),document.activeElement===n&&_()}}function _(){var r;n&&(e&&clearTimeout(e),r=function(r){var s=u.getQueries(n.value).find((function(e){return r.hasOwnProperty(e)})),c=s&&r[s];c?e=setTimeout((function(){var e,n,r=c.userStickers||[],l=c.promotedStickers||[];if(r.length>0||l.length>0){var d=[];each(r,(function(e,t){d.push(m({stickerId:t,query:s,isPromoted:!1}))})),each(l,(function(e,t){d.push(m({stickerId:t,query:s,isPromoted:!0}))})),u.isBotLinkEnabled()&&d.push((e=Object(y.getStickerSize)(),n="light",o.colorScheme.isDarkScheme()&&(n="dark"),Wd.html({inner:[{inner:[{class:"th_img",src:u.getBotLinkImageUrl(e,n),tag:"img"}],class:"sticker_thumb",href:u.getBotLinkUrl(),onclick:"StickersHints.onSuggestionsBotLinkClick();",target:"_blank",tag:"a"}],class:"sticker_item",tag:"div"}))),i.innerHTML=d.join(""),show(a),h(),w(),(t=new Scroller(a)).init()}}),300):(t&&t.destroy(),hide(a))},s?r(s):g()?(s=lsGet("stickers_keywords").keywords,r(s)):v((function(e){s=e,b(e),r(e)})))}function f(){v((function(e){s=e,b(e),_()}))}function p(t){var i=t.target;i===n||gpeByClass(i,"stickersHints")||(hide(a),e&&clearTimeout(e))}function h(){attr(i,"style","")}function m(e){var t=e.isPromoted,n=t?"":"onclick=\"return StickersHints.onStickerThumbClick(event, this, {{stickerId}}, '{{stickerReferrer}}');\"",i=t?'href="/attachments?'+["act=stickers_store","target="+attr(a,"data-target"),"sticker_id={{stickerId}}","from=inline","sticker_referrer={{stickerReferrer}}"].join("&")+'"':"",r=Stickers.getStickerUrl(e.stickerId,Object(y.getStickerSize)());return('<div class="sticker_item sticker{{stickerId}} {{promotedClass}}">        <a class="sticker_thumb thumb_item" '+i+" "+n+'>          <img class="th_img" src="{{stickerUrl}}" />        </a>      </div>').replace(/{{stickerId}}/g,e.stickerId).replace(/{{stickerUrl}}/g,r).replace("{{promotedClass}}",t?"sticker_item_promoted":"").replace("{{stickerReferrer}}","suggestion_"+e.query)}function v(e){ajax.post("/attachments",{_ajax:1,act:"stickers_hints_keywords"},{onDone:function(t){e(function(e){var t={};return each(e,(function(e,n){var i=n.user_stickers,a=n.promoted_stickers;each(n.words,(function(e,n){t[n]={userStickers:i,promotedStickers:a}}))})),t}(t))}})}function g(){return Boolean(lsGet("stickers_keywords"))}function A(){return lsGet("stickers_keywords").time}function b(e){!e||isEmpty(e)?lsSet("stickers_keywords"):lsSet("stickers_keywords",{keywords:e,time:vkNow()})}function w(){var e=geByClass1("stickersHints__callout");if(e){var t=e.offsetWidth-4,n=t/64,i=n%1;i<.3?n=Math.floor(n)-.5:i>.7&&(n=Math.ceil(n)-.5);var a=Math.round(t/n-8);each(geByClass("sticker_item",e),(function(e,t){var n=geByClass1("sticker_thumb",t),i=geByClass1("th_img",t);setStyle(t,"width",a),setStyle(t,"height",a),setStyle(n,"width",a),setStyle(n,"height",a),setStyle(i,"height",a)}))}}return onDOMReady((function(){lsCheck()&&!geByClass1("vk_stickers_hints_support_no")&&(post.onStickersInit((function(){d()})),geByClass1("stickersHints")&&d())})),ajax.onRedirect((function(e){qs2obj(e.split("?")[1]).invalidate_stickers_hints&&f()})),post.onReplyClick((function(e){var t=window.cur;e,setTimeout(_,10),t.destroy.push((function(){;""}))})),{actualizeVisibility:_,init:d,onStickerThumbClick:function(t,i,r,o){window.isNewMail&&preventEvent(t);var s=gpeByClass("sticker_item",i),c=geByClass1("th_img",s);return attr(s,"style",""),attr(i,"style",""),attr(c,"style",""),hide(a),n.value="",e&&clearTimeout(e),post.sendSticker(i,r,!0,o)},onCheckboxLabelClick:function(e,t){setTimeout((function(){!function(e,t,n){var i={_ajax:1,act:"stickers_hints_enabled",value:e,hash:t};ajax.post("/attachments",i,{onDone:n})}(val(geByTag1("input",e.parentElement))?1:0,t,f)}),0)},onCheckboxAutoAnimationLabelClick:function(e,t){setTimeout((function(){!function(e,t,n){var i={_ajax:1,act:"stickers_auto_animation_enabled",value:e,hash:t};ajax.post("/attachments",i,{onDone:n})}(val(geByTag1("input",e.parentElement))?1:0,t,f)}),0)},onSuggestionsBotLinkClick:function(){r.statlogsValueEvent.apply(void 0,[u.getBotLinkClickStatName(),0].concat(u.getBotLinkClickStatKeys()))}}}();var up=need("nav");window.PinnedMsg={onHideClick:befall(),getByMsgId:function(e){return Object(F.$)(dp(e))}};var dp=function(e){return'.pinnedMsg[data-msg-id="'+e+'"]'};function _p(e,t){var n=t.parentNode.getAttribute("data-msg-id");window.isNewMail&&n?(e.preventDefault(),uMessenger.goToMsg(Number(n))):up.go(t,e)}PinnedMsg._onClick=_p,PinnedMsg._onHideClick=PinnedMsg.onHideClick;n("98L6");window.SettingsRow_select={},SettingsRow_select._onChange=hp;var fp=".settingsRow",pp=".settingsRow__description";function hp(e,t){!function(e){var t=e.$select,n=e.label;t.closest(fp).$(pp).textContent=n}(t),d.default.handle(e,t)}n("MzAf"),n("Dh0N"),n("fYoA");var mp=n("PovR");function vp(e){pushNotifier.canBeEnabled().then((function(t){var n=!!e.$control&&geByTag1("input",e.$control);n&&(t?pushNotifier.setupSubscription().then((function(){!function(e){var t=ce("input",{type:"submit"},{display:"none"});e.$control.form.appendChild(t),ajax.click(t),e.$control.form.removeChild(t)}(e)})).catch((function(e){PushNotifier.PUSH_NOTIFIER_BLOCKED_BY_BROWSER_SETTINGS===e?(n.checked=!1,addClass("Popup_open",geByClass1("pageAllowPushPopup"))):n.checked=!1})):n.checked=!1)}))}window.SettingsNotifyPush={},SettingsNotifyPush._onSwitch=vp;var gp=function(){function e(e,t){isObject(t)||(t={items:t}),this.opts=extend({slideClassName:"",onStartChange:!1,onChange:!1,pointsWrap:!1,slideContFn:!1,shownSlidesNum:1},t),this.wrap=ge(e),this.parseItems(t.items),this.init()}var t=e.prototype;return t.parseItems=function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];"string"==typeof i&&(i={className:i}),i=extend({html:"",className:"",pos:t.length},i),t.push(i)}this.items=t},t.init=function(){if(addClass("landings_slider_wrap",this.wrap),addEvent(this.wrap,"touchstart mousedown",this.touchStart.bind(this)),this.opts.pointsWrap){var e="";for(var t in this.items)e+='<div class="landings_slider_point"></div>';addClass("landings_slider_points",this.opts.pointsWrap),val(this.opts.pointsWrap,e)}this.changeSlide(0)},t.getTouchX=function(e){return e.targetTouches&&e.targetTouches.length>0?e.targetTouches[0].pageX:e.pageX},t.getTouchY=function(e){return e.targetTouches&&e.targetTouches.length>0?e.touches[0].pageY:e.pageY},t.touchStart=function(e){var t=this.getTouchX(e),n=this.getTouchY(e),i=this,a=!1,r=!1,o=vkNow(),s=0,c=this.getTouchX(e),l=getW(this.wrap);function u(e){if(!r)if(!a&&Math.abs(i.getTouchY(e)-n)>20)r=!0;else{i.lock&&(a=!0,t=i.getTouchX(e),o=vkNow(),i.changeSlide(i.newPos),cancelEvent(e),i.lock=0,clearTimeout(i.changeTimeout));var u=i.getTouchX(e),d=t-u;(Math.abs(d)>20||a)&&(cancelEvent(e),a||(t=i.getTouchX(e),d=0,a=!0),s=d,c=u,d=-(100+d/l*100),d-=100*i.opts.shownSlidesNum-100,setStyle(i.helper,"transform","translateX("+d+"%)"))}}function d(e){if(removeEvent(bodyNode,"mousemove touchmove",u),removeEvent(bodyNode,"mouseup touchend touchcancel",d),!i.lock)if(i.lock=1,Math.abs(s)>50){var n=s<0?"prev":"next",a=Math.abs(c-t)/(o/vkNow());a+=.2*a;var r=100*i.opts.shownSlidesNum;r="next"==n?100+r:r-100,setStyle(i.helper,{transition:"transform "+a+"ms",transform:"translateX(-"+r+"%)"});var l=i.items.length-1,_="prev"==n?i.pos-1:i.pos+1;_<0?_=l:_>l&&(_=0),i.opts.onStartChange&&i.opts.onStartChange(_,n),i.newPos=_,i.changeTimeout=setTimeout((function(){i.lock=0,i.changeSlide(_)}),a)}else setStyle(i.helper,{transition:"transform 200ms",transform:"translateX(-"+100*i.opts.shownSlidesNum+"%)"}),setTimeout((function(){i.lock=0}),200)}removeEvent(bodyNode,"mousemove touchmove",u),removeEvent(bodyNode,"mouseup touchend touchcancel",d),addEvent(bodyNode,"mousemove touchmove",u),addEvent(bodyNode,"mouseup touchend touchcancel",d)},t.makeItem=function(e){var t=this.pos==e.pos?"_active_slide ":"",n=this.opts.slideContFn?this.opts.slideContFn(e):e.html;return'<div class="landings_slider_item '+t+e.className+" "+this.opts.slideClassName+'">'+n+"</div>"},t.getSlidesHtml=function(e){for(var t=this.opts.shownSlidesNum,n=this.items.length-1,i="",a=e,r=0;r<t;r++)--a<0&&(a=n),i=this.makeItem(this.items[a])+i;i+=this.makeItem(this.items[e]),a=e;for(var o=0;o<t;o++)++a>n&&(a=0),i+=this.makeItem(this.items[a]);return i},t.changeSlide=function(e){if(this.pos=Math.max(0,Math.min(e,this.items.length-1)),this.replaceHtml(this.getSlidesHtml(this.pos)),this.opts.onChange&&this.opts.onChange(this.pos),this.opts.pointsWrap){var t=ge(this.opts.pointsWrap);removeClass("selected",geByClass1("selected",t)),addClass("selected",t.children[this.pos])}},t.replaceHtml=function(e){val(this.wrap,'<div class="landings_slider_helper">'+e+"</div>"),this.helper=geByClass1("landings_slider_helper",this.wrap),setStyle(this.helper,"transform","translateX(-"+100*this.opts.shownSlidesNum+"%)")},t.toSlide=function(e,t){this.lock=1;var n=this.makeItem(this.items[this.pos]),i=this.makeItem(this.items[e]);e>this.pos?n+=i:n=i+n,this.replaceHtml(n),t||(t=e>this.pos?"next":"prev");var a="next"==t?0:-100;setStyle(this.helper,"transform","translateX("+a+"%)"),this.opts.onStartChange&&this.opts.onStartChange(e,t);var r=this;clearTimeout(this.toSlideTimer),this.toSlideTimer=setTimeout((function(){a="next"==t?-100:0,setStyle(r.helper,{transition:"transform 200ms",transform:"translateX("+a+"%)"}),r.toSlideTimer=setTimeout((function(){r.lock=0,r.changeSlide(e)}),200)}),10)},e}();window.landingsSlider=gp;n("03kU"),n("4qiT"),n("Tjn9");window.FriendsRecommendedSlider={init:function(){window.cur&&(Sp($("."+bp)),cur.destroy.push((function(){wp=null,yp=null,Op=null})))},hideRecommended:function(e,t,n,i){var a=gpeByClass("prettyCard",e);if(!a)return i&&Object(r.cancelEvent)(i);var o=jp(a),s=domData(a,"code")||domData(o,"code"),c=domData(o,"ref");!function(e){var t=jp(e);remove(e),Op=null,yp=null,kp().length||Cp(t)}(a);var l="/friends"+obj2qs({act:"hide_possible",hash:n,id:t,track_code:s,ref:c});return ajax.post(l,{_ajax:1}),i&&Object(r.cancelEvent)(i)},hideBlock:Cp,acceptFriend:function(e,t,n,i){if(hasClass("prettyCard__button_accepted",e)||hasClass(e))return i&&Object(r.cancelEvent)(i);var a=gpeByClass("prettyCard",e),o=e.querySelector(".prettyCard__buttonText"),s=jp(e),c=domData(a,"code")||domData(s,"code"),l=domData(s,"ref");return addClass(Ap,e),Friends.accept(t,n,"user_rec",0,l,c,(function(t,n){var i=t||getLang("mobile_friends_feed_recom_got_notification");removeClass(Ap,e),addClass("prettyCard__button_accepted",e),o.innerHTML=i,function(e){var t=function(e){var t=domCA(e,".prettyCard");if(!t)return;return geByClass1("prettyCard__closeButton",t)}(e);addClass("prettyCard__closeButton_hidden",t)}(e);var a=Object(r.isObject)(null==n?void 0:n.friend_request_add_sent_message_nudge)?n.friend_request_add_sent_message_nudge:void 0;if(a){var s=a.url,c=a.text;Object(N.init)({text:i,type:N.SNACKBAR_TYPE_SUCCESS,vertical:!0,action:{text:c,url:s,callback:function(e,t){var n=t.id;Object(N.close)(n),Object(r.cancelEvent)(e),window.nav.go(s)}}})}}),(function(t,n){2===t&&nav.hard_go(n),removeClass(Ap,e)})),i&&Object(r.cancelEvent)(i)},onOpenUser:function(e){var t=gpeByClass("prettyCard",e);if(!t)return;var n=jp(t),i=domData(t,"uid")||"",a=domData(t,"code")||domData(n,"code"),r=domData(n,"ref");FriendsStats.log(FriendsStats.EVENTS.EVENT_OPEN_USER,{uid:i,ref:r,trackCode:a})},onScroll:throttle(Sp,50)};var Ap="prettyCard__button_loading",bp="friendsRecommendedSliderWrap",wp=null,yp=null,Op=null;function Sp(e){if(!wp&&e&&(wp=jp(e)),wp&&(wp._lastScroll=wp.scrollLeft,!e.ajaxIsRunning)){var t=wp.scrollLeft,n=function(){if(yp)return yp;if(!wp)return{};var e=getSize(wp)[0],t=getX(wp),n=kp(),i=getX(n[0])-t,a=getSize(n[0])[0],r=getX(n[1])-t-i-a,o=Math.floor(a/3);return yp={width:e,itemWidth:a+r,leftMargin:i,part:o,scrollWidth:wp.scrollWidth}}(),i=Math.max(0,Math.floor((t-n.leftMargin)/n.itemWidth)),a=Math.max(0,Math.floor((t+n.width-n.leftMargin)/n.itemWidth));i*n.itemWidth+n.itemWidth-n.part<t&&i++,a*n.itemWidth+n.part>t+n.width&&a--;var r=kp();i=Math.max(0,i),a=Math.min(r.length,a);for(var o=domData(wp,"ref"),s=domData(wp,"code"),c=i;c<=a;c++){var l=r[c];if(l&&!l.viewed){l.viewed=!0;var u=domData(l,"uid")||"",d=domData(l,"code")||s;FriendsStats.log(FriendsStats.EVENTS.EVENT_VIEW_USER,{uid:u,pos:c,ref:o,trackCode:d})}}!e.allLoaded&&t+n.width>=n.scrollWidth/2&&function(e){(e=jp(e)).currentPage=e.currentPage||1;var t=domData(e,"next")||"";if(e.allLoaded||!t||e.currentPage++>=3)return void(e.allLoaded=!0);var n=domData(e,"code")||"",i=domData(e,"ref")||"",a=intval(domData(e,"friend-id")),r="/friends"+obj2qs({act:"recommended_carousel",next:t,ref:i,friendId:a,track_code:n});e.ajaxIsRunning=!0,ajax.post(r,{_ajax:1},{onDone:function(t,n){if(t){var i=geByClass1("Slider__line",e),a=cdf(t);append(a,i),yp=null,Op=null}domData(e,"next",n||null),e.allLoaded=!n,e.ajaxIsRunning=!1},onFail:function(){setTimeout((function(){return e.ajaxIsRunning=!1}),500)}})}(e)}}function kp(){return Op||(wp&&(Op=geByClass("prettyCard",wp)),Op||[])}function Cp(e,t){var n=gpeByClass(bp,e);if(!n)return t&&Object(r.cancelEvent)(t);var i=wp;if(!i&&e&&(i=jp(n)),i){var a=domData(i,"code"),o=domData(i,"ref");FriendsStats.log(FriendsStats.EVENTS.EVENT_HIDE_BLOCK,{ref:o,trackCode:a})}if(remove(n)){var s=nav.getQuery();delete s.recs,nav.go(location.pathname+obj2qs(s),!1,{replace:!0,push_only:!0})}return t&&Object(r.cancelEvent)(t)}function jp(e){var t;return hasClass(e,"Slider__scroll")?t=e:(t=geByClass1("Slider__scroll",e))||(t=gpeByClass("Slider__scroll",e)),t}n("w1QQ"),n("DVnk"),n("cLcH"),n("uo4j"),n("Fhlr");var Ep=n("myok");window.groupInvitationClick=function(e,t){var n=t.$btn,i=n.getAttribute("href");(n.nextElementSibling||n.previousElementSibling).remove(),ajax.post(i,{_ajax:1},{onDone:function(){}}),n.closest(".BtnStack").outerHTML='\n    <div class="notification__tempText">'+e+"</div>\n  "},window.apiCallAction=function(e,t,n,i,a,r,o){var s=o.$btn,c=s.getAttribute("href"),l=s.nextElementSibling||s.previousElementSibling,u=t?'<span class="notification__tempIcon '+t+'Icon"></span>':"";i&&!confirm(i)||(Ep.default.setLoading(s,!0),ajax.post(c,{_ajax:1},{onDone:function(){Ep.default.setLoading(s,!1),l&&l.remove(),s.closest(".BtnStack").outerHTML='<div class="notification__tempText">'+u+e+"</div>"}}))},window.NotifierPage={notifyMarkAsViewed:function(e){ajax.post("feed.php",{_ajax:1,section:"notifications",hash:e,action:"mark_as_viewed"})}},window.NotifyItem={_onPhotoTagAcceptClick:function(e,t,n){var i=n.$btn,a=i.getAttribute("href");i.nextElementSibling||i.previousElementSibling;ajax.post(a,{_ajax:1},{onDone:function(){}}),i.closest(".BtnStack").outerHTML='\n      <div class="notification__tempText">'+t+"</div>\n    "},_onPhotoTagDeclineClick:function(e,t,n){var i=n.$btn,a=i.getAttribute("href");i.nextElementSibling||i.previousElementSibling;ajax.post(a,{_ajax:1},{onDone:function(){}}),i.closest(".BtnStack").outerHTML='\n      <div class="notification__tempText">'+t+"</div>\n    "},_onHideClick:function(e,t,n,i){e.preventDefault();var a=e.target.getAttribute("href"),r=a+"&action=hide",o=a+"&action=restore",s=!n||confirm(n);ContextMenu.close(),s&&ajax.post(r,{_ajax:1},{onDone:function(){var e="nid"+i,n=document.getElementById(e),a=n.closest(".notificationList__items")||n.closest(".notificationList"),r=a.closest(".notificationList");if(hide(n),NotifyItem._onBodyScroll(),r.classList.contains("notificationList_type_unread")){var s=r.$(".Pad__title"),c=parseInt(s.innerText,10)-1;s.innerText=langNumeric(c,lang.mobile_notifications_new)}var l=!0;each(geByClass("notification",a),(function(e,t){isVisible(t)&&(l=!1)})),l&&r.classList.add("Pad_empty");var u=window.Snackbar;u&&u.init&&u.init({text:t,action:{url:o,text:lang.mobile_notifications_restore,callback:["NotifyItem._onRestoreClick","event",e]}})}})},_onRestoreClick:function(e,t,n){var i=n.id,a=n.url;e.preventDefault();var r=ge(t);ajax.post(a,{_ajax:1},{onDone:function(){ge(t).style.display="",Snackbar.close(i);var e=r.closest(".notificationList__items")||r.closest(".notificationList"),n=e.closest(".notificationList");if(n.classList.contains("notificationList_type_unread")){var a=n.$(".Pad__title"),o=parseInt(a.innerText,10)+1;a.innerText=langNumeric(o,lang.mobile_notifications_new)}var s=!0;each(geByClass("notification",e),(function(e,t){isVisible(t)&&(s=!1)})),s||n.classList.remove("Pad_empty")}})},_onBodyScroll:function(){$$(".notification_actionsOpen").forEach((function(e){e.classList.remove("notification_actionsOpen")})),window.removeEventListener("scroll",NotifyItem._onBodyScroll)},_onActionTriggerClick:function(e){window.addEventListener("scroll",NotifyItem._onBodyScroll);var t=e.closest(".notification");t.classList.remove("notification_reverse"),t.classList.toggle("notification_actionsOpen"),$$(".notification_actionsOpen").forEach((function(e){e!==t&&e.classList.remove("notification_actionsOpen")})),t.$(".notification__actionsBubble").getBoundingClientRect().y<50&&t.classList.add("notification_reverse")}},window.FriendRequest={_onAcceptClick:function(e,t){var n=t.$btn,i=n.getAttribute("href"),a=n.nextElementSibling||n.previousElementSibling;a&&a.remove(),ajax.post(i,{_ajax:1},{onDone:function(){}}),n.closest(".BtnStack").outerHTML='\n      <div class="notification__tempText">'+e+"</div>\n    "},_onDeclineClick:function(e,t){var n=t.$btn,i=n.getAttribute("href"),a=n.nextElementSibling||n.previousElementSibling;a&&a.remove(),ajax.post(i,{_ajax:1},{onDone:function(){}}),n.closest(".BtnStack").outerHTML='\n      <div class="notification__tempText">'+e+"</div>\n    "}},window.GroupNotify={deleteSource:function(e,t){return ajax.post("feed.php",{gid:e,hash:t,act:"group_notify_delete_source"},{onDone:function(){}}),!1},addSource:function(e,t,n){this.processQuery("group_notify_add_source",e,t,n)},editSource:function(e,t){this.processQuery("group_notify_edit_source",e,t)},processQuery:function(e,t,n,i){var a=$(".group_notify_general .Control_type_switcher input.Control__native").checked?1:0,r={};$$(".group_notify_params .Control_type_switcher input.Control__native").forEach((function(e){r["setting_"+e.name]=e.checked?1:0})),ajax.post("feed.php",Object(B.default)({gid:t,hash:n,unmuted:a,from:i},r,{act:e}),{onDone:function(){}})},gn_grProcess:function(e,t,n,i){ajax.post("club"+e,{act:"user_action",mid:t,hash:n,from:"top_notifier",action:i},{onDone:function(){}})}};var Tp=n("H5mD");function Ip(e,t,n){if(Tp.isWKWebView){attr(t,"onclick",""),attr(t,"href","vk://vk.com/write"+(2e9+e));var i=new Event("click");return t.dispatchEvent(i),void setTimeout((function(){attr(t,"href","/mail?act=show&chat="+e),t.textContent=n}))}x.default.android?location.href="https://vk.com/write"+(2e9+e):Tp.isIOS?(attr(t,"onclick",""),attr(t,"href","/mail?act=show&chat="+e),t.textContent=n,location.href="vk://vk.com/write"+(2e9+e)):location.href="/mail?act=show&chat="+e}window.ChatPreview={join:function(e,t,n){return ajax.post(e,{_ajax:1},{onDone:function(e){Ip(e,t,n)}}),!1},open:function(e,t,n){return setTimeout((function(){Ip(e,t,n)})),!1}};n("wkhI"),n("DOEQ");var Mp=10,Pp={setMaxAttach:function(e){Mp=e},checkAttaches:function(){Pp.toggleEnableAttaches(mediaUpload.getAttachesCount()<Mp)},toggleEnableAttaches:function(e){if(void 0===e&&(e=!0),Object(F.$)("#feed_add_form")){Object(F.$$)(".cp_attach_btn",Object(F.$)("#feed_add_form")).forEach((function(t){t.classList.toggle("cp_disabled_btn",!e)})),["photo","video","audio","doc","poll"].forEach((function(t){Unfold.toggleItemEnabled(Unfold.getByName("attaches"),t,e)})),["photo","audio"].forEach((function(t){var n=Object(F.$)(".CreatePostButtons__item--"+t);n&&n.classList.toggle("CreatePostButtons__item--disabled",!e)}));var t=Object(F.$)(".CreatePostButtons__item--photo .inline_upload");Object(r.attr)(t,"disabled",!e)}}};window.CreatePost=Pp;var Dp=n("Ogzf");!window.isMVK&&(window.vkExpand=window.vkExpand||"VK"+ +new Date,window.vkUUID=window.vkUUID||0,window.vkCache=window.vkCache||{});var xp="doc",Lp="photo",Bp="video",Rp="album",Np="market_album",Fp=window.isMVK?200:120,Hp=window.isMVK?604:537,Up=window.isMVK?360:343;function Vp(e,t,n,i){var a=function(e){var t=0;return each(e,(function(e,n){t+=n})),t},r=function(e,t,n){return(t-(e.length-1)*n)/a(e)},o=(i=Qp(i)?i:{}).wide,s=[],c=0,l=[],u=[];each(n,(function(e,t){Gp(t.type)&&(l[l.length]=t[t.type]),t.type===Bp&&s.push(c),c++}));var d="",_=[],f=l.length;each(l,(function(n,i){var a=zp(i,e,t);d+=a>1.2?"w":a<.8?"v":"q",_[_.length]=a}));var p,h,m=_.length>0?a(_)/_.length:1,v=5;window.isMVK&&(v=window.innerWidth>=480?6:3);var g=v;i.force?(p=e,h=t):(o?(p=Hp,h=Up):e>=381?(p=381,h=1==f?361:237):(p=337,h=1==f?320:214),e<p&&(p=e,h=t),window.isMVK&&(p=Math.min(Hp,window.innerWidth),h=Math.min(Up,p)));var A=p/h,b=0,w=0;if(1==f){var y={lastColumn:1,lastRow:1,single:1};l[0].thumb?(b=279,w=185):_[0]>=1*A?(b=p,w=Math.min(b/_[0],h)):(w=h,b=Math.min(w*_[0],p));var O=Wp(l[0],b,w,y);!O.unsized&&(O.image.width<b&&O.image.height<=h||O.image.height<w&&O.image.width<=p)&&(b=O.image.width,w=O.image.height,O=Wp(l[0],b,w,y)),u[0]=O}else if(2==f){var S,k;switch(d){case"ww":if(m>1.4*A&&_[1]-_[0]<.2){k=p,S=Math.min(k/_[0],k/_[1],(h-g)/2),u[0]=Wp(l[0],k,S,{lastColumn:1}),u[1]=Wp(l[1],k,S,{lastColumn:1,lastRow:1}),b=p,w=2*S+g;break}case"vv":case"qv":case"vq":case"qq":k=(p-v)/2,S=Math.min(k/_[0],k/_[1],h),u[0]=Wp(l[0],k,S,{lastRow:1}),u[1]=Wp(l[1],k,S,{lastRow:1,lastColumn:1}),b=p,w=S;break;default:var C=intval((p-v)/_[1]/(1/_[0]+1/_[1])),j=p-C-v;S=Math.min(h,C/_[0],j/_[1]),u[0]=Wp(l[0],C,S,{lastRow:1}),u[1]=Wp(l[1],j,S,{lastColumn:1,lastRow:1}),b=p,w=S}}else if(3==f)if((_[0]>1.2*A||m>1.5*A)&&"www"==d){var E,T=p,I=Math.min(T/_[0],.66*(h-g));if(u[0]=Wp(l[0],T,I,{lastColumn:1}),"www"==d){var M=intval(p-v)/2;E=Math.min(h-I-g,M/_[1],M/_[2]),u[1]=Wp(l[1],M,E,{lastRow:1}),u[2]=Wp(l[2],p-M-v,E,{lastColumn:1,lastRow:1})}else{var P=intval((p-v)/_[2]/(1/_[1]+1/_[2])),D=p-P-v;E=Math.min(h-I-g,P/_[2],D/_[1]),u[1]=Wp(l[1],P,E,{lastRow:1}),u[2]=Wp(l[2],P,E,{lastRow:1,lastColumn:1})}b=p,w=I+E+g}else{var x=h,L=intval(Math.min(x*_[0],.75*(p-v)));u[0]=Wp(l[0],L,x,{lastRow:1});var B=_[1]*(h-g)/(_[2]+_[1]),R=h-B-g,N=Math.min(p-L-v,intval(B*_[2]),intval(R*_[1]));u[1]=Wp(l[1],N,R,{lastColumn:1}),u[2]=Wp(l[2],N,B,{lastColumn:1,lastRow:1}),b=L+N+v,w=h}else if(4==f)if((_[0]>1.2*A||m>1.5*A)&&"wwww"==d){var F=p,H=Math.min(F/_[0],.66*(h-g));u[0]=Wp(l[0],F,H,{lastColumn:1});var U=(p-2*v)/(_[1]+_[2]+_[3]),V=intval(U*_[1]),W=intval(U*_[2]),$=F-V-W-2*v;U=Math.min(h-H-g,U),u[1]=Wp(l[1],V,U,{lastRow:1}),u[2]=Wp(l[2],W,U,{lastRow:1}),u[3]=Wp(l[3],$,U,{lastColumn:1,lastRow:1}),b=p,w=H+U+g}else{var q=h,z=Math.min(q*_[0],.66*(p-v)),Y=(h-2*g)/(1/_[1]+1/_[2]+1/_[3]),G=intval(Y/_[1]),K=intval(Y/_[2]),Q=q-G-K-2*g;z+(Y=Math.min(p-z-v,Y))+v<p&&q*_[0]>z&&(z=Math.min(q*_[0],p-v-Y)),u[0]=Wp(l[0],z,q,{lastRow:1}),u[1]=Wp(l[1],Y,G,{lastColumn:1}),u[2]=Wp(l[2],Y,K,{lastColumn:1}),u[3]=Wp(l[3],Y,Q,{lastColumn:1,lastRow:1}),b=z+Y+v,w=h}else{var X=[],J=0;m>(s.length?1.3:1.1)?each(_,(function(e,t){X[X.length]=Math.max(1,t)})):each(_,(function(e,t){~s.indexOf(J)?X[X.length]=t:X[X.length]=Math.min(1,t),J++}));var Z,ee,te={};for(te[f+""]=[r(X,p,v)],Z=1;Z<=f-1;Z++)te[Z+","+(ee=f-Z)]=[r(X.slice(0,Z),p,v),r(X.slice(Z),p,v)];for(Z=1;Z<=f-2;Z++)for(ee=1;ee<=f-Z-1;ee++)te[Z+","+ee+","+(f-Z-ee)]=[r(X.slice(0,Z),p,v),r(X.slice(Z,Z+ee),p,v),r(X.slice(Z+ee),p,v)];var ne,ie=null,ae=0;for(var re in te)if(te.hasOwnProperty(re)){var oe=te[re],se=a(oe)+g*(oe.length-1),ce=Math.abs(se-h);if(~re.indexOf(",")){for(var le=re.split(","),ue=0;ue<le.length;ue++)le[ue]=intval(le[ue]);(le[0]>le[1]||le[2]&&le[1]>le[2])&&(ce+=50,ce*=1.5)}(null===ie||ce<ae)&&(ie=re,ae=ce,ne=se)}for(var de=Kp(l),_e=Kp(X),fe=ie.split(","),pe=te[ie],he=fe.length-1,me=0;me<fe.length;me++){var ve=parseInt(fe[me]),ge=de.splice(0,ve),Ae=pe.shift(),be=ge.length-1,we={};he==me&&(we.lastRow=!0);for(var ye=p,Oe=0;Oe<ge.length;Oe++){var Se=ge[Oe],ke=_e.shift(),Ce=we,je=void 0;be==Oe?(je=Math.ceil(ye),Ce.lastColumn=!0):ye-=(je=intval(ke*Ae))+v,u[u.length]=Wp(Se,je,Ae,Ce)}}b=p,w=ne}return{width:intval(b),height:intval(w),thumbs:u}}function Wp(e,t,n,i){var a={id:e.id,width:intval(t),height:intval(n),lastColumn:i.lastColumn,lastRow:i.lastRow,single:i.single,image:$p(e,t,n,i.single),unsized:e.unsized,type:e.type,orig:e};return e.title&&void 0!==e.size?extend(a,{title:e.title,size:e.size}):e.title&&void 0!==e.msize?extend(a,{title:e.title,msize:e.msize}):e.type===Bp&&e.name&&void 0!==e.name&&extend(a,{name:e.namem}),"number"==typeof e.duration&&(e.duration=formatTime(e.duration)),a.unsized?a.ratio=1:a.ratio=a.image.width/a.image.height,a}function $p(e,t,n,i){if(!e)return{};t=intval(t),n=intval(n);var a,r=window.devicePixelRatio||1;if(e.type===Bp||e.type===xp){(e.vid?["x","y","l","s","m"]:["o","z","y","x","m","s","temp"]).forEach((function(i){e.sizes[i]&&(!a||t*r<=e.sizes[i][1]&&n*r<=e.sizes[i][2])&&(a=e.sizes[i])}))}else{var o=e.thumb?e.thumb.sizes:e.sizes,s=o.x||o[o.length-1],c=s?(s[1]||1)/(s[2]||1):1,l=0;c>t/n?(l=n,c>1&&(l*=c)):(l=t,c<1&&(l/=c)),n*=r,t*=r;var u=!i&&o.o,d="";d=o.temp?"temp":l<75?"s":l<130?"m":u&&o.o&&o.o[1]>=t&&o.o[2]>=n?"o":u&&o.p&&o.p[1]>=t&&o.p[2]>=n?"p":u&&o.q&&o.q[1]>=t&&o.q[2]>=n?"q":u&&o.r&&o.r[1]>=t&&o.r[2]>=n?"r":"x",a=o[d]||[]}return a[1]=intval(a[1]),a[2]=intval(a[2]),a[1]&&a[2]||(e.unsized=!0),{src:a[0],width:a[1],height:a[2]}}function qp(e,t,n){var i=t,a=n,r=0,o=0;if(!e.vid&&e.image.width&&e.image.height){var s=e.image.width/e.image.height;s<t/n?(e.single&&e.image.width<t&&(t=e.image.width,n=Math.min(n,e.image.height)),(a=(i=t)/s)>n&&(o=-intval((a-n)/2))):(e.single&&e.image.height<n&&(n=e.image.height,t=Math.min(t,e.image.width)),(i=(a=n)*s)>t&&(r=-intval((i-t)/2)))}return{width:i,height:a,marginLeft:r,marginTop:e.orig&&(e.type===Np||e.type===Rp)&&e.single?0:o}}function zp(e,t,n){var i;switch(e.type){case xp:i=e.ratio;break;case Bp:i=e.ratio||1.777;break;case Rp:case Np:i=1.5;break;default:if(e.sizes&&e.sizes.x){var a=e.sizes.x,r=a[1],o=a[2];r&&o&&(i=r/o)}if(e.sizes&&e.sizes.temp){var s=e.sizes.temp,c=s[1],l=s[2];c&&l&&(i=c/l)}}return i||1}function Yp(e,t,n,i){var a=t.split("_"),r=a[0],o=a[1],s=Object(B.default)({owner_id:r,ownerId:r,itemId:o,type:e,remove:n.remove,click:n.click,temp:"temp"in n.sizes},i);switch(e){case xp:s.data={sizes:n.sizes,ratio:n.ratio,label:n.label,href:n.href},s.doc=s.data;break;case Lp:s.data={pid:o,sizes:n.sizes,restrictionBlur:n.restrictionBlur,restrictionGeo:n.restrictionGeo,photoId:n.photoId},s.photo=s.data;break;case Bp:s.data={vid:o,duration:n.duration,platform:n.platform,play_icon:n.play_icon,preview:n.preview,active_live:n.active_live,restriction:n.restriction,ratio:n.ratio,sizes:n.sizes,name:n.name},s.video=s.data;break;case Rp:s.data={aid:o,title:n.title,size:n.size,thumb:{sizes:n.sizes},restrictionBlur:n.restrictionBlur,restrictionGeo:n.restrictionGeo,photoId:n.photoId},s.album=s.data;break;case Np:s.data={type:Np,aid:o,title:n.title,msize:n.msize,thumb:{sizes:n.sizes}},s.market_album=s.data}return s.data.type=e,s.data.id=s.temp?e+"temp_"+r:""+e+s.ownerId+"_"+s.itemId,s}function Gp(e){return!!~[xp,Lp,Bp,Rp,Np].indexOf(e.toString())}function Kp(e,t){var n=Qp(e)||void 0===e.length?{}:[];for(var i in e)(!/webkit/i.test(_ua)||"layerX"!=i&&"layerY"!=i&&"webkitMovementX"!=i&&"webkitMovementY"!=i)&&(t&&"object"==typeof e[i]&&"prototype"!==i&&null!==e[i]?n[i]=Kp(e[i]):n[i]=e[i]);return n}var Qp=function(e){return"[object Object]"===Object.prototype.toString.call(e)};var Xp=n("0DYw"),Jp=n("eLSo"),Zp=n("4/mX"),eh=n("HbQ2"),th=n("Z6iq"),nh=n("a3n7"),ih=n("l1SD"),ah=n("AQO8"),rh=n("QDiA"),oh=n("R3X3"),sh=n("L3c9"),ch=function(e){var t;switch(e.iconFilename+(e.canPreview?"":"_grey")+"_44"){case"delete_outline_44":t=Object(Xp.getDeleteOutline44Icon)();break;case"delete_outline_grey_44":t=Object(Jp.getDeleteOutlineGrey44Icon)();break;case"do_not_disturb_outline_44":t=Object(Zp.getDoNotDisturbOutline44Icon)();break;case"do_not_disturb_outline_grey_44":t=Object(eh.getDoNotDisturbOutlineGrey44Icon)();break;case"hide_outline_44":t=Object(th.getHideOutline44Icon)();break;case"info_outline_44":t=Object(nh.getInfoOutline44Icon)();break;case"info_outline_grey_44":t=Object(ih.getInfoOutlineGrey44Icon)();break;case"lock_outline_44":t=Object(ah.getLockOutline44Icon)();break;case"lock_outline_grey_44":t=Object(rh.getLockOutlineGrey44Icon)();break;case"recent_outline_44":t=Object(oh.getRecentOutline44Icon)();break;case"recent_outline_grey_44":t=Object(sh.getRecentOutlineGrey44Icon)()}var n=[{class:"VideoRestriction__boxWrap",inner:[{class:"VideoRestriction__box",inner:[Object(R.default)(t),{class:"VideoRestriction__title",inner:e.title}]}]}];e.thumb&&n.push({class:"VideoRestriction__thumb",style:"background-image: url("+e.thumb+"); height: 100%; width: 100%;"});e.button&&n[0].inner[0].inner.push({class:"VideoRestriction__button",inner:e.button.text,onclick:["VideoRestriction.hideDisclaimerAndPlay"]});return n};var lh={drag:{curEl:null},cachedPhoto:{}};window.ThumbsEdit={initialized:!1,_init:function(){onDOMReady((function(){window.ThumbsEdit.init(!1),page.onChange((function(){window.ThumbsEdit.init(!1,"/wall")}))}))},init:function(e,t){var n=this;if(void 0===t&&(t=nav.path),e||(e=$("#feed_add_form .cp_attached_wrap")),!e||0!==t.indexOf("/wall")&&0!==t.indexOf("/board"))return this.initialized=!1,removeClass(document.body,"te_i"),void(lh.destroyLongpress&&lh.destroyLongpress());if(addClass(document.body,"te_i"),!geByClass1("ThumbsEdit",e)){var i=Object(r.ceFromString)(d.default.html({class:"ThumbsEdit",style:"width: 100%; height: 100%",id:"ThumbsEdit"})),a=Object(r.ceFromString)(d.default.html({class:["ThumbsEdit-wrap"," _preventMenuOpen"],inner:i}));a.appendChild(i),e.insertBefore(a,e.firstChild),lh=Object(B.default)({},lh,{previews:[],loaders:{},attachEl:i});var o=this.parsePreviews(Object(r.getPreloadData)());this.initialized=!0,o.length&&(lh.previews=o,this.draw(),Object(r.onBodyResize)((function(){return n.draw()})))}},parsePreviews:function(e){return e.map((function(e){return Yp.apply(void 0,e)})).filter((function(e){return Gp(e.type)}))},draw:function(){var e=this,t=lh,n=t.previews,i=t.attachEl,a=n[0]?zp(n[0]):1.5,r={width:i.parentNode.offsetWidth,height:Math.min(Math.round(i.parentNode.offsetWidth/a),360),wide:!0},o=Vp(r.width,r.height,n,r),s=o.thumbs,c=o.height,l=o.width;lh=Object(B.default)({},lh,{thumbs:s,height:c,options:r});var u=document.createDocumentFragment();s.forEach((function(t,n){u.appendChild(e.createThumbEl(t,n))})),this.updateIds();var d=ce("div");d.id="ThumbsEdit-splitter",val(i,""),i.style.width=l+"px",i.parentNode.style.height=c+"px",i.appendChild(u),ge("ThumbsEdit-splitter")||i.parentNode.appendChild(d),mediaUpload.refreshUploadState(),this.updatePhotos()},update:function(e,t){var n=this;if(e=ge(e)){var i=e.id,a=ge(i),o=lh.thumbs,s=lh.height,c=lh,l=c.options,u=c.drag,_=t[0]?zp(t[0]):1.5,f=l.width,p=l.height;f&&p||(f=e.parentNode.offsetWidth,p=Math.min(Math.round(f/_),360)),l.width=f,l.height=p,l.wide=!0;var h=Vp(f,p,t,l),m=h.thumbs,v=h.height,g=h.width,A=Object(r.ceFromString)(d.default.html({class:"ThumbsEdit",style:"width: "+g+"px; height: "+v+"px; position: fixed; left: "+u.wpos[0]+"px; top: "+u.wpos[1]+"px; visibility: hidden"}));m.forEach((function(e,t){A.appendChild(n.createThumbEl(e,t,!0))})),document.body.appendChild(A);var b=this.getCoords(A,u.wpos);re(A),b.forEach((function(e,t){var n=lh.drag.coords.find((function(t){return t.id===e.id}));if(n){var i=geByClass1("Thumb",n.node),a=$("img",i),s=o[n.index],c=m.find((function(e){return e.id===s.id}));lh.drag.toIndex!==t&&r.setStyle.transform(i,1,[0,0]),n.height===e.height&&e.x===n.x&&e.y===n.y&&n.index!==lh.drag.i||setTimeout((function(){r.setStyle.animate(i,"margin-left, margin-top, height, width, opacity, transform",{duration:Fp+"ms"}),Object(r.setStyle)(i,{"margin-left":0,"margin-top":0,height:e.height,width:e.width,opacity:1}),r.setStyle.transform(i,1,[e.x-n.x,e.y-n.y]),r.setStyle.animate(i.parentNode,"background",{duration:Fp+"ms"}),Object(r.setStyle)(i.parentNode,{func:"ease-in",background:"transparent"});var t=qp(c,e.width,e.height);a&&(r.setStyle.animate(a,Object.keys(t).join(),Fp+"ms"),Object(r.setStyle)(a,t))}))}})),s!==v&&setTimeout((function(){[a,a.parentNode].forEach((function(e){r.setStyle.animate(e,"height",{duration:Fp+"ms"}),Object(r.setStyle)(e,{height:v})}))})),g>=f&&(r.setStyle.animate(a,"width",{duration:Fp+"ms"}),Object(r.setStyle)(a,{width:g})),setTimeout((function(){Object(r.setStyle)(a,{width:g}),lh.thumbs=m,lh.previews=t,lh.height=v;var e=document.createDocumentFragment();m.forEach((function(t,i){e.appendChild(n.createThumbEl(t,i))})),a.innerHTML="",a.appendChild(e),lh.drag.updating=!1,n.updatePhotos()}),Fp)}else console.error("empty el to update")},createThumbEl:function(e,t){var n=e.image,i=e.width,a=e.height,o=e.type,s=qp(e,i,a),c=["Thumb-wrap","Thumb-wrap--"+o],l=0===e.id.indexOf("phototemp_"),u=l||i<=30||a<=60,_=e.orig.restriction;l&&c.push("Thumb-wrap--temp"),e.lastColumn&&c.push("last_column"),e.lastRow&&c.push("last_row");var f=lh.previews[t],p=null;f.label&&(p=d.default.wrap(f.label));var h=this.getCached(e.id,n.src);this.cachePhoto(e.id,n.src);var m=[{class:_?"VideoRestriction__thumb":"",inner:[{tag:"img",src:(h?h.src:n.src)||"/images/blank.gif",width:""+Math.round(s.width),height:""+Math.round(s.height),style:"margin-left: "+s.marginLeft+"px; margin-top: "+s.marginTop+"px;"}]},{class:"Thumb__overlay",inner:[!u&&{class:"Thumb__overlay-closeBtn",onclick:"ThumbsEdit.remove(null, "+t+")"},p]},{tag:"input",type:"hidden",name:"attach"+(t+1)+"_type",value:o},{tag:"input",type:"hidden",name:"attach"+(t+1),value:e.id.slice(o.length,e.id.length)}];if(l){var v,g=Math.min(Math.min((s.width-24)/2,30),Math.min((s.height-24)/2,30));lh.loaders[e.id]&&(v=lh.loaders[e.id]);var A=B_.init(v,g),b=A.component,w=A.id;lh.loaders[e.id]=w,m.push(b)}var y=["Thumb"];_&&(y.push("VideoRestriction"),y.push("VideoRestriction--onlyIcon"),e.orig.restriction.canPreview&&y.push("VideoRestriction--canPreview"),e.orig.restriction.needBlur&&y.push("VideoRestriction--blur"));var O=Object(r.ceFromString)(d.default.html({class:y.join(" "),style:"width: "+Math.round(i)+"px; height: "+Math.round(a)+"px",inner:m})),S=Object(r.ceFromString)(d.default.html({class:c.join(" "),style:"width: "+Math.round(i)+"px; height: "+Math.round(a)+"px","data-media":e.id,"data-index":t,"data-upload":f.upload}));if(lh.destroyLongpress=Object(Dp.onLongpress)(O,350,this.startDrag.bind(this,O)),addEvent(S,"click",this.showPopup.bind(this)),_){var k=d.default.html(ch({canPreview:e.orig.restriction.canPreview,iconFilename:e.orig.restriction.icon,title:e.orig.restriction.title}));O.appendChild(Object(r.ceFromString)(k))}return S.appendChild(O),S},addTempPreview:function(e){var t;if(lh.attachEl){var n=this.parsePreviews([e]);(t=lh.previews).push.apply(t,n),this.draw()}},replaceTemp:function(e,t,n,i){void 0===i&&(i={});var a=lh.previews.findIndex((function(t){return t.ownerId===e})),r=lh.previews[a],o=t.split("_").ownerId,s=t.split("_").itemId;r.ownerId=o,r.owner_id=o,r.itemId=s,r.temp=!1,r.upload=e,r.list=n,r.photo.sizes=i,r.photo.id="photo"+t,r.photo.pid=s,r.data=r.photo,B_.ready(lh.loaders["phototemp_"+e]),this.draw()},onUploadProgress:function(e,t){B_.update(lh.loaders["phototemp_"+e],t)},preventScroll:function(e){preventEvent(e)},startDrag:function(e,t){if(addEvent(window,"touchmove",this.preventScroll),e.classList.contains("Thumb")&&!e.classList.contains("Thumb--moving")){window.navigator.vibrate&&navigator.vibrate(50),Object(r.setStyle)(document.body,"overflow","hidden"),Object(r.setStyle)(document.body,"max-height","100%"),Object(r.setStyle)(document.body,"user-select","none");var n=this.onDrag.bind(this),i=this.onDrop.bind(this);addEvent(window,"mousemove touchmove",n),addEvent(window,"mouseup touchend touchcancel",i),statlogsValueEvent("mvk_thumb_edit_interaction",""),lh.drag=Object(B.default)({},lh.drag,{curEl:e,curIndex:e.parentNode.dataset.index,dragListener:n,dropListener:i});var a=e.offsetWidth>=40&&e.offsetHeight>=80,o=e.parentNode.parentNode,s=$("img",e),c=intval(e.parentNode.getAttribute("data-index")),l=lh.thumbs[c],u=getXY(o),d=getXY(e.parentNode),_=this.getCoords(o,u);lh.drag.id=o.id,lh.drag.i=c,lh.drag.toIndex=c,lh.drag.x=(t.pageX||t.detail.pageX)-d[0],lh.drag.y=(t.pageY||t.detail.pageY)-d[1],lh.drag.t=l,lh.drag.w=l.width,lh.drag.h=l.height,lh.drag.pos=d,lh.drag.wpos=u,lh.drag.crop=qp(l,l.width,l.height),lh.drag.coords=_,lh.drag.needScale=a;var f=a?function(e,t,n,i){n=intval(n),i=intval(i)||n;var a=e,r=t;return e>=t&&e>n?(a=intval(n),r=intval(t/(e/n))):e<t&&t>i&&(r=intval(i),a=intval(e/(t/i))),[a,r]}(l.width,l.height,.9*e.offsetWidth,.9*e.offsetHeight):[l.width,l.height],p=f[0],h=f[1],m=intval((l.width-p)*(browser.android?.5:lh.drag.x/l.width)),v=intval((l.height-h)*(browser.android?.5:lh.drag.y/l.height));addClass(e,"Thumb--moving"),Object(r.setStyle)(e,{zIndex:100}),Object(r.setStyle)(e.parentNode,{zIndex:100});var g=qp(l,p,h);Object(r.setStyle)(e,{opacity:.75,width:p,height:h,marginLeft:m,marginTop:v}),s&&Object(r.setStyle)(s,g),lh.drag.state=!0}},onDrag:function(e){var t=lh.drag.curEl;if(e.touches&&e.touches.length>1)return this.drop();var n=this._getClickCoord(e),i=n.x,a=n.y,o=lh.drag,s=i-(o.pos[0]+o.x),c=a-(o.pos[1]+o.y);r.setStyle.transform(t,1,[s,c]);var l=o.wpos;s=o.pos[0]+intval(t.style.marginLeft)+s-l[0],c=o.pos[1]+intval(t.style.marginTop)+c-l[1];var u=s,d=c,_=(t.offsetWidth,t.offsetHeight,o.i),f=!1,p=o.i,h=-1,m=window.innerWidth>=480?6:3,v={};if(o.coords.forEach((function(e,t){if(t!==o.i&&t!==h){e.offsetX=e.node.offsetWidth+m,e.offsetY=e.node.offsetHeight+m;var n=o.coords[t-1],i=o.coords[t+1],a=u+o.x,s=d+o.y,c=e.x+e.offsetX/2,l=e.y+e.offsetY/2,g=e.x+e.offsetX,A=e.y+e.offsetY,b=(n&&n.x===e.x&&n.y!=e.y&&0!=e.y||i&&i.x===e.x&&i.y!=e.y)&&0!=e.x,w=a>=c&&(i&&(a<=i.x+i.offsetX/2&&(i.offsetY===e.offsetY||a<g)||i.y!=e.y)||!i&&u<=g)&&s>e.y&&s<A,y=a<c&&a>=e.x&&(!n||n.y!=e.y&&!(n.x===e.x&&!i))&&s>e.y&&s<A,O=b&&s>=l&&s<A&&a>e.x&&a<g,S=b&&s<l&&s>=e.y&&a>e.x&&a<g;w=w&&!b,y=y&&!b&&!w,(w||y||O||S)&&(f=!0,p=e.index<o.i&&(w||O)?e.index+1:_<e.index&&(S||y)?e.index-1:e.index),p!==o.i?(r.setStyle.transform(e.node,1,[w?-5:y?5:0,O?-5:S?5:0]),w?(v.side="right",v.toIndex=e.index):y&&(v.side="left"),O?(v.side="down",v.toIndex=e.index):S&&(v.side="up")):r.setStyle.transform(e.node,1,[0,0]),w&&i&&i.y===e.y&&i.x>e.x&&_>e.index&&(r.setStyle.transform(e.node,1,[0,0]),r.setStyle.transform(e.node,1,[0,0]),r.setStyle.transform(i.node,1,[5,0]),h=t+1,v.side="left",v.toIndex=p),O&&i&&i.x===e.x&&i.y>e.y&&s<=l&&(r.setStyle.transform(i.node,1,[0,0]),h=t+1),S&&n&&n.x===e.x&&n.y<e.y&&s<=l&&(r.setStyle.transform(n.node,1,[0,-5]),r.setStyle.transform(e.node,1,[0,0]),v.side="down",v.toIndex=n.index),p===t&&"number"!=typeof v.toIndex&&(v.toIndex=e.index)}})),v&&(!o.split||o.split.toIndex!==v.toIndex||o.split.side!==v.side)){var g=ge("ThumbsEdit-splitter");if(Object(r.setStyle)(g,{opacity:0}),o.split=v,"number"==typeof v.toIndex){var A=o.coords[v.toIndex].node,b=3===m;"left"===o.split.side&&Object(r.setStyle)(g,{left:Math.max(0,A.offsetLeft-(b?0:1)),top:A.offsetTop+8,height:A.offsetHeight-16,width:"2px",opacity:1}),"right"===o.split.side&&Object(r.setStyle)(g,{left:Math.min(A.offsetLeft+A.offsetWidth-(b?2:1),lh.options.width-2),top:A.offsetTop+8,height:A.offsetHeight-16,width:"2px",opacity:1}),"up"===o.split.side&&Object(r.setStyle)(g,{left:A.offsetLeft+8,top:A.offsetTop,height:"2px",width:A.offsetWidth-16,opacity:1}),"down"===o.split.side&&Object(r.setStyle)(g,{left:A.offsetLeft+8,top:A.offsetTop+A.offsetHeight-1,height:"2px",width:A.offsetWidth-16,opacity:1})}}return o.toIndex=f?p:o.i,cancelEvent(e)},onDrop:function(e){var t=lh.drag;t.state=!1,t.updating=!0;var n=t.curEl,i=$("img",n),a="touchcancel".split(" ").includes(e.type);if(removeEvent(window,"mousemove touchmove",t.dragListener),removeEvent(window,"mouseup touchend touchcancel",t.dropListener),removeEvent(window,"touchmove",this.preventScroll),document.body.contains(t.curEl)){if(Object(r.setStyle)(document.body,"overflow",null),Object(r.setStyle)(document.body,"max-height",null),Object(r.setStyle)(document.body,"user-select",null),r.setStyle.transform(n.parentNode,1,[0,0]),t.split)delete t.split,ge("ThumbsEdit-splitter").removeAttribute("style");if(!hasClass(n,"Thumb--moving"))return t.updating=!1,cancelEvent(e);if(a){var o=t.coords[t.toIndex].node;r.setStyle.transform(o,1,[0,0])}if(t.toIndex===t.i||a){var s=t.crop;r.setStyle.animate(n,"transform, margin-top, margin-left, width, height, opacity",{duration:"100ms"},(function(){removeClass(n,"Thumb--moving")})),r.setStyle.animate(i,"transform, margin-top, margin-left, width, height, opacity",{duration:"100ms"});var c=lh.thumbs[t.i];r.setStyle.transform(n,1,[0,0]),Object(r.setStyle)(n,{"margin-top":0,"margin-left":0,width:c.width,height:c.height,opacity:1,zIndex:null}),Object(r.setStyle)(n.parentNode,{zIndex:null}),i&&Object(r.setStyle)(i,s)}else{var l=lh.previews;l=function(e,t,n){if(n>=e.length)for(var i=n-e.length;1+i--;)e.push(void 0);return e.splice(n,0,e.splice(t,1)[0]),e}(l,t.i,t.toIndex),this.update(t.id,l)}return cancelEvent(e)}},getCoords:function(e,t){var n=[];t=t||getXY(e);var i=Array.from(e.childNodes||[]);return[].concat(i).forEach((function(e,i){var a=getXY(e);n[i]={id:e.getAttribute("data-media"),x:intval(a[0]-t[0]),y:intval(a[1]-t[1]),width:intval(e.offsetWidth),height:intval(e.offsetHeight),index:intval(e.getAttribute("data-index")),node:e}})),n},remove:function(e,t){var n=lh.previews[t];e&&Ln.default.close(e.target),mediaUpload.reset(null,null,n.remove,(function(){lh.previews=lh.previews.filter((function(e,n){return n!==t})),ThumbsEdit.draw()}))},showPopup:function(e){var t=e.target;if(!lh.drag.state&&!t.classList.contains("Thumb--moving")&&!t.classList.contains("Thumb__overlay-closeBtn")){e.cancelable&&cancelEvent(e);var n=t.closest(".Thumb-wrap").getAttribute("data-index"),i=Object(r.ceFromString)(d.default.html(this.getPopup(n)));ae.default.open(i,!0)}},getPopup:function(e){var t=lh.previews[e],n=null;switch(t.type){case"doc":t.is_gif&&(n='\n            Gif.openPopup(null, null, {\n              raw: "'+t.doc.id.slice(3,t.doc.id.length)+'",\n              hasVideo: '+Gif.isMp4Supports()+"\n            });\n            Popup.close(this);\n          ");break;case"photo":n='\n          photo.zopen(null, null, "'+t.data.id.slice(5,t.data.id.length)+'", "'+t.list+'", {\n            hideOverlay: true,\n            single: true,\n          });\n          Popup.close(this);\n        '}var i=Object(ae.ModalMenuBtn)({inner:getLang("mobile_delete"),onclick:"ThumbsEdit.remove(event, "+e+")"}),a=null;return n&&!t.temp&&(a=Object(ae.ModalMenuBtn)({inner:getLang("mobile_open"),onclick:""+n})),Object(ae.default)({class:"ThumbsEdit__modal",close:!0,items:[a,i]})},_getClickCoord:function(e){return{x:e.touches?e.touches[0].pageX:e.pageX,y:e.touches?e.touches[0].pageY:e.pageY}},cachePhoto:function(e,t,n){var i=ce("img");if(i.src=t,lh.cachedPhoto[e]){var a=lh.cachedPhoto[e].find((function(e){return e.src===t}));a?n&&n(a.src):i.onload=function(){lh.cachedPhoto[e].push({width:i.width,height:i.height,src:t}),lh.cachedPhoto[e].sort((function(e,t){return e.width>t.width?-1:e.width<t.width?1:0})),n&&n(t)}}else lh.cachedPhoto[e]=[]},updatePhotos:function(){var e=this;lh.thumbs.forEach((function(t){var n=$("[data-media="+t.id+"] img");n.src!==t.image.src&&e.cachePhoto(t.id,t.image.src,(function(e){n.src=e}))}))},getCached:function(e,t){var n=ce("img");return n.src=t,n.complete?t:lh.cachedPhoto[e]&&0!==lh.cachedPhoto[e].length?lh.cachedPhoto[e].find((function(e){var t=e.src,n=ce("img");return n.src=t,n.complete})):null},getThumbsCount:function(){return(lh.thumbs||[]).length},updateIds:function(){var e=$$(".mr_x_wrap"),t=this.getThumbsCount()+1;e.forEach((function(e,n){var i=$$("input",e),a=t+n;i[0].name="attach"+a+"_type",i[1].name="attach"+a}))}};n("WCKs"),n("XLP4");onDOMReady(uh),window.page&&page.onChange(uh);function uh(){window.pushNotifier&&pushNotifier.canBeEnabled().then((function(e){return e&&PushNotifier.getPermission()===mp.PUSH_NOTIFIER_PERMISSION_DEFAULT})).then((function(e){if(e){FeedNotifications.addWebActionAcceptHandler("enable_browser_notifications",dh),FeedNotifications.addWebActionDeclineHandler("enable_browser_notifications",_h);var t=geByClass1("feedAssistance_pushNotificationsSwitch");if(!t)return;FeedAssistanceStats.registerTrackingCls("feedAssistance_pushNotificationsSwitch"),FeedAssistanceStats.register(t,"feed")}}))}function dh(e){return pushNotifier.requestPermission().then((function(t){var n,i=!0;return unlockButton(e),t===mp.PUSH_NOTIFIER_PERMISSION_DEFAULT?i=!1:(n=t===mp.PUSH_NOTIFIER_PERMISSION_GRANTED?FeedAssistanceStats.EVENTS.SUB_EVENT_ENABLE_PUSH:FeedAssistanceStats.EVENTS.SUB_EVENT_DECLINE_PUSH,ph(e,n),fh(),i)}),(function(){return _h(e)}))}function _h(e){return unlockButton(e),ph(e,FeedAssistanceStats.EVENTS.SUB_EVENT_DECLINE_PUSH),fh(),!0}function fh(){var e=geByClass1("feedAssistance_pushNotificationsSwitch");remove(e)}function ph(e,t){FeedAssistanceStats.dispatchEvent({type:FeedAssistanceStats.EVENTS.EVENT_FEED_ASSISTANCE,data:FeedAssistanceStats.serializeEventData(FeedAssistanceStats.EVENTS.EVENT_FEED_ASSISTANCE,e,"m_push_switch",t)})}window.closePostSuggest=function(e,t){return suggestionEvent(e,t,!1),stopEvent(t)},window.suggestionEvent=function(e,t,n){void 0===n&&(n=!1);var i=Object(r.geByClass1)("post_suggest");return ajax.post("wall.php",{_ajax:1,act:"suggestion_event",event_type:e,suggest_id:i.getAttribute("data-suggest-id"),not_hide_by_click:intval(n)}),n||Object(r.re)(i),stopEvent(t)};n("zRDV");var hh=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),a=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,a++)i[a]=r[o];return i},mh=function(){function e(e,t){this.sendLogsTimeout=null,this.sendLogsProcess=!1,this.localStorageKey="recommended_groups",this.logsDataDelimiter="|",this.location=e,this.act=t}return e.prototype.sendLogs=function(){this.sendLogsTimeout&&clearTimeout(this.sendLogsTimeout),this.sendLogsTimeout=setTimeout(this.sendLogsAccept.bind(this),1e4)},e.prototype.sendLogsAccept=function(){var e=this;if(!this.sendLogsProcess){var t=this.getLogs(!0);t.length&&(this.sendLogsProcess=!0,this.clearLogs(),window.ajax.post(this.location,{act:this.act,logs:t},{onDone:function(){e.sendLogsProcess=!1},onFail:function(){return e.restoreLogs(t),e.sendLogsProcess=!1,!0}}))}},e.prototype.restoreLogs=function(e){var t=this,n=this.getLogs(),i=e.map((function(e){return e.split(t.logsDataDelimiter)})),a=hh(i,n);oi.default.set(this.localStorageKey,a)},e.prototype.getLogs=function(e){var t=this,n=oi.default.get(this.localStorageKey)||[];return e&&(n=n.map((function(e){return e.join(t.logsDataDelimiter)}))),n},e.prototype.addLog=function(e){var t=this.getLogs(),n=e.eventType,i=e.trackCode,a=e.groupId,r=a?[n,i,a]:[n,i];t.push(r),oi.default.set(this.localStorageKey,t),this.sendLogs()},e.prototype.clearLogs=function(){oi.default.remove(this.localStorageKey)},e}(),vh=function(){function e(){this.onScroll=Object(r.throttle)(this.onScroll,50)}return e.prototype.init=function(){this.gallery=document.querySelector(".groupsRecommendedSlider"),this.sliderSizes=null,this.allLoaded=!1,this.ajaxIsRunning=!1,this.gallery&&(this.block=document.querySelector(".GroupsRecommendedSlider"),this.sliderScrollNode=this.gallery.querySelector(".Slider__scroll"),this.sliderLineNode=this.gallery.querySelector(".Slider__line"),this.eventLog=new mh("/groups","stats"))},e.prototype.subscribe=function(e,t,n){var i=e.closest(".prettyCard").dataset,a=i.groupId,o=i.trackCode;if(a&&o&&!e.classList.contains("prettyCard__button_accepted"))return this.eventLog.addLog({eventType:"group_subscribed",groupId:a,trackCode:o}),window.ajax.post("/groups",{act:"subscribe_from_recomm_groups",hash:t,oid:-a,track_code:o},{onDone:function(t){e.classList.add("prettyCard__button_accepted"),e.innerHTML=t,e.onclick=null},onFail:function(){return!1},showProgress:function(){Object(r.lockButton)(e),e.classList.add("prettyCard__button_loading")},hideProgress:function(){Object(r.unlockButton)(e),e.classList.remove("prettyCard__button_loading")}}),n&&Object(r.cancelEvent)(n);Object(r.cancelEvent)(n)},e.prototype.closeGroup=function(e,t,n){var i=e.closest(".prettyCard"),a=i.dataset,o=a.groupId,s=a.trackCode;if(o&&s)return this.eventLog.addLog({eventType:"group_hidden",groupId:o,trackCode:s}),Object(r.remove)(i),this.slides=null,window.ajax.post("/groups",{act:"hide_recomm_groups_block_group",hash:t,track_code:s,group_id:o}),n&&Object(r.cancelEvent)(n)},e.prototype.hideBlock=function(){var e=Object(r.domData)(this.sliderScrollNode,"code")||"";this.eventLog.addLog({eventType:"block_hidden",trackCode:e}),Object(r.remove)(this.block)},e.prototype.clickOnGroup=function(e){var t=e.dataset,n=t.groupId,i=t.trackCode;n&&i&&this.eventLog.addLog({trackCode:i,groupId:n,eventType:"group_opened"})},e.prototype.clickOnViewAll=function(){var e=Object(r.domData)(this.sliderScrollNode,"code")||"";e&&this.eventLog.addLog({trackCode:e,eventType:"block_expanded"})},e.prototype.viewBlock=function(e){this.eventLog.addLog({trackCode:e,eventType:"block_seen"})},e.prototype.onScroll=function(){if(this.gallery&&this.sliderScrollNode){var e=this.getScrollSizeValues();if(!this.ajaxIsRunning&&e){var t=this.sliderScrollNode.scrollLeft,n=Math.max(0,Math.floor((t-e.leftMargin)/e.itemWidth)),i=Math.max(0,Math.floor((t+e.width-e.leftMargin)/e.itemWidth));n*e.itemWidth+e.itemWidth-e.part<t&&n++,i*e.itemWidth+e.part>t+e.width&&i--;var a=this.getSlides();if(a){n=Math.max(0,n),i=Math.min(a.length,i);for(var o=n;o<=i;o++){var s=a[o];if(s&&!s.viewed){s.viewed=!0;var c=s.dataset,l=c.groupId;(d=c.trackCode)&&l&&this.eventLog.addLog({trackCode:d,groupId:l,eventType:"group_seen"})}}if(!this.allLoaded&&t+e.width>=e.scrollWidth/2){var u=Object(r.domData)(this.sliderScrollNode,"next")||"",d=Object(r.domData)(this.sliderScrollNode,"code")||"";if(!u)return void(this.allLoaded=!0);this.ajaxIsRunning=!0;var _=this;window.ajax.post("/groups",{act:"recommended_carousel",next:u,track_code:d},{onDone:function(e,t){if(e){var n=window.cdf(e);Object(r.append)(n,_.sliderLineNode),_.sliderSizes=null,_.slides=null}Object(r.domData)(_.sliderScrollNode,"next",t||null),_.allLoaded=!t,_.ajaxIsRunning=!1},onFail:function(){return setTimeout((function(){return _.ajaxIsRunning=!1}),500),!1}})}}}}},e.prototype.getScrollSizeValues=function(){var e;if(this.sliderSizes)return this.sliderSizes;var t=this.getSlides(),n=Object(r.getSize)(this.sliderScrollNode)[0],i=Object(r.getX)(this.sliderScrollNode),a=Object(r.getX)(t[0])-i,o=Object(r.getSize)(t[0])[0],s={width:n,itemWidth:o+(Object(r.getX)(t[1])-i-a-o),leftMargin:a,part:Math.floor(o/3),scrollWidth:null===(e=this.sliderScrollNode)||void 0===e?void 0:e.scrollWidth};return this.sliderSizes=s,this.sliderSizes},e.prototype.getSlides=function(){var e;return this.slides||(this.slides=null===(e=this.gallery)||void 0===e?void 0:e.querySelectorAll(".prettyCard")),this.slides},e}();window.RecommendedGroupsSlider=new vh;n("mPGc"),n("STl5");function gh(e,t){return void 0===e&&(e=""),void 0===t&&(t=[]),!!t.find((function(t){return"*"===t[t.length-1]?e.startsWith(t.slice(0,t.length-1)):e===t}))}var Ah,bh=["/restore","/login","/authorize*","/join*","/","/settings","/album*","/terms","/privacy","/payments*","/attachments*","/page*","/blog*","/about","/privacy","/jobs","/dev","/legal","/data_protection","/safety","/activation*","/licence","/agelimits"];function wh(){Ah&&Ah.classList.remove(Xa.class.open)}function yh(){Ah&&Ah.classList.add(Xa.class.open)}onDOMReady((function(){!function e(t,n){void 0===n&&(n=!0),Object(r.isIosWebView)()||Object(r.isAndroidWebView)()||Object(r.isVkWebView)()||(n||(Ah=Object(r.geByClass1)(Xa.class.btn),window.page.onChange(e.bind(this))),t=t?t.split("?")[0]:nav.path,!/^\/photo/.test(t)&&wh(),gh(t,bh)||nav.getQuery("z")?(wh(),setTimeout(wh)):yh())}(null,!1)}));var Oh={_onCloseClick:function(e){Xa._onCloseClick(e),Object(Nn.setCookie)("remixregbtn",0,0)},show:yh,hide:wh};window.uRegisterFloatBtn=Oh;var Sh,kh=["/restore","/login","/join*","/","/settings","/album*","/terms","/privacy","/payments*","/attachments*","/pages*","/blog*","/about","/privacy","/jobs","/dev","/legal","/data_protection","/safety","/activation*","/licence","/agelimits"];function Ch(){Sh&&Sh.classList.remove(Xa.class.open)}function jh(){Sh&&Sh.classList.add(Xa.class.open)}onDOMReady((function(){!function e(t,n){void 0===n&&(n=!0),n||(Sh=Object(r.geByClass1)(Xa.class.btn),window.page.onChange(e.bind(this))),t=t?t.split("?")[0]:he.default.path,!/^\/photo/.test(t)&&Ch(),gh(t,kh)||he.default.getQuery("z")?Ch():jh()}(null,!1)}));var Eh={_onCloseClick:function(e){Xa._onCloseClick(e)},show:jh,hide:Ch,processOpenInNativeApp:function(e,t,n,i,a){void 0===a&&(a={}),a=a||{},he.default.onMenuItemClick(n),he.default.openInNativeApp(i,t,e),Object(r.statlogsValueEvent)("utm_open_in_native_app_button","clicked",a.utm_source,a.utm_param,a.utm_medium,a.utm_time)}};window.uOpenInNativeAppFloatBtn=Eh;var Th=n("7E7W"),Ih=n("6Ysw");var Mh=function(e){return void 0===e&&(e={}),{inner:[{inner:[Object(R.default)({icon:Object(Th.getCancelOutline24Icon)()})],class:"Covid19Banner__close",role:"button","aria-label":e.aria_label_close,onClick:["Covid19Banner.close","event","this"],tag:"div"},{inner:[{inner:[Object(R.default)({icon:Object(Ih.getCovid1964Icon)()})],class:"Covid19Banner__icon",tag:"div"},{inner:[{inner:[e.title],class:"Covid19Banner__title",tag:"h4"},{inner:[e.text,{inner:[e.more],class:"Covid19Banner__link",href:e.url,onClick:"event.preventDefault()",tag:"a"}],class:"Covid19Banner__text",tag:"p"}],class:"Covid19Banner__content",tag:"div"}],class:"Covid19Banner__wrapper",tag:"div"}],class:"Covid19Banner",role:"complementary",onClick:["Covid19Banner.open","event",e.url,e.statlogsEventOpen],tag:"div"}};function Ph(){Object(r.throttle)(Dh,66)()}function Dh(){var e=Object(F.$)(".Covid19Banner__offset");if(e){var t=Object(F.$)(".Covid19Banner").clientHeight;e.style.height=t+"px"}}onDOMReady((function(){!function(){var e=Object(F.$)(".Covid19Banner");if(e){var t=Object(F.$)(".layout"),n=e.clientHeight,i=(a=n,(r=document.createElement("div")).classList.add("Covid19Banner__offset"),r.style.height=a+"px",r);t.appendChild(i)}var a,r}(),window.addEventListener("resize",Ph)}));window.Covid19Banner=Mh,Object(r.extend)(Mh,{open:function(e,t,n){e.preventDefault(),e.stopPropagation(),Object(r.statlogsValueEvent)(n),nav.hard_go(t)},close:function(e,t){var n;e.preventDefault(),e.stopPropagation(),L.default.post("/stats?act=covid_19_banner_close"),t.parentElement.remove(),n=Object(F.$)(".Covid19Banner__offset"),window.removeEventListener("resize",Ph),n.remove()}});window.ProfileImageModal={open:function(e,t,n,i,a){var o=Object(ie.default)({id:"profile-photo-modal",close:!0,on_overlay_click:"ProfileImageModal.closeModal(this);",items:[Object(ae.ModalMenuBtn)({"aria-label":Object(J.getLang)("mobile_profile_photo_modal_album"),inner:Object(J.getLang)("mobile_profile_photo_modal_album"),onclick:"ProfileImageModal.openAlbum('"+decodeURIComponent(e)+"');"}),Object(ae.ModalMenuBtn)({"aria-label":Object(J.getLang)("mobile_profile_photo_modal_change"),class:"ModalMenu__btn_overflow",inner:[{tag:"input",type:"file",class:"inline_upload","data-upload-url":decodeURIComponent(t),"data-static-url":decodeURIComponent(i),"data-base-url":decodeURIComponent(n),onclick:"ownerPhotoUpload.prepareInput(this);",onchange:"return ownerPhotoUpload.start(this, event);",accept:decodeURIComponent(a)},Object(J.getLang)("mobile_profile_photo_modal_change")],onclick:"ProfileImageModal.selectImage(this);"})]});ie.default.open(d.default.elem(o),!0),Object(r.statlogsValueEvent)("mvk_profile_image_modal","open");var c=Object(F.$)(".profile_photo_modal_expand");Object(s.expandPopup)(c).exitIntent=function(){Object(r.statlogsValueEvent)("mvk_profile_image_modal","close"),ie.default.close()}},openAlbum:function(e){Object(r.statlogsValueEvent)("mvk_profile_image_modal","album"),ie.default.close(),nav.go(e)},selectImage:function(e){Object(r.statlogsValueEvent)("mvk_profile_image_modal","upload"),ie.default.close(),Object(F.$)(".inline_upload",e).click()},closeModal:function(e){Object(r.statlogsValueEvent)("mvk_profile_image_modal","close"),ie.default.close(e)}};var xh=Object(r.need)("page"),Lh=Object(r.need)("audio"),Bh=Object(r.need)("onDOMReady"),Rh=Object(r.need)("audioplayer"),Nh=Object(r.need)("AudioSpecialForYou");function Fh(){Uh(),Lh.subscribe([Lh.events.INIT,Lh.events.SELECT,Lh.events.PAUSE],Uh),xh.onChange(Uh)}function Hh(e){var t=e.$btn;Wh()?Rh.playPause():Rh.playFirst(null,t),Rh.onPlay(Uh),Rh.onPause(Uh)}function Uh(){Nh.setPlaying(Lh.playing()&&Wh())}window.uAudioBlock={},Bh(Fh),window.uAudioBlock._onSpecialPlayAllClick=Hh;var Vh=null;function Wh(){var e=Lh.getCurrentPlaylistId();if(!Vh){var t=document.querySelector(window.AudioSpecialForYou.selector);t&&(Vh=t.querySelector(".AudioPlaylistRoot").dataset.playlistId)}return!!Vh&&e===Vh}var $h=n("9jiJ"),qh={_onMorePopupClose:function(e){return this.expand&&this.expand(),ie.default.close(e)},morePopup:function(e,t){var n=parseInt(Object(r.attr)(t,"data-owner_id"),10),i=parseInt(Object(r.attr)(t,"data-playlist_id"),10),a=Object(r.attr)(t,"data-publish_href"),o="1"===Object(r.attr)(t,"data-is_followed"),c=Object(r.attr)(t,"data-follow_hash"),l=Object(r.attr)(t,"data-can_share"),u=c?"/audio?act=follow_playlist&playlist_owner_id="+n+"&playlist_id="+i+"&hash="+c:"";ie.default.open(d.default.elem(Object(ie.default)({id:"more-"+n+"-"+i,on_overlay_click:["return AudioPlaylist._onMorePopupClose","this"],close:!0,onClose:["return AudioPlaylist._onMorePopupClose","this"],items:[c&&n!==window.vk.id&&Object(ie.ModalMenuBtn)({url:u,class:o?" audioPlaylist__add_added":"",inner:[{inner:o?Object(J.getLang)("mobile_playlist_unfollow"):Object(J.getLang)("mobile_playlist_follow"),tag:"span",class:"audioPlaylistSnippet__buttonText"}],attrs:{"data-playlist_owner_id":n,"data-playlist_id":i,"data-hash":c,"data-follow_text":Object(J.getLang)("mobile_playlist_follow"),"data-unfollow_text":Object(J.getLang)("mobile_playlist_unfollow")},onclick:"return AudioPlaylist.followPlaylist(event, this);"}),l&&Object(ie.ModalMenuBtn)({url:a,inner:Object(J.getLang)("mobile_like_publish_title"),onclick:'return AudioPlaylist._onMorePopupClose(this) || nav.go("'+a+'");'})]})),!0),this.expand=Object(s.expandPopup)(e.target)},playPause:function(e,t){Object(r.preventEvent)(e);var n=Object(r.gpeByClass)("_audioSnippet",t),i=Object(r.geByClass1)("audio_item",n);window.audioplayer.playPause(e,Object(r.attr)(i,"data-id")),Object(r.toggleClass)("audioSnippet__playpause_paused",t)},followPlaylist:function(e,t){Object(r.preventEvent)(e);var n=Object(r.attr)(t,"data-playlist_owner_id"),i=Object(r.attr)(t,"data-playlist_id"),a=Object(r.attr)(t,"data-hash"),o=Object(r.geByClass1)("_audioPlaylistsPage__item"+n+"_"+i),s=t.querySelector(".audioPlaylistSnippet__buttonText"),c=Object(r.hasClass)("audioPlaylist__add_added",t);s&&(s.innerText=c?Object(r.attr)(t,"data-follow_text"):Object(r.attr)(t,"data-unfollow_text")),Object(r.toggleClass)("audioPlaylistsPage__item_removed",o,c),Object(r.toggleClass)("audioPlaylist__add_added",t),function(e){L.default.post("/audio",{_ajax:1,act:"follow_playlist",playlist_owner_id:Object(r.attr)(e,"data-playlist_owner_id"),playlist_id:Object(r.attr)(e,"data-playlist_id"),hash:Object(r.attr)(e,"data-hash")},{redirectToLoginPage:!0})}(t);for(var l=document.querySelectorAll('button[data-owner_id="'+n+'"][data-playlist_id="'+i+'"][data-follow_hash="'+a+'"]'),u=0;u<l.length;u++)Object(r.attr)(l[u],"data-is_followed",c?"false":"true")},tplSearchBlockItem:function(e){return'<div class="audioPlaylists__item">\n              <a href="'+e.href+'" class="audioPlaylists__itemLink al_playlist">'+e.title+'</a>\n              <span class="audioPlaylists__itemCover" style="'+e.thumb_style+'">'+e.grid_covers+'</span>\n              <span class="audioPlaylists__itemTitle">'+e.title+'</span>\n              <span class="audioPlaylists__itemAuthor">'+e.author_name+'</span>\n              <span class="audioPlaylists__itemStats">'+e.short_stats+"</span>\n            </div>"},tplSearchBlock:function(e,t,n,i){return e?'<div class="audioPlaylists">\n                <div class="audioPlaylists__header">\n                  <div class="audioPlaylists__cell">\n                    <div class="audioPlaylists__title">'+n+'</div>\n                  </div>\n                  <div class="audioPlaylists__cell">'+i+'</div>\n                </div>\n                <div class="audioPlaylists__body _preventMenuOpen">\n                  <div class="audioPlaylists__items">\n                    '+e+"\n                  </div>\n                </div>\n              </div>":""},tplSearchListItem:function(e,t){void 0===t&&(t=!1);var n='<div class="audioPlaylistsPage__cell audioPlaylistsPage__cell_actions">\n                <div class="audioPlaylistsPage__menu ai_menu_wrap">\n                  <button class="ai_menu_toggle_button" onclick="AudioPlaylist.morePopup(event, this);" data-owner_id="'+e.owner_id+'" data-playlist_id="'+e.id+'" data-publish_href="'+e.publish_href+'" data-is_followed="'+e.is_followed+'" data-follow_hash="'+e.follow_hash+'" aria-label="'+Object(J.getLang)("mobile_more")+'" aria-haspopup="true" aria-expanded="false" aria-controls="more-'+e.owner_id+"-"+e.id+'"></button>\n                </div>\n             </div>\n             '+e.actions;t&&(n='<div class="audioPlaylistsPage__cell audioPlaylistsPage__cell_actions">\n                   <div class="audioPlaylistsPage__menu ai_menu_wrap">\n                     <button class="ai_menu_toggle_button"></button>\n                   </div>\n                 </div>');var i=e.grid_covers;return i||e.thumb_style||(i=d.default.html({class:"audioPlaylistsPage__coverPlaceholder",inner:Object(R.default)(Object($h.getPlaylistOutline36Icon)())})),'<div class="audioPlaylistsPage__item _audioPlaylistsPage__item'+e.owner_id+"_"+e.id+'">\n              <div class="audioPlaylistsPage__cell audioPlaylistsPage__cell_link">\n                <a href="'+e.href+'" class="audioPlaylistsPage__itemLink">'+e.title+'</a>\n                <span class="audioPlaylistsPage__container">\n                  <span class="audioPlaylistsPage__cell audioPlaylistsPage__cell_cover">\n                    <span class="audioPlaylistsPage__cover" style="'+e.thumb_style+'">'+i+'</span>\n                  </span>\n                  <span class="audioPlaylistsPage__cell audioPlaylistsPage__cell_desc">\n                    <span class="audioPlaylistsPage__title">'+e.title+'</span>\n                    <span class="audioPlaylistsPage__author">'+e.author_name+'</span>\n                    <span class="audioPlaylistsPage__stats">'+e.short_stats+"</span>\n                  </span>\n                </span>\n              </div>\n              "+n+"\n            </div>"},tplSearchListNull:function(e){return'<div class="audioPlaylistsPage__notFound">\n              '+e+"\n            </div>"},tplPlaylistsPage:function(e,t){return void 0===t&&(t=""),'<div class="PageBlock">\n              <div class="audioPlaylistsPage">\n                <div class="audioPage__search">\n                  '+t+'\n                </div>\n                <div class="audioPlaylistsPage__list _si_container" id="au_search_playlist_items">\n                  '+e+"\n                </div>\n              </div>\n            </div>"},tplPlayerSearch:function(e,t){void 0===e&&(e=""),void 0===t&&(t=!1),Object(r.escapeAttr)(e),Object(J.getLang)("mobile_audio_search_btn");var n=function(e,t){return void 0===e&&(e=""),void 0===t&&(t=""),'<div class="audioPage__search">\n              <div class="hp_block">\n                '+e+'\n                <div class="qsearch">\n                  <table class="row_table">\n                    <tr>\n                      <td class="row_table_main_column">\n                        <div class="qs_field_wrap">\n                          <div class="iwrap">\n                            <input id="au_search_field" type="text" class="textfield qs_textfield" name="q" placeholder="'+Object(J.getLang)("mobile_audio_search_placeholder_simple")+'">\n                          </div>\n                        </div>\n                      </td>\n                      <td class="row_table_last_column">\n                        '+t+"\n                      </td>\n                    </tr>\n                  </table>\n                </div>\n              </div>\n            </div>"};return t?n():function(e,t,n){return'<form action="/audio" class="qsearch" onsubmit="return cur.au_search.go(event);">'+e(t,n)+"</form>"}(n)},copyValue:function(e,t){var n=Object(r.val)(e),i=Object(r.ge)(t+"_field");Object(r.val)(i,n),cur&&cur[t]&&cur[t].go();var a=Object(r.geBySel1)(".audioPage__tabs .tab_item_cur");a&&Object(r.toggleClass)("tab_item_cur_noactive",a,n)}};window.AudioPlaylist=qh;n("eJy5");var zh=function(e){var t=e.tag,n=t.id===e.current_id?"control_radio_checked":"control_radio";return{href:t.href,class:"Bookmarks__tagsSelectItem",inner:[{class:"Bookmarks__tagsSelectItemTitle",inner:d.default.wrap(t.name)},d.default.wrap(Object(Ga.default)({icon:n}))]}};var Yh=zh;window.BookmarksFilterListItem=zh;var Gh=function(e){var t=!(!e.tags||!e.tags.length)&&e.tags;return{class:"Owner__tags",inner:t?[{class:"Owner__tags_icon Icon Icon_tagLabel"},t.map((function(e){return{class:"Owner__tag",inner:d.default.wrap(e.name)}}))]:null}};var Kh=Gh;window.BookmarksPageItem=Gh;var Qh=window.Popup,Xh=window.ActionMenu,Jh=window.attr,Zh=window.val,em=window.ajax,tm=window.replace,nm=window.scrollTop,am=window.ceFromString,rm=window.Btn;window.Bookmarks={hideTagsList:km,showTagsList:function(e,t){void 0===t&&(t=!1);e&&e.stopPropagation();var n=ym(om),i=Mm();if(n.classList.remove("BookmarksPopup__hideCorner"),t){var a=t.closest(hm),o=Pm(Jh(a,"id"));i=i.filter((function(e){return o.includes(e.id)})),n.classList.add("BookmarksPopup__hideCorner")}var s=Object(r.qs2obj)(nav.params),c=Object.keys(i).reduce((function(e,t){var n=i[t];return e.push(Yh({tag:n,current_id:parseInt(s.tag)})),e}),[]),l=d.default.html(c);Zh(n.$(".Popup__scrollContent"),l);var u=Object(F.$$)(_m,n);u&&u.forEach((function(e){Object(r.addEvent)(e,"click",km)}));return!1},hideDeletePopup:Cm,showDeletePopup:function(e){var t=ym(sm),n=Jh(e,"data-id"),i=Jh(e,"data-hash"),a=Jh(e,"data-name");return xm(t,{id:n,hash:i}),Zh(t.$("["+mm+"]"),Object(r.htsc)(a)),!1},submitDeleteTag:function(){var e=Lm(Array.from(Object(F.$$)(sm)).pop()),t=e.id,n=e.hash;em.post("/bookmarks",{_ajax:1,act:"tag_delete",id:t,hash:n},{onDone:function(e){wm(e),Cm()}})},hideCreatePopup:jm,showCreatePopup:function(e){var t=ym(cm),n=Jh(e,"data-hash");xm(t,{hash:n});var i=Object(F.$)("[name="+vm+"]",t),a=Object(F.$)(pm,t),r=Zh(i).trim();return rm.setDisabled(a,!r),!1},submitCreateTag:function(){var e=Array.from(Object(F.$$)(cm)).pop(),t=Array.from(Object(F.$$)(dm)).pop(),n=Lm(e).hash,i=Zh(e.$("[name="+vm+"]")),a=+!!Object(F.$)(dm);em.post("/bookmarks",{_ajax:1,act:"tag_edit",tag:i,hash:n,id:0,from_settings:a},{onDone:function(e,n){if(a){var i=[];Array.from(t.$$('[name="tag"][type="checkbox"]:checked')||[]).forEach((function(e){i.push(e.value)})),Zh(t,e),i.forEach((function(e){var n=t.$('[name="tag"][type="checkbox"][value="'+e+'"]');n&&(n.checked=!0)}))}else wm(e);!function(e){var t=Im(),n=e[0],i=e[1];t&&t.tags&&t.tags.push({id:n,name:i,order:0})}(n),jm()}})},hideEditPopup:Em,showEditPopup:function(e){var t=ym(lm),n=Jh(e,"data-id"),i=Jh(e,"data-hash"),a=Jh(e,"data-name")||"",r=t.$("[name="+gm+"]");Zh(r,a),xm(t,{id:n,hash:i,name:a});var o=Array.from(Object(F.$$)(pm,t)).pop(),s=Zh(r).trim();return rm.setDisabled(o,!s),!1},submitEditTag:function(){var e=Array.from(Object(F.$$)(lm)).pop(),t=Lm(e),n=t.id,i=t.hash,a=Zh(e.$("[name="+gm+"]"));em.post("/bookmarks",{_ajax:1,act:"tag_edit",tag:a,hash:i,id:n},{onDone:function(e){wm(e),Em()}})},hideSettingsPopup:Tm,showSettingsPopup:function(e,t){void 0===t&&(t={});var n,i,a,r=Jh(e,"data-item_id"),o=Jh(e,"data-item_oid"),s=Jh(e,"data-item_type"),c=Jh(e,"data-hash"),l=Jh(e,"data-raw");t.wrap||(n=ym(um),i=n.$(dm),a=Pm(l),Zh(i,d.default.html({class:"Bookmarks__tagsSettingsLoading"})),xm(n,{id:r,oid:o,type:s,hash:c,itemRaw:l}));return em.post("/bookmarks",{_ajax:1,act:"tag_settings",hash:c,item_id:r,item_oid:o,item_type:s,wrap:t.wrap?1:0},{onDone:function(e){if(t.wrap){var u=am(e);xm(u=ym(u),{id:r,oid:o,type:s,hash:c,itemRaw:l,needRemove:!0,is_from_snackbar:t.is_from_snackbar})}else Zh(i,e),a.forEach((function(e){var t=n.$('[name="tag"][type="checkbox"][value="'+e+'"]');t&&(t.checked=!0)}))}}),!1},submitSettingsTags:function(){var e=Array.from(Object(F.$$)(um)).pop(),t=Lm(e),n=t.id,i=t.oid,a=t.type,r=t.hash,o=t.itemRaw,s=t.is_from_snackbar,c=[];Array.from(e.$$('[name="tag"][type="checkbox"]:checked')||[]).forEach((function(e){c.push(e.value)}));var l=c.join(",");em.post("/bookmarks",{_ajax:1,act:"tag_set",hash:r,item_id:n,item_oid:i,item_type:a,tag_ids:l,is_from_snackbar:s},{onDone:function(e){Tm();var t=Object(F.$)("#"+o);if(t){var n=Object(F.$)(".BookmarkListItem__tags, .BookmarksItem__tag",t);if(n)Zh(n,e);else if(n=Object(F.$)(".Owner__tags",t)){var i=Mm(),a=c.map((function(e){return parseInt(e,10)})),r=i.filter((function(e){return a.includes(e.id)})),s=d.default.html(Kh({tags:r}));Zh(n.parentNode,s)}Nm(o,c,""),cur&&cur.search_bookmarks&&cur.search_bookmarks.redraw()}}})},closeAll:function(){km(),Cm(),jm(),Em(),Tm()},initStore:Dm,pushItemsToStore:function(e){var t=Im();t&&(t.items=Object(B.default)({},t.items,{},e))},pushItemToStore:Nm,removeFromBookmarkLink:function(e){var t=Jh(e,"data-item_id"),n=Jh(e,"data-item_oid"),i=Jh(e,"data-item_type"),a=Jh(e,"data-hash"),o=Jh(e,"data-raw"),s=Jh(e,"data-link_url"),c=Jh(e,"data-link_title"),l=Jh(e,"data-link_img"),u=Object(F.$)("#"+o);return Xh.closeMenu(),Object(r.addClass)(u,Am),em.post("/bookmarks",{_ajax:1,act:"bookmark_remove",hash:a,item_id:t,item_oid:n,item_type:i,link_url:s,link_title:c,link_img:l},{onDone:function(e){Rm(o,[Am]),Share.setBookmarkState(o,!1),cur&&cur.search_bookmarks&&cur.search_bookmarks.redraw()}}),!1},addToBookmarkLink:function(e){var t=Jh(e,"data-item_id"),n=Jh(e,"data-item_oid"),i=Jh(e,"data-item_type"),a=Jh(e,"data-hash"),o=Jh(e,"data-raw"),s=Jh(e,"data-link_url"),c=Jh(e,"data-link_title"),l=Jh(e,"data-link_img"),u=Object(F.$)("#"+o);return Xh.closeMenu(),Object(r.removeClass)(u,Am),em.post("/bookmarks",{_ajax:1,act:"bookmark_add",hash:a,item_id:t,item_oid:n,item_type:i,link_url:s,link_title:c,link_img:l},{onDone:function(){var e=Bm(o),t=e.indexOf(Am);-1!==t&&e.splice(t,1),Rm(o,e),Share.setBookmarkState(o,!0),cur&&cur.search_bookmarks&&cur.search_bookmarks.redraw()}}),!1},showSuccessSnack:function(e){var t,n=window.lang,i=Object(r.geByClass1)("RepliesField_fixed");i&&(t=Object(r.getH)(i)+5);Snackbar.init({type:N.SNACKBAR_TYPE_BOOKMARK,text:n.mobile_bookmarks_snackbar_added,bottom:t,action:{url:"/bookmarks",text:n.mobile_bookmarks_snackbar_edit_tags,onclick:"return Bookmarks.showSettingsPopup(this, { wrap: true, is_from_snackbar: 1 });",attrs:Object.keys(e).reduce((function(t,n){return t["data-"+n]=e[n],t}),{})}})},keyupCreateInput:function(e,t){var n=Object(r.gpeByClass)("BookmarksPopup",t),i=Object(F.$)(pm,n),a=Zh(t).trim();rm.setDisabled(i,!a)},openSavedTab:function(e,t){var n=Object(F.$)(".mm_counter",t),i=Object(Nn.getCookie)(bm);i&&!n&&(e&&e.preventDefault(),nav.go("/bookmarks?type="+i))},openLikesFeed:function(e){var t=Object(F.$)(".mm_new",e);Object(r.remove)(t)},getStoreItemDataById:Fm,getTagsByItemId:Hm,renderSearchItem:function(e,t,n,i,a){var o="";if(!i||Object(r.isEmpty)(i))o=n;else{var s=Hm(e),c=Bm(e);i=JSON.parse(i),s&&(t=s.reduce((function(e,t){return[].concat(e,[t.id])}),[]),i.subtitle=Kh({tags:s})),c&&(i.mix=[].concat(c)),i.title=d.default.wrap(a.highlight(i.title)),o=d.default.html(oo(i))}return Nm(e,t,n),o}};var om=".BookmarksPopup__filter",sm=".BookmarksPopup__delete",cm=".BookmarksPopup__create",lm=".BookmarksPopup__edit",um=".BookmarksPopup__settings",dm=".Bookmarks__tagsSettings",_m=".Bookmarks__tagsSelectItem",fm=".basisDefault",pm=".BookmarksPopup__buttonSubmit",hm=".BookmarksItem",mm="data-deletetagname",vm="createtagname",gm="edittagname",Am="BookmarksItem_removed",bm="remixblt";function wm(e){var t=nm(),n=Object(F.$)(fm),i=am(e);tm(i,n),nm(t)}function ym(e){var t;Xh.closeMenu(),t="string"==typeof e?Object(F.$)(e):e,t=Qh.open(t,!0);var n="popup"+Date.now();return Jh(t,"data-popupid",n),t}function Om(e){return Jh(e,"data-popupid")}function Sm(e){var t;if(t=!("string"==typeof e)?e:Array.from(Object(F.$$)(e)).pop()){Qh.close(t);var n=Lm(t),i=n&&n.needRemove;!function(e){var t=Om(e);delete Im().popup[t]}(t),i&&Object(r.remove)(t)}return!1}function km(){var e=Array.from(Object(F.$$)(om)).pop(),t=Object(F.$$)(_m,e);return t&&t.forEach((function(e){Object(r.removeEvent)(e,"click",km)})),Sm(e)}function Cm(){return Sm(sm)}function jm(){var e=Array.from(Object(F.$$)(cm)).pop();if(e){var t=e.$("[name="+vm+"]");Zh(t,"")}return Sm(cm)}function Em(){var e=Array.from(Object(F.$$)(lm)).pop();if(e){var t=e.$("[name="+gm+"]");Zh(t,"")}return Sm(lm)}function Tm(){return Sm(um)}function Im(){return window.store.bookmarks||Dm(),window.store.bookmarks}function Mm(){var e=Im();return e.tags?e.tags:{}}function Pm(e){var t=Im();return t.items[e]?t.items[e][3]:[]}function Dm(e){void 0===e&&(e={}),window.store.bookmarks=Object(B.default)({},e,{popup:{}})}function xm(e,t){var n=Om(e);Im().popup[n]=t}function Lm(e){var t=Om(e);return Im().popup[t]}function Bm(e){var t=Im();return t&&t.items&&t.items[e]&&t.items[e][5]}function Rm(e,t){var n=Im();n&&n.items&&n.items[e]&&(n.items[e][5]?n.items[e][5]=[].concat(n.items[e][5],t):n.items[e][5]=[].concat(t))}function Nm(e,t,n,i){var a=Im();a&&a.items&&(t=t.map((function(e){return parseInt(e,10)})),a.items[e]?(a.items[e][3]=t,a.items[e][4]=i):a.items[e]=["",n,e,t,i])}function Fm(e){var t=Im();return t&&t.items&&t.items[e]}function Hm(e){var t=Fm(e),n=Mm();if(t&&n){var i=t[3]||[];return n.filter((function(e){return i.includes(e.id)}))}return!1}window.uCloseProfileSwitcher={},window.uCloseProfileSwitcher._onConfirmClick=Vm;var Um=null;function Vm(e,t){var n=t.checked;he.default.clear();var i={is_closed:n?"1":"0",_ajax:1};L.default.post(e,i,{onDone:function(){he.default.reload();var e=window.cur;Um=Object(r.scrollTop)(),e.destroy.push(Wm)}})}function Wm(){Object(r.scrollTop)(Um),requestAnimationFrame((function(){Object(r.scrollTop)(Um),requestAnimationFrame((function(){Object(r.scrollTop)(Um)}))}))}var $m,qm=function(e,t){void 0===t&&(t={});return{inner:[d.default.wrap(e)],class:"CoronaStatus__tooltip CoronaStatus__tooltip--type"+t.id,onclick:["CoronaStatus.open",t],tag:"span"}};window.page.onChange((function(){$m&&ae.default.close($m)}));window.CoronaStatus=qm,Object(J.extend)(qm,{open:function(e){void 0===e&&(e={}),Object(r.cancelEvent)(),Object(r.statlogsValueEvent)("corona_status_stat","show_tooltip");var t=d.default.elem(Object(ae.default)({class:"CoronaStatus",items:[Object(ae.ModalMenuHeaderCloseButton)(),Object(ae.ModalMenuIcon)({inner:{class:"CoronaStatus__icon CoronaStatus__icon--type"+e.id}}),Object(ae.ModalMenuTitle)({inner:d.default.wrap(e.title)}),Object(ae.ModalMenuBody)({inner:d.default.wrap(e.text)}),Object(ae.ModalMenuBtn)({url:"/covid19#utm_source=vk&utm_medium=cpc&utm_campaign=status_tooltip_mvk",theme:"regular",size:"large",isBtn:!0,inner:Object(J.getLang)("mobile_special_covid_status_modal_go_button"),onclick:"window.CoronaStatus.sendStat()"})]}));$m=ae.default.open(t,!0)},sendStat:function(){Object(r.statlogsValueEvent)("corona_status_stat","open_app")}});function zm(e){void 0===e&&(e={});var t=e,n=t.url,i=t.type,a=t.url_x2;if(!n)return"";var r="";return a&&(r=a+" 2x"),{inner:[{inner:[{src:n,srcSet:r,class:"ImageStatus__image ImageStatus__image--"+i,tag:"img"}],class:"ImageStatus__imageFrame",tag:"div"}],class:"ImageStatus__imageWrapper",tag:"div"}}function Ym(e){var t=e.backgrounds,n=void 0===t?{}:t,i=e.themeKey,a="";return n[i]&&n[i]&&(a=n[i]),a?{class:"ImageStatus__background",style:'background-image: url("'+a+'")',tag:"div"}:""}var Gm;window.page.onChange((function(){Gm&&ae.default.close(Gm)})),window.ImageStatus={open:function(e){void 0===e&&(e={}),Object(r.cancelEvent)();var t=e,n=t.user_id,i=t.special_id,a=d.default.elem(Object(ae.default)({class:"ImageStatus",items:[{class:"ImageStatus__preload",inner:d.default.wrap(Object(Ya.default)())}]}));Gm=ae.default.open(a,!0,"image_status");var s=Object(F.$)(".Popup__content",Gm);window.ajax.post("/special_event",{act:i?"special_event":"image_status",user_id:n},{onDone:function(e){var t,n=e.status_id,a=e.color,r=void 0===a?{}:a,c=e.backgrounds,l=void 0===c?{}:c;t=o.colorScheme.isDarkScheme()?"dark":"light";var u=[Object(ae.ModalMenuHeaderCloseButton)(),Ym({backgrounds:l,themeKey:t}),zm(e.image),Object(ae.ModalMenuTitle)({inner:d.default.wrap(e.title)})];e.description&&u.push(Object(ae.ModalMenuBody)({inner:d.default.wrap(e.description)})),e.participants&&u.push(function(e){void 0===e&&(e={});var t=e,n=t.images,i=t.text,a=t.addition;return{inner:[{inner:[n.map((function(e){return{inner:[{src:e,class:"ImageStatus__participantImage",tag:"img"}],class:"ImageStatus__participantWrapper",tag:"div"}})),a?{inner:[{inner:["+"+a],class:"ImageStatus__participantAddition",tag:"div"}],class:"ImageStatus__participantWrapper",tag:"div"}:""],class:"ImageStatus__participantsWrapper",tag:"div"},{inner:[i],class:"ImageStatus__participantsText",tag:"div"}],class:"ImageStatus__participants",tag:"div"}}(e.participants)),(e.buttons||[]).forEach((function(e){u.push(Object(ae.ModalMenuBtn)({url:e.url,theme:e.type,size:"large",isBtn:!0,inner:e.title,onclick:i?"window.SpecialEvent && window.SpecialEvent.sendStats('popup_action');":"ImageStatus.sendStat("+n+");",attrs:{target:"_blank"}}))})),u.push(function(e){void 0===e&&(e={});var t=e.terms;return t?{inner:[d.default.wrap(t)],class:"ImageStatus__terms",tag:"div"}:""}(e)),Array.from(s.childNodes).forEach((function(e){s.removeChild(e)})),r[t]&&(s.style.backgroundColor="#"+r[t]),s.append(d.default.elem({class:"ImageStatus__inner",inner:u})),i&&window.SpecialEvent?window.SpecialEvent.sendStats("popup_showed"):Object(C.saveStatlogEvents)({name:"image_status",value:n,keys:["show_popup"]})},onFail:function(){ae.default.close(Gm)}})},sendStat:function(e){e&&Object(C.saveStatlogEvents)({name:"image_status",value:e,keys:["popup_action"]})}};var Km=n("Ubt6"),Qm=n("mIGa"),Xm=n("U+Ks"),Jm=n("+QBn"),Zm=n("3PCX"),ev=n("4RAq"),tv=function(e){var t=Object(J.getLang)("mobile_promo_vkconnect_agreement");return t=(t=t.replace("{link1}",'<a href="'+e.terms_url+'" target="_blank" class="PromoVKConnect__agreementLink">').replace("{/link1}","</a>")).replace("{link2}",'<a href="'+e.privacy_url+'" target="_blank" class="PromoVKConnect__agreementLink">').replace("{/link2}","</a>"),t=d.default.wrap(t),{inner:[{inner:[Object(R.default)({icon:Object(Qm.getVkconnectLogoIcon)()}),{inner:[Object(R.default)({icon:Object(Xm.getHelpOutline28Icon)()})],href:e.learn_more_url,target:"_blank",class:"PromoVKConnect__help",tag:"a"}],class:"PromoVKConnect__header",tag:"div"},{inner:[Object(J.getLang)("mobile_promo_vkconnect_title")],class:"PromoVKConnect__title",tag:"h1"},{inner:[{inner:[{inner:[Object(R.default)({icon:Object(Jm.getMagicWandOutline28Icon)()})],class:"PromoVKConnect__listIcon",tag:"div"},Object(J.getLang)("mobile_promo_vkconnect_list1")],class:"PromoVKConnect__listItem",tag:"li"},{inner:[{inner:[Object(R.default)({icon:Object(Zm.getUserCircleOutline28Icon)()})],class:"PromoVKConnect__listIcon",tag:"div"},Object(J.getLang)("mobile_promo_vkconnect_list2")],class:"PromoVKConnect__listItem",tag:"li"},{inner:[{inner:[Object(R.default)({icon:Object(ev.getCheckShieldOutline28Icon)()})],class:"PromoVKConnect__listIcon",tag:"div"},Object(J.getLang)("mobile_promo_vkconnect_list3")],class:"PromoVKConnect__listItem",tag:"li"}],class:"PromoVKConnect__list",tag:"ul"},{inner:[Object(qt.default)({inner:[Object(J.getLang)("mobile_promo_vkconnect_button")],size:"large",class:"PromoVKConnect__button",onClick:["PromoVKConnect.accept","event","this",e.hash],use_native_onclick:!0}),{inner:[t],class:"PromoVKConnect__agreement",tag:"div"}],class:"PromoVKConnect__footer",tag:"div"}],class:"PromoVKConnect ScrollView",tag:"div"}};var nv={init:function(e){var t=this;window.onDOMReady((function(){return t.open(e)}))},open:function(e){var t=Object(ie.default)({on_overlay_click:[],class:"PromoVKConnectModal",attached:!0,body:tv(e)});ie.default.open(Wd.elem(t),!0,"",{swipeDown:!1})},accept:function(e,t,n){var i=this;e.preventDefault(),qt.default.setLoading(t,!0,"white"),L.default.post("/",{act:"vkconnect_accept",hash:n},{onDone:function(){i.showTooltip(),ie.default.close()},onFail:function(){i.showTooltip(),ie.default.close()}})},showTooltip:function(){var e=Object(F.$)(".BottomMenu__cell:nth-child(5) .BottomMenu__icon"),t=Wd.elem(Object(Km.default)({pos:"top_right",theme:"accent",inner:Object(J.getLang)("mobile_promo_vkconnect_tooltip")}));e.appendChild(t)}};window.PromoVKConnect=nv;var iv=function(e){void 0===e&&(e={});var t=e.storiesCount?"window.showNarrative("+e.ownerId+", "+e.id+", 0); return false;":null;return{inner:[{inner:[{class:"NarrativesBlockItem__coverImage",style:"background-image: url('"+e.coverUrl+"')",tag:"div"}],class:"NarrativesBlockItem__cover",tag:"div"},{inner:[e.title],class:"NarrativesBlockItem__title",tag:"div"}],class:"NarrativesBlockItem",onClick:t,tag:"div"}},av=n("3ai+"),rv=n("j+hY");var ov=function(e){void 0===e&&(e={});var t=l.default.class("NarrativesBlock",{empty:e.isEmpty,collapsed:e.isCollapsed}),n=Object(J.getNumShort)(e.hiddenNarrativesCount),i=Object(J.makeUrl)("narratives",{owner_id:e.ownerId}),a=Object(J.makeUrl)("narratives",{act:"create",owner_id:e.ownerId});return e.isEmpty?{inner:[{inner:[{inner:[{inner:[Object(J.getLang)("mobile_narratives_block_title")],class:"slim_header_label",tag:"span"},{inner:[Object(R.default)({icon:Object(av.getChevronRight24Icon)()})],class:"slim_header_rl",tag:"span"}],class:"slim_header slim_header_black",tag:"div"}],class:"NarrativesBlock__header link_header",onClick:["NarrativesBlock.onToggle","event"],tag:"div"},{inner:[Object(qt.default)({inner:[Object(J.getLang)("mobile_narratives_block_create_narrative_label")],theme:"none",url:a,onClick:"return NarrativesBlock.onCreateNarrativeClick("+e.ownerId+", this, event);",use_native_onclick:!0,class:"NarrativesBlock__createBtn",icon:Object(R.default)(Object(rc.getNarrativeOutline24Icon)())}),{inner:[Object(J.getLang)("mobile_narratives_block_empty_description")],class:"NarrativesBlock__emptyPlaceholder",tag:"p"}],class:"NarrativesBlock__content",tag:"div"}],class:t,tag:"div"}:{inner:[{inner:[{inner:[{inner:[Object(J.getLang)("mobile_narratives_block_title")],class:"slim_header_label",tag:"span"},{inner:[e.narrativesTotalCount],class:"slim_header_cnt",tag:"span"},{inner:[Object(R.default)({icon:Object(av.getChevronRight24Icon)()})],class:"slim_header_rl",tag:"span"}],class:"slim_header slim_header_black",tag:"div"}],class:"NarrativesBlock__header link_header",href:i,onClick:"return NarrativesBlock.onHeaderClick("+e.ownerId+", this, event);",rel:"noopener",tag:"a"},Object(Or.default)({inner:[e.isCreateBlockVisible?{inner:[{inner:[Object(R.default)({icon:Object(rv.getAdd24Icon)()})],class:"NarrativesBlockItem__cover",tag:"div"},{inner:[Object(J.getLang)("mobile_narratives_block_create_narrative_label")],class:"NarrativesBlockItem__title",tag:"div"}],class:"NarrativesBlockItem NarrativesBlockItem--create",href:a,onClick:"return NarrativesBlock.onCreateNarrativeClick("+e.ownerId+", this, event);",tag:"a"}:null,e.narratives.map((function(e){return iv(e)})),e.isMoreBlockVisible?{inner:[{inner:["+",n],class:"NarrativesBlockItem__cover",tag:"div"},{inner:[Object(J.getLang)("mobile_narratives_block_more_narratives_label")],class:"NarrativesBlockItem__title",tag:"div"}],class:"NarrativesBlockItem NarrativesBlockItem--more",href:i,onClick:"return NarrativesBlock.onShowMoreClick("+e.ownerId+", this, event);",tag:"a"}:null],mix:"NarrativesBlock__content"})],class:t,tag:"div"}};Object.assign(ov,{onToggle:function(e){var t,n=null===(t=e.target)||void 0===t?void 0:t.closest(".NarrativesBlock");if(!n)return n;n.classList.toggle("NarrativesBlock--collapsed")},onCreateNarrativeClick:function(e,t,n){return Object(Be.sendNarrativeAnalytic)(Be.NarrativeAnalyticEventType.createNarrative,e,0,e>0?Be.NarrativeAnalyticNavScreen.profile:Be.NarrativeAnalyticNavScreen.club),window.nav.go(t,n)},onHeaderClick:function(e,t,n){return Object(Be.sendNarrativeAnalytic)(Be.NarrativeAnalyticEventType.openNarrativeList,e,0,e>0?Be.NarrativeAnalyticNavScreen.profile:Be.NarrativeAnalyticNavScreen.club),window.nav.go(t,n)},onShowMoreClick:function(e,t,n){return Object(Be.sendNarrativeAnalytic)(Be.NarrativeAnalyticEventType.seeMore,e,0,e>0?Be.NarrativeAnalyticNavScreen.profile:Be.NarrativeAnalyticNavScreen.club),window.nav.go(t,n)}}),window.NarrativesBlock=ov;var sv=n("vy0q");window.GroupsMenu={},window.GroupsMenu._onClick=function(e,t,n,i,a){return Object(r.statlogsValueEvent)("groups_menu_item_click",e,t,n,i,a),!0};var cv=function(e){void 0===e&&(e={});var t=window.lang;return Object(ie.default)({on_overlay_click:"return false;",class:"Popup_open",body:{class:"WarningModal",inner:[{class:"WarningModal__icon",inner:Object(R.default)(Object(wc.getHideOutline56Icon)())},{class:"WarningModal__title",inner:e.title},{class:"WarningModal__text",inner:e.text}]},items:[Object(ie.ModalMenuBtn)({url:"/groups",class:"WarningModal__button",theme:"regular",size:"large",inner:t.mobile_back,onclick:["WarningModal.leave","this","event"],attrs:{"data-id":e.id,"data-hash":e.hash,"data-gid":e.gid,"data-uid":e.user_id}}),Object(ie.ModalMenuBtn)({url:e.proceed_url,class:"WarningModal__button",theme:"secondary",size:"large",inner:t.mobile_groups_warning_notification_proceed,onclick:["WarningModal.close","this","event"],attrs:{"data-id":e.id,"data-hash":e.hash,"data-gid":e.gid,"data-uid":e.user_id}})]})};window.WarningModal=cv,Object(r.extend)(cv,{close:function(e,t){t&&t.preventDefault(),ae.default.close(e),L.default.post("/groups",{_ajax:1,act:"hide_warning_notification",notification_id:Object(r.domData)(e,"id"),group_id:Object(r.domData)(e,"gid"),hash:Object(r.domData)(e,"hash")})},leave:function(e,t){t&&t.preventDefault(),ae.default.close(e),Object(F.$)("#m .header__back").click()}}),window.Donut={help:function(e,t){var n=window.lang,i=Object(r.geByClass1)("Tooltip",e);if(i)return;return i=d.default.elem(Object(Km.default)({pos:"left",inner:n.mobile_donut_info_text})),e.appendChild(i),Object(r.cancelEvent)(t)}};n("KiYr");var lv=n("z1UI");n("5sv7");var uv=n("svF/");function dv(e){void 0===e&&(e={});var t={inner:[e.icon],class:"SplashScreen__icon",tag:"div"};return Object(lv.default)({icon_raw:t,title:e.title,text:e.description,action_text:e.action_text,action_url:e.action_url,before:_v(e),class:"DonutPaymentInfo"})}function _v(e){return void 0===e&&(e={}),{inner:["form"===e.layout?[{inner:[{inner:[Object(R.default)(Object(uv.getDonut12Icon)())],class:"DonutPayment__avatarIcon",tag:"div"}],class:"DonutPayment__avatar",style:"background-image: url("+e.avatar+")",tag:"div"},{inner:[e.title],class:"DonutPayment__title",tag:"h2"},e.description?{inner:[e.description],class:"DonutPayment__description",tag:"span"}:null]:null],class:"DonutPayment__header",tag:"div"}}var fv=n("b6Sp"),pv=n("LmmP"),hv=n("WWoJ"),mv=n("asMm"),vv={},gv=Object(mv.getPaymentSessionInitialData)();function Av(e){void 0===e&&(e={});var t=Object(F.$)('[data-section-ref="donut_payment_content"]');if(t){var n=e.type;try{t.innerHTML=d.default.html(dv({icon:e.icon,layout:"info",type:n,title:e.title||Object(r.getLang)("mobile_donut_payment_info_error"),description:e.description||"",action_text:("success"===n||"error"===n)&&Object(r.getLang)("mobile_donut_payment_button"),action_url:e.continueButtonURL||window.nav.path}))}catch(e){console.error(e)}}}var bv=function(){Av({title:Object(r.getLang)("mobile_donut_payment_info_waiting"),description:Object(r.getLang)("mobile_donut_payment_info_waiting_text"),type:"loading",icon:{inner:[Object(R.default)({icon:Object(xt.getLoading40Icon)()})],class:"SplashScreen__icon SplashScreen__icon--loading",tag:"div"}})};function wv(e){var t=e.message,n=Object(hv.default)({inner:[Object(pv.default)({inner:[t],theme:"error"})],style:{small_paddings:!0}}),i=Object(F.$)('[data-section-ref="donut_payment_form_error"]');i&&(i.innerHTML=d.default.html(n))}var yv=function(){return Av({title:Object(r.getLang)("mobile_donut_payment_info_error"),description:Object(r.getLang)("mobile_donut_payment_info_canceled_text")})};function Ov(e){Av({description:e.description,title:Object(r.getLang)("mobile_donut_payment_change_amount_changed_title"),continueButtonURL:vv.backURL}),Cv(a.RESULT_CHANGE_SUCCESS_OK)}function Sv(e){void 0===e&&(e=!1),Object(r.toggleClass)("DonutPayment__customAmount--visible",Object(F.$)('[data-section-ref="custom_price_input_container"]'),e)}function kv(e,t,n){g.logEventAction(Object(B.default)({event_type:e,owner_id:vv.ownerId,screen:t||a.UNKNOWN,source:vv.source},n))}function Cv(e,t){kv(i.PAYMENT_FORM,e,t)}function jv(){kv(i.PAYMENT_FORM_CLICK_OFFER,a.PAYMENT_START)}var Ev={init:function(e){var t=e.backURL,n=e.isCustomPriceVisible,i=e.ownerId,a=e.source,o=e.type,s=e.waitingTimeSec;Object(mv.handlePaymentComponentChange)(gv,Ev),vv={backURL:t,ownerId:i,source:a,type:o,waitingTimeSec:s};var c,l=Object(F.$)("#custom_price_input"),u=l&&l.checked;Sv(n||u),"subscribe"===o&&(c=Object(F.$)('[data-section-ref="donut_payment_external_links"]'))&&Object(r.addEvent)(c,"click",(function(e){Object(r.matchesSelector)(e.target,"a")&&jv()})),Object(mv.handlePaymentComponentDestroy)(gv,Ev)},onCustomAmountChange:function(e,t){return Object(F.$)("#custom_price_input").checked=!0,va.default.filter("number",e,t)},onLegalExternalLinkClick:jv,onFormSubmit:function(e,t){e.preventDefault();var n=Object(fv.getFormValues)(t),i=Object(Mt.parseURL)(t.action);"subscribe"===vv.type&&function(e,t,n){var i=gv.id,o=Object(r.submitBtn)(n),s=Object(mv.getPaymentWindow)(Object(r.getLang)("mobile_donut_payment_info_waiting"));qt.default.setLoading(o,!0);var c=window.ajax.post(e.requestUri,t);Object(mv.handleRequestAbortOnDestroy)(c),c.promise.then((function(e){var n=e.json;if(!e.skip){if(i!==gv.id)throw new Error;qt.default.setLoading(o,!1);var c=n.data[0],l=Object(Mt.makeUrl)(window.nav.path,{act:"donut_payment_check",hash:t.hash});Object(mv.startPaymentWaiting)(Object(B.default)({sessionIdCurrent:gv.id,paymentURL:c,paymentWindow:s,getIsSuccess:function(){var e=window.ajax.post(l,{});return Object(mv.handleRequestAbortOnDestroy)(e),e.promise.then((function(e){var t,n=e.json;if(!e.skip){if(i!==gv.id)throw new Error;if(!n)throw new Error;return!!(null==n||null==(t=n.data)?void 0:t[0].status)&&(Av({title:Object(r.getLang)("mobile_donut_payment_info_success"),description:n.data[0].text}),Cv(a.RESULT_PAYMENT_SUCCESS_OK),!0)}}))}},{onLoading:function(){bv()},onResponse:function(){Cv(a.RESULT_PAYMENT_SUCCESS_WAITING)},onCancel:function(){yv(),Cv(a.RESULT_PAYMENT_CANCEL)},onFailure:function(){yv(),Cv(a.RESULT_ERROR)},onTimeout:function(){Av({title:Object(r.getLang)("mobile_donut_payment_info_success"),description:Object(r.getLang)("mobile_donut_payment_info_success_later_text"),type:"success"}),Cv(a.RESULT_PAYMENT_SUCCESS_WAITING_TIMEOUT)}}))}})).catch((function(e){console.error(e),qt.default.setLoading(o,!1),wv({message:Object(r.getLang)("mobile_unknown_error")}),Object(mv.closePaymentWindow)(s)}))}(i,n,t),"change"===vv.type&&function(e,t,n){var i=gv.id,o=Object(r.submitBtn)(n);qt.default.setLoading(o,!0),s=Object(F.$)('[data-section-ref="donut_payment_form_error"]'),s&&(s.innerHTML="");var s;var c=(d=t,-1===Number(d.price)?Number(d.custom_price):Number(d.price)),l=Object(mv.getPaymentWindow)(Object(r.getLang)("mobile_donut_payment_info_waiting")),u=window.ajax.post(e.requestUri,t);var d;Object(mv.handleRequestAbortOnDestroy)(u),u.promise.then((function(e){var t,n=e.json;if(!e.skip){var s=null==n||null==(t=n.data)?void 0:t[0];if(i!==gv.id||!s||!Object.keys(s).length)throw new Error;if(qt.default.setLoading(o,!1),null==s?void 0:s.error)return wv({message:null==s?void 0:s.error}),void Object(mv.closePaymentWindow)(l);s.paymentRequiredToComplete?function(e,t,n){var i=gv.id,o=Object(Mt.makeUrl)(window.nav.path,{act:"donut_payment_change_check",hash:e.check_hash});Object(mv.startPaymentWaiting)(Object(B.default)({sessionIdCurrent:gv.id,paymentURL:e.paymentURL,paymentWindow:n,getIsSuccess:function(){var n=window.ajax.post(o,{});return Object(mv.handleRequestAbortOnDestroy)(n),n.promise.then((function(n){var r,o,s=n.json;if(!n.skip){if(i!==gv.id)throw new Error;if((null==s||null==(r=s.data)||null==(o=r[0])?void 0:o.amount)===t)return Ov({description:e.successDescription}),Cv(a.RESULT_CHANGE_SUCCESS_OK),!0;throw new Error}}))}},(s=function(){yv(),Cv(a.RESULT_CHANGE_ERROR)},{onFailure:s,onCancel:s,onLoading:function(){bv()},onResponse:function(){Cv(a.RESULT_PAYMENT_SUCCESS_WAITING)},onTimeout:function(){Av({title:Object(r.getLang)("mobile_donut_payment_change_timeout_error_title"),description:Object(r.getLang)("mobile_donut_payment_change_timeout_error_description"),continueButtonURL:vv.backURL}),Cv(a.RESULT_CHANGE_SUCCESS_WAITING_TIMEOUT)}})));var s}(s,c,l):(Ov({description:s.successDescription}),Object(mv.closePaymentWindow)(l))}})).catch((function(e){console.error(e),qt.default.setLoading(o,!1),wv({message:Object(r.getLang)("mobile_unknown_error")}),Object(mv.closePaymentWindow)(l)}))}(i,n,t)},onPriceRadioChange:function(e){Sv(-1===Number(e.value))}};window.DonutPayment=Ev;var Tv=!1,Iv={start:function(e,t,n){if("%page_id%"!==e&&!Tv){var i;switch(Tv=!0,n&&"%page_path%"!==n?n:he.default.cur){case"/feed":i=n_.TAB_ID_FEED;break;case"/feed?section=recommended":i=n_.TAB_ID_RECOMMEND;break;case"/mail":i=n_.TAB_ID_MESSAGES;break;case"/feed?section=notifications":i=n_.TAB_ID_NOTIFICATION}i&&window.innerWidth<882?n_.drawSkeletonLoader(Object(F.$)(".layout__basis"),i):(n_.drawLoader(Object(F.$)(".layout__basis")),Object(r.alLoadingFix)()),setTimeout((function(){var i={headers:{"X-AppShell-Start-Id":e,"X-AppShell-Start":t},zProcess:function(){}};window.ajax.onNavDone(Iv.onStarted),n&&"%page_path%"!==n?he.default.go(n,{push_only:!0,replace:!0},i):he.default.go(he.default.cur,null,i)}))}},onStarted:function(){window.ajax.onNavDone.off(Iv.onStarted),Object(S.calculateTimeOffsets)()}},Mv=Iv;window.AppShell=Mv;var Pv={reload:function(e){qt.default.setDisabled(e,!0),!1===navigator.onLine?setTimeout((function(){qt.default.setDisabled(e,!1)}),500):he.default.reload()}};window.OfflinePage=Pv;var Dv=n("2mXy");var xv=function(e){var t=e.info||{};return{inner:[{inner:[{inner:[Object.keys(t).map((function(e){var n=t[e];return"boolean"==typeof n&&(n=n?"yes":"no"),function(e,t){return{inner:[{inner:[e],tag:"b"},"\n      :\n      ",{inner:[t],tag:"i"}],tag:"div"}}(e,n)}))],class:"fi_row",tag:"div"},{inner:[{inner:[{inner:[{inner:[{inner:"Audio tag not support",tag:"b"}],src:"//vk.com/mp3/bb1.mp3",tag:"source"}],preload:"none",controls:"controls",style:"width: 100%;",tag:"audio"}],style:"color: #777;",tag:"div"}],class:"fi_row",tag:"div"},{inner:[{inner:[{type:"hidden",id:"device_info_text",name:"device_info",value:e.fallbackText,tag:"input"},{inner:[e.needSendButton&&Object(qt.default)({inner:[Object(J.getLang)("mobile_send_device_info")],submit:!0,stretch:!0,onClick:e.onSendClick})],class:"cp_buttons_block",tag:"div"}],action:"/?device",method:"post",tag:"form"}],class:"fi_row",tag:"div"}],class:"form_item",tag:"div"}],class:"PageBlock DeviceInfo fit_box",style:"color: #777; line-height: 1.7",tag:"div"}},Lv=function(e){function t(t){var n;return(n=e.call(this,t)||this).onSendClick=function(e){e.preventDefault();var t=n.state.info,i=Object.keys(t).map((function(e){return e+": "+t[e]})).join("\n");L.default.post("/?device",{_ajax:!0,device_info:i},{onDone:function(e){1===e?(self.setState({needSendButton:!1}),Snackbar.init({text:getLang("mobile_device_info_sent")})):Snackbar.init({text:getLang("mobile_unknown_error")})}})},n.state=Object(B.default)({},t),n}Object(Si.default)(t,e);var n=t.prototype;return n._testAudio=function(){return!!window.Audio&&(new Audio).canPlayType("audio/mpeg")},n._testPhotoView=function(e){var t=document.createElement("div").style,n=[];return void 0!==t.webkitTransform&&n.push("webkitTransform"),void 0!==t.MozTransform&&n.push("MozTransform"),void 0!==t.msTransform&&n.push("msTransform"),void 0!==t.OTransform&&n.push("OTransform"),e+" ("+n.join(", ").replace(/^(, )+|(, )+$|(, )(, )+/g,"$3")+")"},n._testFileAPI=function(e){return e+" ("+[window.XMLHttpRequest?"XMLHttpRequest":"",window.XDomainRequest?"XDomainRequest":"",window.FormData?"FormData":"",window.FileReader?"FileReader":"",window.XMLHttpRequest&&XMLHttpRequest.sendAsBinary?"sendAsBinary":"",window.ArrayBuffer?"ArrayBuffer":"",window.Uint8Array?"Uint8Array":"",window.MozBlobBuilder?"MozBlobBuilder":"",window.WebKitBlobBuilder?"WebKitBlobBuilder":"",window.BlobBuilder?"BlobBuilder":""].join(", ").replace(/^(, )+|(, )+$|(, )(, )+/g,"$3")+")"},n.componentDidMount=function(){var e=this.state.info;e.Audio=this._testAudio(),e["Fullscreen Photoview"]=this._testPhotoView(e["Fullscreen Photoview"]),e.FileAPI=this._testFileAPI(e.FileAPI),this.setState({info:e})},n.render=function(){return d.default.preact(xv,Object(B.default)({},this.state,{onSendClick:this.onSendClick}))},t}(Dv.Component);function Bv(){var e=$("#DeviceInfo");d.default.hydrate(Lv,Object(J.getState)("DeviceInfo"),e)}_.default.getRouter().addRoute("/?device",Bv),window.initDeviceInfo=Bv;var Rv=n("scr1");function Nv(){var e=Object(J.getState)("StoriesArchive"),t=Object(F.$)("#StoriesArchive");d.default.mountPreactComponent(Rv.StoriesArchive,e,t)}_.default.getRouter().addRoute((function(){return"/stories_archive"===nav.path}),Nv),window.initStoriesArchive=Nv;var Fv=n("nXqZ"),Hv=n("usV7"),Uv=n("IjkR"),Vv=n("La8/");function Wv(e){return{inner:[{inner:[e.before],class:"MiniInfoCell__before",tag:"div"},{inner:[e.text],class:"MiniInfoCell__content",tag:"div"}],class:"MiniInfoCell",tag:"div"}}function $v(){return{inner:[d.default.wrap(Object(Ya.default)())],class:"VacancyPhone__spinner",tag:"div"}}function qv(){return Object(ie.default)({on_overlay_click:["return VacancyPhone.close","this"],class:"VacancyPhone",onClose:["return VacancyPhone.close","this"],body:{inner:[{inner:[Object(R.default)({icon:Object(Vv.getCancel12Icon)()})],class:"VacancyPhone__close",onClick:"VacancyPhone.close(this)",tag:"button"},{class:"VacancyPhone__content",tag:"div"}],class:"VacancyPhone__wrap",tag:"div"}})}var zv,Yv=n("qdnm"),Gv=function(){function e(e){this.clickStatCollector=e}return e.prototype.logEvent=function(e,t){var n,i=((n={type:m.ClickProductionStatEventTypes.TYPE_WORKI_CLICK})[m.ClickProductionStatEventTypes.TYPE_WORKI_CLICK]=e,n);this.clickStatCollector.logEvent(i,t)},e}(),Kv=new(function(){function e(e){this.workiClickStatCollector=e}return e.prototype.logEvent=function(e){var t,n=((t={type:m.WorkiEventTypes.TYPE_WORKI_SNIPPET_ITEM})[m.WorkiEventTypes.TYPE_WORKI_SNIPPET_ITEM]=e,t.screen=window.cur.module,t),i={type:m.EventItemType.WORKI_SNIPPET};this.workiClickStatCollector.logEvent(n,i)},e}())(new Gv(Yv.clickStat));!function(e){e.CLICK_CTA="click_cta"}(zv||(zv={}));var Qv={open:function(e,t,n,i,a){var r=a.$btn.closest(i),o=Object(F.$)(Zv,r);if(o){var s=ae.default.open(o,!0,"",{expandable:!0}),c=s.querySelector(tg);return c&&(c.innerHTML=d.default.html($v()),Jv=ag(e,n,c),Xv=function(){rg(s),Jv()},nav.onBeforeGo(Xv),Kv.logEvent({event_name:zv.CLICK_CTA,wallitem_id:t})),s}return!1},close:rg,retry:function(e,t,n){var i=n.$btn.closest(tg);i&&(i.innerHTML=d.default.html($v()),Jv=ag(e,t,i))}},Xv=function(){},Jv=function(){},Zv=".VacancyPhone",eg=".VacancyPhone.Popup_open",tg=".VacancyPhone__content";function ng(e,t){var n,i,a,r,o,s,c,l,u;e.innerHTML=d.default.html((i=(n=t).phone,a=n.name,r=n.profession,o=n.company,s=Object(J.getLang)("market_worki_snippet_phone_modal_title"),c=Object(J.getLang)("market_worki_snippet_phone_modal_call"),l="tel:"+i,u=11===i.length?"+"+i.substr(0,1)+" "+i.substr(1,3)+" "+i.substr(4,3)+" "+i.substr(7,2)+" "+i.substr(9,2):i,[Object(R.default)({icon:Object(Fv.getPhoneOutline56Icon)()}),{inner:[u],class:"VacancyPhone__phone",tag:"div"},{inner:[a],class:"VacancyPhone__name",tag:"div"},{class:"VacancyPhone__separator",tag:"div"},{inner:[s],class:"VacancyPhone__label",tag:"div"},{inner:[Wv({before:Object(R.default)({icon:Object(Hv.getUserOutline20Icon)()}),text:r}),Wv({before:Object(R.default)({icon:Object(Uv.getWorkOutline20Icon)()}),text:o})],class:"VacancyPhone__info",tag:"div"},Object(qt.default)({inner:[c],class:"VacancyPhone__call",url:l,role:"link",theme:"large"})]))}function ig(e,t){var n,i;e.innerHTML=d.default.html((i=["VacancyPhone.retry",(n=t).id,n.hash],{inner:[{inner:[Object(J.getLang)("mobile_market_worki_snippet_phone_modal_error")],class:"VacancyPhone__text",tag:"p"},Object(qt.default)({inner:[Object(J.getLang)("mobile_market_worki_snippet_phone_modal_error_retry")],class:"VacancyPhone__retry",theme:"link",onClick:i})],class:"VacancyPhone__error",tag:"div"}))}function ag(e,t,n){return window.ajax.post("worki.php",{act:"get_vacancy",vacancy_id:e,hash:t},{onDone:function(i){i?ng(n,i):ig(n,{id:e,hash:t})},onFail:function(){ig(n,{id:e,hash:t})}}).abort}function rg(e){return e||(e=Object(F.$)(".Popup_open.VacancyPhone")||Object(F.$)(eg)),e&&(ae.default.close(e),Jv()),nav.onBeforeGo.off(Xv),!1}Object.assign(qv,Qv);var og=qv;window.VacancyPhone=og;var sg=n("EnJO"),cg=n("vOeY"),lg="touch",ug=Object(u.default)();function dg(){window.clog("[UserInteraction] init"),lg="touch","PointerEvent"in window?function(){function e(e){var t="mouse"===e.pointerType?"mouse":"touch";t!==lg&&(window.clog("[UserInteraction] Last interaction method changed to "+t+" (pointer event)"),ug(t),lg=t)}document.addEventListener("pointerdown",e,{passive:!0,capture:!0}),document.addEventListener("pointerover",e,{passive:!0,capture:!0})}():_g()}function _g(){document.addEventListener("mousemove",(function e(){window.clog("[UserInteraction] Last interaction method changed to mouse"),ug("mouse"),lg="mouse",document.removeEventListener("mousemove",e,{capture:!0}),document.addEventListener("touchstart",(function e(t){var n;(null===(n=t.sourceCapabilities)||void 0===n?void 0:n.firesTouchEvents)||(window.clog("[UserInteraction] Last interaction method changed to touch"),ug("touch"),lg="touch",document.removeEventListener("touchstart",e,{capture:!0}),_g())}),{passive:!0,capture:!0})}),{passive:!0,capture:!0})}window.clog("[UserInteraction] done"),window.jsc=function(e){return"cmodules/"+e},Object(f.initStaticManager)(),document.scrollListenerAlreadyInited||(document.scrollListenerAlreadyInited=!0,Object(r.addEvent)(window,"scroll touchmove",(function(){var e,t;(null==(e=window.Speech)||null==(t=e.recorder)?void 0:t.isRecording)||Object(r.onBodyScroll)(!0)}),{passive:!0})),window.trackEvent=te.trackEvent;var fg=window,pg=fg.thover,hg=fg.ajax;function mg(){if(Object(r.lsGet)("custom_opts"))return Object(r.addClass)("_copts","vk_wrap");var e=Object(r.ce)("div",{innerHTML:'<input id="copts_test_radio" type="radio" checked="checked"><div id="copts_test_label"></div>'});Object(r.append)(e,"vk_utils");var t=Object(r.ge)("copts_test_label");t&&Math.abs(t.offsetWidth-5)<1&&(Object(r.addClass)("_copts","vk_wrap"),Object(r.lsSet)("custom_opts",1)),Object(r.remove)(e)}Object(r.addEvent)(document,"touchmove touchcancel",pg.cancel,{passive:!0}),Object(r.addEvent)(document,"touchend",pg.end,{passive:!0}),onDOMReady((function(){dg(document.body.classList.contains("_touch"))})),ug((function(e){document.body.classList.toggle("_hover","mouse"===e),document.body.classList.toggle("_touch","touch"===e)})),hg.enabled=!0,hg.enabled&&(onDOMReady((function(){Object(r.remove)("app_go_frame"),hg.prepare_click(),menu&&menu.init(),audioplayer&&audioplayer.initAudio(),Object(r.addClass)("_js","vk_wrap")})),page.clear()),onDOMReady((function(){_.default.getRouter().checkRoutes(),window.page&&page.onChange((function(){return _.default.getRouter().checkRoutes()}));var e=document.getElementById("utils");e||((e=document.createElement("div")).id="utils",document.body.insertAdjacentElement("afterbegin",e)),window.utilsNode=e})),onDOMReady(D.resizePosters),Object(r.addEvent)(window,"resize",D.resizePosters),Object(r.addEvent)(document,"touchstart",(function(e){var t=Object(r.checkTouchHover)(e.target);pg.clear(),t&&pg.start.call(t,e)}),{passive:!0}),document.clickListenerAlreadyInited?setTimeout((function(){var e=Array.from(document.querySelectorAll("script")).map((function(e){return e.src}));Object(P.statlogsValueEvent)("mvk_click_common_multiple_init",1,"common",e.join("|"),location.href)}),0):(document.clickListenerAlreadyInited=!0,Object(r.addEvent)(document,"click",(function(e){var t,n;if((null==(t=e.target)||null==(n=t.dataset)?void 0:n.donutLogEvent)&&b(e.target.dataset.donutLogEvent,e.target),Object(r.ajaxLayoutEnabled)()){var i=Object(r.gpeByClass)("al_after",e.target);if(i){var a=Object(r.attr)(i,"data-target"),o=!!a&&Object(r.geByClass1)(a,i);if(o&&!nav.go_after(o,e)||!nav.go_after(i,e))return}var s=Object(r.matchesSelector)(e.target,".mi_text a");if(w.SAKIntegration.isIntegrated&&s)if(!e.target.getAttribute("mention_id"))return void(e.target.target="_blank");var c=Object(r.checkNav)(e.target,{allow_post_away:!0});if(c&&(document.activeElement&&document.activeElement.tagName&&"input"===document.activeElement.tagName.toLowerCase()&&document.activeElement.blur(),nav.go(c,e)||Object(r.cancelEvent)(e)),"bookmarks"===cur.module){var l=e&&e.target&&(e.target.closest(".BookmarksItem_link")||e.target.closest(".BookmarkSlider__item")||e.target.closest(".OwnerRow"));if(!l)return;var u=l.getAttribute("id").match(/^(link|page)(-?\d+)_(-?\d+)?$/)||[],d=u[0],_=u[1],f=u[2],p=u[3];if(!(d&&_&&f&&p))return;var h=!1;switch(_){case"link":h=e.target.closest('a[target="_blank"]');break;case"page":h=e.target.closest(".OwnerRow__content")||e.target.closest(".OwnerColumn")}if(!h)return;Object(P.statlogsValueEvent)("bookmarks_product_analytics",{item_type:_,item_owner_id:intval(f),item_id:intval(p),time:vk.ts+Math.floor(((new Date).getTime()-vk.started)/1e3)})}}}))),document.submitListenerAlreadyInited||(document.submitListenerAlreadyInited=!0,Object(r.addEvent)(document,"submit",(function(e){var t=e.target;Object(r.hasClass)("vk_js_yes",geByTag1("html"))&&!Object(r.hasClass)("opera_mini_yes",geByTag1("body"))&&Object(r.hasClass)("qsearch",t)&&Object(r.gpeByClass)("audioPage",t)&&(geBySel1('[type="submit"]',t).click(),Object(r.cancelEvent)(e))}))),document.touchStartListenerAlreadyInited||(document.touchStartListenerAlreadyInited=!0,Object(r.addEvent)(document,x.isTouch?"touchstart":"mousedown",(function(e){tooltip.closeByTap(e)}),{passive:!0})),onDOMReady(mg),onDOMReady((function(){Object(P.statlogsValueEvent)("mvk_feature_is_supported",Number(Object(ne.isFlexboxSupported)()),"flexbox"),Object(P.statlogsValueEvent)("mvk_feature_is_supported",Number(Object(ne.isMatchMediaSupported)()),"match_media"),Object(P.statlogsValueEvent)("mvk_feature_is_supported",Number(Object(ne.isCSSVariablesSupported)()),"css_variables"),Object(P.statlogsValueEvent)("mvk_feature_is_supported",Number(Object(ne.isAutoSchemesSupported)()),"auto_change_scheme"),Object(P.statlogsValueEvent)("mvk_feature_is_supported",Number(Object(ne.isSupportsSupported)()),"css_supports"),Object(P.statlogsValueEvent)("mvk_feature_is_supported",Number(Object(ne.isGridsSupported)()),"grids"),Object(P.statlogsValueEvent)("mvk_feature_is_supported",Number(Object(ne.isSVGSupported)()),"svg"),Object(P.statlogsValueEvent)("mvk_feature_is_supported",Number(Object(ne.isIntersectionObserverSupported)()),"intersection_observer"),Object(P.statlogsValueEvent)("mvk_feature_is_supported",Number(Object(ne.isWebRTCCallsSupported)()),"webrtc_calls"),Object(P.statlogsValueEvent)("mvk_dark_theme",Number(Object(ne.isDarkTheme)()),"current"),function(){var e={is_schemes_supported:Object(ne.isCSSVariablesSupported)(),is_auto_schemes_supported:Object(ne.isAutoSchemesSupported)(),current_scheme:Object(ne.isDarkTheme)()?2:Object(ne.isLightTheme)()},t=Object.keys(e).sort().map((function(t){return t+":"+Number(e[t])})).join("/");if(localStorage&&localStorage.getItem){var n=localStorage.getItem("supportedFeatures");null!==n&&t===n||(localStorage.setItem("supportedFeatures",t),Object(P.statlogsValueEvent)("browser_features",t))}}()})),[!Object(ne.isSVGSupported)()].some((function(e){return e}))&&onDOMReady((function(){UnsupportedBrowser.show()})),onDOMReady(S.calculateTimeOffsets),Object(r.sgFix)(),onDOMReady((function(){var e=window.vk;e&&!e.id&&Object(r.lsCheck)()&&localStorage.clear()})),window.optionsTest=mg,zlayer.isReady=!0,window.PasswordInput={toggleVisibility:function(e,t,n){void 0===n&&(n=!1),(n?Object(F.$$)(".PasswordInput .PasswordInput__button"):t).forEach((function(e){setTimeout((function(){var t="true"===e.getAttribute("aria-expanded"),n=Object(va.getNative)(e.closest(".TextInput"));e.setAttribute("aria-expanded",t?"false":"true"),n.setAttribute("type",t?"password":"text"),e.innerHTML=Wd.html(Object(R.default)({icon:t?Object(_o.getViewOutline24Icon)():Object(fo.getHideOutline24Icon)()}))}),0)}));var i=t.closest(".TextInput"),a=Object(F.$)(".TextInput__native",i),r=document.activeElement===a||i.classList.contains("TextInput--focused");function o(){!r||Object(s.isTabbing)()?(e.preventDefault(),e.stopPropagation(),t.focus()):a.focus()}o(),setTimeout((function(){return o()}))}},onDOMReady((function(){Dt(),window.page.onChange((function(){window.page.lastTrackedPage!==nav.cur&&Dt()}))})),window.MsgTemplates||(window.MsgTemplates={Carousel:{handleElementAction:sv.handleElementAction,moveSlider:sv.moveSlider,onScroll:sv.onScroll}}),window.isNewMail&&(n("4bPz"),n("s0aB"),n("/Id8"),n("DkIl"),n("CkGd"),n("iS9e"),n("fWqt"),n("QBkA"),n("rKp0"),n("u33z"),n("A6le"),n("SNk7"),n("JCKH"),n("1KAK"),n("eWFs"),n("drfJ"),n("V2dH"),n("PUg3"),n("3pHe")),window.MarketAnalyticsManager=sg.MarketAnalyticsManager,window.Form=cg.Form,onDOMReady((function(){p.navigationStat.addStatEvent(p.navigationStat.getModule(),p.NavigationProductionStatEventTypes.TAB_OPEN)}))},"7cYY":function(e,t,n){"use strict";n.r(t),n.d(t,"fixStoryThumbHeaders",(function(){return _}));var i=n("Y6JH"),a=n("fdw3"),r=n("z9sQ"),o=n("iChR"),s=n("pCZP"),c=n("bcGF");var l=function(e){void 0===e&&(e={});var t=r.default.class("StoryThumb",{draggable:e.isDraggable}),n=r.default.class("StoryThumb__checkbox",{checked:e.isSelected}),l=e.story||{},u=e.onClick?e.onClick:l.isUnavailable?null:["Stories.init",l.rawId+"/"+l.listId];e.isSelectable&&!l.isUnavailable&&(u=[e.onStoryThumbCheck,"event",e.story]);var d=Object(a.getDayNumberFromUnixtime)(l.time),_=Object(a.getLang)("months_sm_of","raw")[Object(a.getMonthNumberFromUnixtime)(l.time)];return{inner:[e.isDateHidden?null:{inner:[{inner:[d],class:"StoryThumbDate__day",tag:"div"},{inner:[_],class:"StoryThumbDate__month",tag:"div"}],class:"StoryThumbDate",tag:"div"},e.isSelectable?{inner:[{inner:[Object(i.default)({icon:Object(c.getCheckCircleOn24Icon)()})],class:"StoryThumb__checkboxCheckedIcon",tag:"div"},{inner:[Object(i.default)({icon:Object(s.getCheckCircleOff24Icon)()})],class:"StoryThumb__checkboxUncheckedIcon",tag:"div"}],class:n,onClick:[e.onStoryThumbCheck,"event",e.story],tag:"div"}:null,l.isUnavailable?{inner:[{inner:[Object(i.default)({icon:Object(o.getError24Icon)()})],class:"StoryThumbUnavailable__icon",tag:"div"},{inner:[Object(a.getLang)("mobile_stories_archive_unavailable_label")],class:"StoryThumbUnavailable__label",tag:"div"}],class:"StoryThumbUnavailable",tag:"div"}:null],class:t,onClick:u,style:l.isUnavailable?null:"background-image: url("+l.preview+")","data-time":l.time,"data-story-id":l.id,tag:"div"}},u=n("UxAg"),d=n("OcsD");function _(e){if(!e)return!1;var t={},n=Object(u.$$)(".StoryThumb[data-time]",e);n&&n.length&&n.forEach((function(e,i){var a=Object(d.geByClass1)("StoryThumbDate",e);if(a){var r=n[i-1],o=r&&1e3*r.getAttribute("data-time"),s=o&&new Date(o),c=s&&s.toDateString(),l=1e3*e.getAttribute("data-time"),u=new Date(l).toDateString(),_=c===u;t[u]&&t[u]!==l&&_?Object(d.setStyle)(a,"display","none"):(t[u]=l,Object(d.setStyle)(a,"display","block"))}}))}t.default=l},"7jDv":function(e,t,n){"use strict";n.r(t),n.d(t,"Resampler",(function(){return a})),n.d(t,"fastResample",(function(){return r}));var i={avg:function(){function e(){this.clear()}var t=e.prototype;return t.push=function(e){this._count++,this._accum+=e},t.get=function(){return this._accum/this._count},t.clear=function(){this._count=0,this._accum=0},e}(),peak:function(){function e(){this.clear()}var t=e.prototype;return t.push=function(e){this._max=Math.max(this._max,Math.abs(e))},t.get=function(){return this._max},t.clear=function(){this._max=0},e}(),quad:function(){function e(){this.clear()}var t=e.prototype;return t.push=function(e){this._count++,this._accum+=e,this._accum_q+=e*e},t.get=function(){return 1==this._count?this._accum:Math.sqrt((this._accum_q-this._accum*this._accum/this._count)/this._count)},t.clear=function(){this._count=0,this._accum=0,this._accum_q=0},e}()},a=function(){function e(e){this._normalizeAlgorithm=!1,i[e.normalizeAlgorithm]&&(this._normalizeAlgorithm=new i[e.normalizeAlgorithm]),this._srcSampleRate=parseInt(e.srcSampleRate||0),this._dstSampleRate=parseInt(e.dstSampleRate||0),this._truncateTo=1,void 0!==e.truncateTo&&(this._truncateTo=e.truncateTo),this._dstSampleRate>0?this._sampleRate=this._srcSampleRate/this._dstSampleRate:this._sampleRate=0,i[e.algorithm]||(e.algorithm="peak"),this._algorithm=new i[e.algorithm],this._sampleCount=0,this._data=[]}return e.prototype.push=function(e){if(this._sampleRate<=0)return[];for(var t,n=[],i=0;i<e.length;i++)if(this._truncateTo>0&&(e[i]=Math.min(this._truncateTo,Math.abs(e[i]))),this._sampleCount+=1,this._sampleCount>=this._sampleRate)for(;this._sampleCount>=this._sampleRate;)this._sampleCount-=this._sampleRate,this._sampleCount<=.8&&this._algorithm.push(e[i]),t=this._algorithm.get(),n.push(t),this._normalizeAlgorithm&&this._normalizeAlgorithm.push(t),this._algorithm.clear(),this._sampleCount>.2&&this._algorithm.push(e[i]);else this._algorithm.push(e[i]);if(this._normalizeAlgorithm){var a=this._normalizeAlgorithm.get();if(this._normalizeAlgorithm.clear(),a>0)for(var r=0;r<n.length;r++)n[r]=n[r]/a,this._truncateTo>0&&(n[r]=Math.min(this._truncateTo,Math.abs(n[r])))}return n},e}();function r(e,t,n){return void 0===n&&(n="peak"),new a({srcSampleRate:e.length,dstSampleRate:t,normalizeAlgorithm:n,truncateTo:0}).push(e)}},"8ZMO":function(e,t,n){"use strict";n.r(t);var i=function(e){return{class:["Anchor",e.mix],id:e.id,tag:"div"}};t.default=i},9:function(e,t,n){e.exports=n("75Qd")},"98L6":function(e,t){window.FeedBlocks={hideReason:function e(t,n){if(e.progress)return!1;e.progress=!0;var i="block_"+t,a=ge(i);cur.feedBlocksHTML&&delete cur.feedBlocksHTML[i],ajax.post("feed.php",{act:"block_hide_reason",block_id:t,reason:0|n,hash:attr(a,"data-hash"),pos:attr(a,"data-pos"),ref:attr(a,"data-ref")},{onDone:function(t){e.progress=!1,t?val(a,t):hide(a),e.progress=!1},onFail:function(){e.progress=!1}})},restore:function(e){var t="block_"+e,n=ge(t);cur.feedBlocksHTML&&cur.feedBlocksHTML[t]&&val(t,cur.feedBlocksHTML[t]),ajax.post("feed.php",{act:"block_restore",block_id:e,hash:attr(n,"data-hash"),pos:attr(n,"data-pos"),ref:attr(n,"data-ref")})},hide:function e(t,n){if(e.progress)return!1;e.progress=!0,post.wallActionsHide();var i="block_"+t,a=ge(i);return ajax.post("feed.php",{act:"block_hide",block_id:t,hash:attr(a,"data-hash"),pos:attr(a,"data-pos"),ref:attr(a,"data-ref")},{onDone:function(t){post.wallActionsHide(),cur.feedBlocksHTML||(cur.feedBlocksHTML={}),cur.feedBlocksHTML[i]=val(a),val(a,t),e.progress=!1},onFail:function(){e.progress=!1}}),!1}}},"9M99":function(e,t,n){"use strict";n.r(t),n.d(t,"emojiToHTML",(function(){return c}));var i=n("S6+Z"),a=n("TxR4"),r=n("vkmG");function o(e,t,n,i){return!n&&t?t:i?'<i class="emoji @'+e+'" emoji="'+e+'"'+(t?' title="'+t+'"':"")+"></i>":'<img class="emoji" src="/emoji/e/'+e+(window.devicePixelRatio>=2?"_2x":"")+'.png"'+(t?' alt="'+t+'"':"")+(browser.msie&&Number(browser.version)>8?' contenteditable="false"':"")+">"}function s(e){return o(Object(a.emojiSymbolToByteHex)(e),Object(r.encodeHTMLEntities)(e),!0)}var c=function(e){return function(e,t){if(browser.ipad||browser.iphone)return e;e=(e+"").replace(/&nbsp;/g," ").replace(/<br>/g,"\n");for(var n=0;n<2;n++)Object.keys(i.EMOJI_PREFIXED_REPLACES).forEach((function(t){e.replace(i.EMOJI_PREFIXED_REPLACES[t],(function(e,n,i,a){return(n||"")+o(t)+(a||"")}))}));return Object.keys(i.EMOJI_REPLACES).forEach((function(t){e=e.replace(i.EMOJI_REPLACES[t],(function(e,n,i){return o(t)+(i||"")}))})),e=e.replace(/\n/g,"<br>"),t&&(e=e.replace(/\uFE0F/g,"").replace(Object(i.emojiRegex)(),s)),e}(e,!0)}},"9y81":function(e,t,n){"use strict";n.r(t),n.d(t,"IconWd",(function(){return o}));var i=n("bZ/P"),a=n("Mc5h"),r=function(e){var t,n=e.icon,r=e.class||e.mix;return Object(a.default)({mix:i.default.class(r,"Icon",(t={},t[n]=!0,t.active=e.active,t.blue=e.blue,t.bluer=e.bluer,t.dark=e.dark,t.selected=e.selected,t.small=e.small,t.white=e.white,t)),url:e.url,attrs:e.attrs})};function o(e){var t,n=e.icon,i={class:[e.class,Bem.class("Icon",(t={},t[n]=!0,t.active=e.active,t.blue=e.blue,t.bluer=e.bluer,t.dark=e.dark,t.selected=e.selected,t.small=e.small,t.white=e.white,t),"_")],href:e.url,attrs:e.attrs,tag:"a"};return i.tag=e.url?"a":"div",i}Object.assign(r,{toggleActive:function(e){e.classList.toggle(s)}});var s="Icon_active";t.default=r;window.Icon=r},A6le:function(e,t,n){"use strict";n.r(t);var i=n("Y6JH"),a=n("z9sQ"),r=n("fdw3"),o=n("WQTZ"),s=n("J51G"),c=function(e){var t=e.durationInSeconds,n=e.isDefaultCasperTimerShown,c=t<=60;return{inner:[{inner:[Object(i.default)({icon:Object(o.getBomb16Icon)()})],class:a.default.class("CasperTimer__icon",{normal:!0}),"aria-hidden":"true",tag:"span"},{inner:[Object(i.default)({icon:Object(s.getBombActive16Icon)()})],class:a.default.class("CasperTimer__icon",{warning:!0}),"aria-hidden":"true",tag:"span"},{inner:[Object(r.formatDuration)(t)],class:"CasperTimer__timer",role:"timer","aria-live":"polite",tag:"span"}],class:a.default.class("CasperTimer",{active:t>0,hidden:!n,warning:c}),onClick:["CasperTimer.clickHandler","this","event"],"aria-haspopup":"true","aria-expanded":"false",title:Object(r.getLang)("mobile_casper_timer_title"),"data-left":t,tag:"button"}};var l=n("UxAg"),u=n("qHA9"),d=new(n("Cz26").Timers)({}),_={init:function(e){var t=this;if(Object(u.isMessageWithoutLocalId)(e))return!1;var n=Object(l.$)(".msg_id_"+e);if(!n)return!1;var i=Object(l.$)(".CasperTimer",n);if(!i)return!1;var a=this.getTimerElement(i);d.add((function(n){if(i.parentNode){var o=t.getLeftSeconds(i);(o-=n)<=0&&(i.classList.add("CasperTimer--hidden"),a.classList.remove("CasperTimer__timer--opened"),i.classList.remove("CasperTimer--itsGonnaBlow"),setTimeout((function(){i.hasOwnProperty("remove")?i.remove():i&&i.parentNode&&i.parentNode.removeChild(i)}),1e3),d.remove(e),o=0),t.setLeftSeconds(i,o),o>0&&o<=10&&i.classList.add("CasperTimer--itsGonnaBlow"),o>0&&o<=60&&(i.classList.remove("CasperTimer--hidden"),i.classList.add("CasperTimer--warning")),t.isOpened(i)&&(a.innerHTML=Object(r.formatDuration)(o))}else d.remove(e)}),{id:e})},getLeftSeconds:function(e){return parseInt(e.getAttribute("data-left"))},setLeftSeconds:function(e,t){e.setAttribute("data-left",t)},getTimerElement:function(e){if(!e)throw new Error("CasperTimer: element is not provided");return Object(l.$)(".CasperTimer__timer",e)},isOpened:function(e){return this.getTimerElement(e).classList.contains("CasperTimer__timer--opened")},clickHandler:function(e,t){var n=this.getTimerElement(e);n.classList.toggle("CasperTimer__timer--opened");var i=this.isOpened(e);e.setAttribute("aria-expanded",i),n.innerHTML=Object(r.formatDuration)(this.getLeftSeconds(e)),t.stopPropagation(),clearTimeout(e._autoCloseTimer),i&&(e._autoCloseTimer=setTimeout((function(){n&&n.classList.remove("CasperTimer__timer--opened")}),4e3))}};window.CasperTimer=_;t.default=c},AXyT:function(e,t,n){"use strict";n.r(t);var i=function(e){return Wd.html({inner:["empty"===e.value?" ":e.value],class:[Bem.class("Oval",{type:e.gray?"minor":e.type,hidden:a(e.value)},"_"),e.mix],tag:"div"})};function a(e){return"empty"!==e&&(!e||e<=0)}Object.assign(i,{setValue:function(e,t){if(!e)return;var n=a(t);e.innerText="empty"===t?" ":t,e.classList.toggle(r,n)}});var r="Oval_hidden";t.default=i;Object.assign(window,{Oval:i,Oval_isHidden:a})},AgBx:function(e,t,n){"use strict";n.r(t);var i=n("bZ/P"),a=n("Mc5h"),r=function(e){return Object(a.default)({attrs:e.attrs,mix:i.default.class(e.mix,"ScrollView"),inner:e.inner})};n("QMH7"),t.default=r;window.ScrollView=r},"B+U2":function(e,t,n){"use strict";n.r(t),n.d(t,"BotsKeyboardRow",(function(){return f})),n.d(t,"BotsKeyboardButton",(function(){return p}));var i=n("29dZ"),a=n("Y6JH"),r=n("TYsd"),o=n("z9sQ"),s=n("fdw3"),c=n("GHum"),l=n("gFCQ"),u=n("sPQa"),d=n("lhfX"),_=function(e){var t=e.keyboard,n=e.msgId,i=e.pressed||{},a=t.buttons,r=e.subID,o=0;return{class:"BotsKeyboard__main",inner:a.map((function(e){return f(e,t,n,i,r||null,o++)}))}};function f(e,t,n,i,a,r){var o=0;return{class:"BotsKeyboard__row",inner:e.map((function(e){return p(e,t,n,i,a,r,o++)}))}}function p(e,t,n,_,f,p,h){var m,v=window.lang,g=e.action.type,A=o.default.class("BotsKeyboard__button",{primary:"primary"===e.color||"vkpay"===g,positive:"positive"===e.color,negative:"negative"===e.color}),b=["window.uMailWrite && uMailWrite._onKeyboardButtonClick","this","event",{action:Object(s.stringifyJSON)(e.action),authorId:t.author_id,inline:t.inline,msgId:n,subID:f}];m="vkpay"===g?[{class:"BotsKeyboard__buttonInner",inner:[r.default.wrap(v.mobile_mail_keyboard_label_vkpay),r.default.wrap("&nbsp;"),r.default.wrap("&nbsp;"),Object(a.default)(Object(c.getVkPay16Icon)())]}]:"location"===g?[{class:"BotsKeyboard__buttonInner",inner:[{tag:"span",class:"BotsKeyboard__leadingIcon",inner:Object(a.default)(Object(l.getPlace24Icon)())},r.default.wrap("&nbsp;"),{class:"BotsKeyboard__buttonLabelWrapped",inner:[r.default.wrap(v.mobile_mail_keyboard_label_location)]}]}]:"open_app"===g?[{class:"BotsKeyboard__buttonInner",inner:[{tag:"span",class:"BotsKeyboard__leadingIcon",inner:Object(a.default)(Object(u.getService24Icon)())},r.default.wrap("&nbsp;"),{class:"BotsKeyboard__buttonLabelWrapped",inner:[r.default.wrap(e.action.label)]}]}]:"open_link"===g?[{class:"BotsKeyboard__buttonInner",inner:[{class:"BotsKeyboard__buttonLabelWrapped",inner:[r.default.wrap(e.action.label)]},r.default.wrap("&nbsp;"),Object(a.default)(Object(d.getOpenLink16Icon)())]}]:[r.default.wrap(e.action.label)];var w=!1,y="";f&&(y=f+"|");var O=""+y+p+","+h;return _&&_[O]&&(w=!0),Object(i.default)({class:A,isLoading:w,spinner:!0,on_click:b,use_native_onclick:!0,inner:m,theme:"none",size:"normal",type:"button",attrs:{"data-position":O}})}t.default=_},B9v3:function(e,t,n){"use strict";n.r(t),n.d(t,"setBookmarkState",(function(){return le})),n.d(t,"ActionsPanel",(function(){return O})),n.d(t,"init",(function(){return ue}));var i=n("OcsD"),a=n("Y6JH"),r=n("VRji"),o=n("p5n7"),s=n("29dZ"),c=n("fdw3"),l=n("haUC"),u=n("Uz3H"),d=n("7ADY"),_=n("1S0R"),f=n("ETBP"),p=n("dvEy"),h=n("Epxf"),m=n("sYro"),v=n("7E7W"),g=n("3ZCC"),A=n("Fbxv"),b=n("2fMF"),w=n("PssS");function y(e){return void 0===e&&(e={}),{class:"SharePanel SharePanel-header SharePanel--active ShareHeaderConversationsPanel","aria-hidden":"false","data-name":"ShareHeaderConversationsPanel",inner:[{"aria-label":Object(c.getLang)("mobile_close"),onclick:"cur.share.destroy()",role:"button",class:"SharePanel-header__close",inner:Object(a.default)(Object(d.getCancel24Icon)())},{class:"SharePanel-headerText",inner:[{class:"SharePanel-headerText__label",inner:Object(c.getLang)("mobile_like_publish_head_title")},{class:"SharePanel-headerText__receivers"}]},{class:"SharePanel-headerRight",inner:[{"aria-label":Object(c.getLang)("mobile_search"),class:"SharePanel-headerRight__search",role:"button",inner:Object(a.default)(Object(_.getSearch24Icon)()),onclick:"cur.share.toggleConversationsSearch(true)"},e.supportsExternalShare?{"aria-label":Object(c.getLang)("mobile_share_external"),class:"SharePanel-headerRight__externalShare",role:"button",inner:"iOS"===e.platform?Object(a.default)(Object(f.getShareExternalIos24Icon)()):Object(a.default)(Object(p.getShareExternalAndroid24Icon)()),onclick:"cur.share.externalShare()"}:null]}]}}function O(e){var t=e.buttons,n=e.options,i="boolean"!=typeof e.active||e.active;return{class:"ActionsPanel SharePanel "+(i?"SharePanel--active":""),"data-name":"ActionsPanel","aria-hidden":!i,style:!(n.can_to_own||n.can_to_club||n.can_bookmark)?"display: none;":"",inner:t.map((function(e){if(e)return function(e){var t=e.href?"a":"div",n=e.onclick,i={tag:t,role:"button",tabindex:-1,href:e.href,onclick:n,class:"ActionsPanel-button ActionsPanel-button--"+e.target,inner:[{class:"ActionsPanel-button__icon",inner:e.icon},{class:"ActionsPanel-button__label",inner:e.label}]};"boolean"==typeof e["aria-pressed"]&&(i["aria-pressed"]=e["aria-pressed"]+"");return i}(e)}))}}var S=function(e){var t=e.can_bookmark,n=e.is_bookmarked,i=e.object,d=e.list,f=e.from,p=e.post_from,S=e.supportsExternalShare,k=e.isVKApp,C=e.targetOwnOnClick,j=Object(c.makeUrl)("/wall",{act:"add",share_box:1,is_vk_app:k,object:i,list:d,from:f,post_from:p});return{inner:[{inner:[y({platform:e.platform,supportsExternalShare:S}),{class:"SharePanel ShareHeaderSearch ShareHeaderConversationsSearchPanel","aria-hidden":"true","data-name":"ShareHeaderConversationsSearchPanel",role:"search",inner:Object(o.default)({disabled:!0,autocomplete:!1,onblur:'cur.share.clearSearch(event, "peers", true)',prefix:{text:{role:"button",inner:Object(a.default)(Object(m.getSearchOutline16Icon)())}},postfix:{text:{class:"ShareHeaderSearch__clear",role:"button",onclick:'cur.share.clearSearch(event, "peers")',inner:Object(a.default)(Object(v.getCancelOutline24Icon)())}},class:"ShareHeaderConversationsSearchPanel__input",id:"ShareHeaderConversationsSearchPanel__input",placeholder:Object(c.getLang)("mobile_search"),spellcheck:!1})},{class:"SharePanel SharePanel-header ShareHeaderGroupsPanel","aria-hidden":"true","data-name":"ShareHeaderGroupsPanel",inner:[{"aria-label":Object(c.getLang)("mobile_back"),onclick:"cur.share.toggleGroupsPanel(false)",role:"button",class:"SharePanel-header__close",inner:Object(a.default)(Object(h.getBack24Icon)())},{class:"SharePanel-headerText",inner:[{class:"SharePanel-headerText__label",inner:Object(c.getLang)("mobile_like_publish_head_title")}]},{class:"SharePanel-headerRight",inner:[{class:"SharePanel-headerRight__search",role:"button",inner:Object(a.default)(Object(_.getSearch24Icon)()),onclick:'cur.share.setActivePanel(this, "ShareHeaderGroupsSearchPanel", true)'}]}]},{class:"SharePanel ShareHeaderSearch ShareHeaderGroupsSearchPanel","aria-hidden":"true","data-name":"ShareHeaderGroupsSearchPanel",role:"search",inner:Object(o.default)({disabled:!0,autocomplete:!1,onblur:'cur.share.clearSearch(event, "group", true)',prefix:{text:{"aria-label":Object(c.getLang)("mobile_search"),role:"button",inner:Object(a.default)(Object(m.getSearchOutline16Icon)())}},postfix:{text:{class:"ShareHeaderSearch__clear",onclick:'cur.share.clearSearch(event, "group")',inner:Object(a.default)(Object(v.getCancelOutline24Icon)())}},class:"ShareHeaderGroupsSearchPanel__input",id:"ShareHeaderGroupsSearchPanel__input",placeholder:Object(c.getLang)("mobile_search"),spellcheck:!1})}],class:"SharePanelRoot ShareHeader",tag:"header"},{id:"Share__input",style:"display: none;",tag:"input"},{inner:[{class:"ShareConversations SharePanel SharePanel--active filter_peer_wrap","data-name":"ShareConversations","aria-hidden":"false",role:"group",id:"ShareConversations"},{class:"ShareGroups SharePanel","data-name":"ShareGroups","aria-hidden":"true",role:"group",id:"ShareGroups"}],class:"SharePanelRoot ShareLists",tag:"section"},{inner:[O({active:!0,options:e,buttons:[e.can_to_own?{target:"own",label:Object(c.getLang)("mobile_share_target_own"),onclick:C||"cur.share.go('"+j+"')",icon:Object(a.default)(Object(l.getRepostOutline28Icon)())}:null,e.can_to_club?{target:"group",label:Object(c.getLang)("mobile_share_target_group"),icon:Object(a.default)(Object(u.getUsersOutline28Icon)())}:null,t?{target:"bookmark","aria-pressed":n,label:n?Object(c.getLang)("mobile_share_target_bookmark_active"):Object(c.getLang)("mobile_share_target_bookmark"),icon:Object(a.default)(e.is_bookmarked?Object(b.getFavorite28Icon)():Object(w.getFavoriteOutline28Icon)())}:null]}),{class:"SharePanel MessagePanel","aria-hidden":"true","data-name":"MessagePanel",inner:[Object(o.default)({tabindex:-1,autocomplete:!1,class:"MessagePanel__input",on_click:["cur.share.expandMessage"],placeholder:Object(c.getLang)("mobile_share_message_placeholder"),spellcheck:!1,readonly:!0,disabled:!0}),Object(s.default)({stretch:!0,size:"large",inner:Object(c.getLang)("mobile_share_message_single"),on_click:"cur.share.sendMessage(event)",use_native_onclick:!0})]},{class:"SharePanel ExpandedMessagePanel","aria-hidden":"true","data-name":"ExpandedMessagePanel",inner:[{class:"ExpandedMessagePanel__textareaWrap",inner:[Object(r.default)({placeholder:Object(c.getLang)("mobile_share_message_placeholder"),rows:1}),{class:"ExpandedMessagePanelSend",inner:Object(a.default)(Object(g.getSendActive24Icon)())}]}]},{class:"SharePanel ProcessingPanel","aria-hidden":"true","data-name":"ProcessingPanel",inner:[{class:"ProcessingPanel__icon ProcessingPanel__icon--loading",inner:Object(a.default)(Object(A.getLoading40Icon)())},{class:"ProcessingPanel__label",inner:Object(c.getLang)("mobile_share_state_progress")}]}],class:"SharePanelRoot ShareBottom",tag:"footer"}],class:"Share","aria-role":"dialog","aria-label":Object(c.getLang)("mobile_like_publish_head_title"),hidden:"false",tabindex:"-1",tag:"div"}},k=n("wTbK"),C=n("YU/R"),j=n("Qz23"),E=n("+cqQ");function T(e){return/^((?:([a-z]+)_)?([a-z_]+))(-?\d+)?(?:_(\d+))?$/.test(e)}var I=n("UxAg"),M=n("j80l"),P=n("aiw/"),D=n("H5mD"),x=n("zq7H"),L=n("yOyn"),B=n("L3oE"),R=n("1u0X"),N=n("1UEa"),F="/hints?act=a_json_friends&mobile=1&from=imwrite&case=Nom&qs=1",H="ShareConversations",U=0,V=!1,W={bookmarks:{}};function $(e){z(e)}function q(e){nav.go(e),cur.share.destroy({isNavigation:!0})}function z(e){if(cur.share){var t=cur.share._els.header,n=e.scrollTop;t.classList.toggle("ShareHeader--scrolled",n>=10)}}function Y(e,t,n){if(!cur.share||cur.share.blocked)return!1;if(K(!0),Object(i.cancelEvent)(n),Object(i.hasClass)("inline_item_selected",t))return cur.shareSearch.toggleAttach(e,!1),function(e,t){for(var n=0;n<cur.share.selected.length;n++)if(cur.share.selected[n]===e){cur.share.selected.splice(n,1);break}return Z(!1),te(),!1}(e);cur.shareSearch.toggleAttach(e,!0);for(var a=!1,r=0;r<cur.share.selected.length;r++)if(cur.share.selected[r]===e){a=!0;break}return a||cur.share.selected.push(e),K(!1),Z(!1),te(),!1}function G(e,t,n){if(cur.share&&!cur.share.blocked){e=e.closest(".SharePanelRoot");var a,r=Object(I.$$)(".SharePanel",e);t&&(a=Object(I.$)("."+t,e)),r.forEach((function(e){var t=e===a;e.setAttribute("aria-hidden",!t),e.classList.toggle("SharePanel--active",t),t?e.removeAttribute("tabindex"):e.setAttribute("tabindex",-1),Object(I.$$)("input, ul",e).forEach((function(e){e.setAttribute("aria-hidden",!t);var n=e.closest(".TextInput");t?(null==n||n.classList.remove("TextInput_disabled"),e.removeAttribute("disabled"),e.setAttribute("tabindex",0)):(null==n||n.classList.add("TextInput_disabled"),e.setAttribute("disabled",!0),e.setAttribute("tabindex",-1))}))}));var o=Object(I.$)("input",a);o&&n&&o.focus(),Object(i.setStyle)(e,{height:a?a.clientHeight:0})}}function K(e){var t=Object(I.$)(".ShareModal");t&&t.classList.toggle("ShareModal--disableAnimations",!e)}function Q(e){if(cur.share){var t=cur.share._els,n=t.header,i=t.content,a=t.bottom;i.classList.add("ShareLists--transition"),K(!0),G(n,e?"ShareHeaderGroupsPanel":"ShareHeaderConversationsPanel"),G(i,e?"ShareGroups":"ShareConversations"),G(a,e?"":"ActionsPanel"),setTimeout((function(){i.classList.remove("ShareLists--transition")}),300),Object(I.$)(".SharePanel--active ul",i).focus(),te(),z(e?Object(I.$)("#ShareGroups .ShareList__container"):Object(I.$)("#ShareConversations .ShareList__container"))}}function X(e){if(cur.share){var t=cur.share._els,n=t.header,a=t.bottom,r=ee();V=e,K(!1),G(a,e?"":r),e&&G(n,"ShareHeaderConversationsSearchPanel",!0),!D.isIOS&&window.innerWidth<x.DESKTOP_WIDTH&&te(e),setTimeout((function(){browser.ios&&Object(i.scrollTop)(document.activeElement)}),500)}}function J(){if(cur.share){var e=cur.share._els,t=e.content,n=e.bottom,i=e.messageTextarea;G(n,"ExpandedMessagePanel"),t.classList.add("ShareLists--transition"),D.isIOS||te(!1),i.focus({preventScroll:!0})}}function Z(e){if(void 0===e&&(e=!0),cur.share){var t=cur.share,n=t.selected,a=t._els;Object(i.ge)(H)&&(!function(){if(!cur.share)return;var e=cur.share.cache._cache,t=Object(I.$)(".ShareHeaderConversationsPanel"),n=Object(I.$)(".ShareHeaderConversationsPanel .SharePanel-headerText__receivers",t),i=cur.share.selected,a=i.length;t.classList.toggle("ShareHeaderConversationsPanel--hasReceivers",a>0);var r="";if(1===a){r=Object(c.getLang)("mobile_share_box_to_single");var o=e[i[0]][0];r=r.replace("{name}",o)}else if(2===a){r=Object(c.getLang)("mobile_share_box_to_couple");var s=e[i[0]][6]||e[i[0]][0],l=e[i[1]][6]||e[i[1]][0];r=r.replace("{name1}",s).replace("{name2}",l)}else if(a>2){r=Object(c.getLang)("mobile_share_box_to_many");var u=e[i[0]][6]||e[i[0]][0];r=r.replace("{name}",u).replace("{count}",a-1)}n.innerHTML=r}(),ne());var r,o,s=ee();G(a.bottom,s,e),r=n.length>1,o=cur.share._els.messagePanel,Object(I.$)(".Btn",o).innerHTML=r?Object(c.getLang)("mobile_share_message_many"):Object(c.getLang)("mobile_share_message_single")}}function ee(){if(cur.share){var e=cur.share,t=e.selected,n=e.content,i=Object(I.$)(".SharePanel--active",n).getAttribute("data-name");return"ShareHeaderGroupsSearchPanel"===i||"ShareHeaderGroupsPanel"===i?"":document.activeElement&&document.activeElement.closest(".ExpandedMessagePanel")?"ExpandedMessagePanel":t.length>0?"MessagePanel":"ActionsPanel"}}function te(e){if(cur.share&&cur.share._els){var t=cur.share._els,n=t.header,a=t.bottom,r=t.content,o=t.groupsList;if(n&&a&&r){var s=400;(e=V||e)&&(s+=cur.share.lastBottomHeight-Object(i.getH)(a)),a.clientHeight&&(cur.share.lastBottomHeight=a.clientHeight);var c=[n,a].reduce((function(e,t){var n=Object(I.$)(".SharePanel--active",t);return n&&(e+=n.clientHeight,Object(i.setStyle)(t,{height:n.clientHeight})),e}),0),l=Math.min(s,Object(i.getCh)()-c),u=c+l!==U;u||(K(!1),r.classList.remove("ShareLists--transition")),Object(i.setStyle)(o,{bottom:-a.clientHeight}),Object(i.setStyle)(r,{height:l}),u||K(!0),U=c+l}}}function ne(){cur.share&&Object(i.each)(Object(i.geByClass)("inline_item",Object(I.$)("ShareConversations__container")),(function(e,t){if(cur.share){var n=Object(i.intval)((t.id||"").substr(4)),a=-1!==cur.share.selected.indexOf(n);Object(i.toggleClass)("inline_item_selected",t,a),t.setAttribute("aria-selected",a);var r=Object(I.$)('input[type="checkbox"]',t);r&&(r.checked=a)}}))}function ie(e){var t=cur.share._els.bookmarkButton;if(t){var n=Object(I.$)(".ActionsPanel-button__icon",t),i=Object(I.$)(".ActionsPanel-button__label",t);t.setAttribute("aria-pressed",e),e?(n.innerHTML=Wd.html(Object(a.default)(Object(b.getFavorite28Icon)())),i.innerHTML=Object(c.getLang)("mobile_share_target_bookmark_active")):(n.innerHTML=Wd.html(Object(a.default)(Object(w.getFavoriteOutline28Icon)())),i.innerHTML=Object(c.getLang)("mobile_share_target_bookmark")),window.thover.clear()}}function ae(e){var t=cur.share._els,n=t.bottom,r=t.processingPanel,o=this.mail_hash,s=this.object,l=this.list,u=this.appId,d=this.shouldInteractWithGlobalStories,_={_ajax:1,from:"share_box",hash:o,list:l,message:Object(I.$)(".ExpandedMessagePanel__textareaWrap textarea").value,to:cur.share.selected.join(","),app_id:u};T(cur.share.options.object)?_.media=s:_.link=s,K(!0),e&&Object(i.cancelEvent)(e),G(n,"ProcessingPanel"),cur.share.blocked=!0,(s.startsWith("story")||s.startsWith("narrative"))&&!1!==d&&window.Stories.sendAnalyticsEvent("share_to_message"),setTimeout((function(){te()})),setTimeout((function(){te()}),350),window.ajax.post("/mail?act=send",_,{onDone:function(e){K(!0);var t=Object(I.$)(".ProcessingPanel__icon",r),n=Object(I.$)(".ProcessingPanel__label",r);t.classList.remove("ProcessingPanel__icon--loading");var i=e.error;t.innerHTML=Wd.html(i?Object(a.default)(Object(R.getErrorCircle40Icon)()):Object(a.default)(Object(B.getDoneCircle40Icon)())),n.innerText=i?Object(c.getLang)("mobile_share_state_error"):Object(c.getLang)("mobile_share_state_success"),setTimeout((function(){cur.app&&(i&&cur.app.hasOwnProperty("vkMiniAppShareFail")?cur.app.vkMiniAppShareFail():!i&&window.isFunction(cur.app.vkMiniAppShareSuccess)&&cur.app.vkMiniAppShareSuccess(0)),cur.share&&cur.share.destroy({isFail:i})}),1e3)}})}function re(e,t,n){void 0===n&&(n=!1),Object(i.preventEvent)(e);var a,r,o,s=cur.share._els.header;if("group"===t?(a=Object(i.ge)("ShareHeaderGroupsSearchPanel__input"),r="ShareHeaderGroupsPanel",o=cur.shareGroupSearch):"peers"===t&&(a=Object(i.ge)("ShareHeaderConversationsSearchPanel__input"),r="ShareHeaderConversationsPanel",o=cur.shareSearch),K(!1),a.value){if(n)return void K(!0);o.clear()}else"peers"===t?(G(s,r),X(!1)):(G(s,r),K(!0))}function oe(){var e,t=cur.share.options.object,n="unknown";if(T(cur.share.options.object)){e=/^([a-z_]+)(-?\d+)_(\d+)$/.exec(cur.share.options.object),n=e[1];var a=e[2],r=e[3];"app"===n&&"0"===r&&(t="app"+a),cur.share.options.list&&(t+="?list="+cur.share.options.list),t=t.replace("wall_reply","wall")}else cur.share.options.isVKApp&&(n="link");t=cur.share.options.external_url||t;var o=navigator.share({url:t});if(!o)return Object(i.statlogsValueEvent)("mvk_share_external",n);o.then((function(){cur.share&&Object(i.statlogsValueEvent)("mvk_share_external",n)}))}function se(e,t,n){var a=e.split("_"),r=31,o=5,s=6,c=[r,o,3,s].includes(Object(i.toInt)(t.bookmark_type)),l=[2,s].includes(t.bookmark_type);if(window.ajax.post("/bookmarks.php",{_ajax:1,from:"share_box",wide:l?1:0,star:c?1:0,act:t.is_bookmarked?"bookmark_remove":"bookmark_add",item_type:t.bookmark_type,item_oid:a[0],item_id:a[1],hash:t.bookmark_hash,link_url:t.link_url,link_title:t.link_title,link_img:t.link_img},{onDone:function(e,t,n,a,o){var s=Object(I.$)("."+e),c=Object(i.ceFromString)(t);s&&Object(i.replace)(c,s.parentNode),n&&n.item_type===r&&o&&Object(N.sendNarrativeAnalytic)(N.NarrativeAnalyticEventType.addToBookmarks,n.item_oid,n.item_id,N.NarrativeAnalyticNavScreen.storyViewer)}}),t.bookmark_type===o&&window.Article.toggleButton(e,!t.is_bookmarked),t.bookmark_type===r&&!1!==t.shouldInteractWithGlobalStories){var u=Object(I.$)(".StoryMenu__button");window.Stories.toggleBookmark(u,!0)}t.is_bookmarked=!t.is_bookmarked,W.bookmarks[e]=t.is_bookmarked,n()}function ce(){te(!1)}function le(e,t){W.bookmarks[e]=t}var ue=function(e,t,n){var o=t.can_to_own,s=void 0===o||o,l=t.can_to_club,u=void 0===l||l,d=t.can_bookmark,_=t.is_bookmarked,f=t.from,p=t.post_from,h=t.list,m=t.targetOwnOnClick,v=t.appId,g=t.isVKApp;cur.share&&cur.share.destroy();var A=!T(t.object);if(!A||g){A&&!/^(https|http)?:\/\//i.test(t.object)&&(t.object="https://"+e,e=t.object),C.default&&C.default.close(),t.withoutScrollView||Object(j.preventDocumentScroll)(),A||(_=void 0!==W.bookmarks[e]?W.bookmarks[e]:_,t.is_bookmarked=_),Object(i.cancelEvent)(n);var b=!!navigator.share,w=browser.ios?"iOS":"Android",y=Object(k.default)({on_overlay_click:"cur.share.destroy()",class:"ShareModal",attached:!0,body:S({targetOwnOnClick:!!m&&"cur.share.toOwnWall()",can_to_own:s,can_to_club:u,supportsExternalShare:b,platform:w,can_bookmark:d,is_bookmarked:_,list:h,from:f,post_from:p,object:t.object,isVKApp:t.isVKApp})}),O=t.withoutHash?null:"share";k.default.open(Wd.elem(y),!0,O,{swipeDown:!0,onClose:function(){cur.share&&cur.share.destroy({closeModal:!1})}});var x=Object(I.$)(".ShareModal"),B=Object(I.$)(".ShareHeader"),R=Object(I.$)(".ShareLists"),N=Object(I.$)(".ShareBottom"),U=Object(I.$)(".ActionsPanel-button--bookmark"),V=Object(I.$)(".ActionsPanel-button--group");setTimeout((function(){!function(e){void 0===e&&(e={});cur.shareSearch=new window.QuickSearch;var t=e.appId?F+"&app_id="+e.appId:F,n=e.appId?F+"&app_id="+e.appId+H:"/hints?act=a_json_friends&mobile=1&from=imwrite&case=Nom&qs=1ShareConversations";cur.shareSearch.init({action:t,field:"ShareHeaderConversationsSearchPanel__input",container:H,top_len:20,onFocusChanged:function(e){e?P.onOpen("top"):P.onClose(),te(e),setTimeout((function(){te(e)}),200)},tpl:function(e,t){return'<ul aria-multiselectable="true" aria-hidden="false" class="ScrollView ShareConversations__container ShareList__container" onscroll="cur.share.onScroll(this)">'+e+"</ul>"},item_tpl:function(e,t){if(cur.share){var n=cur.share.cache._cache,i=n[this.id][0],r=!(!n[this.id][8]||!n[this.id][8].is_casper)?'<span class="ShareConversationsCasperTitle">\n             <span class="ShareConversationsCasperTitle__text">'+this.highlight(i)+'</span>\n             <span class="ShareConversationsCasperTitle__icon">'+Wd.html(Object(a.default)(Object(L.getCasper16Icon)()))+"</span>\n           </span>":this.highlight(i),o=-1!==cur.share.selected.indexOf(+this.id)?"inline_item_selected":"";return'\n        <label aria-label="'+i+'" tabindex="0" role="checkbox" id="peer'+this.id+'" onclick="cur.share.select('+this.id+', this)" class="inline_item active '+o+'">\n          <input type="checkbox" style="display: none;">\n            <img aria-hidden="true" class="ii_img" src="'+t+'" />\n            <div class="ii_body">\n              <div class="ii_owner">\n                 '+r+"\n              </div>\n            </div>\n          </input>\n        </label>\n      "}},null_tpl:function(e){var t=Object(c.getLang)("mobile_friends_search_not_found").replace("%s",Object(i.htsc)(e));return e||(t=Object(c.getLang)("mobile_share_list_no_friends")),'<div class="service_msg_box"><div class="service_msg service_msg_null">'+t+"</div></div>"}}),cur.share.cache=window.QuickSearchCache[n],ne()}({appId:v})}),250),Object(i.addEvent)(U,"click",se.bind(this,e,t,(function(){ie(t.is_bookmarked)})),{passive:!0}),Object(i.addEvent)(V,"click",(function(){Q(!0)}),{passive:!0});var z=Object(I.$)(".ExpandedMessagePanel textarea"),ee=Object(I.$)(".MessagePanel__input input");z.value=t.message||"",ee.value=t.message||"",Object(r.initAutogrow)(z),Object(i.addEvent)(z,"input blur focus",(function(e){var t=cur.share._els.content;ee.value=z.value.replace(/\n/gi," "),K(!1),"input"===e.type&&te(!1),"focus"===e.type&&(t.classList.remove("ShareLists--transition"),x.classList.add("ModalMenu--blocked"),x.classList.add("ModalMenu--focused"),P.onOpen("bottom"),setTimeout((function(){Z(!0),K(!1),te()}),100)),"blur"===e.type&&(x.classList.remove("ModalMenu--blocked"),e.preventDefault(),e.stopPropagation(),P.onClose(),K(!1),x.classList.remove("ModalMenu--focused"),D.isIOS||te(!1),setTimeout((function(){Z(!1),K(!1),te()}),100))})),Object(i.addEvent)(Object(I.$)(".ExpandedMessagePanelSend"),"click touchend",(function(e){e.stopPropagation(),e.preventDefault(),document.activeElement&&document.activeElement.blur(),cur.share.sendMessage()}),{capture:!0}),Object(i.addEvent)(z,"touchmove",(function(e){Object(i.stopEvent)(e)}),{capture:!0}),P.onCloseCallback(ce),Object(i.addEvent)(z,"keydown",(function(e){13===e.keyCode&&(e.ctrlKey||e.metaKey&&browser.mac)&&cur.share.sendMessage(e)}));var le={act:"publish_box",object:"null"};v&&(le.app_id=v),t.object?(le.object=t.object,t.list&&(le.list=t.list)):A&&(le.link=e,delete le.object);var ue=Object(M.makeUrl)("/like",le);cur.share={open:!0,onClose:Object(E.default)(),go:q,options:t,externalShare:oe,actionBox:ue,blocked:!1,updateHeights:te,_els:{actionsPanel:Object(I.$)(".ActionsPanel"),messagePanel:Object(I.$)(".MessagePanel"),processingPanel:Object(I.$)(".ProcessingPanel"),groupsList:Object(i.ge)("ShareGroups"),conversationsList:Object(i.ge)("ShareConversations"),bookmarkButton:U,messageTextarea:z,header:B,content:R,bottom:N},selected:[],expandMessage:J,toggleGroupsPanel:Q,toggleConversationsSearch:X,select:Y,clearSearch:re,setActivePanel:G,onScroll:$,sendMessage:ae.bind(t),lastBottomHeight:N.clientHeight,destroy:function(e){void 0===e&&(e={}),e=Object(i.extend)({closeModal:!0,isFail:!0,isNavigation:!1},e),P.offCloseCallback(ce);var t=Object(I.$)(".ShareModal");e.isFail&&cur.app&&cur.app.vkMiniAppShareFail&&cur.app.vkMiniAppShareFail(),t&&e.closeModal&&k.default.close(t),cur.share&&(cur.share.onClose(e.isNavigation),cur.share.open=!1),cur.share.options.withoutScrollView||Object(j.restoreDocumentScroll)(),delete cur.share,delete cur.shareSearch,delete cur.shareGroupSearch}},m&&(cur.share.toOwnWall=m),setTimeout((function(){!function(){cur.shareGroupSearch=new window.QuickSearch;var e=window.Icon({icon:"chevron_right"});if(!cur.share||!cur.share.options.can_to_club)return;cur.shareGroupSearch.init({load_once:!0,field:"ShareHeaderGroupsSearchPanel__input",container:"ShareGroups",action:cur.share.actionBox,onFocusChanged:function(e){e?P.onOpen("top"):P.onClose(),setTimeout((function(){te(!1)}),100)},tpl:function(e,t){return'<ul aria-hidden="true"  class="ScrollView ShareGroups__container ShareList__container" onscroll="cur.share.onScroll(this)">'+e+"</ul>"},item_tpl:function(t,n){if(!cur.share)return"";var a=function(){if(!cur.share)return{};var e=cur.share.actionBox+"ShareGroups";return window.QuickSearchCache[e]}()._cache[this.id][0],r=cur.share.options,o=r.object,s=r.list,c=r.from,l=r.post_from,u={act:"add",share_box:"1"};o&&(u=Object(i.extend)(u,{object:o,list:s,from:c,post_from:l})),cur.share.options.isVKApp&&(u.is_vk_app=+cur.share.options.isVKApp);var d=Object(M.makeUrl)("/wall"+this.id,u);return'\n        <li aria-label="'+a+'" tabindex="0" role="link" id="group'+this.id+'" onclick="cur.share.go(\''+d+"', "+cur.share.options.isVKApp+')" class="inline_item " xmlns="http://www.w3.org/1999/html">\n          <img aria-hidden="true" class="ii_img" src="'+n+'" />\n          <div class="ii_body">\n            <div class="ii_owner">\n               '+this.highlight(a)+'\n            </div>\n            <div class="ii_go">\n               '+e+"\n            </div>\n          </div>\n        </li>\n      "},null_tpl:function(e){var t=Object(c.getLang)("mobile_groups_no_groups_found");return e||(t=Object(c.getLang)("mobile_share_list_no_groups")),'<div class="service_msg_box"><div class="service_msg service_msg_null">'+t+"</div></div>"}})}()}),300),ie(_),te(),B.closest(".Share").focus(),window.onBodyResize((function(){document.activeElement&&"INPUT"===document.activeElement.tagName?te(!0):te(!1),setTimeout((function(){K(!0)}),150)})),window.onBodyResize(!0)}else console.warn("Can't share link outside miniapp")};window.Share=ue,Object(i.extend)(window.Share,{setBookmarkState:le});t.default=S},"BJj/":function(e,t,n){"use strict";function i(e,t,n){var i;return function(){var a=this,r=arguments,o=function(){i=null,n||e.apply(a,r)},s=n&&!i;clearTimeout(i),i=setTimeout(o,t),s&&e.apply(this,r)}}n.r(t),n.d(t,"debounce",(function(){return i}))},BLcx:function(e,t){var n,i=(n=document.getElementsByClassName("gift_create_post_counter"),{counter:function(e){var t=n[0];if(t){var i=e.value.length,a=e.maxLength;if(i>a)e.value=e.value.substr(0,a);else if(i>a/2){var r=Math.max(a-i,0);t.innerText=langNumeric(r,lang.text_N_symbols_remain),show(t)}else hide(t)}}});window.GiftsSendFormCounter=i},BZzM:function(e,t,n){"use strict";n.r(t),n.d(t,"resizePosters",(function(){return i}));function i(e,t,n){var i=ge(t)||document,a="[data-poster-resized='false']";(e||n)&&(a="");var r=domQuery(".poster__text"+a,i),o=[],s=cur.posterConfig&&cur.posterConfig.constants;if(!s){if(!r.length)return;s=JSON.parse(domData(r[0].parentElement,"poster-constants"))}for(var c=0;c<r.length;c++){var l=r[c],u=domPN(l);o.push(domPN(u).clientWidth)}for(var d=0;d<r.length;d++){var _=r[d],f=domPN(_),p=o[d],h=s.font_size_ratio_range_1*p+"px",m=Math.round(s.line_height_ratio_range_1*p)+"px",v="0 "+Math.round(p*(1/18))+"px";_.textContent.length>s.range_threshold&&(h=Math.round(s.font_size_ratio_range_2*p)+"px",m=Math.round(s.line_height_ratio_range_2*p)+"px"),setStyle(f,{height:p*(3/4)+"px",width:p}),setStyle(_,{fontSize:h,lineHeight:m,padding:v}),domData(_,"poster-resized",!0)}}},BoyB:function(e,t,n){"use strict";n.r(t);var i=n("TYsd"),a=n("z9sQ"),r=n("Y6JH"),o=n("/0lW"),s=function(e){void 0===e&&(e={});var t=[e.class||e.mix,a.default.class("Loading",{white:e.white,large:e.large,spinner:e.spinner},"_")];if(e.spinner)return i.default.html({inner:[Object(r.default)({icon:Object(o.getSpinner16Icon)()})],class:t,tag:"div"});return i.default.html({inner:[{inner:[[{class:"Loading__item Loading__item_0",tag:"div"},{class:"Loading__item Loading__item_1",tag:"div"},{class:"Loading__item Loading__item_2",tag:"div"}]],class:"Loading__items",tag:"div"}],class:t,tag:"div"})};t.default=s;window.Loading=s},CQvH:function(e,t,n){"use strict";n.r(t),n.d(t,"isTabbing",(function(){return w})),n.d(t,"setFocusTrap",(function(){return y})),n.d(t,"setMenuNavigation",(function(){return O})),n.d(t,"expandPopup",(function(){return S})),n.d(t,"onTransitionEnd",(function(){return k})),n.d(t,"sayIt",(function(){return o}));var i=n("OcsD"),a=n("H5mD"),r=n("UxAg");function o(e,t){var n=(void 0===t?{}:t).important,i=void 0!==n&&n;if(e){Object(r.$$)('[id^="say-it-"]').forEach((function(e){document.body.removeChild(e)}));var a=document.createElement("span"),o=i?"alert":"status";a.setAttribute("aria-live",i?"assertive":"polite"),a.setAttribute("role",o),a.classList.add("visually-hidden"),a.id="say-it-"+Date.now(),document.body.appendChild(a),setTimeout((function(){a.innerHTML=e}),10)}}var s=function(){function e(e){var t=e.capacity,n=void 0===t?1:t;this._capacity=n,this.clear()}var t=e.prototype;return t.add=function(e){this._cursor>=this._capacity&&(this._cursor=0),this._buffer[this._cursor]=e,this._cursor++,this._size<this._capacity&&this._size++},t.clear=function(){this._buffer=Array(this._capacity),this._cursor=0,this._size=0},t.size=function(){return this._size},t.toArray=function(){return this._buffer},e}(),c=n("DM2o"),l=n("Cz26"),u=n("W9Tc");!function(){var e=new s({capacity:15}),t=new s({capacity:15}),n=new s({capacity:15}),i=new s({capacity:15}),a=null;if(window.addEventListener("mousemove",(function(){if(a){var t=Date.now()-a;t>500&&(t-500<500&&e.add(!1),a=null)}else a=Date.now()}),{capture:!0,passive:!0}),new l.Timers({timer:1e4}).add((function(){e.add(!0)})),window.addEventListener("touchstart",(function(e){if(e&&e.touches)if(e.touches.length>1)t.add(!1);else{if(1===e.touches.length){var n=e.touches[0];if(0!==n.radiusX&&0!==n.radiusY)return void t.add(!1)}t.add(!0)}}),{capture:!0,passive:!0}),window.addEventListener("click",(function(a){if(a&&a.target){var r=0===a.pageX&&0===a.pageY&&0===a.screenX&&0===a.screenY,o=a.target.getBoundingClientRect(),s=Math.abs(o.width/2+o.left-a.clientX)<2&&Math.abs(o.height/2+o.top-a.clientY)<2;if(r||s){n.add(!0);try{i.add(function e(t){if(t.id)return"#"+t.id;var n=t.tagName.toLowerCase(),i="";t.name&&(i+='[name="'+t.name+'"]');var a="";!i&&t.className&&(a=t.className.split(/ +/g).map((function(e){return"."+e})).join(""));var r="";if(!i)for(var o=0,s=0;s<t.parentNode.children.length;s++){var c=t.parentNode.children[s];if(c.tagName===t.tagName&&o++,t===c){r=":nth-of-type("+o+")";break}}var l=n+i+a+r;return t.parentNode===document.body?"body > "+l:e(t.parentNode)+" > "+l}(a.target)+"—"+s+"—"+r)}catch(e){}}else n.add(!1),i.add(!1);if(n.size()>3){var l=e.toArray().filter((function(e){return e})).length>=Math.round(e.size()/2),u=t.toArray().filter((function(e){return e})).length>=Math.round(t.size()/2),d=n.toArray().filter((function(e){return e})).length>=Math.round(n.size()/2);if(localStorage&&localStorage.getItem){var _=localStorage.getItem("isKeyboardUser1"),f=d&&u&&l,p=document.querySelector(".keyboardUser");p&&(f?(p.style.display="block",p.innerHTML=e.toArray().filter((function(e){return e})).length+"."+t.toArray().filter((function(e){return e})).length+"."+n.toArray().filter((function(e){return e})).length):p.style.display="none"),(f&&null===_||null!==_&&_!==String(f))&&(localStorage.setItem("isKeyboardUser1",f),Object(c.statlogsValueEvent)("accessibility","is_keyboard_user",f))}}}}),{capture:!0,passive:!0}),Object(u.partConfigEnabled)("mvk_show_a11y_box")){var r=window.onDOMReady||function(e){setTimeout(e,5e3)};r&&r((function(){if(document.body&&!document.querySelector(".keyboardUser")){var e=document.createElement("div");e.style.background="rgba(230,0,255,.7)",e.style.position="fixed",e.style.top="3px",e.style.right="3px",e.style.color="#fff",e.style.fontSize="10px",e.style.minWidth="8px",e.style.height="14px",e.style.lineHeight="14px",e.style.textAlign="center",e.style.border="1px solid rgba(255,255,255, 0.2)",e.style.display="none",e.style.zIndex=9999999999,e.innerHTML="K",e.style.padding="0 3px",e.className="keyboardUser";var t=document.createElement("textarea");if(t.style.position="fixed",t.style.opacity=.9,t.style.top=0,t.style.right=0,t.style.bottom=0,t.style.left=0,t.style.width="100%",t.style.padding="10px",t.style.zIndex=9999999,t.style.display="none",document.body.appendChild(t),e.addEventListener("click",(function(){t.innerHTML=i.toArray().join("\n\n"),"none"===t.style.display?t.style.display="block":t.style.display="none"})),document.body.appendChild(e),localStorage&&localStorage.getItem)"true"===localStorage.getItem("isKeyboardUser1")&&(e.style.display="block")}}))}}();var d=38,_=40,f=36,p=35,h=32,m=13,v=27,g=9,A=["a[href]","area[href]","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","button:not([disabled])","iframe","audio","video","[contenteditable]","[tabindex]"];function b(){document.body.classList.add("tabbing")}function w(){return document.body.classList.contains("tabbing")}function y(e){if(a.isIOS&&a.iosMajor>8)return!1;if(!e)throw new Error("A11y: No element passed to setFocusTrap");var t=Array.from(e.querySelectorAll(A.join()));if(!(t=t.filter((function(e){return null!==e.offsetParent}))).length)return!1;var n=t[0],i=t[t.length-1],r=j(e,(function(e){var t=e.event,a=e.exit;t.keyCode===g&&(t.shiftKey?document.activeElement===n&&(t.preventDefault(),i.focus()):document.activeElement===i&&(t.preventDefault(),n.focus())),t.keyCode===v&&a()}));return cur.destroy.push((function(){r()})),setTimeout((function(){n.focus()})),r}function O(e,t){void 0===t&&(t={});var n=void 0===t.enableInitialFocus||t.enableInitialFocus;if(a.isIOS&&a.iosMajor>8)return!1;if(!e)throw new Error("A11y: No element passed to setMenuNavigation");if(!["menu","menubar"].includes(e.getAttribute("role")))throw new Error('A11y: Element must be `role="menu"` or `role="menubar"`');var i=['[role="menu"]','[role="menubar"]'].join(),r=['[role="menuitem"]','[role="menuitemradio"]','[role="menuitemcheckbox"]'].join(),o=Array.from(e.querySelectorAll(i)),s=Array.from(e.querySelectorAll(r));if(o.forEach((function(e){Array.from(e.querySelectorAll(r)).forEach((function(e){s[s.indexOf(e)]=null}))})),!(s=(s=s.filter((function(e){return e}))).filter((function(e){return null!==e.offsetParent}))).length)return!1;if("menu"===e.getAttribute("role")&&!s.every((function(e){return"-1"===e.getAttribute("tabindex")})))throw new Error('A11y: Every `menuitem` must have `tabindex="-1" attribute`');var c=j(e,(function(e){var t=e.event,n=e.exit,i=document.activeElement,a=s[0],r=s[s.length-1||0],o=s.indexOf(i),c=s[o+1],l=s[o-1];t.keyCode===d&&(l?C(l,t):r&&C(r,t)),t.keyCode===_&&(c?C(c,t):a&&C(a,t)),t.keyCode===f&&a&&C(a,t),t.keyCode===p&&r&&C(r,t),t.keyCode!==h&&t.keyCode!==m||(n(),i.click(),t.preventDefault()),t.keyCode!==v&&t.keyCode!==g||n()}),{onExit:function(){}});return n&&setTimeout((function(){C(s[0])})),c}function S(e){if(!e)throw new Error("A11y: No element passed to expandPopup");if(!e.getAttribute("aria-haspopup"))throw new Error("A11y: No `aria-haspopup` attribute on expanded element");if(null==e.getAttribute("aria-expanded"))throw new Error("A11y: No `aria-expanded` attribute on expanded element");if(null==e.getAttribute("aria-controls"))throw new Error("A11y: No `aria-controls` attribute on expanded element");if(!document.getElementById(e.getAttribute("aria-controls")))throw new Error("A11y: No element that the `aria-controls` refers to. Try to call `expandPopup` _after_ appending a popup");return e.setAttribute("aria-expanded",!0),j(e,(function(e){var t=e.event,n=e.exit;t.keyCode===v&&n()}),{onExit:function(){e.setAttribute("aria-expanded",!1)}})}function k(e,t){var n,i;void 0===t&&(t={});var a=null!=(n=t.startThreshold)?n:10,r=null!=(i=t.ignoreBubbledEvents)&&i;return new Promise((function(t){var n=setTimeout((function(){e.removeEventListener("transitionrun",i),t()}),a),i=function i(a){if(r&&a.target!==a.currentTarget)return!1;clearTimeout(n),e.removeEventListener("transitionrun",i);e.addEventListener("transitionend",(function n(i){if(r&&i.target!==i.currentTarget)return!1;e.removeEventListener("transitionend",n),t()}),!1)};e.addEventListener("transitionrun",i,!1)}))}function C(e,t){t&&(b(),t.preventDefault());var n=!1;null!=e.getAttribute("tabindex")&&(n=!0),n||e.setAttribute("tabindex",0),e.focus(),setTimeout((function(){n||e.removeAttribute("tabindex")}))}function j(e,t,n){void 0===n&&(n={}),e._enteredA11yElementKeyDownHandler&&document.removeEventListener("keydown",e._enteredA11yElementKeyDownHandler);var a=document.activeElement,r=!1;function o(t){if(t&&o.exitIntent&&!1===o.exitIntent(t))t.preventDefault();else if(!r){r=!0;var c=Object(i.scrollTop)(),l=Array.from(e.querySelectorAll(A.join()));document.activeElement&&!l.includes(document.activeElement)||(a&&C(a),Object(i.scrollTop)(c)),document.removeEventListener("keydown",s),n.onExit&&n.onExit()}}function s(e){e.ctrlKey||e.altKey||e.metaKey||t({event:e,exit:o.bind(null,e)})}return document.addEventListener("keydown",s),e._enteredA11yElementKeyDownHandler=s,o}addEvent(window,"keydown",(function(e){e.keyCode===g&&b()}),{passive:!0}),addEvent(window,"mousedown touchstart",(function(){document.body.classList.remove("tabbing")}),{capture:!0,passive:!0}),document._buttonA11yFix||(document._buttonA11yFix=!0,document.addEventListener("keydown",(function(e){e.ctrlKey||e.altKey||e.metaKey||(e.keyCode!==m&&e.keyCode!==h||"button"!==e.target.getAttribute("role")||(e.target.click(),e.preventDefault()),e.keyCode!==h||"checkbox"!==e.target.getAttribute("role")&&"radio"!==e.target.getAttribute("role")||(e.target.click(),e.preventDefault()))})))},Cbap:function(e,t,n){"use strict";n.r(t);var i=function(){function e(){this.routes=[]}e.getRouter=function(){return window.router||(window.router=new e),window.router};var t=e.prototype;return t.addRoute=function(e,t,n){this.routes.push({isActive:!1,test:e,activateCallback:t,deactivateCallback:n})},t.test=function(e){var t=e.test;if(nav.cur)return"function"==typeof t?t(window.nav.cur):t instanceof RegExp?t.test(window.nav.cur):!(!window.nav.cur||"string"!=typeof t)&&window.nav.cur.startsWith(t)},t.deactivateAllRoutes=function(){this.routes=this.routes.map((function(e){return e.isActive=!1,e.deactivateCallback&&e.deactivateCallback(),e}))},t.checkRoutes=function(){var e=this;this.routes=this.routes.map((function(t){var n=e.test(t);return n&&t.activateCallback&&t.activateCallback(),!n&&t.isActive&&t.deactivateCallback&&t.deactivateCallback(),t.isActive=n,t}))},e}();t.default=i,window.Router=i},CkGd:function(e,t,n){"use strict";n.r(t);var i=n("MUpH"),a=n("bZ/P"),r=n("9y81");function o(){var e=Object(i.default)(['\n    <div class="','" ',">","</div>\n  "]);return o=function(){return e},e}function s(){var e=Object(i.default)(['\n    <button class="','" aria-label="','" ',"></button>\n  "]);return s=function(){return e},e}function c(){var e=Object(i.default)(['\n    <button class="Btn Btn_theme_small ','" ',">\n      ","\n    </button>\n  "]);return c=function(){return e},e}function l(){var e=Object(i.default)(['\n    <div class="','">\n\n      ','\n\n      <div class="mailActs__counter"></div>\n\n      <div class="mailActs__buttons">\n        <div class="mailActs__buttonsIn">\n          ',"\n          ",'\n        </div>\n        <div class="mailActs__chevron">\n          <div class="mailActs__chevronIn">\n            ',"\n            ","\n            ","\n            ","\n            ",'\n          </div>\n          <div class="mailActs__chevronMore">\n            <div class="mailActs__chevronMoreIcon" ','></div>\n            <div class="mailActs__chevronList">\n              ',"\n              ","\n              ","\n              ","\n              ","\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n  "]);return l=function(){return e},e}var u=function(e){e||(e={});window.lang;var t=a.default.onClick("MailActs._onMoreClick"),n=Object(r.default)({mix:"mailActs__close",icon:"close12",attrs:a.default.onClick("MailActs._onCloseClick")}),i=d("reply"),o=d("forward"),s=_("edit",e),c=_("pin",e),u=_("important",e),p=_("remove",e),h=_("spam",e),m=f("edit",e),v=f("pin",e),g=f("important",e),A=f("remove",e),b=f("spam",e),w=a.default.class("mailActs",{canPin:e.canPin,pinned:e.isPinned,important:e.isImportant,isChannel:e.isChannel});return a.default.html(l(),w,n,i,o,s,c,u,p,h,t,m,v,g,A,b)};function d(e){var t=window.lang,n=a.default.class("mailActs__button",{type:e}),i=a.default.onClick("MailActs._onButtonClick",e),r="reply"===e?t.mobile_mail_messages_actions_reply:t.mobile_mail_messages_actions_forward;return a.default.html(c(),n,i,r)}function _(e,t){var n,i=window.lang,r=a.default.class("mailActs__icon",{type:e}),o=a.default.onClick("MailActs._onButtonClick",e),c=t.isPinned?i.mobile_mail_messages_actions_unpin:i.mobile_mail_messages_actions_pin,l=t.isImportant?i.mobile_mail_messages_actions_important_off:i.mobile_mail_messages_actions_important;switch(e){case"edit":n=i.mobile_mail_messages_actions_edit;break;case"pin":n=c;break;case"important":n=l;break;case"remove":n=i.mobile_mail_messages_actions_delete;break;case"spam":n=i.mobile_mail_messages_actions_spam}return a.default.html(s(),r,n,o)}function f(e,t){var n,i=window.lang,r=a.default.class("mailActs__chevronListItem",{type:e}),s=a.default.onClick("MailActs._onButtonClick",e),c=t.isPinned?i.mobile_mail_messages_actions_unpin:i.mobile_mail_messages_actions_pin,l=t.isImportant?i.mobile_mail_messages_actions_important_off:i.mobile_mail_messages_actions_important;switch(e){case"edit":n=i.mobile_mail_messages_actions_edit;break;case"pin":n=c;break;case"important":n=l;break;case"remove":n=i.mobile_mail_messages_actions_delete;break;case"spam":n=i.mobile_mail_messages_actions_spam}return a.default.html(o(),r,s,n)}var p,h=n("UxAg"),m=n("+cqQ");function v(){store.mail.cur&&O()}function g(e){store.mail.cur&&function(e){var t=e.target,n=$(".mailActs");n&&n.classList.contains("mailActs_menuOpened")&&!t.closest(".mailActs__chevronList")&&!t.closest(".mailActs__chevronMoreIcon")&&n.classList.remove("mailActs_menuOpened")}(e)}function A(e){w({canEdit:e})}function b(e){$(".mailActs__button_type_forward").disabled=!e}function w(e){Object(h.$$)(".mailActs").forEach((function(t){var n=a.default.parseClass("mailActs",t.getAttribute("class"));t.setAttribute("class",a.default.class("mailActs",Object.assign({},n,e)))}))}function y(e){switch(e){case"edit":u.onEditClick();break;case"remove":u.onRemoveClick();break;case"important":u.onImportantClick();break;case"reply":u.onReplyClick();break;case"forward":u.onForwardClick();break;case"spam":u.onSpamClick();break;case"pin":u.onPinClick()}}function O(){var e=document.querySelector(".mailActs__chevron"),t=e.offsetWidth-1,n=e.querySelectorAll(".mailActs__chevronListItem"),i=e.querySelectorAll(".mailActs__icon");Array.prototype.forEach.call(i,(function(e,a){t<36*i.length?t-34>=36*(a+1)?(e.classList.remove("mailActs__icon_hidden"),n[a].classList.add("mailActs__chevronListItem_hidden")):(e.classList.add("mailActs__icon_hidden"),n[a].classList.remove("mailActs__chevronListItem_hidden")):(e.classList.remove("mailActs__icon_hidden"),n[a].classList.add("mailActs__chevronListItem_hidden"))})),w({cutted:t<36*i.length})}function S(){Object(h.$$)(".mailActs").forEach((function(e){return e.classList.toggle("mailActs_menuOpened")}))}Object.assign(u,((p={onCloseClick:Object(m.default)(),onRemoveClick:Object(m.default)(),onImportantClick:Object(m.default)(),onReplyClick:Object(m.default)(),onForwardClick:Object(m.default)(),onSpamClick:Object(m.default)(),onPinClick:Object(m.default)(),onMoreClick:Object(m.default)(),onEditClick:Object(m.default)(),setCount:function(e){var t=langNumeric(e,lang.mobile_mail_messages_selected).replace("{count}",e);Object(h.$$)(".mailActs__counter").forEach((function(e){return e.innerText=t})),1!=e&&A(!1);O()},setEditAvailable:A,setImportantAvailable:function(e){w({canImportant:e})},toggleQuickButtons:function(e){$(".mailActs__buttonsIn").hidden=!e},setForwardAvailable:b,setReplyAvailable:function(e){$(".mailActs__button_type_reply").disabled=!e}}).setForwardAvailable=b,p.togglePin=function(e){Object(h.$$)(".mailActs").forEach((function(t){return t.classList.toggle("mailActs_canPin",e)}))},p.setModifiers=w,p.setLabels=function(e){var t=window.lang,n=e.pinned?t.mobile_mail_messages_actions_unpin:t.mobile_mail_messages_actions_pin,i=e.important?t.mobile_mail_messages_actions_important_off:t.mobile_mail_messages_actions_important;$(".mailActs__icon_type_pin").setAttribute("aria-label",n),$(".mailActs__icon_type_important").setAttribute("aria-label",i),$(".mailActs__chevronListItem_type_pin").innerHTML=n,$(".mailActs__chevronListItem_type_important").innerHTML=i},p.update=O,p)),u._onButtonClick=y,u._onCloseClick=u.onCloseClick,u._onMoreClick=S,onBodyResize(v),document.addEventListener("click",g,{passive:!0});t.default=u;window.MailActs=u},Cz26:function(e,t,n){"use strict";n.r(t),n.d(t,"Timers",(function(){return i}));var i=function(){function e(e){var t=e.timer,n=void 0===t?1e3:t,i=e.autostart,a=void 0===i||i;this._list=[],this._timer=n,this._autostart=a}var t=e.prototype;return t._animate=function(e){var t=!1;return function n(){t||requestAnimationFrame((function(){t||(e(),n())}))}(),function(){t=!0}},t.add=function(e,t){var n=(void 0===t?{}:t).id;this.remove(e),n?(this.remove(n),this._list.push({id:n,callback:e})):this._list.push({callback:e}),!this._cancellation&&this._autostart&&this.start()},t.remove=function(e){this._list="function"==typeof e?this._list.filter((function(t){return t.callback!==e})):this._list.filter((function(t){return t.id!==e}))},t.start=function(){var e=this,t=Date.now();return this._cancellation=this._animate((function(){var n=Date.now();t+e._timer<n&&(e._list.forEach((function(n){var i=t;Promise.resolve().then((function(){var t=Date.now()-(i+e._timer);n.callback(Math.floor(t/e._timer)+1)}))})),t=n)})),this._cancellation},t.stop=function(){return!!this._cancellation&&(this._cancellation(),this._list=[],!0)},e}()},DLiR:function(e,t,n){"use strict";n.r(t),n.d(t,"screenWakeLocker",(function(){return i}));var i=new(function(){function e(){this.onVisibilityChange=this._onVisibilityChange.bind(this)}return e.prototype._onVisibilityChange=function(){this.wakeLockSentinel&&"visible"===document.visibilityState&&this.lock().then((function(){})).catch(console.error)},e.prototype.requestWakeLock=function(){var e=this;return navigator.wakeLock?this.wakeLockSentinel?Promise.resolve():navigator.wakeLock.request("screen").then((function(t){e.wakeLockSentinel=t})):Promise.reject()},e.prototype.isLocked=function(){return!!this.wakeLockSentinel&&!this.wakeLockSentinel.released},e.prototype.lock=function(){var e=this;return this.requestWakeLock().then((function(){e.wakeLockSentinel&&document.addEventListener("visibilitychange",e.onVisibilityChange)})).catch((function(){}))},e.prototype.unlock=function(){var e=this;return this.wakeLockSentinel?(document.removeEventListener("visibilitychange",this.onVisibilityChange),this.wakeLockSentinel.release().finally((function(){e.wakeLockSentinel=null}))):Promise.resolve()},e}())},DM26:function(e,t,n){"use strict";function i(e,t){return new Promise((function(n){setTimeout(n.bind(null,t),1e3*e)}))}function a(e,t,n){void 0===n&&(n=null);var a=0;return function r(){for(var o=arguments.length,s=new Array(o),c=0;c<o;c++)s[c]=arguments[c];return Promise.resolve().then((function(){return e.apply(void 0,s)})).catch((function(e){if(++a<=t){var o="function"==typeof n?n(a):0;return 0===o?r.apply(void 0,s):i(o).then((function(){return r.apply(void 0,s)}))}throw e}))}}function r(e,t,n){var i,a;return function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return new Promise((function(e,r){var s=n&&!i;clearTimeout(i),a&&a.reject("debounce"),i=setTimeout((function(){i=null,a=null,n||e(o)}),t),s?e(o):n&&r("debounce"),a={resolve:e,reject:r}})).then((function(t){return e.apply(void 0,t)}))}}function o(e,t){var n,i,a;return function(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return new Promise((function(e,r){var s=Date.now(),c=function(){e(o),n=s};!n||n+t<s?c():(a&&(a.reject(),clearTimeout(i)),a={resolve:e,reject:r},i=setTimeout(c,t-(s-n)))})).then((function(t){return e.apply(void 0,t)}))}}function s(e,t){var n,i=new Promise((function(i){n=i,setTimeout(i.bind(null,t),1e3*e)}));return{pause:function(){return i},abort:function(){n(t)}}}function c(e){return function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return new Promise((function(t){return e.apply(void 0,n.concat([t]))}))}}n.r(t),n.d(t,"pause",(function(){return i})),n.d(t,"retryFn",(function(){return a})),n.d(t,"debouncedPromise",(function(){return r})),n.d(t,"throttledPromise",(function(){return o})),n.d(t,"abortablePause",(function(){return s})),n.d(t,"promisify",(function(){return c}))},DOEQ:function(e,t,n){"use strict";n.r(t),n.d(t,"POST_PARAM_DONUT_DURATION",(function(){return i}));var i="donut_duration"},DVnk:function(e,t){FeedAssistanceStats.registerTrackingCls("feedAssistance_recommendedFriends"),FeedAssistanceStats.onStartViewElement((function(e){if(FeedAssistanceStats.getElementType(e)===FeedAssistanceStats.BLOCKS.BLOCK_TYPE_RECOMMENDED_SLIDER){if(e._friendsSliderHandlersAdded)return;e._friendsSliderHandlersAdded=!0}}))},Dh0N:function(e,t){function n(e,t){var n=t.$select,r=t.value;n.closest(i.email).classList.toggle(a.groupsVisible,e.includes(r)||e.includes(Number(r)))}window.SettingsEmail={},SettingsEmail._onFrequencyChange=n;var i={email:".settingsEmail"},a={groupsVisible:"settingsEmail_groupsVisible"}},DkIl:function(e,t,n){"use strict";n.r(t),n.d(t,"MailHat",(function(){return i.MailHat})),n.d(t,"MailHat__Title",(function(){return i.MailHat__Title})),n.d(t,"MailHat__icon",(function(){return i.MailHat__icon})),n.d(t,"MailHat_main",(function(){return i.MailHat_main})),n.d(t,"MailHat_convo",(function(){return i.MailHat_convo})),n.d(t,"MailHat_page",(function(){return i.MailHat_page}));var i=n("k9Tg"),a=n("UxAg"),r=n("bZ/P"),o=n("+cqQ"),s=n("gy8s");function c(e){Object(a.$$)(".mailHat").forEach((function(t){var n=r.default.parseClass("mailHat",t.getAttribute("class"));t.setAttribute("class",r.default.class("mailHat",Object.assign({},n,e)))}))}Object.assign(i.MailHat_main,{onUnreadClick:Object(o.default)(),onBurgerClick:Object(o.default)(),onCancelForwardTap:Object(o.default)(),setFolder:function(e){Object(a.$$)(".mailHat__folder").forEach((function(t){s.default.setActive(t,e)}))},setImportantCount:function(e){Object(a.$$)(".mailHat__folder").forEach((function(t){s.default.setCount(t,"important",e)}))},setForwarding:function(e){Object(a.$$)(".mailHat_type_main").forEach((function(t){return t.classList.toggle("mailHat_forwarding",e)}))},setModifiers:c}),Object.assign(i.MailHat_convo,{onBackTap:Object(o.default)(),onCancelEditingTap:Object(o.default)(),setOnline:function(e,t){var n=Object(i.MailHat_getOnlineText)(e,t);Object(a.$$)(".mailHat__convoDetailsText").forEach((function(e){return e.innerText=n}))},setMobile:function(e){Object(a.$$)(".mailHat__convo").forEach((function(t){return t.classList.toggle("mailHat__convo_mobile",e)}))},setHasPinnedMsg:function(e){Object(a.$$)(".mailHat_type_convo").forEach((function(t){return t.classList.toggle("mailHat_hasPinnedMsg",e)}))},setModifiers:c}),window.MailHat_main=i.MailHat_main,window.MailHat_convo=i.MailHat_convo},EXR0:function(e,t,n){"use strict";n.r(t);var i=n("Y6JH"),a=n("fdw3"),r=n("7ADY");t.default=function(e){return void 0===e&&(e={}),{inner:[{inner:[Object(i.default)({icon:Object(r.getCancel24Icon)()})],class:"ModalMenuHeader__close","aria-label":Object(a.getLang)("mobile_close"),onClick:e.onClose,tag:"button"},{inner:[e.inner],class:"ModalMenuHeader__title",tag:"div"}],class:"ModalMenuHeader",tag:"div"}}},EnJO:function(e,t,n){"use strict";n.r(t),n.d(t,"MarketAnalyticsManager",(function(){return a}));var i={screens:[],hash:"",replacedScreen:"",isEnabled:!1},a={setHash:function(e){i.hash=e},getHash:function(){return i.hash},getScreens:function(){var e=[];return i.screens.forEach((function(t){e.push(t)})),e},replaceScreen:function(e){i.replacedScreen=e},setScreen:function(e){i.screens.push(e),i.screens.length>5&&i.screens.shift()},getScreen:function(){return""!==i.replacedScreen?i.replacedScreen:i.screens.length>0?i.screens[i.screens.length-1]:""},getPrevScreen:function(){return i.screens.length>1?i.screens[i.screens.length-2]:""},popScreen:function(){return i.screens.length>0?String(i.screens.pop()):""},setEnabled:function(e){i.isEnabled=e},isEnabled:function(){return i.isEnabled}}},Eyxt:function(e,t,n){"use strict";n.r(t),n.d(t,"DeliveryPrice",(function(){return a}));var i=n("UWnA");function a(e){return{inner:[e.prices.map((function(e){return Object(i.default)({inner:[e.title,{inner:[Wd.html(e.price)],class:"DeliveryPrice__totalPrice",tag:"div"}],class:"DeliveryPrice__price"})}))],id:"delivery_price_"+e.type,tag:"div"}}},FbVm:function(e,t,n){"use strict";n.r(t),n.d(t,"NavigationStatCollector",(function(){return _})),n.d(t,"ProductionStatCollector",(function(){return h})),n.d(t,"ActionStatCollector",(function(){return v})),n.d(t,"ClickStatCollector",(function(){return A})),n.d(t,"ViewStatCollector",(function(){return w})),n.d(t,"RegistrationItemStatCollector",(function(){return y})),n.d(t,"MarketingTransitionItemStatCollector",(function(){return r})),n.d(t,"NavigationProductionStatEventTypes",(function(){return i.NavigationProductionStatEventTypes})),n.d(t,"RegistrationFieldItemNames",(function(){return i.RegistrationFieldItemNames})),n.d(t,"RegistrationItemEventTypes",(function(){return i.RegistrationItemEventTypes})),n.d(t,"EventScreens",(function(){return i.EventScreens})),n.d(t,"marketingTransitionItemStat",(function(){return O})),n.d(t,"easterEggsItemStat",(function(){return S})),n.d(t,"bridgeEventItemStat",(function(){return k})),n.d(t,"vkAppsActionMenuItemStat",(function(){return C}));var i=n("r0fY"),a=n("J8bf"),r=function(){function e(){this.productStatCollector=new h,this.actionStatCollector=new v(this.productStatCollector)}return e.prototype.logEvent=function(e,t,n,r){var o;void 0===r&&(r="");var s={campaign:e,source:n,event:t,unauth_id:Object(a.getCookie)("remixstid")};r&&(s.url=r);var c=((o={type:i.ActionProductionStatEventTypes.TYPE_MARKETING_TRANSITION_ITEM})[i.ActionProductionStatEventTypes.TYPE_MARKETING_TRANSITION_ITEM]=s,o);this.actionStatCollector.logEvent(c)},e}(),o=function(){function e(){this.productStatCollector=new h,this.actionStatCollector=new v(this.productStatCollector)}return e.prototype.logEvent=function(e,t,n,a){var r,o={webview_url:e,mini_app_id:t,event:n,error:a},s=((r={type:i.ActionProductionStatEventTypes.TYPE_BRIDGE_EVENT_ITEM})[i.ActionProductionStatEventTypes.TYPE_BRIDGE_EVENT_ITEM]=o,r);this.actionStatCollector.logEvent(s)},e}(),s=function(){function e(){this.productStatCollector=new h,this.actionStatCollector=new v(this.productStatCollector)}return e.prototype.logEvent=function(e,t,n,a){var r,o={egg_id:e,egg_event_id:t,position_id:n,event_type:a},s=((r={type:i.ActionProductionStatEventTypes.TYPE_EASTER_EGGS_ITEM})[i.ActionProductionStatEventTypes.TYPE_EASTER_EGGS_ITEM]=o,r);this.actionStatCollector.logEvent(s)},e}(),c=function(){function e(){this.productStatCollector=new h,this.clickStatCollector=new A(this.productStatCollector)}return e.prototype.logEvent=function(e,t,n){var a,r={type:n},o=((a={type:i.ClickProductionStatEventTypes.TYPE_MINI_APP_ITEM})[i.ClickProductionStatEventTypes.TYPE_MINI_APP_ITEM]=r,a),s={type:t,id:e};this.clickStatCollector.logEvent(o,s)},e}(),l=n("HLtZ"),u=n("W9Tc"),d=function(){return(d=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},_=function(){function e(e){this.ProductionStatCollector=e,this.tabId=this.ProductionStatCollector.getIntId()%128}return e.prototype.logEvent=function(e){var t,n=d(d({},this.ProductionStatCollector.getBaseEvent()),((t={type:i.ProductionStatEventTypes.TYPE_NAVGO})[i.ProductionStatEventTypes.TYPE_NAVGO]=e,t));return this.ProductionStatCollector.logEvent(n),{statEvent:n}},e.prototype.getEventTabOpen=function(e){return{subtype:i.NavigationProductionStatEventTypes.TAB_OPEN,tab_id:this.tabId,screen:e}},e.prototype.getEventMove=function(e,t){var n,a,r=this.lastStatEvents,o=this.lastNavEvents;return r&&o?(o.subtype===i.NavigationProductionStatEventTypes.TAB_OPEN?n=o.screen:(n=o.screen_to,a=o.screen),{prev_navgo_id:r.id,subtype:t,screen:n,screen_to:e,screen_prev:a,prev_navgo_timestamp:r.timestamp,tab_id:this.tabId}):(Object(l.logError)(new Error("NavigationStatCollector: previous event not found.")),null)},e.prototype.addStatEvent=function(e,t){if(void 0===t&&(t=i.NavigationProductionStatEventTypes.GO),Object(u.partConfigEnabled)("navigation_timespent")){var n;if(t===i.NavigationProductionStatEventTypes.TAB_OPEN)n=this.getEventTabOpen(e);else{var a=this.getEventMove(e,t);if(!a)return;n=a}var r=this.logEvent(n).statEvent;this.lastStatEvents=r,this.lastNavEvents=n}},e.prototype.getModule=function(){var e,t;return null!==(t=null===(e=window.cur)||void 0===e?void 0:e.module)&&void 0!==t?t:"unknown"},e}(),f=n("W0P9"),p=n("Bj12"),h=function(){function e(){this.DEBUG=!1}return e.prototype.getCurrentTime=function(e){void 0===e&&(e=!0);var t=Date.now().toString(10);return e?t+"000":t},e.prototype.getIntId=function(){return Math.floor(Math.random()*e.MAX_INT32)},e.prototype.logEvent=function(e){this.DEBUG&&Object(f.log)(e),e.type&&e[e.type]?(Object(p.saveProductionStats)(e),this.lastEvent=e):Object(l.logError)(new Error("ProductionStatCollector: invalid event."))},e.prototype.getLastEvent=function(){return this.lastEvent},e.prototype.getBaseEvent=function(){var e;return{id:this.getIntId(),prev_id:null===(e=this.lastEvent)||void 0===e?void 0:e.id,timestamp:this.getCurrentTime(),url:window.location.href}},e.MAX_INT32=2147483647,e}(),m=function(){return(m=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},v=function(){function e(e){this.productionStatCollector=e}return e.prototype.logEvent=function(e){var t,n=m(m({},this.productionStatCollector.getBaseEvent()),((t={type:i.ProductionStatEventTypes.TYPE_ACTION})[i.ProductionStatEventTypes.TYPE_ACTION]=e,t));this.productionStatCollector.logEvent(n)},e}(),g=function(){return(g=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},A=function(){function e(e){this.productionStatCollector=e}return e.prototype.logEvent=function(e,t){var n,a=g(g({},this.productionStatCollector.getBaseEvent()),((n={type:i.ProductionStatEventTypes.TYPE_CLICK})[i.ProductionStatEventTypes.TYPE_CLICK]=g({item:t},e),n));this.productionStatCollector.logEvent(a)},e}(),b=function(){return(b=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},w=function(){function e(e){this.productionStatCollector=e}return e.prototype.logEvent=function(e,t){var n,a=b(b({},this.productionStatCollector.getBaseEvent()),((n={type:i.ProductionStatEventTypes.TYPE_VIEW})[i.ProductionStatEventTypes.TYPE_VIEW]=b({item:t},e),n));this.productionStatCollector.logEvent(a)},e}(),y=function(){function e(e){this.actionStatCollector=e,this.fields={}}return e.prototype.logFieldInteraction=function(e,t,n){void 0===n&&(n=!1),[i.RegistrationFieldItemNames.PASSWORD,i.RegistrationFieldItemNames.SMS_CODE,i.RegistrationFieldItemNames.RULES_ACCEPT].includes(e)&&(t=t?"1":"0");var a=n?"0":this.actionStatCollector.productionStatCollector.getCurrentTime(!1);this.fields[e]?(this.fields[e].value=t,this.fields[e].end_interaction_time=a):this.fields[e]={name:e,value:t,start_interaction_time:a,end_interaction_time:a}},e.prototype.getFieldInteractions=function(){return Object.values(this.fields)},e.prototype.resetFieldInteractions=function(){for(var e=0,t=Object.getOwnPropertyNames(this.fields);e<t.length;e++){var n=t[e];delete this.fields[n]}},e.prototype.logEvent=function(e,t,n){var r;if(Object(u.partConfigEnabled)("registration_item_stat")){var o={event_type:e,screen:t,unauth_id:Object(a.getCookie)("remixstid"),sid:Object(a.getCookie)("remixnreg_sid")};[i.RegistrationItemEventTypes.SCREEN_PROCEED,i.RegistrationItemEventTypes.SCREEN_SKIP,i.RegistrationItemEventTypes.SCREEN_RETURN].includes(e)&&(o.screen_to=n,o.fields=this.getFieldInteractions(),this.resetFieldInteractions());var s=((r={type:i.ActionProductionStatEventTypes.TYPE_REGISTRATION_ITEM})[i.ActionProductionStatEventTypes.TYPE_REGISTRATION_ITEM]=o,r);this.actionStatCollector.logEvent(s)}},e}(),O=new r,S=new s,k=new o,C=new c},Fhlr:function(e,t){FeedAssistanceStats.registerTrackingCls("feedAssistance_promoButton"),FeedAssistanceStats.onStartViewElement((function(e){if(FeedAssistanceStats.getElementType(e)===FeedAssistanceStats.BLOCKS.BLOCK_TYPE_PROMO_BUTTON){if(e._promoButtonClickHandlerAdded)return;var t=geByClass1("feedAssistancePromoButtonInstallApp__button",e),n=t?"install_app":"";addEvent(t||e,"click",(function(){!function(e,t,n){FeedAssistanceStats.dispatchEvent({type:FeedAssistanceStats.EVENTS.EVENT_PROMO_BUTTON,data:FeedAssistanceStats.serializeEventData(FeedAssistanceStats.EVENTS.EVENT_PROMO_BUTTON_SUB,e,t,n)})}(e,FeedAssistanceStats.EVENTS.SUB_EVENT_PROMO_BUTTON_CLICK,n)})),e._promoButtonClickHandlerAdded=!0}}))},Fkq0:function(e,t,n){"use strict";n.r(t),n.d(t,"marketDebug",(function(){return o})),n.d(t,"marketItemIdToObject",(function(){return s})),n.d(t,"albumLinkToObject",(function(){return c})),n.d(t,"parseBookmarkedProductClass",(function(){return l})),n.d(t,"extractURLQueryParameter",(function(){return u})),n.d(t,"isElementVisible",(function(){return d})),n.d(t,"isElementInViewport",(function(){return _}));var i=n("ZD4m"),a=n("W9Tc"),r=n("tGJf");function o(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];(Object(a.partConfigEnabled)("extended_client_logging")||r.vkLocalStorage.getItem("market_extended_client_logging"))&&("error"===e?console.error("[market "+t+"]: ",n):"warn"===e?console.warn("[market "+t+"]: ",n):"info"===e?console.info("[market "+t+"]: ",n):console.debug("[market "+t+"]: ",n))}function s(e,t){void 0===t&&(t="market");var n=new RegExp(t+"(-?[0-9]+)_([0-9]+)"),i=e.match(n);if(!i||i.length<3)return null;var a=i[1],r=i[2];return{id:a+"_"+r,ownerId:parseInt(a),itemId:parseInt(r)}}function c(e){var t=e.match(/market(\-?[0-9]+).+section=album_([0-9]+)/);if(!t||t.length<3)return null;var n=t[1],i=t[2];return{id:n+"_"+i,ownerId:parseInt(n),itemId:parseInt(i)}}function l(e){var t=e.match(/_([0-9]+)_(\-?[0-9]+)_4/);if(!t||t.length<3)return null;var n=t[1],i=t[2];return{id:i+"_"+n,ownerId:parseInt(i),itemId:parseInt(n)}}function u(e,t){var n=new RegExp("[?&]+"+t+"=([a-zA-Z0-9_]+)"),i=e.match(n);return!i||i.length<2?null:i[1]?String(i[1]):null}function d(e){var t;return"none"!==(null===(t=e.style)||void 0===t?void 0:t.display)}function _(e,t,n,a){void 0===t&&(t=50),void 0===n&&(n=null);var r=n?n.left:0,o=n?n.top:0,s=Object(i.getViewportSize)(),c=Object(i.getElementOffset)(e),l=Object(i.getElementSize)(e),u=l.width*t/100,d=l.height*t/100;if(a){if(a.width>s.width)return!1;if(a.height>s.height)return!1;s=a}return!(c.left+l.width<r+u)&&(!(c.left+u>s.width)&&(!(c.top+l.height<o+d)&&!(c.top+d>s.height)))}},G0UO:function(e,t,n){"use strict";n.r(t);var i=n("hw56"),a=Array.isArray,r={mail:{},helpHints:{all:{},shown:{},locked:{}}},o={injectStore:function(e){r.mail={};var t=e.mail,n=t.cur,o=t.rolls,s=t.reached;t.msgs,t.queue;a(e.mail.msgs)&&(e.mail.msgs={}),a(e.mail.replies)&&(e.mail.replies={}),o&&a(o.peer)&&(o.peer={}),o&&a(o.search.peers)&&(o.search.peers={}),o&&a(o.search.msgs)&&(o.search.msgs={}),s&&a(s.search.peers)&&(s.search.peers={}),s&&a(s.search.msgs)&&(s.search.msgs={}),s&&a(s.peer.before)&&(s.peer.before={}),s&&a(s.peer.after)&&(s.peer.after={}),r.mail=e.mail,r.mail.pendingReplies={},r.mail.presend={},n&&(n.msgSelected={},n.msgRemoved={},n.msgAttached={},n.msgReply={},n.keyboards={},n.typings={},n.peerMembers={}),"notificationsCount"in r||(r.notificationsCount=e.notificationsCount),"menuNotifications"in r||(r.menuNotifications=e.menuNotifications),Array.isArray(n.drafts)?n.drafts={}:n.drafts&&(Object(i.loadDrafts)(n.viewerId),Object.keys(n.drafts).forEach((function(e){var t=n.drafts[e];Object(i.setPeerDraft)(n.viewerId,e,t)})))},injectMail:function(e){var t=r.mail,n=e,i=isObject(t.peers)&&isObject(n.peers)&&Object.assign({},t.peers);isObject(n.msgs)&&Object.assign(t.msgs,n.msgs),isObject(n.peers)&&Object.assign(t.peers,n.peers),isObject(n.members)&&Object.assign(t.members,n.members),isObject(n.replies)&&Object.assign(t.replies,n.replies),isObject(n.forwards)&&Object.assign(t.forwards,n.forwards),t.page=n.page,n.mrs&&(t.cur.countMR=n.mrs.count,t.rolls.mrs=n.mrs.rolls,t.reached.mrs=n.mrs.reached,t.scraps.mrs=n.mrs.rolls,Object.keys(n.msgs).forEach((function(e){var i=n.msgs[e],a=i.peerId;t.rolls.peer[a]=[i.id],t.reached.peer.after[a]=!0})),t.mrs=n.mrs),i&&Object.keys(i).forEach((function(e){var a=t.peers[e],r=n.peers[e],o=i[e];a&&(a.peerProfileData=o.peerProfileData),o&&o.actionUrls&&r&&!r.actionUrls&&(a.actionUrls=o.actionUrls)}))},injectMsg:function(e){var t;o.injectMail({msgs:(t={},t[e.id]=e,t)})},resetMail:function(){r.mail={}}};window.storeMethods=o,window.store=r},"GR/G":function(e,t,n){var i=n("/8IX"),a=n("HN+/");function r(e,t){return t?e?e.isSameNode&&e.isSameNode(t)?t:e.tagName!==t.tagName||o(e)!==o(t)?e:(a(e,t),s(e,t),t):null:e}function o(e){return e.dataset?e.dataset.nanomorphComponentId:void 0}function s(e,t){for(var n,i,a,o,s=0,l=0;n=t.childNodes[l],i=e.childNodes[l-s],n||i;l++)if(i)if(n)if(c(i,n))(a=r(i,n))!==n&&(t.replaceChild(a,n),s++);else{o=null;for(var u=l;u<t.childNodes.length;u++)if(c(t.childNodes[u],i)){o=t.childNodes[u];break}o?((a=r(i,o))!==o&&s++,t.insertBefore(a,n)):i.id||n.id?(t.insertBefore(i,n),s++):(a=r(i,n))!==n&&(t.replaceChild(a,n),s++)}else t.appendChild(i),s++;else t.removeChild(n),l--}function c(e,t){return e.id?e.id===t.id:e.isSameNode?e.isSameNode(t):e.tagName===t.tagName&&(3===e.type&&e.nodeValue===t.nodeValue)}e.exports=function(e,t,n){if(i.equal(typeof e,"object","nanomorph: oldTree should be an object"),i.equal(typeof t,"object","nanomorph: newTree should be an object"),n&&n.childrenOnly)return s(t,e),e;return i.notEqual(t.nodeType,11,"nanomorph: newTree should have one root node (which is not a DocumentFragment)"),r(t,e)}},GVTI:function(e,t,n){"use strict";n.r(t),n.d(t,"_PhotoviewPage_tags",(function(){return f}));var i=n("vOib"),a=n("rc7J"),r=n("fdw3"),o=n("29dZ"),s=n("vk58"),c=n("Q8gl"),l=n("O5lf"),u=n("vhZE");function d(e){var t="wi_like_wrap";e.liked_people||(t+=" is_empty");var n="PhotoviewPage__description";return e.photo.description||(n+=" PhotoviewPage__description--empty"),{inner:[e.photo.caption?{inner:[Wd.wrap(e.photo.caption)],class:"PhotoviewPage__caption",tag:"div"}:null,{inner:[Wd.wrap(e.photo.description)],class:n,tag:"div"},{inner:[e.liked_people?e.liked_people:null],class:t,tag:"div"},e.buttons?{inner:[{inner:[e.buttons],class:"wi_buttons",tag:"div"}],class:"wi_buttons_wrap",tag:"div"}:null,e.author,e.replies],class:"PhotoviewPage__footer",tag:"div"}}function _(e){var t=window.lang;return{inner:[{inner:[e.edit_data.rotate.can_rotate?Object(s.BtnStack)({inner:[Object(o.default)({inner:[t.mobile_photos_edit_rotate_left],url:e.edit_data.rotate.left,stretch:!0}),Object(o.default)({inner:[t.mobile_photos_edit_rotate_right],url:e.edit_data.rotate.right,stretch:!0})],nowrap:!0}):null,{inner:[{inner:[t.mobile_photos_edit_desc_label],class:"fi_label",tag:"dt"},{inner:[{inner:[e.photo.description],name:"text",class:"textfield",rows:"4",tag:"textarea"}],class:"iwrap",tag:"dd"}],class:"fi_row",tag:"dl"},{inner:[{inner:[t.mobile_photos_edit_album_label],class:"fi_label",tag:"dt"},{inner:[{inner:[e.edit_data.albums.map((function(e){return{inner:[e.name],selected:e.selected?"selected":null,value:e.id,tag:"option"}}))],name:"aid",tag:"select"},{inner:[Object(c.default)({withoutWrap:!0,name:"cover",label:t.mobile_photos_edit_cover_label,type:"checkbox"})],class:"fi_subrow",tag:"div"}],class:"iwrap",tag:"dd"}],class:"fi_row",tag:"dl"},{inner:[Object(s.BtnStack)({inner:[Object(o.default)({inner:[t.mobile_photos_edit_save_btn],type:"submit"}),Object(o.default)({inner:[t.mobile_cancel],theme:"link",url:e.edit_data.back_url})]})],class:"fi_row",tag:"div"}],action:e.edit_data.action,method:"post",tag:"form"}],class:"form_item",tag:"div"}}function f(e){return void 0===e&&(e=[]),{inner:[Object.keys(e).map((function(t){return{inner:[{class:"fill",tag:"div"}],class:"pv_tag",id:"pv_tag"+t,style:function(e){if(!Object(r.isArray)(e))return"";var t=e[0];return Object(r.isArray)(t)?"left: "+t[0]+"%; top: "+t[1]+"%; width: "+t[2]+"%; height: "+t[3]+"%":""}(e[t]),tag:"div"}}))],class:"PhotoviewPage__tags",tag:"div"}}var p=function(e){void 0===e&&(e={});var t=e.info||{},n=e.photo||{},o=e.is_loading||!1,s=e.navigation_buttons||{},c=Object(r.concatValues)("PhotoviewPage ",e.class);e.info&&(e.author=Object(a.default)({url:t.url,author_url:t.author_url,avatar:t.avatar,title:t.title,subtitle:t.subtitle,withoutBottomBorder:!e.has_replies})),e.photo||(e.photo={}),e.photo.description||(e.photo.description="");var p,h="",m=null;o&&(c=Object(r.concatValues)(c," PhotoviewPage--skeleton"),n.width?h+=" width"+e.width+"px;":m=Wd.wrap(Object(l.default)({mix:"al_loading",type:"pageLoader"})));var v=["PhotoviewPage__photo"];e.photo.restriction&&("block"===e.photo.restriction.type?v.push("PhotoviewPage__photo--block"):"blur"===e.photo.restriction.type&&v.push("PhotoviewPage__photo--blur")),p=[{src:n.src,style:h,tag:"img"},f(e.tags)];var g,A=!!e.photo.restriction;return A&&((g=e.photo.restriction).width=e.width,g.height=e.height||e.width),Object(i.default)({inner:[{inner:[{inner:[m||{inner:[p],class:v,href:n.href,tag:"a"},{inner:[Object(u.default)(g)],class:"PhotoviewPage__restrictedInfo",style:A?"":"display: none;",tag:"div"},s],class:"PhotoviewPage__thumb",tag:"div"},e.edit_mode?_(e):d(e)],id:e.photo.id,tag:"div"}],class:c})};t.default=p},GYWy:function(e,t,n){(function(e,i){var a;!function(r){t&&t.nodeType,e&&e.nodeType;var o="object"==typeof i&&i;o.global!==o&&o.window!==o&&o.self;var s,c=2147483647,l=/^xn--/,u=/[^\x20-\x7E]/,d=/[\x2E\u3002\uFF0E\uFF61]/g,_={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,p=String.fromCharCode;function h(e){throw new RangeError(_[e])}function m(e,t){for(var n=e.length,i=[];n--;)i[n]=t(e[n]);return i}function v(e,t){var n=e.split("@"),i="";return n.length>1&&(i=n[0]+"@",e=n[1]),i+m((e=e.replace(d,".")).split("."),t).join(".")}function g(e){for(var t,n,i=[],a=0,r=e.length;a<r;)(t=e.charCodeAt(a++))>=55296&&t<=56319&&a<r?56320==(64512&(n=e.charCodeAt(a++)))?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),a--):i.push(t);return i}function A(e){return m(e,(function(e){var t="";return e>65535&&(t+=p((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=p(e)})).join("")}function b(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function w(e,t,n){var i=0;for(e=n?f(e/700):e>>1,e+=f(e/t);e>455;i+=36)e=f(e/35);return f(i+36*e/(e+38))}function y(e){var t,n,i,a,r,o,s,l,u,d,_,p=[],m=e.length,v=0,g=128,b=72;for((n=e.lastIndexOf("-"))<0&&(n=0),i=0;i<n;++i)e.charCodeAt(i)>=128&&h("not-basic"),p.push(e.charCodeAt(i));for(a=n>0?n+1:0;a<m;){for(r=v,o=1,s=36;a>=m&&h("invalid-input"),((l=(_=e.charCodeAt(a++))-48<10?_-22:_-65<26?_-65:_-97<26?_-97:36)>=36||l>f((c-v)/o))&&h("overflow"),v+=l*o,!(l<(u=s<=b?1:s>=b+26?26:s-b));s+=36)o>f(c/(d=36-u))&&h("overflow"),o*=d;b=w(v-r,t=p.length+1,0==r),f(v/t)>c-g&&h("overflow"),g+=f(v/t),v%=t,p.splice(v++,0,g)}return A(p)}function O(e){var t,n,i,a,r,o,s,l,u,d,_,m,v,A,y,O=[];for(m=(e=g(e)).length,t=128,n=0,r=72,o=0;o<m;++o)(_=e[o])<128&&O.push(p(_));for(i=a=O.length,a&&O.push("-");i<m;){for(s=c,o=0;o<m;++o)(_=e[o])>=t&&_<s&&(s=_);for(s-t>f((c-n)/(v=i+1))&&h("overflow"),n+=(s-t)*v,t=s,o=0;o<m;++o)if((_=e[o])<t&&++n>c&&h("overflow"),_==t){for(l=n,u=36;!(l<(d=u<=r?1:u>=r+26?26:u-r));u+=36)y=l-d,A=36-d,O.push(p(b(d+y%A,0))),l=f(y/A);O.push(p(b(l,0))),r=w(n,v,i==a),n=0,++i}++n,++t}return O.join("")}s={version:"1.4.1",ucs2:{decode:g,encode:A},decode:y,encode:O,toASCII:function(e){return v(e,(function(e){return u.test(e)?"xn--"+O(e):e}))},toUnicode:function(e){return v(e,(function(e){return l.test(e)?y(e.slice(4).toLowerCase()):e}))}},void 0===(a=function(){return s}.call(t,n,t,e))||(e.exports=a)}()}).call(this,n("YuTi")(e),n("yLpj"))},GtpT:function(e,t,n){"use strict";n.r(t),n.d(t,"getDataFromDOM",(function(){return d}));var i=n("Y6JH"),a=n("z9sQ"),r=n("HaOv"),o=n("xTMR"),s=n("CW4u");var c=function(e){var t,n,c=e.album,l=c.url,u=c.title,d=c.photos_count_label,_=c.restriction,f="";if(_){var p={};p[_.type]=!0,f=a.default.class("AlbumItem__restriction",p)}if(t=e.emptyIcon?e.emptyIcon:Object(i.default)({icon:Object(s.getCameraOutline56Icon)()}),_&&"geo"===_.type)n={inner:[{inner:[Object(i.default)({icon:Object(r.getDoNotDisturbOutline56Icon)()})],class:f,tag:"div"}],class:"AlbumItem__thumb",tag:"div"};else{var h=[a.default.class("AlbumItem__thumb",{blur:_&&"blur"===_.type})];n={inner:[!c||c.thumb||_?null:{inner:[t],class:"AlbumItem__emptyThumbIcon",tag:"div"},_&&_.type?{inner:[Object(i.default)({icon:Object(o.getHideOutline56Icon)()})],class:f,tag:"div"}:null],class:h,"data-thumb-id":c.thumb_id,style:"background-image: url("+c.thumb+")",tag:"div"}}return{inner:[{inner:[n],class:"AlbumItem__thumbWrap",tag:"div"},{inner:[{inner:[u],class:"AlbumItemInfo__title",tag:"div"},{inner:[d],class:"AlbumItemInfo__subtitle",tag:"div"}],class:"AlbumItemInfo",tag:"div"}],href:l,class:"AlbumItem al_album",onclick:e.onClick,"data-count":c.count,tag:"a"}},l=n("OcsD"),u=n("UxAg");function d(e){if(!e.classList.contains("AlbumItem"))return{};var t=Object(l.val)(Object(u.$)(".AlbumItemInfo__title",e))||"",n=Object(l.val)(Object(u.$)(".AlbumItemInfo__subtitle",e))||"",i=e.getAttribute("href"),a=Object(u.$)(".AlbumItem__thumb",e),r=/url\("(.*)"\)/.exec(a.style.backgroundImage),o=!!r&&r[1],s=Object(u.$)(".AlbumItem__restriction",e),c=!1;return s&&(s.classList.contains("AlbumItem__restriction--blur")?c={type:"blur"}:s.classList.contains("AlbumItem__restriction--geo")&&(c={type:"geo"})),{album:{title:Wd.wrap(t),photos_count_label:n,url:i,thumb:o,restriction:c},onClick:e.getAttribute("onclick")}}t.default=c},Gyo5:function(e,t,n){"use strict";n.r(t),n.d(t,"customMetricsCollector",(function(){return r}));var i=n("r0fY"),a=n("FbVm"),r=new(function(){function e(){this.productionStatCollector=new a.ProductionStatCollector,this.actionStatCollector=new a.ActionStatCollector(this.productionStatCollector)}return e.prototype.logEvent=function(e){var t;return this.actionStatCollector.logEvent(((t={type:i.ActionProductionStatEventTypes.TYPE_CUSTOM_METRICS_ITEM})[i.ActionProductionStatEventTypes.TYPE_CUSTOM_METRICS_ITEM]=e,t))},e}())},Gzds:function(e,t,n){"use strict";n.r(t);var i,a,r=n("+cqQ"),o=n("wkhI"),s=n("UxAg"),c=n("DOEQ"),l=n("OcsD"),u=n("fdw3"),d=n("zvhO"),_=(n("W9Tc"),n("cZev")),f=n("6Mr/"),p=n("TYsd");onDOMReady((function(){if(_.default.onStickerPanelUpdate((function(){if(cur.waitingStickerPanel)clog("Show sticker panel after waiting"),h.stickersToggle(null,!0);else if("mail"!==cur.module){var e=Object(s.$)("#stickers_panel");Object(l.domData)(e,"need-update",1),e&&"none"!==e.style.display&&h.stickersToggle(null,!1)}})),Object(f.canShow)(f.TooltipHelpHints.ACCOUNT_HINT_FEED_POST_REACTION)&&!Object(f.getHelpHint)(f.TooltipHelpHints.ACCOUNT_HINT_FEED_POST_REACTION)){var e=Object(s.$)(".Socials__button--reactions"),t=Object(f.default)({onboarding:!0,theme:"accent",inner:lang.intro_hint_title_mvk_post_reaction,pos:"center-right","tooltip-id":f.TooltipHelpHints.ACCOUNT_HINT_FEED_POST_REACTION,style:"right: 10px; white-space: normal; width: 230px"});e&&e.appendChild(p.default.elem(t))}}));var h={curGif:null,onStickersTabSelected:Object(r.default)(),onStickerClick:Object(r.default)(),onStickersInit:se(),onReplyClick:se(),add_attach:function(e,t){var n=window.al;remove("feed_extra_field");var i=gpeByTag("form",e),a=ce("input",{id:"feed_extra_field",type:"hidden",name:"add_attach",value:2});if(i){var r=!1;if(each(i,(function(e,t){if("submit"===t.type)return r=t,!1})),r)return append(a,i),window.al&&n.ver?nav.go(r,t):i.submit()}return!0},saveDraft:function(e,t,n,i){if(e&&e.preventDefault(),!i||!i.classList.contains("CreatePostButtons__item--disabled")){var a=ge("feed_add_form"),r=qs2obj(nav.params),s={act:"post",save_draft:1,redirect:n,hash:t};r.comment&&(s.comment=r.comment),each(a.elements,(function(e,t){if(!["submit","file"].includes(t.type)){if(Object(o.isFieldIgnored)(t))return;s[t.name]="checkbox"===t.type?(+t.checked).toString():t.value}})),ajax.post(window.nav.path,s)}},toggleActions:function(e,t){var n=gpeByClass("post_item",e);return toggleClass("pi_actions_opened",n),cancelEvent(t),!1},wallActions:function(e,t){var n=window.tooltip,i=gpeByClass("_audioPlaylist",e)||gpeByClass("wall_item",e)||gpeByClass("post",e);if(!i)return!0;if(hasClass("wi_actions_opened",i))removeClass("wi_actions_opened",i),n.hide();else{var a=geByClass1("wi_actions_wrap",i),r=geByClass1("wi_actions",a),o=geByClass1("wi_actions_btn",i);h.wallActionsHide(),addClass("wi_actions_opened",i);var s=getY(i)+45+getH(r)+7,c=scrollTop()+getCh();toggleClass("wi_actions_top",a,s>c),n.addHandler(h.wallActionsHide),n.show(a,o)}return cancelEvent(t),!1},wallActionsHide:function(){var e=window.tooltip;removeClass("wi_actions_opened",geByClass1("wi_actions_opened")),e.hide()},wallPostOpen:function(e,t){var n=gpeByClass("wall_item",e),i=geByClass1("wi_date",n);return!i||nav.go_after(i,t)},toggleGif:function(e,t,n,a){return void 0===a&&(a=!1),!e||(!!checkEvent(t)||(clearInterval(i),hasClass("current_gif",e)?h.hideGif(e,t,a):(a||Gif.autoplayTest(),h.showGif(e,t,n,a))))},hidePlayingGifs:function(e,t){geByClass("current_gif","mcont").forEach((function(n,i){n!==e&&h.hideGif(n,!1,t)}))},showGif:function(e,t,n,r){var o=window.cur;if(!e)return!0;if(checkEvent(t))return!0;if(n){if(o.loadedGifs||(o.loadedGifs={}),!o.loadedGifs[e.href]&&!confirm(n))return!1;o.loadedGifs[e.href]=!0}if(clearInterval(i),!r){var c=getY(e),l=scrollTop();scrollTop(l-(c-getY(e)))}geByClass("current_gif","mcont").forEach((function(e,t){h.hideGif(e,!1,r)}));var u=!hasClass("not_mp4",e)&&Gif.isMp4Supports()&&e.href.includes("&mp4"),d=function(t,n){hasClass("current_gif",e)&&(e.classList.remove("gif_loading"),e.classList.add("gif_opened"),"VIDEO"===a.tagName&&document.body.contains(a)?a.play():append(a,e),h.curGif=e,n&&n())};if(u){var _=geByClass1("ph_img",e).src;(a=Object(s.$)("video.gif_original",e)||ce("video",{src:e.href,className:"gif_original",loop:!0,muted:!0,autoplay:!0,poster:_})).setAttribute("playsinline",!0),a.setAttribute("webkit-playsinline",!0),a.setAttribute("controls",!0),a.controls=!1,a.readyState>=2&&"VIDEO"===a.tagName?(e.classList.remove("gif_loading"),e.classList.add("gif_opened"),a.play(),d()):a.load()}else a=ce("img",{src:e.href,className:"gif_original"});return e.classList.add("current_gif"),e.classList.contains("gif_opened")||e.classList.add("gif_loading"),u?a.oncanplay=function(){e!==h.curGif&&(statlogsValueEvent("gif_play",0,"mp4",null,r?1:0),d())}:i=setInterval((function(){a.complete&&(statlogsValueEvent("gif_play",0,"gif",null,r?1:0),d(),clearInterval(i))}),100),t&&!t.defaultPrevented?cancelEvent(t):void 0},hideGif:function(e,t,n){if(void 0===n&&(n=!1),!e)return!0;if(checkEvent(t))return!0;if(removeClass("current_gif",e),removeClass("gif_opened",e),removeClass("gif_loading",e),geByClass("gif_original").forEach((function(e){"VIDEO"===e.tagName?e.pause():remove(e)})),!n){var i=Gif.getState(),a=i.currentAutoplayElement,r=i.ignore;a===e&&(r.push(e),Gif.setState("ignore",r))}return h.curGif=null,t&&!t.defaultPrevented?cancelEvent(t):void 0},replyNamesRE:function(){var e=window.cur;if(!e.replyNames)return!1;var t=[];return each(e.replyNames,(function(){t.push(escapeRE(this[0]))})),new RegExp("^("+t.join("|")+")")},stickerPanelInit:function(){if(Object(s.$)("#stickers_panel"))return!0;var e=!1;if("mail"===cur.module&&window.isNewMail)e=Object(s.$)(".uMailWrite__popupStickers").childNodes[0];else{var t=Object(s.$)(".RepliesField_wrap")||(Object(s.$)(".create_post")||{}).parentNode;if(!t)return!1;e=(Array.from(t.children).find((function(e){return!(!e||!e.nextSibling||e.nextSibling.nodeType!==Node.COMMENT_NODE)}))||{}).nextSibling}if(e&&e.nodeType===Node.COMMENT_NODE){var n,i=_.default.getStickerPanel();if(!i)return!1;var a=document.createElement("div");return a.innerHTML=i,e&&(n=e).after.apply(n,a.childNodes),e&&e.remove(),h.stickersInit(),!0}return!1},stickersInit:function(){if(!window.isNewMail||!geByClass1("messenger")){var e=window.cur,t=window.Scroller,n=Object(s.$)("#stickers_panel");if(!n)return!h.stickerPanelInit()||(h.stickersInit(),"cached");var i=geByClass1("sp_body",n),a=geByClass1("sp_stickers_tabs",n);e.scroller&&e.scroller.destroy(),e.scroller=new t(i,{byPage:!0}),e.scroller.init(),e.destroy.push((function(){e.scroller.destroy()})),e.tabScroller&&e.tabScroller.destroy(),e.tabScroller=new t(a),e.tabScroller.init(),e.destroy.push((function(){e.tabScroller.destroy()})),h.onStickersInit(!0)}},replyTo:function(e,t,n,i,a){var r=window.cur;if(checkEvent(e))return!0;n=n||0,removeClass("nc_current_reply",geByClass1("nc_current_reply"));var o=ge("nc_form"),s=ge("nc_message"),c=geByClass1("nc_reply_name",o),l=gpeByClass("near_btn",c),u=ge("nc_reply_as"),d=val(s),_=h.replyNamesRE();if(n){var f=ge(t+"_"+n),p=getY(f)+getH(f),m=scrollTop();after(o,f),addClass("nc_current_reply",geByClass1("pi_reply_wrap",f)),scrollTop(m+getY(f)+getH(f)-p);var v=r.replyNames[i]||{},g=v[0]||"",A=v[1]||"";d=d?_?d.replace(_,g):d:g,h.onReplyClick(!0,g)}else{append(o,geByClass1("wall_replies")),scrollToEl(o);A="";d=_?d.replace(_,""):d}return val(s,replaceEntities(d)),val(c,A),toggle(l,n),u&&(val(u,+a),toggleClass("cp_post_as_group",o,+a)),val("nc_reply_to",n),r.replyTo=n,elfocus(s),!1},stickersToggle:function(e,t){var n=window.cur;if(!_.default.getStickers())return _.default.checkStickers(),!0;isUndefined(t)&&(t=!isVisible("stickers_panel")),!t&&n.waitingStickerPanel&&delete n.waitingStickerPanel;var i=ge("write_form")||ge("nc_form"),a=ge("stickers_panel"),r=geByClass1("cp_sticker_btn",i);if(!a){var o=h.stickersInit();if("cached"===o)return h.stickersToggle(e,t);if(!0===o)return n.waitingStickerPanel=!0,void _.default.checkStickers()}if(n.waitingStickerPanel&&delete n.waitingStickerPanel,!t&&Object(l.domData)(a,"need-update")){var c=Object(u.getState)("target")||safeGet(window.store,"mail.cur.peerId"),d=_.default.getStickerPanel(c),f=document.createElement("div");f.innerHTML=d;var p=Object(s.$)(".stickers_panel",f);a.innerHTML=p.innerHTML,h.stickersInit()}return toggle(a,t),toggleClass("cp_sticker_btn_sel",r,t),t&&n.tabScroller&&n.tabScroller.onShow(),n.onStickersToggleCallbacks&&n.onStickersToggleCallbacks.forEach((function(e){return e(t)})),!1},saveCurrentStickersPanelToCache:function(){var e=Object(s.$)(".stickers_panel");if(e){var t=safeGet(window.store,"mail.cur.peerId"),n=(Object(u.getState)("target")||"").toString()||(t?"mail"+t:"");if(n){var i=_.default.getStickerPanel(),a=document.createElement("div");a.innerHTML=i,Object(s.$)(".stickers_panel",a).innerHTML=e.innerHTML.replace(new RegExp(n,"g"),"mail0"),_.default.saveStickerPanel(a.innerHTML)}}},stickersClick:function(e,t){var n=_.default.getStickers();return n&&n[t]?(window.isNewMail&&"/mail"===location.pathname&&(window.uMailWrite.drawStickers(),window.uMailWrite.openStickersPanel()),h.stickersToggle(null,!0),h.stickersSelectTab(null,t)):nav.go(e)},stickersStoreOpen:function(e){var t=window.cur;return setTimeout((function(){_.default.checkStickers({force:!0})}),1e3),ajax.click(e,!1,{url_params:{reply_to:t.replyTo||0}})},fromStickerToObject:function(e){return{id:e[0],size:e[1],url:e[2],animationUrl:e[3],recent:e[4],ref:e[5]}},fromObjectToSticker:function(e){return[e.id,e.size,e.url,e.animationUrl,e.recent,e.ref]},getStickersTabHTML:function(e){var t=(_.default.getStickers()||[])[e],n=window.isNewMail?16:8,i=[];if(t&&t.length)for(var a=0;a<t.length/n;a++)i.push(t.slice(a*n,a*n+n));var r=i.map((function(e){return e&&Object(l.isArray)(e)?'\n        <div class="sp_page scroller_page">\n          <div class="stickers_list">\n            '+e.map((function(e){var t=h.fromStickerToObject(e),n=t.id,i=t.size,a=t.url,r=t.animationUrl,o=t.recent,s=t.ref,c="",l="";return r&&(c=" sticker_animation",l='\n          data-animation-path="'+r+'"\n          data-uniq-id="'+Date.now()+Math.round(1e8*Math.random())+'"\n          data-sticker-id="'+n+'"\n          data-loop-count="3"\n          ontouchstart="StickersAnimation.touchStartSticker(this);"\n          ontouchend="StickersAnimation.touchEndSticker(this);"\n        '),'\n          <div class="sticker_item'+(" sticker"+n)+'">\n            <a class="sticker_thumb thumb_item'+c+'" '+(' onclick="return post.sendSticker(this, '+n+", "+Boolean(o)+", '"+s+"');\"")+" "+l+'>\n              <img src="'+a+'" class="th_img sticker_img" height="'+i+'"/>\n            </a>\n          </div>\n        '})).join("\n")+"\n          </div>\n        </div>\n      ":""})).join("\n"),o='\n        <div class="sp_page scroller_page">\n          <div class="stickers_list">\n            <div class="stickers_null">'+getLang("mobile_common_stickers_no_recent")+"</div>\n          </div>\n        </div>\n    ",s=i.map((function(e,t){return'\n        <span class="sp_ppt '+(0===t?"sp_ppt_sel":"")+'" data-i="'+t+'">\n            <span class="sp_pptw"></span>\n        </span>\n      '})).join("\n");return'\n        <div class="sp_cont scroller_wrap">\n          <div class="scroller_cont">\n            '+(t&&t.length?r:o)+'\n          </div>\n        </div>\n        <div class="sp_pages_pts">\n            '+(i.length>1?s:"")+"\n        </div>\n      "},stickersSelectTab:function(e,t){var n=window.cur;if(!window.isNewMail&&n.tabScroller&&!n.tabScroller.canClick())return!1;var i=ge("stickers_panel"),a=geByClass1("sp_body",i),r=geByClass1("sp_tab_selected",i);n.scroller&&n.scroller.destroy(),val(a,h.getStickersTabHTML(t)),n.scroller&&n.scroller.init(),e||(e=geByClass1("sp_tab"+t,i)),removeClass("sp_tab_selected",r),addClass("sp_tab_selected",e);var o=getY(i),s=o+getW(i),c=scrollTop(),l=c+getCh();return(o<c||s>l)&&scrollToEl(i),n.tabScroller&&n.tabScroller.showElem(e),StickersAnimation&&StickersAnimation.loadAutoplayAnimationStickers(),h.saveCurrentStickersPanelToCache(),window.isNewMail&&h.onStickersTabSelected(),!1},addRecentSticker:function(e,t,n){window.cur;var i=gpeByClass("sticker_item",e);if(_.default.getStickers()&&i){var a=Object.keys(_.default.getStickers()).reduce((function(e,n){return e||_.default.getStickers()[n].find((function(e){return h.fromStickerToObject(e).id===t}))}),null);if(!a)throw new Error("Sticker "+t+" not found");var r=h.fromStickerToObject(a),o=r.id,c=r.size,l=r.url,u=r.animationUrl,f=_.default.getStickers()[-1]||[];(f=f.filter((function(e){return h.fromStickerToObject(e).id!==o}))).unshift(h.fromObjectToSticker({id:o,size:c,url:l,animationUrl:u,recent:1,ref:"recent"})),f=f.filter((function(e,t){return t<(window.isNewMail?16:8)})),_.default.setStickerTab(-1,f);var p=-1;if(!n){var m=Object(s.$)(".stickers_panel .sp_tab_selected"),v=m&&m.className.split(" ").find((function(e){return/sp_tab.([0-9])*/.test(e)})).split("sp_tab")[1];Object(d.isNumber)(+v)&&(p=+v)}h.stickersSelectTab(!1,p)}},sendSticker:function(e,t,n,i){if(window.isNewMail&&h.onStickerClick(t,i))return h.addRecentSticker(e,t,!1),!1;var a=window.cur;if(a.scroller&&!a.scroller.canClick())return!1;h.stickersToggle(e,!1);var r=ge("write_submit"),o={lock:!0,url_params:{media:"sticker"+t,_af:srand()}};if(n&&!i&&(o.url_params.media_from="recent"),a.ref&&(o.url_params.ref=a.ref,a.ref=void 0),a.refSource&&(o.url_params.ref_source=a.refSource,a.refSource=void 0),!i){var s=attr(e,"href");s&&(i=s.split("sticker_referrer=")[1].split("&")[0])}return i&&(o.url_params.sticker_referrer=i),h.addRecentSticker(e,t,n),r?ajax.click(r,extend({save:!0},Dialog),o):(r=ge("nc_submit"))?(Replies.getCurrentTimestamp()||Replies.setCurrentTimestamp(-1),setTimeout((function(){Replies.setCurrentTimestamp(0)}),0),ajax.click(r,{},o)):void 0},toggleMarkAsAds:function(e,t){var n=Object(s.$)("input[name='from_group']");if(n&&!n.checked)return cancelEvent(t);var i=Object(s.$)("input",e);if(i.disabled)return cancelEvent(t);var a=Object(s.$)("input[name='mute_notifications']");a&&(a.checked=i.checked,a.disabled=i.checked),h.checkCopyright()},toggleDonut:function(e,t){var n=Object(s.$)("input[name='from_group']");if(!n||n.checked){var i=Object(s.$)("#feed_add_form"),a=Object(s.$)('input[name="donut_only"]'),r=Object(s.$)("#select-donut-duration"),u=Object(s.$)('[name="'+c.POST_PARAM_DONUT_DURATION+'"]',i),d=!a.checked,_=Object(s.$)("input",r);Object(o.setFieldIgnored)(u,d),r.classList.toggle("post__select_hidden",d),Object(l.domData)(_,"ignore-field",d);var f=Object(s.$)("input[name='marked_as_ads']");if(f){var p="1"===Object(l.domData)(f,"value");a.checked?(Object(l.domData)(f,"value",f.checked?"1":"0"),f.checked=!1):(Object(l.domData)(f,"value",null),f.checked=p),f.disabled=a.checked}}},toggleSender:function(e,t){t.stopPropagation(),t.preventDefault();var n=e.querySelector("input"),i={group:[],user:["marked_as_ads","signed","close_comments","mute_notifications","donut_only"]},a=Object(s.$)("input[name='marked_as_ads']");Object(s.$)("input[name='donut_only']");$$(".Control.Control_type_switcher.Row").forEach((function(e){if(!hasClass("Control__blocked",e)){var t=e.querySelector("input[name]");if("from_group"!==t.name)(n.checked&&!i.group.includes(t.name)||!n.checked&&i.user.includes(t.name))&&(t.disabled=!n.checked),"mute_notifications"===t.name&&a&&a.checked&&(t.disabled=!0);else{var r=Object(s.$)(".header__user"),o=Object(s.$)(".header__group"),c=Object(s.$)("#select-timer"),l=Object(s.$)("input[name=postpone]"),u=Object(s.$)("input#add_post_btn");if(n.checked?(r.classList.add("header_hidden"),o.classList.remove("header_hidden"),c.style.display="inline-block",l.disabled=!1):(r.classList.remove("header_hidden"),o.classList.add("header_hidden"),c.style.display="none",l.disabled=!0),u){var d=u.value;u.value=u.dataset.value,u.dataset.value=d}}}})),h.checkCopyright()},checkCopyright:function(){var e=Object(s.$)("input[name='marked_as_ads']"),t=Object(s.$)("input[name='from_group']"),n=ge("select-copyright"),i=Object(s.$)('input[name="copyright"]'),a=Object(s.$)(".create_post__source-option");if(n){var r=Object(s.$)(".Btn",a),o=Object(s.$)(".Btn__text",r);e&&e.checked&&(!t||t.checked)?(hide(n),attr(r,"disabled",!0),a.classList.add("create_post__source-option--disabled"),o.innerHTML=getLang("mobile_wall_post_copyright_add_button")):(attr(r,"disabled",!1),a.classList.remove("create_post__source-option--disabled"),i.value?(setStyle(n,"display","inline-block"),o.innerHTML=getLang("mobile_wall_post_copyright_edit_button")):o.innerHTML=getLang("mobile_wall_post_copyright_add_button"))}}};t.default=h,window.post=h},H5mD:function(e,t,n){"use strict";n.r(t),n.d(t,"IPHONE_SAFARI_BOTTOM_BAR",(function(){return r})),n.d(t,"IPHONE_X_SAFARI_BOTTOM_BAR",(function(){return o})),n.d(t,"IPHONE_KEYBOARD_REJECT_OFFSET",(function(){return s})),n.d(t,"IOS_NO_KEYBOARD_ALLOWED_OFFSET",(function(){return c})),n.d(t,"isIPad",(function(){return d})),n.d(t,"isIPhone",(function(){return _})),n.d(t,"isIOS",(function(){return f})),n.d(t,"isIPadOS",(function(){return u})),n.d(t,"iosMajor",(function(){return i})),n.d(t,"iosMinor",(function(){return a})),n.d(t,"isWKWebView",(function(){return m})),n.d(t,"isScrollBasedViewport",(function(){return h})),n.d(t,"isIPhoneX",(function(){return v})),n.d(t,"isIOSChrome",(function(){return g})),n.d(t,"isLandscapePhone",(function(){return A})),n.d(t,"checkIPadOS",(function(){return b}));var i,a,r=45,o=85,s=180,c=70,l=navigator.userAgent.toLowerCase(),u=b(l),d=u||-1!==l.indexOf("ipad"),_=!d&&-1!==l.search(/iphone|ipod/),f=_||d,p=f&&navigator.userAgent.match(/OS ([\d_]+) like Mac OS X/i);u&&(i=13,a=0),p&&(p=p[1].split("_"),i=+p[0],a=+p[1]),p=null;var h=i<13&&!(11===i&&a<3),m=f&&function(e){if(window.webkit&&window.webkit.messageHandlers)return!0;var t=/constructor/i.test(window.HTMLElement),n=!!window.indexedDB;if(-1===e.indexOf("safari")||-1===e.indexOf("version")||navigator.standalone){if(!n&&t||!window.statusbar||!window.statusbar.visible);else if(!t||n)return!0}else;return!1}(l),v=f&&375===screen.width&&812===screen.height&&3===window.devicePixelRatio,g=-1!==l.search(/crios/i);function A(){return 90===Math.abs(window.orientation)&&!d}function b(e){var t=!/ipad|iphone|ipod/.test(e);return!(!/mac os/.test(e)||!t||"boolean"!=typeof navigator.standalone)}},HGMY:function(e,t,n){"use strict";n.r(t),n.d(t,"MailPreSendList__Msg",(function(){return r})),n.d(t,"getElem",(function(){return s})),n.d(t,"setMsgs",(function(){return c})),n.d(t,"addMsg",(function(){return l})),n.d(t,"removeMsg",(function(){return u})),n.d(t,"getMsg",(function(){return d}));n("TYsd");var i=n("/Id8"),a=function(){store.mail.pendingMsgs;return{class:"MailPreSendList__box"}};function r(e){var t=store.mail,n=t.members[e.authorId],a=e.peerId,r=t.peers[a],o=Object(i.Msg__authorName)(n,a,t.cur.userId);return Object(i.default)({id:e.id,text:e.text,important:e.isImportant,unread:e.isUnread,authorPhoto:n.avatar,authorName:o,authorUrl:n.url,date:e.date,removed:t.cur.msgRemoved[e.id],admin:e.adminName?{name:e.adminName,url:e.adminUrl}:null,edited:e.edited,channel:r.isChannel&&r.ownerId!==t.cur.viewerId,attaches:e.attaches,attachesHTML:e.attachesHTML,attachesLoading:e.attachesLoading,forwards:e.forwards,reply:e.reply,pending:e.pending,failed:e.failed,sendId:e.sendId,sticker:e.sticker,ts:e.ts,maxDepth:store.mail.cur.maxMsgDepth})}var o=n("UxAg");function s(){return Object(o.$)(".MailPreSendList__box")}function c(e){s().innerHTML=e.map((function(e){return r(e)})).join("")}function l(e){s().insertAdjacentHTML("beforeend",r(e)),MailScrap.peerGoToBottom(),e.attaches.audiomsg&&AudioMessagePlayer.redrawWaves()}function u(e){var t=i.default.getElem(e.sendId);t&&t.remove()}function d(e){return i.default.getElem(e.sendId)}t.default=a},"HN+/":function(e,t,n){var i=n("vOyG"),a=i.length;function r(e,t,n){e[n]!==t[n]&&(t[n]=e[n],e[n]?t.setAttribute(n,""):t.removeAttribute(n))}e.exports=function(e,t){var n=e.nodeType,o=e.nodeName;1===n&&function(e,t){for(var n=t.attributes,i=e.attributes,a=null,r=null,o=null,s=null,c=i.length-1;c>=0;--c)s=i[c],o=s.name,a=s.namespaceURI,r=s.value,a?(o=s.localName||o,t.getAttributeNS(a,o)!==r&&t.setAttributeNS(a,o,r)):t.hasAttribute(o)?t.getAttribute(o)!==r&&("null"===r||"undefined"===r?t.removeAttribute(o):t.setAttribute(o,r)):t.setAttribute(o,r);for(var l=n.length-1;l>=0;--l)!1!==(s=n[l]).specified&&(o=s.name,(a=s.namespaceURI)?(o=s.localName||o,e.hasAttributeNS(a,o)||t.removeAttributeNS(a,o)):e.hasAttributeNS(null,o)||t.removeAttribute(o))}(e,t);3!==n&&8!==n||t.nodeValue!==e.nodeValue&&(t.nodeValue=e.nodeValue);"INPUT"===o?function(e,t){var n=e.value,i=t.value;r(e,t,"checked"),r(e,t,"disabled"),n!==i&&(t.setAttribute("value",n),t.value=n);"null"===n&&(t.value="",t.removeAttribute("value"));e.hasAttributeNS(null,"value")?"range"===t.type&&(t.value=n):t.removeAttribute("value")}(e,t):"OPTION"===o?function(e,t){r(e,t,"selected")}(e,t):"TEXTAREA"===o&&function(e,t){var n=e.value;n!==t.value&&(t.value=n);if(t.firstChild&&t.firstChild.nodeValue!==n){if(""===n&&t.firstChild.nodeValue===t.placeholder)return;t.firstChild.nodeValue=n}}(e,t);!function(e,t){for(var n=0;n<a;n++){var r=i[n];e[r]?t[r]=e[r]:t[r]&&(t[r]=void 0)}}(e,t)}},HdGT:function(e,t,n){"use strict";n.r(t),n.d(t,"onStopped",(function(){return v})),n.d(t,"onSent",(function(){return g})),n.d(t,"onFailed",(function(){return A})),n.d(t,"onCaptcha",(function(){return b})),n.d(t,"onErrorMessage",(function(){return w})),n.d(t,"onMessage",(function(){return y})),n.d(t,"onMessageRemove",(function(){return O})),n.d(t,"QUEUE_MAX_FAILS",(function(){return S})),n.d(t,"QUEUE_NAME",(function(){return k})),n.d(t,"ready",(function(){return C})),n.d(t,"getItems",(function(){return j})),n.d(t,"send",(function(){return E})),n.d(t,"retry",(function(){return T})),n.d(t,"remove",(function(){return I}));var i=n("W38l"),a=n("OcsD"),r={},o={};function s(e,t){var n=r[e];delete n.items[t];var i=n.pending.indexOf(t),a=n.failed.indexOf(t);-1!==i&&n.pending.splice(i,1),-1!==a&&n.failed.splice(a,1),d(e)}function c(e){var t=r[e];t.failed=t.failed.concat(t.pending),t.pending=[],o[e]="idle",t.sendingItemId=null,t.onStopped(),d(e)}function l(e){var t=r[e];return t.loaded?Promise.resolve():(t.retrieving||(t.retrieving=function(e){return new Promise((function(t){var n=Object(a.lsGet)("q_"+e)||{items:{},pending:[],failed:[]};n.failed=n.failed.concat(n.pending).filter((function(e){return!!n.items[e]})),n.pending=[],t(n)}))}(e).then((function(t){var n=t.pending,i=t.failed,a=t.items,o=r[e];o.retrieving=null,o.loaded=!0,o.pending=n,o.failed=i,o.items=a}))),t.retrieving)}function u(e,t){if(!1!==navigator.onLine){var n=r[e];if("sending"!==o[e]&&n.pending.length&&!n.backoffTimer){var i=n.pending[0],a=n.items[i];if(!a.fails||t)o[e]="sending",n.sendingItemId=i,n.onSend(a.id,a.data);else{var s=Math.pow(2,Math.max(a.fails-2,0));n.backoffTimer=setTimeout((function(){n.backoffTimer=null,u(e,!0)}),1e3*s)}}}}function d(e){var t=r[e],n=t.pending,i=t.failed,o=t.items;Object(a.lsSet)("q_"+e,{pending:n,failed:i,items:o})}window.addEventListener("online",(function(){Object.keys(r).forEach((function(e){u(e)}))}));var _,f,p=n("qHA9"),h=n("+cqQ"),m=n("j80l"),v=Object(h.default)(),g=Object(h.default)(),A=Object(h.default)(),b=Object(h.default)(),w=Object(h.default)(),y=Object(h.default)(),O=Object(h.default)(),S=5,k="mail_send";function C(){return l(k)}function j(){return{pending:(e=r[k]).pending,failed:e.failed,items:e.items};var e}function E(e){C().then((function(){var t;i.logQueueSize((t=r[k])?t.pending.length:0);var n=Object(p.sendDataToMessage)(e);!function(e,t,n){var i={id:t,data:n,fails:0},a=r[e];s(e,t),a.items[t]=i,a.pending.push(t),u(e),d(e)}(k,n.sendId,{data:e}),y(n)}))}function T(e,t){var n,i=(n=e,r[k].items[n]||null);t&&(i.data=t(i.data)),s(k,e),E(i.data.data)}function I(e,t){s(k,e),"silent"!==t&&O(e)}f={onSend:function(e,t){!function(e,t){e=Object.assign({},e);var n="/mail",a="edit_message"===e.act;a?Object.keys(e).forEach((function(t){"attached_messages"!==t&&"has_reply"!==t||delete e[t]})):(n=Object(m.makeUrl)("/mail",{act:"send",to:e.to,from:e.from,hash:e.hash,_af:e._af,ref:e.ref||"",ref_source:e.ref_source||""}),Object.keys(e).forEach((function(t){"act"!==t&&"to"!==t&&"from"!==t&&"hash"!==t&&"_af"!==t&&"attachesHTML"!==t||delete e[t]}))),i.log(t,a?"edit":"send");var s=function(e){var n,s,c;i.mark(t,"server"),a&&!e.was_modified&&O(t),g(),s=r[n=k],(c=s.sendingItemId)&&(s.pending[0]===c&&s.pending.shift(),delete s.items[c]),o[n]="idle",s.sendingItemId=null,u(n),d(n)};Object(p.mailRequest)(n,e).then(s,(function e(n){var a=n.type,l=n.code,d=n.message,_=n.data;if(i.error(t,"server_send",a),"captcha"!==a&&i.clean(t),"server"===a&&l&&l!==p.UNKNOWN_ERROR)return d&&w(d),void c(k);"captcha"!==a?(function(e){var t=r[e],n=t.sendingItemId;if(n&&t.pending[0]===n){var i=t.items[n];if(i&&(i.fails+=1,i.fails>=t.maxFails))return void c(e)}o[e]="idle",t.sendingItemId=null,u(e)}(k),A()):b(_,(function(n){if(!n)return i.clean(t),void c(k);n.then(s,e)}))}))}(t.data,e)},onStopped:v,maxFails:S},r[_=k]={pending:[],failed:[],items:{},onSend:f.onSend,onStopped:f.onStopped,maxFails:0|f.maxFails,loaded:!1,sendingItemId:null,backoffTimer:null},o[_]="idle"},I2ZF:function(e,t){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0,a=n;return[a[e[i++]],a[e[i++]],a[e[i++]],a[e[i++]],"-",a[e[i++]],a[e[i++]],"-",a[e[i++]],a[e[i++]],"-",a[e[i++]],a[e[i++]],"-",a[e[i++]],a[e[i++]],a[e[i++]],a[e[i++]],a[e[i++]],a[e[i++]]].join("")}},I7Du:function(e,t,n){"use strict";n.r(t);var i=n("z9sQ");var a=function(e){void 0===e&&(e={});var t=e.on_change;return{inner:[{inner:[e.options.map((function(e){return e?{inner:[e.label],attrs:e.attrs,class:"Select__option",value:e.value,selected:e.selected?"selected":null,tag:"option"}:null}))],class:"Select__native",name:e.name,disabled:e.disabled,onchange:e.nativeOnChange?e.onChange:t?["Select._onChange","this",t]:null,required:e.required,tag:"select"}],class:[e.mix||e.class,i.default.class("Select",{disabled:e.disabled},"_")],tag:"div"}};t.default=a},IetZ:function(e,t,n){"use strict";n.r(t),n.d(t,"cutTextToHighlight",(function(){return i}));function i(e){var t=null;document.querySelectorAll(e+":not(.cutTextToHighlight)").forEach((function(e){if(e.classList.add("cutTextToHighlight"),null===t){var n=getComputedStyle(e).font;i=n,(a=document.createElement("canvas").getContext("2d")).font=i,t=function(e){var t=a.measureText(e).width;return Math.ceil(t)}}var i,a;e.innerHTML=function(e,t,n){void 0===n&&(n="…");var i=e.querySelector(".highlight");if(!i)return e.innerHTML;var a=e.innerHTML.indexOf('<em class="highlight">');if(i.offsetLeft+i.offsetWidth<=e.offsetWidth-15)return e.innerHTML;if(i.offsetWidth<e.offsetWidth-15){for(var r=0,o="",s=a;s>0&&r+i.offsetWidth<=e.offsetWidth;){var c=e.innerHTML.lastIndexOf(" ",s-1);if(-1===c&&(c=0),o=e.innerHTML.substring(c,s)+o,!((r=t(n+o.trim()))+i.offsetWidth<=e.offsetWidth-15))break;s=c}a=s}if(a>0)return n+e.innerHTML.substring(a).trim();return e.innerHTML}(e,t)}))}},JCKH:function(e,t,n){"use strict";n.r(t),n.d(t,"GroupCallSnippet",(function(){return a})),n.d(t,"GroupCallSnippetSkin",(function(){return c}));var i=n("ZMWW"),a={join:function(e){i.SAKIntegration.isIntegrated&&i.SAKIntegration.sendMessage("call_join",{callData:e,peerId:store.mail.cur.peerId})}},r=n("Y6JH"),o=n("fdw3"),s=n("5fby");function c(e){var t=e.data,n=t?{inner:[Object(o.getLang)("mobile_mail_snippet_groupcall_connect")],class:"GroupCallSnippet__link",tag:"div"}:{inner:[Object(o.getLang)("mobile_mail_snippet_groupcall_ended")],class:"GroupCallSnippet__ended",tag:"div"};return{inner:[{inner:[Object(r.default)({icon:Object(s.getPhone24Icon)()})],class:"GroupCallSnippet__left",tag:"div"},{inner:[{inner:[Object(o.getLang)("mobile_mail_snippet_groupcall_title")],class:"GroupCallSnippet__title",tag:"div"},n],class:"GroupCallSnippet__main",tag:"div"}],class:"MailButton GroupCallSnippet",type:"button",onClick:t?["GroupCallSnippet.join",t]:"",tag:"button"}}window.GroupCallSnippet=a},JlTo:function(e,t,n){"use strict";n.r(t),n.d(t,"tmrTrackPage",(function(){return c})),n.d(t,"tmrTrackRegistration",(function(){return l})),n.d(t,"tmrTrackCustomGoal",(function(){return u})),n.d(t,"tmrTrackMiniAppOpen",(function(){return v})),n.d(t,"tmrTrackMiniAppClose",(function(){return g})),n.d(t,"tmrTrackMiniAppLogin",(function(){return A})),n.d(t,"tmrTrackMiniAppRegistration",(function(){return b})),n.d(t,"tmrTrackMiniAppCustom",(function(){return w}));var i=n("wx14"),a=n("J8bf"),r="miniAppEvent";function o(){return window.vk&&window.vk.id?window.vk.id:0}function s(e){window.vk&&window.vk.zero||window.__dev||(window._tmr=window._tmr||[],window._tmr.push(e))}function c(e,t){s({id:"2579437",url:e,referrer:t,type:"pageView",start:(new Date).getTime(),pid:o(),userid:o()}),Object(a.getCookie)("remixtmr_login")&&(Object(a.setCookie)("remixtmr_login","",-1),s({id:"2579437",type:"reachGoal",goal:"mt_login",userid:o()}))}function l(){s({id:"2579437",type:"reachGoal",goal:"mt_registration",userid:o()})}function u(e,t){void 0===t&&(t={}),s({id:"2579437",type:"reachGoal",goal:e,userid:o(),params:t})}function d(e){var t=o();o&&s({id:"2579437",type:r,params:Object(i.default)({},e,{platformUserId:String(t)})})}var _="open",f="close",p="login",h="registration",m="custom";function v(e,t){d({eventType:_,miniAppId:e,queryParams:t})}function g(e){d({eventType:f,miniAppId:e})}function A(e,t){d({eventType:p,miniAppId:e,customUserId:t})}function b(e,t){d({eventType:h,miniAppId:e,customUserId:t})}function w(e,t){d(Object(i.default)({eventType:m,miniAppId:e},t))}},KMpi:function(e,t,n){"use strict";n.r(t),n.d(t,"Avatar",(function(){return c}));var i=n("TYsd"),a=n("Y6JH"),r=n("2oAq"),o=n("fdw3"),s=n("uBUF");function c(e){var t=e.mode||"image",n=e.size||24,c=e.src?Object(o.isArray)(e.src)?e.src:[e.src]:[],l=e.borderRadius||"full",u=e.backgroundTheme?e.backgroundTheme>6?Math.abs(e.backgroundTheme)%6+1:e.backgroundTheme:1,d=e.mix?Object(o.isArray)(e.mix)?e.mix.join(" "):e.mix:"",_=function(e,t,n,i,a,r){return["Avatar","Avatar--mode-"+e,"Avatar--size-"+t,"Avatar--images-"+n,"Avatar--borderRadius-"+i,"image"!==e&&"Avatar--theme-"+a,r]}(t,n,c.length,l,u,d),f=e.inner?Object(o.isObject)(e.inner)?e.inner:i.default.wrap(e.inner):null,p=null,h=null,m=null;return"text"===t?p={inner:[e.text],class:"Avatar__text",tag:"div"}:(h=function(e){for(var t=[],n=e.length<=4?e.length:4,i=0;i<n;i++){var a=i+1;t.push({class:"Avatar__image Avatar__image-"+a,style:"background-image: url('"+e[i]+"')",tag:"div"})}return t}(c),c.length||f||(m=Object(a.default)({icon:Object(r.getUsers24Icon)()}))),Object(s.CustomTag)({inner:[h,m,p,f],tag:e.url?"a":"div",href:e.url,class:_})}},KiYr:function(e,t,n){"use strict";n.r(t);var i=n("LmmP");t.default=i.default},L9Nh:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"QueueManager",(function(){return QueueManager}));var _babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("wx14"),_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("OcsD"),QUEUE_CREATION_TIME_INDEX=0,QUEUE_TIMESTAMP_INDEX=1,QUEUE_KEY_INDEX=2,QUEUE_CALLBACK_INDEX=3,INCORRECT_KEY_OR_TIMESTAMP_ERROR_CODE=2,KEY_IS_BLOCKED_BY_ANOTHER_REQUEST_ERROR_CODE=4,TRANSPORT_FRAME_ID="queue_transport_frame",QueueManager=function(){function QueueManager(){}return QueueManager.addQueue=function(e,t){QueueManager.initialized&&(QueueManager.queues[e.key]=[vkNow(),e.ts,e.key,t])},QueueManager.start=function(){QueueManager.initialized&&!QueueManager.started&&(QueueManager.createFrame(QueueManager.check),QueueManager.started=!0)},QueueManager.check=function check(){var _this=this,params={act:"a_check",ts:curNotifier.timestamp,key:curNotifier.key,id:curNotifier.uid,wait:25},addQueues=[],now=vkNow();Object.keys(QueueManager.queues).forEach((function(e){var t=QueueManager.queues[e],n=t[QUEUE_CREATION_TIME_INDEX],i=t[QUEUE_TIMESTAMP_INDEX];now-n>3e4&&!e.match(/nccts/)?delete QueueManager.queues[t]:(params.ts+="_"+i,params.key+=e,addQueues.push(e))})),curNotifier.lpMakeRequest&&curNotifier.lpMakeRequest(curNotifier.frame_url,params,(function(text){try{var response=eval("("+text+")"),main_response=response,addResponse,addQueue,busy=0;if(isArray(response))for(main_response=response.shift(),curNotifier.timestamp=main_response.ts;(addResponse=response.shift())&&(addQueue=addQueues.shift(),addQueue);)addResponse.failed!==INCORRECT_KEY_OR_TIMESTAMP_ERROR_CODE||addResponse.err!==KEY_IS_BLOCKED_BY_ANOTHER_REQUEST_ERROR_CODE?addResponse.failed?delete QueueManager.queues[addQueue]:QueueManager.callQueue(addQueue,addResponse):busy|=1;else if(response.failed)for(;addQueue=addQueues.shift();)delete QueueManager.queues[addQueue];busy||(clearTimeout(curNotifier.lpCheckTO),curNotifier.lpCheckTO=setTimeout(QueueManager.check.bind(_this),curNotifier.request_timeout||1e3),curNotifier.error_timeout=Math.max(1,(curNotifier.error_timeout||1)/1.5))}catch(e){curNotifier.error_timeout=curNotifier.error_timeout||1,clearTimeout(curNotifier.lp_error_to),curNotifier.lp_error_to=setTimeout(QueueManager.check.bind(_this),1e3*curNotifier.error_timeout),curNotifier.error_timeout<64&&(curNotifier.error_timeout*=2)}}),(function(){return!0}))},QueueManager.init=function(e){window.curNotifier=Object(_babel_runtime_helpers_esm_extends__WEBPACK_IMPORTED_MODULE_0__.default)({},e),QueueManager.initialized=!0,delete curNotifier.makeRequest},QueueManager.createFrame=function(e){re(TRANSPORT_FRAME_ID),Object(_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_1__.createIframe)({id:TRANSPORT_FRAME_ID,name:TRANSPORT_FRAME_ID,src:window.curNotifier.frame_path,ariaHidden:!0});var t=setInterval((function(){curNotifier.lpMakeRequest&&(clearInterval(t),e())}),500);setTimeout((function(){return clearInterval(t)}),1e4)},QueueManager.callQueue=function(e,t){var n=QueueManager.queues[e];if(Array.isArray(n)&&n.length){n[QUEUE_TIMESTAMP_INDEX]=t.ts;var i=n[QUEUE_CALLBACK_INDEX];isFunction(i)&&i(n[QUEUE_KEY_INDEX],t)}},QueueManager}();QueueManager.queues={},QueueManager.started=!1,QueueManager.initialized=!1,window.QueueManager=QueueManager},LmmP:function(e,t,n){"use strict";n.r(t),n.d(t,"Alert",(function(){return r}));var i=n("z9sQ"),a=n("fdw3");function r(e){return{inner:[e.title?{inner:[e.title],class:"Alert__title",tag:"div"}:null,{inner:[e.text||e.inner],class:"Alert__description",tag:"div"}],class:Object(a.classNames)(e.class,i.default.class("Alert",{theme:e.theme},"_")),tag:"div"}}t.default=r},Mc5h:function(e,t,n){"use strict";n.r(t);var i=n("2IoG");t.default=i.default,window.Brick=i.default},MzAf:function(e,t){function n(e){return function(t){t.$control.closest(a.sms).classList.toggle(r[e])}}function i(e,t){var n=t.$select,i=t.value;n.closest(a.sms).classList.toggle(r.pmUsersVisible,e.includes(i)||e.includes(Number(i)))}window.SettingsSms={},SettingsSms._onEnabledChange=n("enabled"),SettingsSms._onTimeLimitedChange=n("timeLimited"),SettingsSms._onFrequencyChange=i;var a={sms:".settingsSms"},r={enabled:"settingsSms_enabled",timeLimited:"settingsSms_timeLimited",pmUsersVisible:"settingsSms_pmUsersVisible"}},N4ZS:function(e,t,n){"use strict";function i(e){return"https://vk.com/web/away.php?to="+e}function a(e,t){var n=decodeURIComponent(e);return/^\/[^/]/.test(n)||/^(https?:\/\/)?([a-z0-9_\-.]+\.)?vk.com(\/.*)?/.test(n)?e:"/away.php?to="+encodeURIComponent(n)+(t?"&utf=1":"")}n.r(t),n.d(t,"wrapAway",(function(){return i})),n.d(t,"wrapAwayIfExternal",(function(){return a}))},NroU:function(e,t,n){"use strict";n.r(t),n.d(t,"CartOrder",(function(){return S})),n.d(t,"CartOrder_info",(function(){return k})),n.d(t,"CartOrderFormContent",(function(){return O})),n.d(t,"orderActionsIds",(function(){return y}));var i=n("p5n7");var a=function(e){return{inner:[e.inner],class:[e.class,"Label"],for:e.for?e.for:null,tag:"label"}},r=n("29dZ"),o=n("UWnA"),s=n("I7Du"),c=n("VRji");function l(e){var t=e.data.filter((function(e){return!!e.labelText})).length,n=0;return{inner:[e.data.map((function(e){return n+=1,{inner:[{class:"DeliveryTabs__input",id:"delivery_option_"+e.type,name:"delivery_option",type:"radio",checked:e.isChecked,value:e.type,onchange:["CartOrder.setOrderSetting","event","delivery_option"],tag:"input"},{inner:[{inner:[e.labelText],class:"DeliveryTabs__labelText",tag:"div"},{inner:[e.infoText],class:"DeliveryTabs__infoText",tag:"div"}],class:"DeliveryTabs__label DeliveryTabs__label--nth"+n+" DeliveryTabs__label--"+e.type,for:"delivery_option_"+e.type,tag:"label"},{inner:[e.content],class:"DeliveryTabs__content",tag:"div"}],class:"DeliveryTabs_elem",tag:"div"}}))],class:"DeliveryTabs DeliveryTabs--nth"+t,tag:"div"}}var u=n("Eyxt"),d=n("+qVl"),_=n("z9sQ"),f=n("fdw3"),p=n("TYsd"),h=n("z1UI"),m=n("g5Vw"),v=n("3ai+"),g=n("Y6JH");function A(e){var t=e.item;return[{inner:[t.required_error_msg],class:"DeliveryInput DeliveryInput__requiredErrorMsg DeliveryInput__errorMsg",tag:"div"},{inner:[t.validation_regex_error_msg],class:"DeliveryInput DeliveryInput__validationRegexErrorMsg DeliveryInput__errorMsg",tag:"div"},{inner:[t.error_msg],class:"DeliveryInput__serverErrorMsg "+_.default.class("DeliveryInput__errorMsg",{show:!!t.error_msg}),tag:"div"}]}function b(e){var t=!e.value&&e.is_required||e.error_msg;return _.default.class("DeliveryInput",{noValid:t,required:e.is_required})}function w(e){var t=e.item;return[{inner:[Object(i.default)({class:"CartOrder__cityIdInputJs",placeholder:t.placeholder,required:t.is_required,pattern:t.validation_regex?t.validation_regex:null,type:t.type,value:t.city.name,readonly:!0}),Object(i.default)({class:"CartOrder__cityIdInputJs",name:t.name,required:t.is_required,pattern:t.validation_regex?t.validation_regex:null,type:"hidden",value:t.value,hidden:!0}),{class:"CartOrder__cityInputLink CartOrder__cityIdLinkJs",href:"?city_select=1&country_id="+e.curCountry,"aria-label":t.placeholder,tag:"a"}],class:"CartOrder__cityInputWrap",tag:"div"},A({item:t})]}var y={0:"do_order",1:"write_to_merchant",2:"pay"};function O(e,t){var n,l=t.delivery_point,h=t.field_types,m=e.form.map((function(r){if(r.type===h.country)return n=r.value,Object(o.default)({inner:[a({inner:[r.label]}),Object(s.default)({name:r.name,options:t.countries.map((function(e){return{label:e.label,value:e.value,selected:e.value===r.value}})),nativeOnChange:!0,onChange:"CartOrder.setOrderSetting(event, '"+r.name+"')",required:r.is_required}),A({item:r})],class:b(r)});if(r.type===h.city)return Object(o.default)({inner:[a({inner:[r.label]}),w({item:r,curCountry:n})],class:b(r)});if(r.type===h.image)return r.image?Object(o.default)({inner:[{class:"CartOrder__inputImage",href:r.image,target:"_blank",style:"background-image: url("+r.image+")","aria-label":Object(f.getLang)("market_order_delivery_area"),tag:"a"}]}):"";if(r.type===h.dropdown){var u=r.options.map((function(e){return{label:e.name,value:e.id}}));return u.unshift({label:r.placeholder||"",value:""}),Object(o.default)({inner:[a({inner:[r.label]}),Object(s.default)({name:r.name,options:u.map((function(e){return{label:e.label,value:e.value,selected:e.value===r.value}})),nativeOnChange:!0,onChange:["CartOrder.setOrderSetting","event",r.name]}),A({item:r})],class:b(r)})}if(r.type===h.screen_select){var p=r.options.filter((function(e){return e.id===r.value})),m=p[0]?p[0].name:r.placeholder;return Object(o.default)({inner:[{inner:[{inner:[a({inner:[r.label],class:"CartOrder__selectScreenLabel"}),{inner:[m],class:"CartOrder__selectScreenTitle",tag:"div"}],tag:"div"},{inner:[Object(g.default)({icon:Object(v.getChevronRight24Icon)()})],class:"CartOrder__selectScreenIcon",tag:"div"}],class:"CartOrder__selectScreenWrap",href:"?act=cart_screen_select&delivery_option="+e.type+"&name="+r.name,tag:"a"},A({item:r})],class:b(r)})}if(r.type===h.delivery_point)return[Object(o.default)({inner:[a({inner:[r.label]}),Object(i.default)({name:r.name,required:r.is_required,pattern:r.validation_regex?r.validation_regex:null,value:r.value||null,type:"hidden"})],class:b(r)+" CartOrder__deliveryPointLabel"}),{inner:[r.value?Object(d.DeliveryPointListItem)(l):""],id:"js_cart_order_delivery_point",tag:"div"},Object(o.default)({inner:[{inner:[r.placeholder],href:"?act=cart_delivery_point_list",tag:"a"}],class:"CartOrder__deliveryPointSelect"})];if(r.type===h.header)return Object(o.default)({inner:[r.label],tag:"h2"});if(r.type===h.textarea)return Object(o.default)({inner:[a({inner:[r.label]}),Object(c.default)({name:r.name,placeholder:r.placeholder,type:r.type,text:r.value||"",attrs:{onblur:"CartOrder.setOrderSetting(event, '"+r.name+"')",maxlength:t.maxlength}}),A({item:r})],class:b(r)});if(r.type===h.placeholder)return Object(o.default)({inner:[{inner:[r.label],class:""+_.default.class("DeliveryPlaceholder",{show:!1}),tag:"div"}],class:b(r)});if(r.type===h.text||r.type===h.number){var y=r.type===h.text?"CartOrder__inputToUnclean":"";return Object(o.default)({inner:[a({inner:[r.label]}),Object(i.default)({name:r.name,placeholder:r.placeholder,required:r.is_required,pattern:r.validation_regex?r.validation_regex:null,value:r.value||null,type:r.type,onblur:"CartOrder.setOrderSetting(event, '"+r.name+"')",maxlength:t.maxlength,mix:y}),A({item:r})],class:b(r)})}return""}));m.push(Object(i.default)({name:"delivery_option",value:e.type,type:"hidden"})),m.push(Object(i.default)({name:"act",value:"cart_do_order",type:"hidden"})),m.push(Object(i.default)({name:"hash",value:t.hash,type:"hidden"})),m.push(Object(i.default)({name:"group_id",value:t.group_id,type:"hidden"}));var y=Object(u.DeliveryPrice)({prices:t.order_settings.prices,type:e.type}),O=t.order_settings.order_actions.map((function(t){var n,i=0===(n=t.type)?"do_order":1===n?"write_to_merchant":2===n?"pay":"";return Object(o.default)({inner:[Object(r.default)({inner:[t.title],attrs:{id:i+"_button_"+e.type},disabled:t.is_disabled,stretch:!0,size:"large",theme:t.is_accent?"regular":"tertiary",type:"submit",onClick:["CartOrder.doOrder",t.type]})]})}));return{inner:[m,y,Object(o.default)({inner:[{inner:[p.default.html(Object(f.getLang)("market_mobile_required_field_sign_description").replace("{sign}",'<span class="CartOrder__requiredSign">*</span>'))],class:"CartOrder__requiredDescription",tag:"span"},t.user_agreement?{inner:[t.user_agreement],class:"CartOrder__userAgreement",tag:"span"}:null],class:"CartOrder__terms"}),O],id:"delivery_option_form_"+e.type,tag:"form"}}function S(e){var t=Object(o.default)({inner:[Object(m.CartOrderSellerComment)({text:e.seller_comment})],class:"CartOrder__sellerCommentRow"}),n=e.order_settings.delivery_options.map((function(t){return{type:t.type,labelText:t.title,infoText:t.info||t.default_message,content:O(t,e),isChecked:e.order_settings.selected_delivery_option===t.type}}));return{inner:[e.seller_comment?t:"",l({data:n})],class:"CartOrder","data-section-ref":"payment_content",tag:"div"}}function k(e){void 0===e&&(e={});var t={inner:[e.icon],class:"SplashScreen__icon",tag:"div"};return Object(h.default)({icon_raw:t,title:e.title,text:e.description,action_text:e.actionText,action_url:e.actionUrl,class:"CartOrderInfo"})}},O5lf:function(e,t,n){"use strict";n.r(t);var i=n("9y81"),a=n("Y6JH"),r=n("z9sQ"),o=n("Fbxv"),s=function(e){void 0===e&&(e={});var t=e.mix||"",n="pageLoader"===(e.type||"gray"),s=r.default.class("Spinner",{pageLoader:n,hidden:e.isHidden,fixed:e.isFixed}),c=t+" "+s;if(n)return Wd.html({inner:[Object(a.default)(Object(o.getLoading40Icon)())],class:c,tag:"div"});return Object(i.default)({mix:c,icon:"spinner"})};var c=n("jE6c");var l={show:function(e){Object(c.isElement)(e)&&e.classList.remove("Spinner--hidden")},hide:function(e){Object(c.isElement)(e)&&(e.classList.contains("Spinner--hidden")||e.classList.add("Spinner--hidden"))}};Object.assign(s,l),window.Spinner=s;t.default=s},OGWK:function(e,t){window.SubscribeBtn={onClick:function(e,t,n,i,a,r){try{var o=r+"_unsubscribe",s=r+"Icon",c=r+"Icon_unsubscribe",l=r+"Icon_subscribe",u=hasClass(e,o),d=u?i:n,_=u?getLang("mobile_groups_public_subscribe"):getLang("mobile_groups_you_are_in_public"),f=!u,p=geByClass1(s,e),h=function(e){var t=intval(domData(e,"block-id"));if(!t){var n=domCA(e,".feedAssistance");t=intval(domData(n,"block-id"))||null}return t}(e),m=domData(e,"from")||null;p&&(toggleClass(c,p,f),toggleClass(l,p,!f)),attr(e,"aria-label",escapeAttr(_)),toggleClass(o,e,f),"group"===a?function(e,t,n,i){(n?Groups.leave:Groups.enter).call(Groups,e,t,i)}(t,d,u):function(e,t,n,i,a){(n?Friends.decline:Friends.accept).call(Friends,e,t,i,a)}(t,d,u,m,h)}catch(e){console.trace(e)}return!1}}},OGfC:function(e,t,n){"use strict";n.r(t);var i=n("JX7q"),a=n("dI71"),r=n("W9Tc");function o(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(t),i=new Uint8Array(n.length),a=0;a<n.length;++a)i[a]=n.charCodeAt(a);return i}var s=n("W0P9"),c=n("Xrg9"),l=function(){function e(e,t){var n=this;this.sw=e,this.SWClient=t,vk.id&&this.canBeEnabled().then((function(e){e&&(n.listenPermission(),n.loadEndpoint()&&n.update().then(n.checkMessageState.bind(n)))}))}e.getPermission=function(){return Notification.permission};var t=e.prototype;return t.cleanNotification=function(){this.sw.action("cleanNotification")},t.canBeEnabled=function(){return Promise.resolve(this.isSupported())},t.isSupported=function(){return"PushManager"in window&&"Notification"in window&&this.SWClient.isSupported()},t.loadEndpoint=function(){return c.default.get("push_notifier_endpoint"+vk.id)||!1},t.saveEndpoint=function(e){c.default.set("push_notifier_endpoint"+vk.id,e||!1)},t.action=function(e,t){return this.sw.action(e,t)},t._needupdate=function(e){var t=Date.now(),n=this.loadEndpoint(),i=c.default.get("push_notifier_subscribed_ts"+vk.id),a=!1;return(n!==e.endpoint||!i||t-i>6e4)&&(c.default.set("push_notifier_subscribed_ts"+vk.id,t),a=!0),a},t.listenPermission=function(){var e=this;Object(r.partConfigEnabled)("push_notifier")&&navigator.permissions&&navigator.permissions.query&&navigator.permissions.query({name:"notifications"}).then((function(t){t.onchange=function(){return e.update()}}))},t.update=function(){var t=this;return this.updatePermission().then((function(n){return n===e.PUSH_NOTIFIER_PERMISSION_GRANTED?t.subscribe().catch((function(t){t!==e.SUBSCRIBE_ERROR_NETWORK&&Object(s.error)("can not update subscribe")})):Promise.reject("premession_not_granted")})).catch(s.error)},t.updatePermission=function(){var t=e.getPermission();if(t!==e.PUSH_NOTIFIER_PERMISSION_GRANTED){var n=this.loadEndpoint();if(n)return this.unsubscribe(n).then((function(){return t}))}return Promise.resolve(t)},t.processSubscribe=function(t){return t.subscribe({userVisibleOnly:!0,applicationServerKey:o(e.SERVER_KEY)})},t.setupSubscription=function(){var t=this;return new Promise((function(n,i){var a=e.getPermission(),r=function(){t.subscribe(!0).then((function(){n()})).catch((function(){i()}))};a!==e.PUSH_NOTIFIER_PERMISSION_DENIED?a!==e.PUSH_NOTIFIER_PERMISSION_GRANTED?a===e.PUSH_NOTIFIER_PERMISSION_DEFAULT&&t.requestPermission().then((function(t){t===e.PUSH_NOTIFIER_PERMISSION_GRANTED?r():i()})):r():i(e.PUSH_NOTIFIER_BLOCKED_BY_BROWSER_SETTINGS)}))},t.subscribe=function(t){var n=this;return this.sw.getRegistration().then((function(e){var t=e.pushManager;return t.getSubscription().then((function(e){if(e){var i=e.expirationTime;return i&&Date.now()>i-432e6?n.unsubscribe(n.loadEndpoint()).then((function(){return n.processSubscribe(t)})):e}return n.processSubscribe(t)}))})).then((function(i){return new Promise((function(a,r){if(t||n._needupdate(i)){var o=i.getKey("p256dh"),s=i.getKey("auth");window.ajax.post(e.SERVER_URL,{act:"a_subscribe",hash:n.sw.getParams().push_hash,endpoint:i.endpoint,key:o?btoa(String.fromCharCode.apply(null,new Uint8Array(i.getKey("p256dh")))):null,token:s?btoa(String.fromCharCode.apply(null,new Uint8Array(i.getKey("auth")))):null},{onDone:function(e){e?(n.saveEndpoint(i.endpoint),a()):r()},onFail:function(){return r(e.SUBSCRIBE_ERROR_NETWORK),!0}})}else a()}))}))},t.unsubscribe=function(t){var n=this;return this.sw.register().then((function(i){return i.pushManager.getSubscription().then((function(i){return i?i.unsubscribe().then((function(i){return i?new Promise((function(i,a){ajax.post(e.SERVER_URL,{act:"a_unsubscribe",endpoint:t},{onDone:function(e){e?(n.saveEndpoint(!1),i()):a()}})})):Promise.reject("ERROR: can not unsubscribe")})):(n.saveEndpoint(!1),Promise.reject("ERROR: no subscription"))}))}))},t.requestPermission=function(){var t=e.getPermission();return t===e.PUSH_NOTIFIER_PERMISSION_DEFAULT?new Promise((function(e,t){var n=Notification.requestPermission((function(t){e(t)}));n instanceof Promise&&n.then(e,t)})):Promise.resolve(t)},t.checkMessageState=function(){var t=this;return new Promise((function(e){return setTimeout(e,5e3)})).then((function(){return t.action("getMessagesMetaData")})).then((function(t){return"object"==typeof t&&Object.keys(t).length?new Promise((function(n,i){window.ajax.post(e.SERVER_URL,{act:"a_update_messages_state",data:Object.entries(t)},{onDone:function(e){e?n(e):i("ERROR: act error")},onFail:function(){return i("ERROR: network error"),!0}})})):Promise.resolve({})})).then((function(e){try{return JSON.parse(e)}catch(e){return{}}})).then((function(e){return t.action("updateMessageNotifications",e)})).catch((function(e){return Object(s.error)(e)}))},e}();l.SERVER_KEY="BPrntRk2W1_ISFwlgY-vz9tQDg9i1oSQ3-N8xyjdbNAbIOdZIGFdh5FlO7zn730UwU9Sayoec-Fpqq4JZFTyv60",l.SERVER_URL="push_notifier",l.PUSH_NOTIFIER_PERMISSION_GRANTED="granted",l.PUSH_NOTIFIER_PERMISSION_DEFAULT="default",l.PUSH_NOTIFIER_PERMISSION_DENIED="denied",l.PUSH_NOTIFIER_BLOCKED_BY_BROWSER_SETTINGS="BLOCKED_BY_BROWSER_SETTINGS",l.SUBSCRIBE_ERROR_NETWORK="SUBSCRIBE_ERROR_NETWORK";var u=l,d=n("PovR"),_=function(e){function t(t,n){var a;return a=e.call(this,t,n)||this,vk.id&&a.canBeEnabled().then((function(e){e&&(a.updateHeadClass(),a.handlerMessagesLP=a.handlerMessagesLP.bind(Object(i.default)(a)),page.onChange((function(){return a.updateHeadClass()})))})),a}Object(a.default)(t,e);var n=t.prototype;return n.canBeEnabled=function(){return e.prototype.canBeEnabled.call(this).then((function(e){return e?t.isNativeAppInstalled().then((function(e){return!e})):Promise.resolve(!1)}))},n.isSupported=function(){return e.prototype.isSupported.call(this)&&(browser.chrome||browser.mozilla)},n.updateHeadClass=function(){var e=u.getPermission();document.head&&(removeClass(document.head,"push_notifier_"+u.PUSH_NOTIFIER_PERMISSION_GRANTED),removeClass(document.head,"push_notifier_"+u.PUSH_NOTIFIER_PERMISSION_DENIED),removeClass(document.head,"push_notifier_"+u.PUSH_NOTIFIER_PERMISSION_DEFAULT),e&&addClass(document.head,"push_notifier_"+e),addClass(document.head,"push_notifier_supported"))},n.handlerMessagesLP=function(e,t){this.sw.action("removeMessageNotification",{peerId:t,msgId:e})},n.cleanNotification=function(){this.sw.action("cleanNotification")},n.removeLongPollListener=function(){this.lp&&this.lp.off(),this.lp=null},n.addLongPollListener=function(){window.isNewMail&&window.isNewLongpoll&&!this.lp&&(this.lp=window.im.onMsgReadByMe(this.handlerMessagesLP))},t.isNativeAppInstalled=function(){var e=Date.now(),n=c.default.get(t.PUSH_NOTIFIER_LS_KEY_RELATED_APPS_TS),i=c.default.get(t.PUSH_NOTIFIER_LS_KEY_RELATED_APPS);return new Promise((function(a){null!==i&&n&&e-n<t.PUSH_NOTIFIER_LS_TTL_RELATED_APPS?a(!!i):"getInstalledRelatedApps"in navigator?navigator.getInstalledRelatedApps().then((function(n){var i=Object.values(n).some((function(e){return"com.vkontakte.android"===e.id}));c.default.set(t.PUSH_NOTIFIER_LS_KEY_RELATED_APPS_TS,e),c.default.set(t.PUSH_NOTIFIER_LS_KEY_RELATED_APPS,i),a(i)})).catch((function(){a(!1)})):a(!1)}))},n.update=function(){var t=this;return e.prototype.update.call(this).then((function(){t.updateHeadClass(),t.addLongPollListener()}))},n.unsubscribe=function(t){var n=this;return e.prototype.unsubscribe.call(this,t).then((function(){return n.removeLongPollListener()}))},t}(u);_.PUSH_NOTIFIER_LS_KEY_RELATED_APPS="push_notifier_related_apps",_.PUSH_NOTIFIER_LS_KEY_RELATED_APPS_TS="push_notifier_related_apps_ts",_.PUSH_NOTIFIER_LS_TTL_RELATED_APPS=d.HOUR/2;t.default=_},Ogzf:function(e,t,n){"use strict";n.r(t),n.d(t,"onLongpress",(function(){return r})),n.d(t,"onLongpressOrClick",(function(){return s}));var i=n("wx14"),a=n("OcsD");function r(e,t,n,i){void 0===t&&(t=350);var r,s=void 0===i?{}:i,c=s.cancelLongPressOnMove,l=void 0!==c&&c,u=s.eventsRelease,d=void 0===u?"touchcancel touchend touchmove mouseout mouseup mousemove scroll":u,_=s.initialTouchStartEvent,f=s.onRelease,p=s.onStart,h=s.shouldPreventDefault,m=s.ignoreMouseLongpress,v=s.canStart,g=function(n){if(!isFunction(v)||v({event:n,type:"start"})){var i=n.target;h&&o(n),Object(a.addEvent)(e,d,b,{passive:!0}),null==p||p(n),(0===n.button||Object(a.isUndefined)(n.button))&&(r=setTimeout(w.bind(i,n),t))}},A=function(){clearTimeout(r),_&&Object(a.removeEvent)(e,d,b,{passive:!0})},b=function t(n){clearTimeout(r),Object(a.removeEvent)(e,d,t,{passive:!0}),null==f||f(n)};function w(t){var i,o;t.touches?(i=t.touches[0].pageX,o=t.touches[0].pageY):(i=t.pageX,o=t.pageY),Object(a.removeEvent)(e,d,b,{passive:!0}),clearTimeout(r),!t.touches&&m||n({event:t,pageX:i,pageY:o})}return Object(a.addEvent)(e,"touchstart mousedown",g,{capture:!0,passive:!h}),l&&Object(a.addEvent)(e,"touchmove",A,{passive:!1}),_&&_ instanceof Event&&g(_),function(){clearTimeout(r),Object(a.removeEvent)(e,"touchstart mousedown",g,{capture:!0,passive:!0}),l&&Object(a.removeEvent)(e,"touchmove",A,{passive:!1})}}var o=function(e){(function(e){return"touches"in e})(e)&&e.touches.length<2&&e.preventDefault&&e.preventDefault()};function s(e,t,n,a,s){void 0===s&&(s={});var c=!1,l=s,u=l.shouldPreventDefault,d=void 0!==u&&u,_=l.canStart;return r(e,t,(function(){d&&e.removeEventListener("touchend",o,{passive:!0}),isFunction(_)&&!_()||c||(n.apply(void 0,arguments),c=!0)}),Object(i.default)({},s,{eventsRelease:s.ignoreMoveEvent?"touchend mouseleave mouseup scroll":"touchend touchmove mouseleave mouseup scroll",onRelease:function(t){(d&&e.removeEventListener("touchend",o,{passive:!0}),!isFunction(_)||_())&&(["mouseup","touchend"].includes(t.type)&&!c&&(a(t),c=!0),d&&e.removeEventListener("touchend",o,{passive:!0}))},onStart:function(){c=!1,d&&e.addEventListener("touchend",o,{passive:!1}),null==s.onStart||s.onStart()}}))}},PU8N:function(e,t,n){"use strict";n.r(t),n.d(t,"isMvk",(function(){return a})),n.d(t,"getVideoDuration",(function(){return r})),n.d(t,"getMediaBlob",(function(){return o})),n.d(t,"getBlobType",(function(){return s})),n.d(t,"noop",(function(){return c})),n.d(t,"getAverageRGB",(function(){return l})),n.d(t,"loadVideo",(function(){return u})),n.d(t,"getPhotoFromVideo",(function(){return d})),n.d(t,"loadImage",(function(){return _})),n.d(t,"loadImages",(function(){return f})),n.d(t,"loadFontFace",(function(){return p})),n.d(t,"loadFontFacePromise",(function(){return h})),n.d(t,"getCroppedImage",(function(){return m}));var i=function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function a(){return!!window.isMVK}function r(e){return void 0===e&&(e=""),new Promise((function(t,n){var i=document.createElement("video");i.addEventListener("loadedmetadata",(function(){return t(i.duration)}),{once:!0}),i.addEventListener("error",n,{once:!0}),i.crossOrigin="anonymous",i.preload="metadata",i.src=e}))}function o(e){return new Promise((function(t,n){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="blob",i.onload=function(){if(404===i.response.status)return n();t(i.response)},i.onerror=n,i.send()}))}function s(e){try{return e.type.split("/").splice(-1)[0]}catch(e){return null}}var c=function(){};function l(e){var t,n={r:0,g:0,b:0};try{t=e.getImageData(0,0,e.canvas.width,e.canvas.height)}catch(e){return n}for(var i=-4,a=0;(i+=20)<t.data.length;)++a,n.r+=t.data[i],n.g+=t.data[i+1],n.b+=t.data[i+2];return n.r=~~(n.r/a),n.g=~~(n.g/a),n.b=~~(n.b/a),n}function u(e){return new Promise((function(t,n){var i=document.createElement("video");i.muted=!0,i.autoplay=!0,i.addEventListener("canplay",(function(){i.pause(),t(i)}),{once:!0}),i.addEventListener("error",n,{once:!0}),i.crossOrigin="anonymous",i.src=e}))}function d(e,t){void 0===t&&(t=[0]);var n=[];return new Promise((function(i,a){var r=document.createElement("canvas"),o=r.getContext("2d"),s=e.videoWidth,c=e.videoHeight;r.width=s,r.height=c,function l(u){var d=e.currentTime;e.addEventListener("seeked",(function(){null==o||o.drawImage(e,0,0,s,c,0,0,s,c),e.currentTime=d,_(r.toDataURL("image/jpeg",1)).then((function(a){n.push(a),u>=t.length-1?(e.src="",i(n)):l(u+1)})).catch(a)}),{once:!0}),e.currentTime=-1===t[u]?e.duration:t[u]}(0)}))}function _(e){return new Promise((function(t,n){var i=new Image;i.crossOrigin=e.startsWith("data:")?null:"Anonymous",i.onerror=function(){return n(new Error("Failed to load image's URL: "+e))},i.onload=function(){return t(i)},i.src=e}))}var f=function(e){return new Promise((function(t){var n=e.map((function(e){return _(e)}));Promise.all(n).then((function(e){return t(e)})).catch((function(){}))}))};function p(e,t){var n,i,a,r,o,s,c,l,u={normal:"400",500:"500",600:"600",bold:"700"},d={tolerance:2,delay:100,glyphs:"",success:function(){},error:function(){},timeout:5e3,weight:"400",style:"normal"},_={display:"block","font-size":"48px","line-height":"normal","font-variant":"normal","white-space":"nowrap",position:"absolute",visibility:"hidden",top:"-9999px",left:"-9999px",width:"auto",height:"auto",margin:"0",padding:"0"};function f(e){var t=[];return each(e,(function(e,n){t.push(e+":"+n)})),t.join(";")}function p(e,t,n){return Math.abs(e.width-t.offsetWidth)>n||Math.abs(e.height-t.offsetHeight)>n}function h(){r||(utilsNode.appendChild(o),r=!0,a={sansSerif:{width:c.offsetWidth,height:c.offsetHeight},serif:{width:s.offsetWidth,height:s.offsetHeight}},browser.opera&&!browser.chrome?(c.style.fontFamily='"'+e+'", sans-serif',s.style.fontFamily='"'+e+'", serif'):(setStyle(c,"font-family",'"'+e+'", sans-serif'),setStyle(s,"font-family",'"'+e+'", serif'))),r&&a&&(p(a.sansSerif,c,t.tolerance)||p(a.serif,s,t.tolerance))?(re(o),t.success()):(new Date).getTime()-i.getTime()>t.timeout?(re(o),t.error()):!r&&"requestAnimationFrame"in window?window.requestAnimationFrame(h):window.setTimeout(h,t.delay)}for(var m in d)t.hasOwnProperty(m)||(t[m]=d[m]);_["font-weight"]=t.weight,_["font-style"]=t.style,!t.glyphs&&"fonts"in document?(t.timeout&&(n=setTimeout((function(){t.error()}),t.timeout)),function(n){each(null===document||void 0===document?void 0:document.fonts,(function(i){i.family.toLowerCase()===e.toLowerCase()&&(u[i.weight]||i.weight)===""+t.weight&&i.style===t.style&&i.load().then((function(){t.success(),clearTimeout(n)}))}))}(n)):(l="AxmTYklsjo190QW"+t.glyphs,i=new Date,o=ce("div"),c=ce("div",{innerHTML:l}),s=ce("div",{innerHTML:l}),c.setAttribute("style",f(extend({"font-family":"sans-serif"},_))),s.setAttribute("style",f(extend({"font-family":"serif"},_))),o.appendChild(c),o.appendChild(s),h())}function h(e,t){return new Promise((function(n,a){p(e,i(i({},t),{glyphs:"",success:function(){var e=function(){n(),(null==t?void 0:t.success)&&t.success()};browser.safari?setTimeout(e,150):e()},error:function(){a(),(null==t?void 0:t.error)&&t.error()}}))}))}function m(e,t,n,i,a){return new Promise((function(r,o){("string"==typeof e?_(e):Promise.resolve(e)).then((function(e){var s=document.createElement("canvas");s.width=e.width,s.height=e.height;var c=s.getContext("2d");if(c){c.fillStyle="#fff",c.fillRect(0,0,c.canvas.width,c.canvas.height),c.drawImage(e,0,0);var l=c.getImageData(t,n,i,a),u=document.createElement("canvas");u.width=i,u.height=a;var d=u.getContext("2d");if(d)return d.putImageData(l,0,0),_(u.toDataURL("image/jpeg",1)).then(r).catch(o);r(e)}else r(e)})).catch(o)}))}},PUg3:function(e,t,n){"use strict";n.r(t);var i=n("MUpH"),a=n("bZ/P"),r=n("TYsd"),o=n("Mc5h"),s=n("9y81"),c=n("AXyT"),l=n("gy8s"),u=n("29dZ"),d=n("Y6JH"),_=n("/Id8"),f=n("BoyB"),p=n("fdw3"),h=n("e0pj"),m=n("UknS"),v=n("f2Fr"),g=n("FoBY"),A=n("/nc2"),b=n("6atH"),w=n("DKoU"),y=n("i4v4"),O=n("hgAR"),S=n("1GqV"),k=n("jVsh"),C=n("lk/L");function j(){var e=Object(i.default)(['\n    <input type="hidden" name="attached_messages" value="','" />\n  ']);return j=function(){return e},e}function E(){var e=Object(i.default)(['\n    <div class="uMailWrite__attachedMsgs">\n      ',"\n      ","\n      ",'\n      <div class="uMailWrite__attachedMsgsText">',"</div>\n    </div>\n  "]);return E=function(){return e},e}function T(){var e=Object(i.default)(['\n    <div class="',' _preventMenuOpen">\n      ',"\n      ","\n    </div>\n  "]);return T=function(){return e},e}function I(){var e=Object(i.default)(['\n    <div class="','">\n      ',"\n      ","\n      ","\n    </div>\n  "]);return I=function(){return e},e}function M(){var e=Object(i.default)(['\n    <div class="uMailWrite__templates">\n      <div class="uMailWrite__templatesHeader">\n        ','\n        <a class="uMailWrite__templatesAdd" href="','" ',">\n          ",'\n        </a>\n      </div>\n      <div class="uMailWrite__templatesBody ScrollView"></div>\n    </div>\n  ']);return M=function(){return e},e}function P(){var e=Object(i.default)(['\n    <div class="uMailWrite__buttonKeyboardIcon"></div>\n  ']);return P=function(){return e},e}function D(){var e=Object(i.default)(['\n    <div class="uMailWrite__keyboard ScrollView">\n\n    </div>\n  ']);return D=function(){return e},e}function x(){var e=Object(i.default)(['\n    <div class="uMailWrite__SVGIcon uMailWrite__SVGIcon_','"></div>\n  ']);return x=function(){return e},e}function L(){var e=Object(i.default)(['\n    <div class="uMailWrite__main">\n      <div class="uMailWrite__button uMailWrite__buttonAttach">','</div>\n      <div class="uMailWrite__button uMailWrite__buttonKeyboard" ',">",'</div>\n      <div class="uMailWrite__button uMailWrite__buttonStickers" ',">","",'</div>\n      <button class="','" type="submit" ',">\n        ","\n        ","\n        ","\n        ","\n        ","\n        ","\n        ","\n        ",'\n      </button>\n      <div class="uMailWrite__textareaContainer">\n        <textarea\n          class="uMailWrite__textarea"\n          name="message"\n          placeholder="','"\n          maxlength="4096"\n          ',"\n          ","\n          ","\n          ","\n          ","\n          ","\n          ",'\n        ></textarea>\n        <div class="uMailWrite__textareaGhost"></div>\n      </div>\n    </div>\n  ']);return L=function(){return e},e}function B(){var e=Object(i.default)(["\n    ","\n    ","\n  "]);return B=function(){return e},e}function R(){var e=Object(i.default)(['\n    <form\n      class="','"\n      method="POST"\n      action="/mail?act=send&to=',"&hash=","&from=dialog",'"\n      ','\n    >\n      <div class="uMailWrite__toBottom" ',">","</div>\n      ","\n      ","\n      ","\n      ","\n      ","\n      ","\n    </form>\n  "]);return R=function(){return e},e}function N(){var e=Object(i.default)(['\n      <div class="uMailWrite uMailWrite_unableToWrite">\n        ','\n        <div class="uMailWrite__unableToWriteText">\n          ',"\n        </div>\n      </div>\n    "]);return N=function(){return e},e}var F=function(){var e=window.lang,t=store.mail,n=t.cur.peerId;if(!n)return'<form class="uMailWrite"></form>';var i=t.peers[n];if(i.unableToWrite){if(i.isChannel)return"";var c=i.kickedMessage||e.mobile_msg_mail_privacy_error,u=Object(s.default)({mix:"uMailWrite__unableToWriteIcon",icon:"warning"});return a.default.html(N(),u,c)}var _=a.default.onSubmit("window.uMailWrite && uMailWrite._onSubmit","event","this"),f=a.default.onClick("window.uMailWrite && uMailWrite.onToBottomClick"),j=Object(o.default)({mix:"uMailWrite__popupStickers _preventMenuOpen",inner:""}),E=V(null),T=W(n),I=function(e){var t=window.lang,n=store.mail,i=n.cur,o=n.queue,c=a.default.onMouseDown("window.uMailWrite && uMailWrite._onStickersClick","event"),u=a.default.onMouseDown("window.uMailWrite && uMailWrite._onKeyboardClick","event"),_=n.peers[e],f=i.groupId,j=Math.abs(f),E=f?"&community="+j:"",T=!Object(p.isSAKIntegration)(),I=!Object(p.isSAKIntegration)()&&_.canSendGift,M=!Object(p.isSAKIntegration)()&&_.canSendGift,D=!Object(p.isSAKIntegration)(),x=Object(p.isSAKIntegration)(),B=Object(p.isSAKIntegration)(),R=!Object(p.isSAKIntegration)(),N=Object(l.default)({icon_html:r.default.html(Object(d.default)(Object(h.getAttachOutline28Icon)())),name:"uMailWrite_attachments",position:"bottomLeft",items:[{text:i.inlineUploadHTML.replace(/mail\d+/g,"mail"+e),icon:Object(d.default)(Object(m.getPictureOutline28Icon)()),attrs:a.default.onClick("mediaUpload.onUnfoldItemClick","event","this")},R?{text:t.mobile_attachments_add_photo_vk,url:"/attachments?act=choose_photo&target=mail"+e+E,icon:Object(d.default)(Object(v.getCameraOutline28Icon)())}:null,x?{text:t.mobile_attachments_add_device_video,icon:Object(d.default)(Object(g.getVideoOutline28Icon)()),attrs:a.default.onClick("SAKIntegration.sendMessage","attach_video",{peerId:e})}:null,D?{text:t.mobile_attachments_add_video,url:"/attachments?act=choose_video&target=mail"+e+E,icon:Object(d.default)(Object(g.getVideoOutline28Icon)())}:null,T?{text:t.mobile_attachments_add_audio,url:"/attachments?act=choose_audio&target=mail"+e+E,icon:Object(d.default)(Object(A.getMusicOutline28Icon)())}:null,{text:t.mobile_attachments_add_doc,url:"/attachments?act=choose_doc&target=mail"+e+E,icon:Object(d.default)(Object(b.getDocumentOutline28Icon)())},B?{text:t.mobile_attachments_add_device_document,icon:Object(d.default)(Object(b.getDocumentOutline28Icon)()),attrs:a.default.onClick("SAKIntegration.sendMessage","attach_document",{peerId:e})}:null,I?{text:t.mobile_attachments_add_gift,url:"/gifts"+e+"?act=send&from=mail&ref=media_selector",icon:Object(d.default)(Object(w.getGiftOutline28Icon)())}:null,M?{text:t.mobile_attachments_add_money,url:"/attachments?act=attach_money&target=mail"+e+E,icon:Object(d.default)(Object(y.getMoneyTransferOutline28Icon)())}:null,_.canAttachPoll?{text:t.mobile_attachments_add_poll,url:"/attachments?act=attach_poll&target=mail"+e+E,icon:Object(d.default)(Object(O.getPollOutline28Icon)()),mix:"uMailWrite__pollUnfoldItem"}:null]}),F=a.default.onKeyUp("window.uMailWrite && uMailWrite._onKeyUp"),H=a.default.onInput("window.uMailWrite && uMailWrite._onInput","event","this"),V=a.default.onKeyDown("window.uMailWrite && uMailWrite._onKeyDown","event","this"),W=a.default.onFocus("window.uMailWrite && uMailWrite._onFocus","event","this"),$=a.default.onBlur("window.uMailWrite && uMailWrite._onBlur","event","this"),q=a.default.onClick("window.uMailWrite && uMailWrite._onClick","event","this"),z=a.default.onTouchEnd("window.uMailWrite && uMailWrite._onSendTouchEnd","event","this"),Y=r.default.html({class:"uMailWrite__buttonSendIcon Icon_send",inner:Object(d.default)(Object(S.getSendOutline28Icon)())}),G=r.default.html({class:"uMailWrite__buttonSendIcon Icon_send Icon_active",inner:Object(d.default)(Object(S.getSendOutline28Icon)())}),K=r.default.html({class:"uMailWrite__buttonVoiceIcon",inner:Object(d.default)(Object(C.getVoiceOutline28Icon)())}),Q=U("accept"),X=U("remove"),J=U("templates"),Z=U("templatesActive"),ee=Object(s.default)({mix:"uMailWrite__buttonSendIcon",icon:"spinner"}),te=r.default.html({class:"uMailWrite__buttonStickersIcon Icon_sticker",inner:Object(d.default)(Object(k.getSmileOutline28Icon)())}),ne=r.default.html({class:"uMailWrite__buttonStickersIcon Icon_sticker Icon_active",inner:Object(d.default)(Object(k.getSmileOutline28Icon)())}),ie=a.default.html(P()),ae=_.attachmentsHTML.length,re=i.msgAttached[i.peerId],oe=re&&re.length,se=!!(o[i.peerId]||[]).length,ce=a.default.class("uMailWrite__button","uMailWrite__buttonSend",{send:!0,sendActive:!!(ae>150||oe),loading:se});return a.default.html(L(),N,u,ie,c,te,ne,ce,z,Y,G,K,ee,Q,X,J,Z,t.mobile_mail_message_placeholder,W,F,H,V,W,$,q)}(n),x=a.default.html(D()),B=function(){var e=window.lang,t=Object(s.default)({icon:"plus"}),n=store.mail.cur.peerId,i=store.mail.cur.communityParam,r="/mail?act=template&from="+n+i,o=a.default.onClick("uMailWrite.loadTemplatePage","event","this",r);return a.default.html(M(),e.mobile_mail_templates_panel_title,r,o,t)}(),F=H(),$=a.default.class("uMailWrite",{canAttachMoney:!!i.canAttachMoney,canAttachPoll:!0});return a.default.html(R(),$,n,i.hashSend,t.cur.communityParam,_,f,F,E,T,I,j,x,B)};function H(){var e=store.mail,t=e.cur,n=e.peers,i=n[t.peerId]?n[t.peerId].countUnread:null,r=i?Object(c.default)({mix:"uMailWrite__toBottomValue",value:i}):"",o=Object(s.default)({mix:"uMailWrite__toBottomIcon",icon:"arrowDown"});return a.default.html(B(),r,o)}function U(e){return a.default.html(x(),e)}function V(e){var t=store.mail.cur,n=store.mail.members,i=t.peerId,r=t.msgReply[i],o=null;r&&(o=store.mail.forwards[r]||store.mail.msgs[r]);var s="",c="";if(o){var l=Object(_.Msg__authorName)(n[o.authorId],i,t.userId);s=Object(_.Msg__reply)(o,l,e),c='\n      <input type="hidden" name="attached_messages" value="'+r+'" />\n      <input type="hidden" name="has_reply" value="true" />\n    ',t.editing&&(c+='\n        <input type="hidden" name="mail_edit_attach_fwd" value="1" />\n      ')}var u=a.default.class("uMailWrite__reply",{visible:!!s}),d=MailButton({class:"uMailWrite__replyClose",onClick:a.default.onClick("uMailWrite.onReplyClose")});return a.default.html(I(),u,s,d,c)}function W(e){var t,n=store.mail,i=n.cur,r=n.peers[e].attachmentsHTML,o=a.default.class("uMailWrite__attachments",((t={})[e]=!0,t)),c=i.msgAttached[e]||[],l=c.length,u="";l>0&&(u=function(e,t){var n=window.lang,i=a.default.onClick("uMailWrite.onAttachedMsgsRemove"),r=Object(s.default)({mix:"uMailWrite__attachedMsgsIcon",icon:"msgMini"}),o=Object(s.default)({mix:"uMailWrite__attachedMsgsRemove",icon:"close9",attrs:i}),c=langNumeric(e,n.mobile_mail_messages),l=function(e){return a.default.html(j(),e)}(t);return a.default.html(E(),l,o,r,c)}(l,c.join(";")));return a.default.html(T(),o,u,r)}var $=n("wx14"),q=n("UxAg"),z=n("+cqQ"),Y=n("jk6M"),G=n("rKp0"),K=n("V4qE"),Q=n("HGMY"),X=n("t7Ww"),J=n("r/ag");function Z(){try{if(window.crypto){var e=new Int32Array(1);return crypto.getRandomValues(e),Math.abs(e.reduce((function(e,t){return e+t})))}}catch(e){}return intval(rand(0,2147483647).toFixed(0))}var ee=n("N4ZS"),te=n("9M99"),ne=n("H5mD"),ie=n("aiw/"),ae=n("Qz23"),re=(n("jE6c"),n("UlUB")),oe=n("hw56"),se=n("bpvD"),ce=n("j80l"),le=n("wcVR"),ue=n("B+U2");function de(e){var t=e.length,n=!t;return r.default.html([_e(n),{class:"uMailWrite__templatesRows",attrs:{hidden:n},inner:e.map((function(e,n){return function(e,t,n){var i=t>0&&t===n-1,o=store.mail.cur.communityParam,s=store.mail.cur.peerId,c=e.name,u=e.text;c=Object(te.emojiToHTML)(c),u=fe(u,!0);var d="_touched uMailWrite__templatesRow";d+=" uMailWrite__templatesRow"+e.id,e.deleting&&(d+=" uMailWrite__templatesRow_hidden");return{class:d,inner:[{class:"uMailWrite__templatesRowContent",attrs:{onclick:["uMailWrite.onTemplateClick","event","this",e.id]},inner:[{class:"uMailWrite__templatesRowName",inner:r.default.html(c)},{class:"uMailWrite__templatesRowText",inner:r.default.html(u)}]},{class:"uMailWrite__templatesRowMore",inner:[r.default.wrap(Object(l.default)({mix:"",icon:"more",position:i?"bottomRight":"topRight",items:[{text:lang.mobile_mail_templates_action_edit,name:"edit",url:"/mail?act=template&id="+e.id+o+"&from="+s},{text:lang.mobile_mail_templates_action_delete,name:"delete",attrs:a.default.onMouseDown("uMailWrite._onDeleteTemplate",e.id)}]}))]}]}}(e,n,t)}))}])}function _e(e){var t="/mail?act=template&from="+store.mail.cur.peerId+store.mail.cur.communityParam,n=a.default.onClick("uMailWrite.loadTemplatePage","event","this",t);return{class:"uMailWrite__templatesEmpty",attrs:{hidden:!e},inner:[{class:"uMailWrite__templatesEmptyInfo",inner:lang.mobile_mail_templates_empty_info},Object(u.default)({type:"button",theme:"small",attrs:n,inner:lang.mobile_mail_templates_empty_button})]}}function fe(e,t){void 0===t&&(t=!1);var n,i=store.mail.members,a=store.mail.cur,r=i[a.peerId],o=i[a.userId],s=i[a.groupId],c=r.raw_name.replace(r.firstName,"").trim(),l=o.raw_name.replace(o.firstName,"").trim();if((e=(e=(e=(e=(e=(e=(e=(e=e.replace(/<br>/g,"\n")).replace(/&lt;br&gt;/g,"\n")).replace(/\t/g,"\n")).replace(/{user name}/g,r.firstName)).replace(/{user surname}/g,c)).replace(/{admin name}/g,o.firstName)).replace(/{admin surname}/g,l)).replace(/{community}/g,s.name)).match(/{greeting}/g)){var u,d=(n=Date.now()+1e3*store.mail.cur.timeShift,new Date(n).getHours());u=d>=3&&d<12?lang.mobile_mail_templates_greeting_morning:d>=12&&d<17?lang.mobile_mail_templates_greeting_afternoon:d>=17&&d<=23?lang.mobile_mail_templates_greeting_evening:lang.mobile_mail_templates_greeting_night,e=e.replace(/{greeting}/g,u)}return t&&(e=Object(te.emojiToHTML)(e)),e}var pe=n("HdGT"),he=n("qHA9"),me=n("cZev"),ve=(n("W9Tc"),n("OcsD")),Ae=n("Sn6X"),be=n.n(Ae),we=n("xt6h"),ye=n("Q8TZ"),Oe=n("kGB6"),Se=n("R2xh"),ke=n("b46l"),Ce=n("t2Vq"),je=n("WWJR"),Ee=n("defm"),Te=n("Ro2m");function Ie(e){return void 0===e&&(e={}),{inner:[{inner:[{inner:[Object(d.default)({icon:Object(Ee.getPlay16Icon)()})],class:"audio-msg-track--playIcon",tag:"div"},{inner:[Object(d.default)({icon:Object(Te.getPause16Icon)()})],class:"audio-msg-track--pauseIcon",tag:"div"}],class:"audio-msg-track--btn audio-msg-track--btnSvg",tag:"button"},{inner:[Object(p.formatDuration)(e.duration)||"0:00"],class:"audio-msg-track--duration",tag:"div"},{inner:[{class:"audio-msg-track--wave",tag:"svg"}],class:"audio-msg-track--wave-wrapper",tag:"div"}],class:"audio-msg-track audio-msg-track--preview clear_fix voicemsg0",onClick:"AudioMessagePlayer.togglePlay(this);cancelEvent(event);","data-duration":e.duration,"data-mp3":e.url,"data-ogg":e.url,"data-wave":e.wave,tag:"div"}}var Me=n("QqmJ"),Pe=n("VPdG");function De(e){var t=window.lang;return"preview"===e.state?null:{inner:[{inner:[Object(d.default)({icon:Object(Ce.getChevron24Icon)()})],class:"VoiceRecordControls__lockChevron",tag:"div"},{inner:[Object(d.default)({icon:"locked"===e.state?Object(Pe.getStop20Icon)():Object(ke.getUnlockOutline20Icon)()})],class:"VoiceRecordControls__lockIcon",tag:"div"}],class:"VoiceRecordControls__lock","aria-label":t.mobile_mail_voice_record_stop_aria,tag:"div"}}function xe(e){void 0===e&&(e={});var t,n=window.lang;"preview"!==e.state?t=["locked"===e.state?Object(u.default)({inner:[n.mobile_cancel],class:"VoiceRecordControls__cancel VoiceRecordControls__cancel--button",theme:"tertiary",use_native_onclick:!0,onClick:"uMailWrite._cancelVoiceRecord()"}):{inner:[Object(d.default)({icon:Object(ye.getChevron16Icon)()}),n.mobile_cancel],class:"VoiceRecordControls__cancel",tag:"span"},{inner:[{class:"VoiceRecordControls__marker",tag:"span"},{inner:[e.duration||"0:00"],class:"VoiceRecordControls__durationText",tag:"span"},{inner:[Wd.wrap(Object(f.default)({spinner:!0}))],class:"VoiceRecordControls__spinner",tag:"div"}],class:"VoiceRecordControls__duration",tag:"span"}]:t=[{inner:[Object(d.default)({icon:Object(je.getCancelOutline28Icon)()})],class:"VoiceRecordControls__cancel VoiceRecordControls__cancel--button",onClick:"uMailWrite._cancelVoiceRecord()","aria-label":n.mobile_mail_voice_record_cancel_aria,tag:"button"},{inner:[Ie({url:e.url,duration:e.audioMessagePreviewData.duration,wave:e.audioMessagePreviewData.waves.join(",")||"0"})],class:"VoiceRecordControls__player",tag:"div"},{inner:[Object(d.default)({icon:Object(Me.getSend28Icon)()})],class:"VoiceRecordControls__send","aria-label":n.mobile_mail_voice_record_send_aria,tag:"button"}];return{inner:[t],class:Object(p.classNames)("VoiceRecordControls__panel",{"VoiceRecordControls__panel--preview":"preview"===e.state}),tag:"div"}}var Le=n("rf2p"),Be=n("CQvH"),Re=n("DLiR"),Ne=n("jesr"),Fe=function(){function e(e,t){var n=this;this.onSend=Object(z.default)(),this.onDestroy=Object(z.default)(),this.onPreviewProcessComplete=Object(z.default)(),this.audioMessagePreviewData=null,this.initialized=!1,this.lastDurationSend=0,this.state="moving",this.moving=!1,this.needLock=!1,this.floatPosition=[0,0],this.isSending=!1,this.isPreviewProcessing=!1,this.init=function(e,t,i){var a,o,s,c,l,u;n.state=t,n.recorder&&(n.recorder.duration=0),n.recordingID=i;var _=function(e){void 0===e&&(e={});var t=window.lang;return{inner:[xe(e),De(e),"preview"!==e.state?{inner:[{inner:[{inner:[Object(d.default)({icon:Object(Me.getSend28Icon)()})],class:"VoiceRecordControls__circleSend",tag:"div"},{inner:[Object(d.default)({icon:Object(Oe.getMicrophone28Icon)()})],class:"VoiceRecordControls__circleMicrophone",tag:"div"},{inner:[Object(d.default)({icon:Object(Se.getDelete28Icon)()})],class:"VoiceRecordControls__circleCancel",tag:"div"}],class:"VoiceRecordControls__circle",tag:"div"},{class:"VoiceRecordControls__shadow",tag:"div"}],class:"VoiceRecordControls__float","aria-label":t.mobile_mail_voice_record_send_aria,tag:"button"}:null],class:Object(p.classNames)("VoiceRecordControls",{"VoiceRecordControls--locked":"locked"===e.state,"VoiceRecordControls--lock":"locked"===e.state,"VoiceRecordControls--show":"locked"===e.state}),tag:"div"}}({state:"moving"===n.state?"":n.state,audioMessagePreviewData:n.audioMessagePreviewData});if(n.elements.appendElement&&_&&(n.elements.controls=r.default.elem(_),n.elements.controls&&n.elements.appendElement.appendChild(n.elements.controls)),n.findPanelElements(),"preview"!==n.state&&(n.elements.float=Object(q.$)(".VoiceRecordControls__float",n.elements.controls),n.elements.lock=Object(q.$)(".VoiceRecordControls__lock",n.elements.controls),n.elements.lockChevron=Object(q.$)(".VoiceRecordControls__lockChevron",n.elements.controls),n.elements.lockIcon=Object(q.$)(".VoiceRecordControls__lockIcon",n.elements.controls),n.calculateTransitionData()),"moving"===n.state&&e){e.preventDefault(),e.stopPropagation();var f=e.touches[0];n.moveElements([f.pageX,f.pageY])}else"locked"===n.state&&n.lock();n.applyVolume(0),null===(a=n.elements.controls)||void 0===a||a.classList.add("VoiceRecordControls--show"),window.nav.onBeforeGo((function(){return n.cancel(!0)})),"moving"===n.state&&(Object(ve.addEvent)(n.elements.initialElement,"touchmove",n.onTouchMove,{passive:!0}),Object(ve.addEvent)(n.elements.initialElement,"touchend touchcancel",n.onTouchEnd,{passive:!0}),Object(ve.addEvent)(window,"resize",n.onResize),document.addEventListener("visibilitychange",n.onVisibilityChange,!1)),"preview"!==n.state&&(Object(ve.addEvent)(n.elements.float,"click",n.onFloatClick),Object(ve.addEvent)(n.elements.lock,"click",(function(){"locked"===n.state&&(n.getDuration()>0?n.showPreview():n.cancel(!0))})),Object(ve.addEvent)(window,"click",n.onGlobalClick,{capture:!0}),window.Speech&&(window.Speech.onRecordProgress(n.onProgress),window.Speech.onRecordStart(n.onRecordStart),window.Speech.onStop(n.onStop),window.Speech.onCancel(n.onCancel)),Re.screenWakeLocker.lock()),n.initialized=!0,"preview"===n.state?(n.updatePanel(!0),window.requestAnimationFrame((function(){window.AudioMessagePlayer.redrawWaves()}))):("locked"===t?null===(o=n.recorder)||void 0===o||o.record():"moving"===t&&setTimeout((function(){var e;null===(e=n.recorder)||void 0===e||e.record()}),window.browser.iphone?250:0),"suspended"===(null===(s=n.recorder)||void 0===s?void 0:s._ctx.state)&&(null===(u=null===(c=n.recorder)||void 0===c?void 0:(l=c._ctx).resume)||void 0===u||u.call(l))),setTimeout((function(){Object(ve.statlogsValueEvent)("mvk_audio_messages_event",null,"init",n.state)}),400)},this.setAudioMessagePreviewData=function(e){n.audioMessagePreviewData=e},this.getDuration=function(){return n.recorder?n.recorder.duration:n.audioMessagePreviewData?n.audioMessagePreviewData.duration:0},this.calculateTransitionData=function(){var e=Object(ve.getSize)(n.elements.appendElement)[0],t=Object(ve.getCh)(),i=t-160-40,a=0;n.elements.panel&&(a=parseInt(getComputedStyle(n.elements.panel).marginBottom,10)),n.elements.initialElement=document.body,n.transitionData={cancelPositionX:Math.max(e/2,e-240),cancelOpacityDecreaseStartX:e-320,minY:t-40-a,maxX:e-40,maxLockY:i+40,maxY:i}},this.findPanelElements=function(){n.elements.panel=Object(q.$)(".VoiceRecordControls__panel",n.elements.controls),n.elements.duration=Object(q.$)(".VoiceRecordControls__duration",n.elements.controls),n.elements.cancel=Object(q.$)(".VoiceRecordControls__cancel",n.elements.controls),n.elements.previewPlayer=Object(q.$)(".audio-msg-track",n.elements.controls)},this.onPreviewPanelShow=function(){n.findPanelElements(),n.elements.send=Object(q.$)(".VoiceRecordControls__send",n.elements.controls),Object(ve.addEvent)(n.elements.send,"click",n.send),n.state="preview"},this.updatePanel=function(e){var t,i;void 0===e&&(e=!1),"preview"===n.state&&(e=!0);var a={state:n.needLock?"locked":""};if(!e&&n.recorder&&(a.duration=Object(we.formatDuration)(n.getDuration())),null===(t=n.elements.controls)||void 0===t||t.classList.toggle("VoiceRecordControls--locked","locked"===n.state),e){n.needLock=!0,n.previewBuffer=n.previewBuffer||(null===(i=n.recorder)||void 0===i?void 0:i.buffer);var o=URL.createObjectURL(n.previewBuffer);a.state="preview",a.url=o,window.Speech&&n.recorder&&n.audioMessagePreviewData&&window.Speech.saveRecordingBuffer(n.audioMessagePreviewData.bufferKey,n.previewBuffer).then((function(){window.clog("[VoiceRecorder] Voice record was cached")})),a.audioMessagePreviewData=n.audioMessagePreviewData,n.onPreviewProcessComplete(n.audioMessagePreviewData),Object(ve.remove)(n.elements.float),Object(ve.remove)(n.elements.lock),n.transitionData&&n.moveElements([n.transitionData.maxX,n.transitionData.minY])}var s=r.default.elem(xe(a));n.elements.panel&&s&&(n.elements.panel.outerHTML=s.outerHTML),n.findPanelElements(),e?n.onPreviewPanelShow():n.movePanelElements(),window.requestAnimationFrame((function(){window.AudioMessagePlayer.redrawWaves()}))},this.onFinish=function(){var e,t;n.isPreviewProcessing=!1,null===(e=n.elements.controls)||void 0===e||e.classList.remove("VoiceRecordControls--longProcessing"),Object(ve.removeEvent)(window,"click",n.onGlobalClick,{capture:!0}),Object(ve.removeEvent)(n.recorder,"finish",n.onFinish);var i=n.audioMessagePreviewData||{bufferKey:n.key,duration:n.getDuration(),waves:null===(t=n.recorder)||void 0===t?void 0:t._waveData};n.setAudioMessagePreviewData(i),n.isSending||n.updatePanel(!0)},this.showPreview=function(){var e;n.isPreviewProcessing||(Object(ve.statlogsValueEvent)("mvk_audio_messages_event",null,"show_preview"),n.isPreviewProcessing=!0,Object(ve.addEvent)(n.recorder,"finish",n.onFinish),setTimeout((function(){var e;n.isPreviewProcessing&&(null===(e=n.elements.controls)||void 0===e||e.classList.add("VoiceRecordControls--longProcessing"))}),500),null===(e=n.recorder)||void 0===e||e.stop())},this.applyVolume=Object(we.throttle)((function(e){var t=Object(q.$)(".VoiceRecordControls__shadow");ve.setStyle.transform(t,.7+Math.min(e,.2))}),50),this.setDuration=function(e){n.elements.duration&&(Object(q.$)(".VoiceRecordControls__durationText",n.elements.duration).innerHTML=e)},this.isTouchCancel=function(e){var t;return!(null===(t=n.recorder)||void 0===t?void 0:t._aquireing)&&e.pageX<=n.transitionData.cancelPositionX},this.moveElements=function(e){void 0===e&&(e=[0,0]);var t=[Math.min(n.transitionData.maxX,e[0])-40,Math.max(Math.min(n.transitionData.minY,e[1])-40,n.transitionData.maxY)];n.floatPosition=t;var i="locked"===n.state?0:1-(n.transitionData.minY-t[1]-40)/(n.transitionData.minY-n.transitionData.maxLockY-40),a=[Math.max(0,Math.min(6,6*i)),Math.max(0,Math.min(10,10*i))],o=[t[0]+20,t[1]-80-a[0]-a[1]];be.a.mutate((function(){ve.setStyle.transform(n.elements.float,{translate:t}),ve.setStyle.transform(n.elements.lock,{translate:o}),Object(ve.setStyle)(n.elements.lock,{"padding-top":a[0],"padding-bottom":a[1]}),ve.setStyle.transform(n.elements.lockIcon,{translate:[0,Math.max(-10,Math.min(0,-10*(1-i)))]}),ve.setStyle.transform(n.elements.lockChevron,{translate:[Math.max(-8,Math.min(0,-8*(1-i))),0],rotate:-90}),Object(ve.setStyle)(n.elements.lockChevron,{opacity:i}),n.movePanelElements()}));var s=i<=0;if("locked"===n.state||n.needLock!==s){var c=void 0;"locked"===n.state?c=Object(Pe.getStop20Icon)():(n.needLock=s,c=n.needLock?Object(Le.getLockOutline20Icon)():Object(ke.getUnlockOutline20Icon)()),n.elements.lockIcon&&"locked"!==n.state&&(n.elements.lockIcon.innerHTML=r.default.html(Object(d.default)({icon:c})))}},this.movePanelElements=function(){var e=[n.floatPosition[0]-160,0];ve.setStyle.transform(n.elements.duration,{translate:e}),n.transitionData&&Object(ve.setStyle)(n.elements.cancel,{opacity:e[0]/n.transitionData.cancelOpacityDecreaseStartX})},this.lock=function(){var e,t;if("locked"!==n.state){Object(ve.statlogsValueEvent)("mvk_audio_messages_event",null,"lock"),n.needLock=!0,n.state="locked",null===(e=n.elements.controls)||void 0===e||e.classList.add("VoiceRecordControls--lock"),null===(t=n.elements.controls)||void 0===t||t.classList.add("VoiceRecordControls--locked"),n.initialized&&(ve.setStyle.animate(n.elements.lock,"transform",{duration:150,func:"ease"}),ve.setStyle.animate(n.elements.duration,"transform",{duration:150,func:"ease"}));var i=function(){if(n.updatePanel(),n.elements.lockIcon&&(n.elements.lockIcon.innerHTML=r.default.html(Object(d.default)({icon:Object(Pe.getStop20Icon)()}))),n.elements.lock&&(n.elements.lock.setAttribute("tabindex","0"),n.elements.lock.setAttribute("role","button")),n.elements.float&&(n.elements.float.setAttribute("tabindex","0"),n.elements.float.setAttribute("role","button"),n.elements.float.focus()),n.elements.controls){var e=Object(Be.setFocusTrap)(n.elements.controls);e&&(n.cancelFocusTrap=e,n.cancelFocusTrap.exitIntent=function(){return n.cancel(!0)})}};n.initialized?ve.setStyle.animate(n.elements.float,"transform",{duration:200,func:"ease"},(function(){i()})):i(),n.moveElements([n.transitionData.maxX,n.transitionData.minY])}else n.moveElements([n.transitionData.maxX,n.transitionData.minY])},this.onGlobalClick=function(e){if("preview"!==n.state)return n.moving?(e.preventDefault(),e.stopPropagation(),void(n.getDuration()?n.cancel(!0):n.lock())):void(!e.target||e.target.closest(".VoiceRecordControls")||e.target.closest(".uMailWrite__buttonSend")||e.target.classList.contains("uMailWrite__buttonSend")||(e.preventDefault(),e.stopPropagation(),n.getDuration()<=0?n.cancel(!0):n.showPreview()))},this.onTouchMove=function(e){var t,i,a,r,o,s;if("suspended"===(null===(t=n.recorder)||void 0===t?void 0:t._ctx.state)&&(null===(r=null===(i=n.recorder)||void 0===i?void 0:(a=i._ctx).resume)||void 0===r||r.call(a)),"moving"===n.state){n.moving=!0;var c=e.touches[0];null===(o=n.elements.controls)||void 0===o||o.classList.toggle("VoiceRecordControls--cancel",n.isTouchCancel(c)),n.moveElements([c.pageX,c.pageY]),null===(s=n.elements.controls)||void 0===s||s.classList.toggle("VoiceRecordControls--lock",n.needLock)}},this.onTouchEnd=function(e){var t;if("moving"===n.state){n.moving=!1;var i=n.isTouchCancel(e.changedTouches[0]);(null===(t=n.recorder)||void 0===t?void 0:t._aquireing)||n.needLock&&!i?n.lock():i||n.getDuration()<=0?n.cancel():n.send()}},this.onFloatClick=function(){"locked"===n.state&&n.send()},this.onResize=function(){n.calculateTransitionData(),n.lock()},this.onCancel=function(){n.cancel(!0)},this.onStop=function(){n.getDuration()>0?n.showPreview():n.cancel(!0)},this.onProgress=function(){if(n.recorder&&n.recorder._waveData){var e=n.recorder._waveData[n.recorder._waveData.length-1];n.applyVolume(e/.5)}n.setDuration(Object(we.formatDuration)(n.getDuration())||"0:00")},this.onRecordStart=function(){n.elements.controls&&n.elements.controls.classList.add("VoiceRecordControls--recording")},this.onVisibilityChange=function(){document.hidden&&"moving"===n.state&&n.lock()},this.stopRecording=function(){n.recorder&&n.recorder.isRecording&&n.recorder._stream&&n.recorder.stop()},this.detachEvents=function(){Object(ve.removeEvent)(n.elements.initialElement,"touchmove",n.onTouchMove),Object(ve.removeEvent)(n.elements.initialElement,"touchend",n.onTouchEnd),Object(ve.removeEvent)(window,"click",n.onGlobalClick,{capture:!0}),Object(ve.removeEvent)(window,"resize",n.onResize),document.removeEventListener("visibilitychange",n.onVisibilityChange,!1),window.Speech&&(window.Speech.onRecordProgress.off(n.onProgress),window.Speech.onRecordStart.off(n.onRecordStart),window.Speech.onCancel.off(n.onCancel),window.Speech.onStop.off(n.onStop))},this.send=function(){if(!(n.isSending||n.getDuration()<=0)){n.isSending=!0;var e=function(){if(n.onFinish(),Object(ve.removeEvent)(n.recorder,"finish",e),n.audioMessagePreviewData&&n.previewBuffer){var t=Object(Ne.getFormData)(n.audioMessagePreviewData.waves,n.previewBuffer,n.previewBuffer.type);n.onSend(t,n.recordingID)}else{t=n.recorder.getFormData();n.onSend(t,n.recordingID)}};window.Speech&&n.audioMessagePreviewData&&window.Speech.saveRecordingBuffer(n.audioMessagePreviewData.bufferKey,null),Object(ve.statlogsValueEvent)("mvk_audio_messages_event",null,"send"),!n.audioMessagePreviewData&&n.recorder.isRecording?(Object(ve.addEvent)(n.recorder,"finish",e),n.stopRecording(),n.destroy()):(e(),n.destroy(!0))}},this.cancel=function(e){void 0===e&&(e=!1),Object(ve.statlogsValueEvent)("mvk_audio_messages_event",null,"cancel"),window.clog("[VoiceRecorder] Voice send cancelled"),n.stopRecording(),n.destroy(e)},this.destroy=function(e){var t;void 0===e&&(e=!1),n.audioMessagePreviewData=void 0,n.previewBuffer=void 0,null===(t=n.elements.controls)||void 0===t||t.classList.add("VoiceRecordControls--destroying"),n.detachEvents(),Re.screenWakeLocker.unlock();var i=function(){n.cancelFocusTrap&&n.cancelFocusTrap(),Object(ve.remove)(n.elements.controls),n.elements.previewPlayer&&window.AudioMessagePlayer.togglePlay(n.elements.previewPlayer,null,!1),n.onDestroy()};e?i():setTimeout(i,250)},this.key=e,this.elements={},this.elements.appendElement=t}return e.prototype.clearCache=function(){window.Speech&&window.Speech.saveRecordingBuffer(this.key,null)},e}(),He=n("zq7H"),Ue=n("Ogzf"),Ve=n("a0wW"),We=n("TAKr"),$e=n("hC3G"),qe=n("rudk"),ze=n("Gyo5");Object.assign(F,{onToBottomClick:Object(z.default)(),onAttachedMsgsRemove:Object(z.default)(),onReplyClose:Object(z.default)(),onMessage:Object(z.default)(),showToBottom:function(){if(tt)return;nt&&(clearTimeout(nt),nt=null);addClass("uMailWrite__toBottom_visible",Object(q.$)(".uMailWrite__toBottom"))},hideToBottom:function(){clearTimeout(null),nt=setTimeout((function(){removeClass("uMailWrite__toBottom_visible",Object(q.$)(".uMailWrite__toBottom"))}),100)},preventShowToBottom:function(){tt=!0,setTimeout((function(){tt=!1}),300)},openStickersPanel:gt,redrawReply:Pt,uiRedrawAttachments:Dt,redrawToBottom:function(){Object(q.$$)(".uMailWrite__toBottom").forEach((function(e){return e.innerHTML=H()}))},drawStickers:ht,setModifiers:function(e){Object(q.$$)(".uMailWrite").forEach((function(t){var n=a.default.parseClass("uMailWrite",t.getAttribute("class"));t.setAttribute("class",a.default.class("uMailWrite",Object.assign({},n,e)))}))},hideStickersPanel:vt,setText:an,renderKeyboardIfNeeded:on,openKeyboard:cn,init:function(){var e=store.mail,t=e.cur,n=e.msgs,i=e.pendingReplies,a=e.flags,r=t&&Object(oe.getPeerDraft)(t.viewerId,t.peerId);"templates"===Object(oe.getKeyboardType)()?kt():on();r&&!t.editing&&(r.text&&function(e){var t=document.createElement("textarea");t.innerHTML=e;var n=t.value;Object(q.$$)(".uMailWrite__textarea").forEach((function(e){return e.value=n}));var i=Object(q.$)(".uMailWrite__textareaGhost");i.innerText=n,"\n"===last(n)&&(i.innerHTML+="&nbsp;");ct()}(r.text),r.audioMessagePreviewData&&ot().then((function(){window.Speech.getRecordingBuffer(r.audioMessagePreviewData.bufferKey).then((function(e){if(e){var n=Z();Nt[n]={peerId:t.peerId},Bt(),Ke.previewBuffer=e,Ke.setAudioMessagePreviewData(r.audioMessagePreviewData),Ke.init(null,"preview",n)}})).catch((function(){}))})).catch((function(e){})));pn(),ut(),r&&!t.editing&&Array.isArray(r.msgs)&&(t.msgAttached[t.peerId]=r.msgs);if(r&&!t.editing&&isFinite(r.reply)){var o=_.default.getReplyDataFromHTML(r.reply);o&&(t.msgReply[t.peerId]=r.reply,i[r.reply]=o)}Pt(),Dt(t.peerId),Object.keys(n).forEach((function(e){CasperTimer.init(e)})),Object(q.$$)(".uMailWrite__textarea").forEach((function(e){Object(ae.setScrollView)(e,{topBanner:!1,overscrollY:!1})})),Object(q.$$)(".uMailWrite__attachments").forEach((function(e){Object(ae.setScrollView)(e,{topBanner:!1,allowY:!1})})),a.areAudioMessagesEnabled&&Ve.default.getFlag(Ve.FLAG_SUPPORTS_AUDIO_MESSAGES)&&ot().then((function(){Jt();var e=Object(q.$)(".uMailWrite__buttonSend");Object(Ue.onLongpressOrClick)(e,150,Ht,Ut,{canStart:function(){return!!Jt().canVoiceRecord},shouldPreventDefault:!0,ignoreMoveEvent:!0,ignoreMouseLongpress:!0})})).catch((function(){}))},reset:function(){Object(oe.setKeyboardType)("")},loadTemplatePage:function(e,t,n){e.preventDefault(),uMessenger.loadMailPage(n)}}),uVK.onReady(lt),F._onBlur=Qt,F._onKeyUp=Wt,F._onKeyDown=Yt,F._onFocus=Kt,F._onInput=$t,F._onSubmit=xt,F._onClick=Gt,F._onAttachClick=jt,F._onStickersClick=mt,F._onKeyboardClick=At,F._onKeyboardButtonClick=bt,F._onDeleteTemplate=un,F._onConfirmDeleteTemplate=dn,F._onSendTouchEnd=Vt,F._onRetryFailedMsg=mn,F._onDeleteFailedMsg=vn,F._onCancelPendingMsg=gn,F._onConfirmSendGeo=wt,F._cancelVoiceRecord=Rt,F._resendAudioMessage=function(){},mediaUpload.onRemove(dt),mediaUpload.onComplete(pt),mediaUpload.onStart(_t),mediaUpload.onError(ft),post.onStickersTabSelected(Et),post.onStickerClick(Tt),me.default.onStickerPanelUpdate(It),pe.onSent(fn),pe.onErrorMessage(An),_.default.onPendingClick(hn),l.default.onOpen("uMailWrite_attachments")(st),F.onToBottomClick((function(){var e=Object(q.$)(".uMailWrite__toBottom_visible");e&&e.classList.remove("uMailWrite__toBottom_visible"),G.default.removeDivider()})),F.onReplyClose((function(){var e=store.mail.cur;e.msgReply[e.peerId]=null,Object(oe.setPeerDraft)(e.viewerId,e.peerId,{reply:void 0},e.editing),e.editing||ajaxRequest("/mail",{act:"reply_cancel",peer_id:store.mail.cur.peerId,hash:store.mail.hash.reply}),Pt()})),F.onTemplateClick=function(e,t,n){var i;n&&(store.mail.cur.templates.some((function(e){if(e.id===n)return i=e,!0})),i&&an(fe(i.text)))},Mention.onOpen((function(){if(store.mail.cur){var e=store.mail.cur,t=e.peerMembers,n=e.peerId;t[n]||(t[n]=!0,ajaxRequest("/mail",{act:"get_members",peer_id:n},(function(e){Object.assign(store.mail.members,e);var t=qt(n);Mention.update({items:t,defaultItems:t})}),(function(){t[n]=!1})))}}));var Ye,Ge,Ke,Qe="uMailWrite__popupAttach_open",Xe="uMailWrite__popupStickers_open",Je="uMailWrite_canAttachPoll",Ze=".uMailWrite",et=".attachment_type_poll",tt=!1,nt=null,it=[],at=Object(re.throttle)(Jt,100),rt=Object(re.throttle)(Xt,1e3);function ot(){return n.e("audio_messages").then(n.bind(null,"tPJ0")).catch((function(e){return Object(ve.statlogsValueEvent)("mvk_audio_messages_event",null,"chunk_error",e.name)}))}function st(){function e(e,t){return e=e.replace(/&edit_msg_id=\d+/,"").replace(/=mailedit(-?\d+)/,"=mail$1"),store.mail.cur.editing&&(e=e.replace(/=mail(-?\d+)/,"=mailedit$1"),e+=t?"&edit_msg_id="+store.mail.cur.editing:""),e}Object(q.$$)("a.Unfold__item").forEach((function(t){var n=e(t.getAttribute("href"),!0);t.setAttribute("href",n)})),Object(q.$$)("input.inline_upload").forEach((function(t){t.setAttribute("data-upload-url",e(t.getAttribute("data-upload-url")))}))}function ct(){var e=Object(q.$)(".uMailWrite__textareaGhost").offsetHeight;Object(q.$$)(".uMailWrite__textarea").forEach((function(t){return setStyle(t,"height",e)})),Object(q.$$)(".uMailWrite__main").forEach((function(t){return setStyle(t,"height",e+8)})),Object(q.$$)(".uMailWrite__popupStickers .stickersHints").forEach((function(t){setStyle(t,"bottom",e+8+-5)})),Jt()}function lt(){if("/mail"===location.pathname||0===location.pathname.indexOf("/write")){var e=store.mail.cur;if(e&&e.peerId){var t=geBySel(".uMailWrite__attachments .medias_thumb").length,n=geBySel(".uMailWrite__attachments .medias_row").length,i=(e.msgAttached[e.peerId]||[]).length?1:0;e.hasAttachments=t+n+i>0,Object(q.$$)(".uMailWrite__attachments").forEach((function(t){toggleClass("uMailWrite__attachments_hasAttachments",t,e.hasAttachments)})),function(){var e=Object(q.$)(".uMailWrite__buttonAttach");if(!e)return;var t=(n=Object(q.$)(".uMailWrite__attachments"),(n?n.$$(".thumb_item").length+n.$$(".medias_row").length-n.$$(".fwd_item").length:0)>=10);var n;e.classList.add("uMailWrite__button_disabled",t),t?e.addEventListener("mousedown",nn,!0):e.removeEventListener("mousedown",nn,!0)}()}}}function ut(){var e=store.mail.cur;e&&e.peerId&&(it=qt(e.peerId),Mention.init({defaultItems:it,items:it,appendTo:geByClass1("uMailWrite__main"),url:null,params:{},preferDomain:!0,afterInsert:function(t){var n=Object(q.$)(".uMailWrite__textareaGhost"),i=t.value;n.innerText=i,ct(),Xt(i,e.viewerId,e.peerId)}}))}function dt(e){if(store.mail.cur){var t=store.mail,n=t.cur,i=t.peers,a=n.peerId;if(a&&(i[a].attachmentsHTML=geBySel1(".uMailWrite__attachments_"+a+" .cp_attached_wrap").outerHTML,Dt(a)),e.closest(et))Object(q.$)(Ze).classList.add(Je)}}function _t(){store.mail.cur&&(lt(),Jt())}function ft(){if(store.mail.cur){var e=store.mail,t=e.cur,n=(e.peers,t.peerId);n&&(Dt(n),Messenger.scrollConvoToBottom())}}function pt(){var e=store.mail,t=e.cur,n=e.peers;if(t){var i=t.peerId;i&&(n[i].attachmentsHTML=geBySel1(".uMailWrite__attachments_"+i+" .cp_attached_wrap").outerHTML,Jt())}}function ht(){var e=store.mail.cur,t=Object(q.$)(".uMailWrite__popupStickers");e&&t&&!t.childElementCount&&(me.default.checkStickers(),t.innerHTML=me.default.getStickerPanel("mail"+e.peerId),t.innerHTML||(e.waitingStickerPanel=!0),Object(q.$$)(".sp_body",t).forEach((function(e){Object(ae.setScrollView)(e,{topBanner:!1})})),Object(q.$$)(".scroller_wrap",t).forEach((function(e){Object(ae.setScrollView)(e,{topBanner:!1,allowY:!1})})),post.stickersSelectTab(null,-1))}function mt(e){var t=Object(q.$)(".uMailWrite__popupStickers"),n=hasClass(Xe,t);e.preventDefault(),ht(),ln("stickers"),n?vt():gt()}function vt(){"stickers"===Object(oe.getKeyboardType)()&&Object(oe.setKeyboardType)("");var e=Object(q.$)(".uMailWrite__popupStickers");removeClass(Xe,e),Zt(!1);var t=ge("stickers_panel");t&&"block"===t.style.display&&(t.style.display="none"),domData(e,"need-update")&&(clog("[mail sticker panel] inject new sticker panel after close"),Mt(),domData(e,"need-update",null))}function gt(){Object(oe.setKeyboardType)("stickers");var e=Object(q.$)(".uMailWrite__popupStickers");addClass(Xe,e),post.stickerPanelInit(),post.stickersInit(),Zt(!0)}function At(e){var t=Object(q.$)(".uMailWrite__keyboard"),n=hasClass("uMailWrite__keyboard_open",t);e.preventDefault(),ln("buttons"),n?yt({store:!0}):Ot({store:!0})}function bt(e,t,n){var i=n.authorId,r=n.inline,o=n.msgId,s=n.subID,c=JSON.parse(n.action),l=c.type,d=c.payload,_=c.rawLabel,f=store.mail,p=f.cur,h=f.members,m=f.peers,v=f.msgs;if(store.mail.cur){t.stopPropagation();var g,A,b=h[i],w=Z();if(o){var y=v[o];g=y.peerId,A=y.conversationMsgId}else g=p.peerId;var O,S=m[g],k=_||"";if(g>=2e9)if(b.domain)O="@"+b.domain+" "+k;else{var C=b.url.replace(/^\//,"");O="@"+C+" ("+b.firstName+") "+k}else O=k;var j=l,E=r?"inline":"normal";if("open_app"===j&&(j="app"),Object(ve.statlogsValueEvent)("message_send_from_keyboard",0,p.viewerId,g,i,j,E),"vkpay"!==l)if("open_app"!==l)if("open_link"!==l)if("location"!==l){if("callback"===l)return u.default.setLoading(e,!0,"spinner"),void ajaxRequest("/mail",{act:"sendEvent",peer_id:g,author_id:i,message_id:o,conversation_message_id:A,payload:d,hash:S.hashSend},(function(t){var n=t.result.event_id;clog("waiting for "+n+" event callback"),Object(oe.registerCallbackButtonEvent)(g,e,n,o,s)}),(function(){K.init({type:K.SNACKBAR_TYPE_ERROR,text:lang.mobile_unknown_error}),u.default.setLoading(e,!1)}));tn({act:"send",to:g,from:"dialog",hash:S.hashSend,message:O,media:"",_af:p._af,random_id:w,payload:d}),r&&!p.peerId&&nav.go(Object(ce.makeUrl)("/mail",{act:"show",peer:g,community:nav.getQuery("community")}))}else{le.default.init()?(u.default.setLoading(e,!0,"blue"),le.default.getCurrentPosition((function(t){var n=t.coords,i=n.latitude,r=n.longitude;u.default.setLoading(e,!1),MailDialog.open({body:lang.mobile_mail_geo_send_question,confirmText:lang.mobile_mail_geo_send_confirm,cancelText:lang.mobile_cancel,onConfirm:a.default.onClick("uMailWrite._onConfirmSendGeo",i,r,d,O,g)})}),(function(){u.default.setLoading(e,!1),K.init({text:lang.mobile_mail_geo_not_available})}),{maximumAge:100,enableHighAccuracy:!0,timeout:1e4})):K.init({text:lang.mobile_mail_geo_not_available})}else{var T=c.link;g===$e.VK_OFFICIAL_PEER_ID&&Object(qe.isOnboardingFindFriendsLink)(T)&&ze.customMetricsCollector.logEvent({experiment_id:1285,service:"messages",metric_name:"push_find_friends_button",metric_value:4,unit_id:p.viewerId,unit_type_id:1});var I=Object(ee.wrapAwayIfExternal)(T,!0);nav.hard_go(I)}else{var M=c.app_id,P=c.hash,D=Object(ce.makeUrl)("/app"+M,{from:nav.cur.slice(1)});nav.go(D+"#"+P)}else{var x=c.hash,L=Object(ce.makeUrl)("/app6217559",{from:nav.cur.slice(1)});nav.go(L+"#"+x)}}}function wt(e,t,n,i,a){var r=store.mail,o=r.cur,s=r.peers[a],c=Z();tn({act:"send",to:a,from:"dialog",hash:s.hashSend,message:i,media:"",_af:o._af,random_id:c,payload:n,attach1_type:"map",attach1:e+"_"+t}),MailDialog.close(),nav.go(Object(ce.makeUrl)("/mail",{act:"show",peer:a,community:nav.getQuery("community")}))}function yt(e){"buttons"===Object(oe.getKeyboardType)()&&Object(oe.setKeyboardType)("");var t=Object(q.$)(".uMailWrite__keyboard");if(removeClass("uMailWrite__keyboard_open",t),en(!1),e&&e.store){var n=store.mail.cur.peerId,i=store.mail.peers[n];i&&i.keyboard&&(Ye[n]=i.keyboard.chat_local_id,lsSet("mail_keyboard_hidden",Ye))}}function Ot(e){Object(oe.setKeyboardType)("buttons");var t=Object(q.$)(".uMailWrite__keyboard"),n=e&&e.forceRender;addClass("uMailWrite__keyboard_open",t),en(!0);var i=Object(oe.getKeyboardState)(store.mail.cur.peerId);!n&&!!i.rendered||function(){var e=store.mail,t=e.cur,n=e.peers,i=t.peerId&&n[t.peerId];if(!i||!i.keyboard||!i.keyboard.buttons)return;var a=r.default.render(Object(ue.default)({keyboard:i.keyboard,pressed:bn(t.peerId)})),o=Object(q.$)(".uMailWrite__keyboard");o.innerHTML=a,Object(ae.setScrollView)(o,{topBanner:!1}),Object(oe.getKeyboardState)(t.peerId).rendered=!0}(),e&&e.store&&St()}function St(){var e=store.mail.cur.peerId;Object(oe.clearCallbackButtons)(e),Ye&&(delete Ye[e],lsSet("mail_keyboard_hidden",Ye))}function kt(){Object(oe.setKeyboardType)("templates");var e=Object(q.$)(".uMailWrite__templates");addClass("uMailWrite__templates_open",e),Jt(),sn()}function Ct(){"templates"===Object(oe.getKeyboardType)()&&Object(oe.setKeyboardType)("");var e=Object(q.$)(".uMailWrite__templates");removeClass("uMailWrite__templates_open",e),Jt()}function jt(e){var t=Object(q.$)(".uMailWrite__popupAttach"),n=Object(q.$)(".uMailWrite__popupStickers");e.preventDefault(),e.stopPropagation(),hasClass(Xe,n)&&removeClass(Xe,n),hasClass(Qe,t)?removeClass(Qe,t):(addClass(Qe,t),addEvent(window,"click",(function e(n){removeClass(Qe,t),removeEvent(window,"click",e)})))}function Et(){store.mail.cur&&(geByClass1("sp_body")&&(cur.scroller&&cur.scroller.destroy(),geByClass1("sp_body").scrollTop=0,removeClass("scroller_wrap",geByClass1("sp_cont")),geByClass("sp_page").forEach((function(e){return removeClass("scroller_page",e)}))))}function Tt(e,t){if(store.mail.cur){var n=store.mail,i=n.cur,a=n.peers,r=(geByClass1("uMailWrite"),Object(q.$)(".uMailWrite__popupStickers")),o=Z(),s=0===t.indexOf("suggestion"),c={act:"send",to:i.peerId,from:"dialog",hash:a[i.peerId].hashSend,message:"",media:"sticker"+e,_af:i._af,random_id:o,sticker_referrer:t};post.addRecentSticker(!1,e,!1);var l=i.msgReply[i.peerId];if(l&&(c.attached_messages=l,c.has_reply=!0,Object(oe.setPeerDraft)(i.viewerId,i.peerId,{reply:void 0}),ajaxRequest("/mail",{act:"reply_cancel",peer_id:store.mail.cur.peerId,hash:store.mail.hash.reply}),i.msgReply[i.peerId]=null),s){var u=Object(q.$)(".uMailWrite__textarea");u.value="",Xt("",i.viewerId,i.peerId),$t({},u)}return tn(c),Jt(),Pt(),Object(q.$)(".sp_tab_selected",r).classList.contains("sp_tab-1")&&setTimeout((function(){post.stickersSelectTab(!1,-1)})),!0}}function It(){var e=Object(q.$)(".uMailWrite__popupStickers");if(!e)return!1;clog("[mail sticker panel] received panel update event");var t=e.classList.contains("uMailWrite__popupStickers_open"),n=!e.innerHTML;t&&!n?domData(e,"need-update",1):(clog("[mail sticker panel] redraw closed sticker panel"),n&&ht(),Mt())}function Mt(){var e=store.mail.cur,t=Object(q.$)(".uMailWrite__popupStickers");if(!t)return!1;var n=Object(q.$)("#stickers_panel");if(!n)return!1;var i=Object(q.$)(".sp_tab_selected",n),a=Array.from(i.classList).reduce((function(e,t){if(t.startsWith("sp_tab")){var n=parseInt(t.split("sp_tab")[1]);isNaN(n)||(e=n)}return e}),0);return t.innerHTML=me.default.getStickerPanel("mail"+e.peerId),post.stickersSelectTab(!1,a),!0}function Pt(){var e=store.mail,t=e.cur,n=e.replies,i=t.msgReply[t.peerId],a="";if(t.editing){var r=n[i];r&&(a=r.preview_url)}else{var o=i&&_.default.getElem(i);if(o){var s=Object(q.$)(".thumbs_map .thumb_map_img_as_div",o);(a=s&&s.style.backgroundImage)&&(a=a.replace(/^url\((['"])?/,"").replace(/(['"])?\)$/,""))}}Object(q.$$)(".uMailWrite__reply").forEach((function(e){e.outerHTML=V(a)}))}function Dt(e){Object(q.$$)(".uMailWrite__attachments_"+e).forEach((function(t){t.outerHTML=W(e)})),lt(),Object(q.$)(".uMailWrite__textarea")&&Jt();var t=Object(q.$)(Ze);if(t){var n=!!t.$(et);t.classList.toggle(Je,!n)}}function xt(e){if(e&&e.preventDefault(),!mediaUpload.checkUploading())return!1;var t,n=Object(q.$)(".uMailWrite__textarea"),i=store.mail,a=i.cur,r=i.peers,o=Z(),s=store.mail.cur.editing,c=s&&store.mail.msgs[s],l=c?{act:"edit_message",id:s,peerId:c.peerId,hash:r[a.peerId].hashSend}:{act:"send",to:a.peerId,from:"dialog",hash:r[a.peerId].hashSend,_af:a._af,random_id:o,entrypoint:store.mail.cur.mvk_entrypoint||""};if(!rn())return c?MsgDeleteDialog.open({isEditing:!0}):a.groupId&&!Object(he.isChatPeer)(a.peerId)&&(t=Object(q.$)(".uMailWrite__templates"),ln("templates"),hasClass("uMailWrite__templates_open",t)?Ct():kt()),!1;each(geByClass1("uMailWrite"),(function(e,t){return!(t.name&&!t.disabled)||("radio"===t.type&&!t.checked||("checkbox"===t.type&&!t.checked||("button"===t.type||("submit"===t.type||("image"===t.type||void(l[t.name]=t.value))))))})),s?(uMailHat.onCancelEditing(!0),tn(l)):(tn(l),store.mail.cur.mvk_entrypoint="",Object(oe.popPeerAttachments)(a.peerId),n.value="",Xt("",a.viewerId,a.peerId),Object(oe.setPeerDraft)(a.viewerId,a.peerId,{msgs:void 0,reply:void 0},a.editing),a.msgReply[a.peerId]&&!a.editing&&ajaxRequest("/mail",{act:"reply_cancel",peer_id:store.mail.cur.peerId,hash:store.mail.hash.reply}),a.msgAttached[a.peerId]=[],a.msgReply[a.peerId]=null,$t({},n)),G.default.onSystemMessageClick(),Dt(a.peerId),Pt(),StickersHints.actualizeVisibility(),ne.isIOS?(n.focus(),setTimeout((function(){return n.focus()}))):Y.default.msie_edge||(n.focus(),requestAnimationFrame((function(){return n.focus()})))}function Lt(e){var t=store.mail,n=t.cur,i=t.peers,a=n.peerId,r=i[a];r&&ajaxRequest("/mail",{_ajax:1,act:"typing",peer:a,hash:r.hashTyping,community:nav.getQuery("community"),type:e})}function Bt(){var e=store.mail.cur;ln("text");var t=Object(q.$)(".messenger__layer_convo .messenger__content");Ke=new Fe(e.viewerId+"_"+e.peerId,t),setStyle(t,{overflow:"visible"}),Object(z.onEmitOnce)(Ke.onDestroy,(function(){setStyle(t,{overflow:""}),Ke=null})),Object(z.onEmitOnce)(Ke.onPreviewProcessComplete,(function(e){var t=store.mail.cur,n=t&&Object(oe.getPeerDraft)(t.viewerId,t.peerId);Object(oe.setPeerDraft)(t.viewerId,t.peerId,Object($.default)({},n,{audioMessagePreviewData:e}),t.editing)})),Object(z.onEmitOnce)(Ke.onSend,(function(e,t){!function e(t,n){var i=store.mail,a=i.cur,r=i.peers,o=a.peerId,s=r[o],c=Nt[n];if(!c||c.peerId!==o)return window.clog("Recording peer id and target not same"),delete Nt[n],void Object(ve.statlogsValueEvent)("mvk_audio_messages_event",null,"abort","pid");function l(){Object(ve.statlogsValueEvent)("mvk_audio_messages_event",null,"upload_fail"),mediaUpload.finishFakeUploading();var i=K.init({duration:3e4,type:SNACKBAR_TYPE_ERROR,text:window.getLang("mail_audio_message_upload_error"),action:{text:window.getLang("mobile_mail_audio_message_upload_retry"),onclick:"uMailWrite._resendAudioMessage()"}});F._resendAudioMessage=function(){Object(ve.statlogsValueEvent)("mvk_audio_messages_event",null,"upload_retry"),window.Snackbar.close(i,!0),e(t,n)}}F._resendAudioMessage=function(){},uploadFile(a.audio_msg.upload_url,t,{onStart:function(){mediaUpload.startFakeUploading()},onComplete:function(e){Object(ve.statlogsValueEvent)("mvk_audio_messages_event",null,"upload_complete"),ajaxRequest(a.audio_msg.done_url,JSON.parse(e.target.responseText),(function(e){if(e){mediaUpload.finishFakeUploading(),delete Nt[n];var t=e.owner_id+"_"+e.id,i=Z(),r=a.msgReply[a.peerId];tn({act:"send",to:o,from:"dialog",hash:s.hashSend,message:"",media:"audiomsg",attach1:t,attach1_type:"doc",attached_messages:r,has_reply:!!r,_af:a._af,random_id:i}),a.msgReply[a.peerId]=null,Pt(),Object(z.onEmitOnce)(pe.onMessage,(function(){uMessenger.cacheAudioMessageWaves()}))}else l()}),l)},onError:l})}(e,t),Ke=null,AudioMessagePlayer.resumeGlobalMedia()}))}function Rt(){Ke&&(Ke.clearCache(),Ke.cancel(!0))}var Nt={};function Ft(e){var t=store.mail.cur,n=Object(q.$)(".uMailWrite__textarea");setStyle.transform(n,0),Bt();var i=window.Speech.startRecording();Ke.recorder=i,Promise.all([i.getAvailableMicrophones(),i.aquireMicrophone()]).then((function(e){if(0===e[0].length){var t=new Error;throw t.name="DevicesNotFoundError",t}})).catch((function(e){delete Nt[r];var t="Error"===e.name?e.constructor.name||"Error":e.name;Object(ve.statlogsValueEvent)("mvk_audio_messages_event",null,"aquire_error",t||"Empty");var i=null;switch(t){case"DevicesNotFoundError":case"NotFoundError":case"OverconstrainedError":case"NotReadableError":i=window.getLang("mail_audio_message_device_error");break;case"NotAllowedError":case"PermissionDeniedError":case"PermissionDismissedError":Object(We.showAlert)(window.getLang("mobile_mail_record_unavailable_title"),window.getLang("mobile_mail_record_unavailable_text"));break;default:i=window.getLang("mail_audio_message_unsupported_error")}i&&K.init({type:SNACKBAR_TYPE_ERROR,text:i}),AudioMessagePlayer.resumeGlobalMedia(),Ke.cancel(!0),Ke=null,setStyle.transform(n,1)})),Object(z.onEmitOnce)(Ke.onDestroy,(function(){delete Nt[r],setStyle.transform(n,1),AudioMessagePlayer.resumeGlobalMedia(),window.Speech.onTypingEvent.off(a)})),AudioMessagePlayer.pauseGlobalMedia(),AudioMessagePlayer.detachPlayer();var a=function(){return Lt("audio")};window.Speech.onTypingEvent(a);var r=Z();Nt[r]={peerId:t.peerId},Ke.init(e,e?"moving":"locked",r)}function Ht(e){var t=e.event;t.target.closest(".Tooltip")||Object(q.$)(".uMailWrite__buttonSend").classList.contains("uMailWrite__buttonSend_canVoiceRecord")&&Object(ve.getCw)()<He.DESKTOP_WIDTH&&Ft(t)}function Ut(e){var t;e.target.closest(".Tooltip")||Object(q.$)(".uMailWrite__buttonSend").classList.contains("uMailWrite__buttonSend_canVoiceRecord")&&((null==(t=Ke)?void 0:t.initialized)?Ke.lock():Ft())}function Vt(e){Y.default.msie_edge&&(e.preventDefault(),xt(e))}function Wt(){var e=Wt,t=e.typingData||(e.typingData={});if(!(0===Object(q.$)(".uMailWrite__textarea").value.length||store.mail.cur&&store.mail.cur.editing)){var n=Date.now(),i=store.mail.cur.peerId;i<=-2e9||t[i]&&n-t[i]<5e3||(t[i]=n,Lt("text"))}}function $t(e,t){var n=Object(q.$)(".uMailWrite__textareaGhost"),i=t.value;n.innerText=i,"\n"===last(i)&&(n.innerHTML+="&nbsp;");var a=store.mail.cur,r=n.offsetHeight;Object(q.$$)(".uMailWrite__textarea").forEach((function(e){return setStyle(e,"height",r)})),Object(q.$$)(".uMailWrite__main").forEach((function(e){return setStyle(e,"height",r+8)})),Object(q.$$)(".uMailWrite__popupStickers .stickersHints").forEach((function(e){setStyle(e,"bottom",r+8+-5)})),at(),a&&rt(i,a.viewerId,a.peerId),zt(e,t,(function(){Mention.onKeyUp(e,t)}))}function qt(e){var t=store.mail,n=t.peers,i=t.members,a=t.cur,o=n[e].memberIds||[],s=[],c=[];o.forEach((function(e,t){if(e!==a.viewerId){var n=i[e];if(n){var r=[n.id,n.name,n.url.replace("/","@"),n.avatar,n.url.replace("/",""),null,null,null,n.firstName,n.domain];s.push(r)}else{var o=["fake"+t,"...","@...",i[0].avatar,"",null,null,null,"...",null];c.push(o)}}}));var l=r.default.html(Object(d.default)(Object(se.getMentionOutline20Icon)())),u=[];return $e.MASS_MENTION_ALIASES.online.forEach((function(e){var t=["online",lang.mobile_mail_mention_online,"@"+e,null,"",null,null,null,"",e,'<div class="MentionItem__img MentionItem__online">'+l+"</div>"];u.push(t)})),$e.MASS_MENTION_ALIASES.all.forEach((function(e){var t=["all",lang.mobile_mail_mention_all,"@"+e,null,"",null,null,null,e,e,'<div class="MentionItem__img MentionItem__all">'+l+"</div>"];u.push(t)})),s.concat(c).concat(u)}function zt(e,t,n){it.length&&(!hasClass("Mention_inited",geByClass1("uMailWrite__main"))&&ut(),n(e,t))}function Yt(e,t){zt(e,t,(function(){Mention.onKeyDown(e,t)})),(10==e.keyCode||13==e.keyCode&&(e.ctrlKey||e.metaKey))&&xt()}function Gt(e,t){zt(e,t,(function(){Mention.onClick(e,t)}))}function Kt(e,t){Object(oe.setKeyboardType)("text");var n=function(){store.mail.cur&&(ht(),ln("text"),StickersHints.init({peerId:store.mail.cur.peerId}),zt(e,t,(function(){Mention.onFocus(e,t)})))};ne.isIOS?n():requestAnimationFrame((function(){requestAnimationFrame((function(){n()}))})),ie.onOpen("bottom")}function Qt(e,t){if("text"===Object(oe.getKeyboardType)()&&Object(oe.setKeyboardType)(""),ie.onClose(),rt._timer&&clearTimeout(rt._timer),store.mail&&store.mail.cur){var n=store.mail.cur,i=n.viewerId,a=n.peerId;Xt(t.value,i,a)}}function Xt(e,t,n){var i=store.mail.cur.editing;Object(oe.setPeerDraft)(t,n,{text:e},i)}function Jt(){var e=store.mail,t=e.cur,n=(e.queue,e.flags);if(t&&t.peerId){var i=!rn(),r=!mediaUpload.checkUploading(),o=!!t.editing,s={sendActive:!(i||o||r||l),loading:r,editAccept:o&&!i,editRemove:o&&i},c=n.templates&&!(o||!t.groupId||Object(he.isChatPeer)(t.peerId)||!i||s.loading||s.uploading);s.templates=c&&"templates"!==Object(oe.getKeyboardType)(),s.templatesActive=c&&"templates"===Object(oe.getKeyboardType)();var l=n.areAudioMessagesEnabled&&!r&&!c&&!o&&i&&!(!window.AudioContext&&!window.webkitAudioContext||!navigator.mediaDevices);s.showVoiceRecord=l,s.canVoiceRecord=l&&"Speech"in window;var u=!(s.sendActive||s.showVoiceRecord||s.loading||s.editAccept||s.editRemove||s.templates||s.templatesActive);s.disabled=u;var d=a.default.class("uMailWrite__button","uMailWrite__buttonSend",s);return Object(q.$$)(".uMailWrite__buttonSend").forEach((function(e){return e.className=d})),s}}function Zt(e){var t=a.default.class("uMailWrite__button","uMailWrite__buttonStickers",{active:e});Object(q.$$)(".uMailWrite__buttonStickers").forEach((function(e){return e.className=t}))}function en(e){var t=a.default.class("uMailWrite__button","uMailWrite__buttonKeyboard",{active:e});Object(q.$$)(".uMailWrite__buttonKeyboard").forEach((function(e){return e.className=t}))}function tn(e){if(store.mail.cur){var t=store.mail.cur,n=t.ref,i=t.refSource,a=e.to;if(i&&(e.ref_source=i,e.ref=n,store.mail.refSource=void 0,store.mail.ref=void 0),pe.send(e),a){var r=store.mail.peers[a];if(r&&r.keyboard&&r.keyboard.one_time)r.keyboard=null,Object(oe.getKeyboardState)(a).updateTime=Date.now(),on()}Jt()}}function nn(e){e.stopPropagation(),alert(lang.mobile_mail_attachments_limit)}function an(e){var t=document.createElement("textarea");t.innerHTML=e;var n=t.value,i=Object(q.$$)(".uMailWrite__textarea");i.forEach((function(e){return e.value=n})),$t({},i[0])}function rn(){var e=Object(q.$)(".uMailWrite__textarea");return!!e&&(function(){var e=store.mail,t=e.cur;e.peers;return!!t&&t.hasAttachments}()||!!e.value.trim())}function on(e){if(Object(q.$)(".uMailWrite__keyboard")){var t,n=store.mail,i=n.cur,r=n.peers,o=i.peerId&&r[i.peerId];t=!(i.groupId||!o||o.closed||o.kicked)&&!(!o.keyboard||!o.keyboard.buttons.length);var s=Object(q.$)(".uMailWrite"),c=a.default.parseClass("uMailWrite",s.className);if(c.keyboard!==t&&(s.className=a.default.class("uMailWrite",Object.assign({},c,{keyboard:t}))),Object(oe.getKeyboardState)(i.peerId).rendered=!1,t){Ye||(Ye=lsGet("mail_keyboard_hidden")||{});var l=o.keyboard,u=Ye[i.peerId];e&&!0===e.update&&Object(oe.clearCallbackButtons)(i.peerId);var d=!Object(oe.getKeyboardType)()||"buttons"===Object(oe.getKeyboardType)()||"text"===Object(oe.getKeyboardType)(),_=!1;u&&(u==l.chat_local_id?d=!1:_=!0),d?cn("buttons",{store:_}):_&&St()}else yt()}}function sn(){var e=store.mail,t=e.cur,n=e.peers,i=t.peerId&&n[t.peerId];if(t.groupId&&i&&!i.closed&&!i.kicked){var a=Object(q.$)(".uMailWrite__templatesBody"),r=t.templates;if(a)return r?void function(e,t){e.innerHTML=de(t)}(a,r):(function(e){e.innerHTML=Loading({mix:"uMailWrite__templatesLoading"})}(a),Ge||(Ge=new Promise((function(e){ajaxRequest("/mail",{act:"get_templates"},(function(t){e(t)}),(function(t){e()}))}))),void Ge.then((function(e){Ge=null,store.mail&&store.mail.cur&&(store.mail.cur.templates=e),sn()})))}}function cn(e,t){switch(ln(e),e){case"stickers":gt();break;case"buttons":Ot(t);break;case"text":(n=Object(q.$)(".uMailWrite__textarea"))&&n.focus();break;case"templates":kt()}var n}function ln(e){var t;"stickers"!==e&&vt(),"buttons"!==e&&yt(),"text"!==e&&(t=Object(q.$)(".uMailWrite__textarea"))&&document.activeElement===t&&t.blur(),"templates"!==e&&Ct()}function un(e){var t=store.mail.cur.templates.find((function(t){return t.id===e}));if(t){var n=lang.mobile_mail_templates_delete_popup_text;n=n.replace("{name}",Object(te.emojiToHTML)(t.name)),MailDialog.open({body:n,confirmText:lang.mobile_mail_delete_popup_delete,cancelText:lang.mobile_mail_delete_popup_cancel,onConfirm:a.default.onClick("uMailWrite._onConfirmDeleteTemplate",e)})}}function dn(e){var t=store.mail.cur.templates,n=t.findIndex((function(t){return t.id===e}));if(-1!==n){var i=t[n],a=Object(q.$)(".uMailWrite__templatesRow"+i.id);i.deleting=!0,a.classList.add("uMailWrite__templatesRow_hidden"),ajaxRequest("/mail",{act:"delete_template",hash:store.mail.hash.templateDelete,id:e},(function(n){if(n.error)_n(e);else{var i=t.findIndex((function(t){return t.id===e}));t.splice(i,1),sn()}}),(function(){_n(e)}))}MailDialog.close()}function _n(e){var t=store.mail.cur.templates,n=Object(q.$)(".uMailWrite__templatesRow"+e),i=t.findIndex((function(t){return t.id===e})),a=t[i];a.deleting=!1,n.classList.remove("uMailWrite__templatesRow_hidden");var r=lang.mobile_mail_templates_delete_error;r=r.replace("{name}",a.name),K.init({text:r,action:{text:lang.mobile_mail_templates_toast_action_ok,callback:function(e,t){var n=t.id;K.close(n)}}})}function fn(){G.default.clearSystemMessage2(),remove(geByClass1("message__newMsgsDivider")),remove(geByClass1("Unfold__item_returnToChat"))}function pn(){var e=store.mail,t=e.cur,n=e.presend,i=e.pendingReplies,a=[],r=n.failed[t.peerId]||[],o=n.pending[t.peerId]||[];(r.length||o.length)&&(r.concat(o).map((function(e){var t=n.msgs[e];if(t)if(0===t.sendId.indexOf("edit"))F.onMessage(t);else{if(t.reply){var r=_.default.getReplyDataFromHTML(t.reply);r&&(i[t.reply]=r)}a.push(t)}})),Q.setMsgs(a))}function hn(e,t,n){var i;n?i=[Object(X.ModalMenuBtn)({inner:lang.mobile_mail_presend_menu_retry,onclick:["uMailWrite._onRetryFailedMsg","this",t]}),Object(X.ModalMenuBtn)({inner:lang.mobile_mail_presend_menu_delete,onclick:["uMailWrite._onDeleteFailedMsg","this",t]})]:i=[Object(X.ModalMenuBtn)({inner:lang.mobile_mail_presend_menu_cancel,onclick:["uMailWrite._onCancelPendingMsg","this",t]})];var a=Object(X.default)({class:"",close:!0,closeText:lang.mobile_mail_presend_menu_close,items:i});J.default.open(r.default.elem(a),!0)}function mn(e,t){X.default.close(e);var n=store.mail.presend.msgs[t];Object(oe.removeFailedMsg)(n),pe.retry(t,(function(e){var t=store.mail.cur.peerId,n=store.mail.peers[t];return e.data.hash=n.hashSend,e}))}function vn(e,t){X.default.close(e),pe.remove(t)}function gn(e,t){X.default.close(e),pe.remove(t)}function An(e){K.init({duration:0,text:e,action:{text:lang.mobile_mail_templates_toast_action_ok,callback:function(e,t){var n=t.id;K.close(n)}}})}function bn(e){return store.mail&&store.mail.cur&&store.mail.cur.pressedButtons?store.mail.cur.pressedButtons.peers[e]:{}}t.default=F;window.uMailWrite=F},"Po+v":function(e,t,n){"use strict";n.r(t),t.default=function(e){void 0===e&&(e={});var t=[];if(e.on_overlay_click_native)t=e.on_overlay_click_native;else{var n=!0;"boolean"==typeof e.hide_on_overlay_click&&(n=e.hide_on_overlay_click),t=["Popup._onOverlayClick","this",e.on_overlay_click||null,n]}e.content||(e.content=e.inner);return{inner:[e.rel?e.rel:null,{class:"Popup__overlay",onclick:t,tag:"div"},{inner:[{inner:[e.header?{inner:[e.header.title?{inner:[e.header.title],class:"Popup__headerTitle",tag:"div"}:null,e.header.corner?{inner:[e.header.corner.text],class:["Popup__headerCorner",e.header.corner.class],href:e.header.corner.url,onclick:e.header.corner.onclick,tag:"a"}:null],class:"Popup__header",tag:"div"}:null,e.scrollable?{inner:[{inner:[e.content],class:"Popup__scrollContent",tag:"div"}],class:"Popup__scroll ScrollView",tag:"div"}:e.content,e.footer?{inner:[e.footer],class:"Popup__footer",tag:"div"}:null],class:"Popup__content",role:"dialog","aria-modal":"true",tag:"div"}],class:"Popup__wrap",tag:"div"}],id:e.id,class:[e.mix?e.mix:e.class,Bem.class("Popup",{open:e.open,scrollable:e.scrollable},"_")],tag:"div"}}},PovR:function(e,t,n){"use strict";n.r(t),n.d(t,"SECOND",(function(){return i})),n.d(t,"MINUTE",(function(){return a})),n.d(t,"HOUR",(function(){return r})),n.d(t,"DAY",(function(){return o})),n.d(t,"PUSH_NOTIFIER_PERMISSION_GRANTED",(function(){return s})),n.d(t,"PUSH_NOTIFIER_PERMISSION_DEFAULT",(function(){return c})),n.d(t,"PUSH_NOTIFIER_PERMISSION_DENIED",(function(){return l}));var i=1e3,a=60*i,r=60*a,o=24*r,s="granted",c="default",l="denied"},Q8gl:function(e,t,n){"use strict";n.r(t),n.d(t,"Control_switcher",(function(){return l})),n.d(t,"Control_checkbox",(function(){return s})),n.d(t,"Control_radio",(function(){return c}));var i=n("OcsD"),a=n("z9sQ"),r=n("UWnA"),o=n("fdw3");function s(e){return u(Object(o.extend)(e,{type:"checkbox"}))}function c(e){return u(Object(o.extend)(e,{type:"radio"}))}function l(e){return u(Object(o.extend)(e,{type:"switcher"}))}function u(e){void 0===e&&(e={});var t,n=e.name,i=e.description,s=e.label||e.inner,c=e.type,l=e.checked,u=e.disabled,d=e.on_change||e.onChange,_=e.ariaHiddenLabel?e.ariaHiddenLabel:"true",f="value"in e?e.value:"1",p=[e.class||e.mix,a.default.class("Control",{type:c},"_")],h=e.attrs||[];h=Object(o.extend)({onclick:!0},h),"switcher"===c&&(t="switch");var m=e.name+"_"+f+"_label",v={inner:[{id:e.input_id,class:"Control__native",name:n,value:f,checked:!!l&&"checked",disabled:!!u&&"disabled",type:"switcher"===c?"checkbox":c,onChange:d?["Control._onChange","this",d]:null,"aria-labelledby":s?m:null,role:t,tag:"input"},{class:"Control__icon",tag:"div"},{inner:[{inner:[s],id:m,"aria-hidden":_,tag:"span"},i?{inner:[i],class:"Control__description",tag:"div"}:""],class:"Control__label",tag:"div"}],tag:"div"}.inner;return e.withoutWrap?{inner:[v],class:p,attrs:h,tag:"label"}:(h.role="menuitem",Object(r.default)({inner:[v],tag:"label",class:p,attrs:h}))}var d=u,_=n("TYsd"),f={setChecked:function(e,t){void 0===t&&(t=!0);g(e).checked=t},isChecked:function(e){return g(e).checked}},p=f;f._onChange=v;var h=".Control",m=".Control__native";function v(e,t){_.default.handle(t,{$control:e.closest(h),name:e.name,checked:e.checked,value:e.value})}function g(e){return e.$(m)}var A=Object(i.extend)(d,p);t.default=A;window.Control=A},QBkA:function(e,t,n){"use strict";n.r(t);var i=n("bZ/P"),a=n("9y81"),r=n("sYro"),o=function(e){var t=window.lang,n=e.query;return Wd.html({class:[Bem.class("mailFilter",{hasQuery:!!n},"_"),e.mix],inner:[SVGIcon(Object(r.getSearchOutline16Icon)()),{class:"mailFilter__input",tag:"input",placeholder:t.mobile_search,value:n,oninput:["MailFilter._onInput","this"],attrs:i.default.onFocus("MailFilter._onFocus")},{class:"mailFilter__right",inner:[Wd.wrap(Object(a.default)({mix:"mailFilter__clear",icon:"close12",attrs:i.default.onMouseDown("MailFilter._onClearMouseDown","this")}))]}]})};var s=n("UxAg"),c=n("+cqQ"),l=n("jk6M"),u=n("aiw/");function d(e){requestAnimationFrame((function(){var t=e.value;p(e.value),o.onChange(t)}))}function _(){u.onOpen("top")}function f(e){var t=e.closest(".mailFilter").$(".mailFilter__input"),n=document.activeElement===t;(l.default.ios?setTimeout:requestAnimationFrame)((function(){p(""),t.value="",n&&t.focus(),o.onClear(),o.onChange("")}))}function p(e){Object(s.$$)(".mailFilter").forEach((function(t){return t.classList.toggle("mailFilter_hasQuery",!!e)}))}Object.assign(o,{onChange:Object(c.default)("query"),onClear:Object(c.default)(),setQuery:function(e){var t=Object(s.$)(".mailFilter__input");t&&t.value!==e&&(t.value=e,o.onChange(e),p(e))},setQuerySilently:function(e){var t=Object(s.$)(".mailFilter__input");t&&t.value!==e&&(t.value=e,p(e))}}),o._onInput=d,o._onClearMouseDown=f,o._onFocus=_;t.default=o;window.MailFilter=o},QMH7:function(e,t,n){"use strict";n.r(t),n.d(t,"healScroll",(function(){return u})),n.d(t,"unhealScroll",(function(){return d}));var i=n("OcsD"),a=n("UxAg"),r=n("Qz23");n("H5mD").isIOS&&window.MutationObserver&&document.addEventListener("DOMContentLoaded",c);var o=".ScrollView",s="_scrollViewHealed";function c(){(l(),document.body)&&new MutationObserver(l).observe(document.body,{childList:!0,subtree:!0})}function l(){var e,t;(null==(e=window.Speech)||null==(t=e.recorder)?void 0:t.isRecording)||Object(a.$$)(o).forEach(u)}function u(e){if(!e[s]){e[s]={};var t=getComputedStyle(e),n=parseInt(t.paddingTop,10),a=parseInt(t.paddingBottom,10);e.style.paddingTop=n+1+"px",e.style.paddingBottom=a+1+"px",_(e),Object(r.setScrollView)(e,{override:!1}),Object(i.hasClass)("messenger__body",e)||Object(i.addEvent)(e,"scroll",p),Object(i.addEvent)(e,"scroll",f)}}function d(e){e[s]&&(e[s]=null,e.style.paddingTop="",e.style.paddingBottom="",Object(r.cleanScrollView)(e),Object(i.removeEvent)(e,"scroll",p),Object(i.removeEvent)(e,"scroll",f))}function _(e){var t=e.scrollTop;t<0||(0===t?e.scrollTop+=1:t+e.offsetHeight===e.scrollHeight&&(e.scrollTop-=1))}function f(e){var t=e.target,n=t[s];n&&(n.timer&&clearTimeout(n.timer),n.timer=setTimeout((function(){t[s]&&_(t)}),50))}function p(){onBodyScroll(!0)}},QQoL:function(e,t,n){"use strict";n.r(t);var i=n("TYsd"),a=n("z9sQ"),r=n("9y81"),o=function(e){var t=window.lang,n=e.count;return i.default.html({class:[a.default.class("Bell",{empty:!n},"_"),"al_menu"],href:e.url,onclick:e.onclick,"aria-label":t.mobile_notifications_title,"data-header":t.mobile_notifications_title,"data-skiponclick":1,inner:[i.default.html(Object(r.default)({mix:"Bell__icon",icon:"bell"})),{class:"Bell__counter",inner:n,tag:"em"}]})};var s=n("UxAg");Object.assign(o,{setCount:function(e){Object(s.$$)(l).forEach((function(t){var n=t.$(u);t.classList.toggle(c,!e),n.innerText=e}))}});var c="Bell_empty",l=".Bell",u=".Bell__counter";t.default=o;window.Bell=o},Qg0H:function(e,t,n){"use strict";n.r(t);var i=n("UxAg"),a=n("TYsd"),r=n("+cqQ");window.Voting={cls:"Voting",setLoading:m,setHtml:function(e,t){f(e).forEach((function(e){e.outerHTML=t})),f(e).forEach((function(e){e.classList.add(s)})),setTimeout((function(){f(e).forEach((function(e){e.classList.remove(s),Voting.onHtmlUpdate(e)}))}),30)},getVotingsById:f,onHtmlUpdate:Object(r.default)("$voting")},Voting._onSubmit=v,Voting._onSingleAnswerClick=h,Voting._onCheckboxClick=p,Voting._onRevoteClick=g;var o="Voting_loading",s="Voting_beforeAnimation",c="Voting_hasCheckedOptions",l=".Voting",u=function(e){return'.Voting[data-id="'+e+'"]'},d=".Voting__option",_=".Voting__optionControl";function f(e){return Object(i.$$)(u(e))}function p(e){var t=e.closest(l),n=Array.from(Object(i.$$)(_)).some((function(e){return e.checked}));e.closest(d).setAttribute("aria-checked",e.checked),t.classList.toggle(c,n)}function h(e){var t=e.name,n=e.value,i=e.closest("form"),a=i.getAttribute("action");i._Voting_singleAnswerAction=a+"&"+t+"="+encodeURIComponent(n)}function m(e){e.classList.add(o)}function v(e,t,n){var i;if(e.preventDefault(),t._Voting_singleAnswerAction)i=t._Voting_singleAnswerAction,m(t);else{var r=Array.from(t.$$("input:checked"));if(0===r.length)return;var o=r[0].name,s=r.map((function(e){return e.value})).join(","),c=t.getAttribute("action"),l=c.includes("?")?"&":"?";m(t),i=""+c+l+o+"="+s+"&is_board="+t.$('input[name="is_board"]').value}a.default.handle(n,{$voting:t,url:i})}function g(e,t){var n=e.closest(l);a.default.handle(t,{$voting:n})}},Qz23:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"init",(function(){return g})),n.d(t,"preventDocumentScroll",(function(){return A})),n.d(t,"restoreDocumentScroll",(function(){return b})),n.d(t,"cleanDocumentViews",(function(){return w})),n.d(t,"allowScrolling",(function(){return y})),n.d(t,"setScrollView",(function(){return k})),n.d(t,"cleanScrollView",(function(){return C})),n.d(t,"hideTopBanner",(function(){return F})),n.d(t,"showTopBanner",(function(){return H}));var i,a,r,o,s,c,l,u=n("UxAg"),d=n("aiw/"),_=n("H5mD"),f=!0,p=!1,h="closed",m=!1,v=[];function g(e){m&&w(),A(e)}function A(e){void 0===e&&(e={}),_.isIOS&&(!0!==e.stack&&m||(l={initialized:!1,scrollViews:[]},v.push(l),e.layoutElement&&e.layoutElement.nodeType?l.layoutElement=e.layoutElement:l.layoutElement=Object(u.$)(e.layoutElement||".layout")),!1===e.topBanner?l.topBanner=!1:l.topBanner=!0,m||(m=!0,addEvent(window,"focusin",L),addEvent(window,"focusout",B),addEvent(document,"touchmove",P,{capture:!0}),addEvent(document,"touchmove",D,{capture:!1}),addEvent(window,"resize",E),d.onCloseCallback(R),_.isWKWebView||(addEvent(window,"orientationchange",T),requestAnimationFrame((function(){Object(_.isLandscapePhone)()?T(null,!0):(E(),l&&!l.topBanner?requestAnimationFrame(F):r||requestAnimationFrame(H))})))))}function b(){m&&(m=!1,w(),1===v.length&&(l.layoutOffset=null,U(),document.body.style.height=""),l.layoutElement=null,v.pop(),(l=v.length?v[v.length-1]:null)&&U(),removeEvent(window,"focusin",L),removeEvent(window,"focusout",B),removeEvent(document,"touchmove",P,{capture:!0}),removeEvent(document,"touchmove",D,{capture:!1}),removeEvent(window,"resize",E),removeEvent(window,"orientationchange",T),removeEvent(window,"resize",I),removeEvent(window,"scroll",M),d.offCloseCallback(R))}function w(){l.scrollViews.forEach((function(e){return C(e)})),l.scrollViews=[]}function y(e){var t=e.currentTarget.__ScrollView;if("prevented"!==t.state){if(!("start"!==t.state||t.allowX&&t.allowY)){var n=Math.abs(t.startX-e.changedTouches[0].clientX),i=Math.abs(t.startY-e.changedTouches[0].clientY);if(!t.allowX&&n>i)return void(t.state="prevented");if(!t.allowY&&i>n)return void(t.state="prevented")}if("allowed"!==t.state&&(t.state="allowed"),f=!1,!t.overscrollX){var a=e.currentTarget.scrollLeft,r=t.startX-e.changedTouches[0].clientX;(a<=0&&r<=0||a>=t.maxX&&r>=0)&&(f=!0,t.standalone&&e.preventDefault())}if(!t.overscrollY){var o=e.currentTarget.scrollTop,s=t.startY-e.changedTouches[0].clientY;(o<=0&&s<=0||o>=t.maxY&&s>=0)&&(f=!0,t.standalone&&e.preventDefault())}}}function O(e){var t=e.currentTarget,n=t.__ScrollView;n.state="start",n.startX=e.changedTouches[0].clientX,n.startY=e.changedTouches[0].clientY,n.maxX=n.overscrollX?null:t.scrollWidth-t.clientWidth,n.maxY=n.overscrollY?null:t.scrollHeight-t.clientHeight}function S(e){e.currentTarget.__ScrollView.state=""}function k(e,t){if(void 0===t&&(t={}),_.isIOS&&(!1!==t.override||!e.__ScrollView)){if(!0!==t.standalone){if(!m)return;e.__ScrollView||l.scrollViews.push(e)}e.__ScrollView={allowX:!1!==t.allowX,allowY:!1!==t.allowY,overscrollX:!1!==t.overscrollX,overscrollY:!1!==t.overscrollY,standalone:!0===t.standalone},l&&(_.isWKWebView||(!1!==t.topBanner&&(e.__ScrollView.topBanner=t.topBanner||{hide:30,show:60}),addEvent(e,"scroll",j))),addEvent(e,"touchstart",O),addEvent(e,"touchmove",y),addEvent(e,"touchend",S)}}function C(e){e.__ScrollView=null,removeEvent(e,"touchstart",O),removeEvent(e,"touchmove",y),removeEvent(e,"touchend",S),removeEvent(e,"scroll",j)}function j(e){if("closed"!==h||Object(_.isLandscapePhone)())return p=!1,void(o&&clearTimeout(o));p=!0;var t=e.target.__ScrollView.topBanner;l&&l.topBanner&&t?N(e.target,t.show,t.hide):N(e.target,1/0,0),o&&clearTimeout(o),o=setTimeout((function(){p=!1,E()}),100)}function E(){if(!p)if(c)c=!1;else if(!Object(_.isLandscapePhone)()){window.pageYOffset;"closed"===h&&(_.isWKWebView||(i=document.documentElement.offsetHeight,a=innerHeight,r=i===a,"show"===s?(s=null,requestAnimationFrame(H)):"hide"===s&&(s=null,requestAnimationFrame(F))))}}function T(e,t){_.isIPad?l.topBanner||setTimeout((function(){F()}),400):90===Math.abs(window.orientation)?(addEvent(window,"resize",I),document.body.style.height="",l.layoutHeight=null,t?setTimeout((function(){window.scrollTo(0,-300),I()})):setTimeout((function(){window.scrollTo(0,-300)}),400)):(removeEvent(window,"resize",I),l.layoutOffset=null,U(),l.topBanner||setTimeout((function(){F()}),400))}function I(){if("closed"===h){var e=document.body.offsetHeight,t=e-innerHeight;l.layoutOffset=t,U(),window.scrollTo(0,e)}}function M(){pageYOffset&&(h="opened",removeEvent(window,"scroll",M))}function P(e){f=!0}function D(e){f&&e.preventDefault()}function x(e){var t=e&&e.target,n=0===e.eventPhase&&t.getAttribute("autofocus"),i=!1;return"textarea"!==t.tagName.toLowerCase()||n||(i=!0),"input"!==t.tagName.toLowerCase()||["checkbox","radio","image","submit"].includes(t.type)||n||(i=!0),"select"===t.tagName.toLowerCase()&&(i=!0),i}function L(e){if(x(e)){var t,n=e&&e.target;h="opening",addEvent(window,"scroll",M),window.isCustomScroll&&(t=n.dataset.scrollviewposition),d.onOpen(t,{exitIfStarted:!0})}}function B(e){x(e)&&d.onClose({exitIfStarted:!0})}function R(){removeEvent(window,"scroll",M),h="closed",setTimeout((function(){Object(_.isLandscapePhone)()?I():E()}),100)}function N(e,t,n){var i=e.scrollTop;i<=-t&&(r||s)?(s="show",window.scrollTo(0,-10)):i>=n&&(!r||s)&&(s="hide",window.scrollTo(0,10))}function F(){window.scrollTo(0,300)}function H(){window.setImmediate?e((function(){window.scrollTo(0,-300)})):window.scrollTo(0,-300)}function U(){var e=l.layoutOffset;l.layoutElement.style.top=e?e+"px":""}}.call(this,n("URgk").setImmediate)},RJa5:function(e,t,n){"use strict";var i,a,r,o;n.r(t),n.d(t,"AnalyticsArea",(function(){return i})),n.d(t,"AnalyticsEventTable",(function(){return a})),n.d(t,"ECommGoodsEvent",(function(){return r})),n.d(t,"ECommOrdersEvent",(function(){return o})),function(e){e.MARKET="market",e.GROUP="group",e.USER_PROFILE="user_profile",e.BOOKMARKS="bookmarks",e.FEED="feed"}(i||(i={})),function(e){e.GOODS="ecomm_goods",e.ORDERS="ecomm_orders"}(a||(a={})),function(e){e.TRANSITION_TO_ITEM="transition_to_item",e.TRANSITION_TO_ALBUM="transition_to_album",e.SWITCH_ITEM_VARIANT_1="switch_item_variant_1",e.SWITCH_ITEM_VARIANT_2="switch_item_variant_2",e.TRANSITION_TO_ITEM_LEFT="transition_to_item_left",e.TRANSITION_TO_ITEM_RIGHT="transition_to_item_right",e.VIEW_ITEM="view_item",e.VIEW_ALBUM="view_album",e.CLOSE_ITEM="close_item",e.TRANSITION_TO_OWNER="transition_to_owner",e.VIEW_ITEM_MEDIA="view_item_media",e.ADD_ITEM_TO_CART="add_item_to_cart",e.EXPAND_ITEM_DESCRIPTION="expand_item_description",e.ADD_ITEM_TO_BOOKMARKS="add_item_to_bookmarks",e.REMOVE_ITEM_FROM_BOOKMARKS="remove_item_from_bookmarks",e.EXPAND_COMMENTS="expand_comments",e.COMMENT="comment",e.ADD_TO_CART_HS="add_to_cart_hs",e.OPEN_WIKI="open_wiki",e.SEND_MESSAGE_TO_OWNER="send_message_to_owner",e.OPEN_CHAT_WITH_OWNER="open_chat_with_owner",e.LIKE_ITEM="like_item",e.UNLIKE_ITEM="unlike_item",e.SHARE_ITEM="share_item",e.CTA_LINK="cta_link",e.CREATE_ITEM="create_item",e.CREATE_ALBUM="create_album",e.EDIT_ITEM="edit_item",e.EDIT_ALBUM="edit_album",e.DELETE_ITEM="delete_item",e.DELETE_ALBUM="delete_album",e.GROUP_ITEMS="group_items",e.ADD_PROPERTY="add_property",e.ADD_PROPERTY_VALUE="add_property_value",e.DELETE_PROPERTY="delete_property",e.DELETE_PROPERTY_VALUE="delete_property_value",e.TRANSITION_TO_EDIT_PROPERTIES="transition_to_edit_properties",e.TRANSITION_TO_EDIT_ALBUMS="transition_to_edit_albums",e.TRANSITION_TO_ADD_ALBUM="transition_to_add_album",e.TRANSITION_TO_ADD_ITEM="transition_to_add_item",e.TRANSITION_TO_EDIT_ITEM="transition_to_edit_item",e.TRANSITION_TO_DELETE_ALBUM="transition_to_delete_album",e.TRANSITION_TO_GROUP_ITEMS="transition_to_group_items"}(r||(r={})),function(e){e.EVENT_MAKE_ORDER="make_order",e.CANCEL_ORDER="cancel_order",e.EXPAND_ORDER_INFO="expand_order_info",e.TRANSITION_TO_ORDERS="transition_to_orders",e.OPEN_MARKET_GROUP_ORDERS="open_market_group_orders",e.OPEN_MARKET_GROUP_ITEMS="open_market_group_items",e.OPEN_MARKET_GROUP_SETTINGS="open_market_group_settings",e.OPEN_MARKET_GROUP_DELIVERY="open_market_group_delivery",e.TRANSITION_TO_MARKET_SUPPORT="transition_to_market_support",e.OPEN_ORDER_INFO="open_order_info",e.ADD_TRACK_CODE="add_track_code",e.ADD_INTERNAL_COMMENT="add_internal_comment",e.CHANGE_ORDER_STATUS="change_order_status",e.OPEN_CHAT_WITH_CUSTOMER="open_chat_with_customer",e.SEND_MESSAGE_TO_CUSTOMER="send_message_to_customer",e.OPEN_ORDER_HISTORY="open_order_history",e.FILTER_ORDERS_BY_STATUS="filter_orders_by_status",e.EXPORT_ORDERS_DATA="export_orders_data"}(o||(o={}))},"S6+Z":function(e,t,n){"use strict";n.r(t),n.d(t,"emojiRegex",(function(){return i})),n.d(t,"skinToneModifierRegex",(function(){return a})),n.d(t,"EMOJI_PREFIXED_REPLACES",(function(){return r})),n.d(t,"EMOJI_REPLACES",(function(){return o})),n.d(t,"EMOJI_HINTS",(function(){return s}));var i=function(){return/(?:\uD83C\uDFF4)(?:(?:\uDB40\uDC67)(?:\uDB40\uDC62)(?:(?:\uDB40\uDC65)(?:\uDB40\uDC6E)(?:\uDB40\uDC67)|(?:\uDB40\uDC77)(?:\uDB40\uDC6C)(?:\uDB40\uDC73)|(?:\uDB40\uDC73)(?:\uDB40\uDC63)(?:\uDB40\uDC74))(?:\uDB40\uDC7F)|\u200D\u2620\uFE0F?)|(?:\uD83D\uDC69)\u200D(?:\uD83D\uDC69)\u200D(?:(?:\uD83D\uDC66)\u200D(?:\uD83D\uDC66)|(?:\uD83D\uDC67)\u200D(?:\uD83D[\uDC66\uDC67]))|(?:\uD83D\uDC68)(?:\u200D(?:\u2764\uFE0F?\u200D(?:(?:\uD83D\uDC8B)\u200D)?(?:\uD83D\uDC68)|(?:\uD83D[\uDC68\uDC69])\u200D(?:(?:\uD83D\uDC66)\u200D(?:\uD83D\uDC66)|(?:\uD83D\uDC67)\u200D(?:\uD83D[\uDC66\uDC67]))|(?:\uD83D\uDC66)\u200D(?:\uD83D\uDC66)|(?:\uD83D\uDC67)\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDB0-\uDDB3]))|(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDB0-\uDDB3]))|(?:\uD83D\uDC69)\u200D(?:\u2764\uFE0F?\u200D(?:(?:\uD83D\uDC8B)\u200D(?:\uD83D[\uDC68\uDC69])|(?:\uD83D[\uDC68\uDC69]))|(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDB0-\uDDB3]))|(?:\uD83D\uDC69)\u200D(?:\uD83D\uDC66)\u200D(?:\uD83D\uDC66)|(?:(?:\uD83D\uDC41)\uFE0F?\u200D(?:\uD83D\uDDE8)|(?:\uD83D\uDC69)(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|(?:\uD83D\uDC68)(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708])|(?:(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)\uFE0F?|(?:\uD83D\uDC6F|\uD83E[\uDD3C\uDDDE\uDDDF]))\u200D[\u2640\u2642]|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDD6-\uDDDD])(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]|\u200D[\u2640\u2642])|(?:\uD83D\uDC69)\u200D[\u2695\u2696\u2708])\uFE0F?|(?:\uD83D\uDC69)\u200D(?:\uD83D\uDC67)\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D\uDC69)\u200D(?:\uD83D\uDC69)\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D\uDC68)(?:\u200D(?:(?:\uD83D[\uDC68\uDC69])\u200D(?:\uD83D[\uDC66\uDC67])|(?:\uD83D[\uDC66\uDC67]))|(?:\uD83C[\uDFFB-\uDFFF]))|(?:\uD83C\uDFF3)\uFE0F?\u200D(?:\uD83C\uDF08)|(?:\uD83D\uDC69)\u200D(?:\uD83D\uDC67)|(?:\uD83D\uDC69)(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\uD83E[\uDDB0-\uDDB3])|(?:\uD83D\uDC69)\u200D(?:\uD83D\uDC66)|(?:\uD83C\uDDF6)(?:\uD83C\uDDE6)|(?:\uD83C\uDDFD)(?:\uD83C\uDDF0)|(?:\uD83C\uDDF4)(?:\uD83C\uDDF2)|(?:\uD83D\uDC69)(?:\uD83C[\uDFFB-\uDFFF])|(?:\uD83C\uDDED)(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|(?:\uD83C\uDDEC)(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|(?:\uD83C\uDDEA)(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|(?:\uD83C\uDDE8)(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|(?:\uD83C\uDDF2)(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|(?:\uD83C\uDDF3)(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|(?:\uD83C\uDDFC)(?:\uD83C[\uDDEB\uDDF8])|(?:\uD83C\uDDFA)(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|(?:\uD83C\uDDF0)(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|(?:\uD83C\uDDEF)(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|(?:\uD83C\uDDF8)(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|(?:\uD83C\uDDEE)(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|(?:\uD83C\uDDFF)(?:\uD83C[\uDDE6\uDDF2\uDDFC])|(?:\uD83C\uDDEB)(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|(?:\uD83C\uDDF5)(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|(?:\uD83C\uDDE9)(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|(?:\uD83C\uDDF9)(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|(?:\uD83C\uDDE7)(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|[#\*0-9]\uFE0F?\u20E3|(?:\uD83C\uDDF1)(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|(?:\uD83C\uDDE6)(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|(?:\uD83C\uDDF7)(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|(?:\uD83C\uDDFB)(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|(?:\uD83C\uDDFE)(?:\uD83C[\uDDEA\uDDF9])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDB8\uDDB9\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270A-\u270D]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC70\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDCAA\uDD74\uDD7A\uDD90\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1F\uDD30-\uDD36\uDDB5\uDDB6\uDDD1-\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDEEB\uDEEC\uDEF4-\uDEF9]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF])|(?:[\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2648-\u2653\u265F\u2660\u2663\u2665\u2666\u2668\u267B\u267E\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEF9]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD70\uDD73-\uDD76\uDD7A\uDD7C-\uDDA2\uDDB0-\uDDB9\uDDC0-\uDDC2\uDDD0-\uDDFF])\uFE0F?|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC69\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDDB5\uDDB6\uDDB8\uDDB9\uDDD1-\uDDDD])/g},a=/\uFE0F?\uD83C[\uDFFB-\uDFFF]/,r={e29da4:/(\s|^)([0OО]:\))([\s\.,]|$)/g,f09f9887:/(\s|^)(;-\)+)([\s\.,]|$)/g,f09f9889:/(\s|^)([XХxх]-?D)([\s\.,]|$)/g,f09f9886:/(\s|^)(B-\))([\s\.,]|$)/g,f09f988e:/(\s|^)(3-\))([\s\.,]|$)/g,f09f988c:/(\s|^)(&gt;\()([\s\.,]|$)/g,f09f98a0:/(\s|^)(;[oоOО])([\s\.,]|$)/g,f09f98b0:/(\s|^)(8\|)([\s\.,]|$)/g,f09f98b3:/(\s|^)(8-?[oоOО])([\s\.,]|$)/g,f09f98b2:/(\s|^)(8-\))([\s\.,]|$)/g,f09f988d:/(\s|^)(:[XХ])([\s\.,]|$)/g,f09f98b7:/(\s|^)(:[oоOО])([\s\.,]|$)/g,f09f98a8:/(\s|^)(&lt;3)([\s\.,]|$)/g},o={f09f988a:/(:-\))([\s\.,]|$)/g,f09f9883:/(:-D)([\s\.,]|$)/g,f09f989c:/(;-[PР])([\s\.,]|$)/g,f09f988b:/(:-[pр])([\s\.,]|$)/g,f09f9892:/(:-\()([\s\.,]|$)/g,e298ba:/(:-?\])([\s\.,]|$)/g,f09f988f:/(;-\])([\s\.,]|$)/g,f09f9894:/(3-?\()([\s\.,]|$)/g,f09f98a2:/(:&#039;\()([\s\.,]|$)/g,f09f98ad:/(:_\()([\s\.,]|$)/g,f09f98a9:/(:\(\()([\s\.,]|$)/g,f09f9890:/(:\|)([\s\.,]|$)/g,f09f98a1:/(&gt;\(\()([\s\.,]|$)/g,f09f989a:/(:-\*)([\s\.,]|$)/g,f09f9888:/(\}:\))([\s\.,]|$)/g,f09f918d:/(:like:)([\s\.,]|$)/g,f09f918e:/(:dislike:)([\s\.,]|$)/g,e2989d:/(:up:)([\s\.,]|$)/g,e29c8c:/(:v:)([\s\.,]|$)/g,f09f918c:/(:ok:|:ок:)([\s\.,]|$)/g},s={e29da4:[0,"<3"],f09f988a:[1,":-)"],f09f9883:[2,":-D"],f09f9889:[3,";-)"],f09f9886:[4,"xD"],f09f989c:[5,";-P"],f09f988b:[6,":-p"],f09f988d:[7,"8-)"],f09f988e:[8,"B-)"],f09f9892:[9,":-("],f09f988f:[10,";-]"],f09f9894:[11,"3("],f09f98a2:[12,":'("],f09f98ad:[13,":_("],f09f98a9:[14,":(("],f09f98a8:[15,":o"],f09f9890:[16,":|"],f09f988c:[17,"3-)"],f09f98a0:[18,">("],f09f98a1:[19,">(("],f09f9887:[20,"O:)"],f09f98b0:[21,";o"],f09f98b3:[22,"8|"],f09f98b2:[23,"8o"],f09f98b7:[24,":X"],f09f989a:[25,":-*"],f09f9888:[26,"}:)"],f09f918d:[27,":like:"],f09f918e:[28,":dislike:"],e2989d:[29,":up:"],e29c8c:[30,":v:"],f09f918c:[31,":ok:"]}},SNk7:function(e,t,n){"use strict";n.r(t);var i=n("fdw3"),a=n("Y6JH"),r=n("DsG2"),o=function(){return{inner:[{inner:[Object(a.default)({icon:Object(r.getBomb24Icon)()})],class:"CasperHiddenMessages__buttonIcon","aria-hidden":"true",tag:"span"},{inner:[Object(i.getLang)("mobile_casper_chat_message_has_gone")],class:"CasperHiddenMessages__buttonText",tag:"span"}],class:"CasperHiddenMessages__button",onClick:["CasperHiddenMessages.clickHandler","this","event"],"aria-haspopup":"true","aria-expanded":"false","aria-controls":"mail-dialog",tag:"button"}};var s=n("iS9e"),c=n("TYsd"),l=n("CQvH"),u=null,d={clickHandler:function(e){s.default.open({body:c.default.html({inner:[{inner:[Object(i.getLang)("mobile_casper_message_modal_info")],class:"CasperHiddenMessages__paragraph",tag:"p"}],class:"CasperHiddenMessages__box",tag:"div"}),title:Object(i.getLang)("mobile_casper_message_modal_title"),class:"CasperHiddenMessages__dialog",buttons:c.default.html({inner:[{inner:[Object(i.getLang)("mobile_casper_message_modal_install_vk_me")],tag:"span"}],class:"Btn Btn_theme_regular CasperHiddenMessages__dialogButton mailDialog__button mailDialog__confirmButton",tag:"button"}),onConfirm:function(e){if(u(),!(store&&store.mail&&store.mail.cur&&store.mail.cur.vkmeLink))throw new Error("Cannot find a link to VK Me app");nav.hard_go(store.mail.cur.vkmeLink)},onClose:function(){u(),s.default.close()}}),(u=Object(l.expandPopup)(e)).exitIntent=function(){s.default.close()}}};window.CasperHiddenMessages=d;t.default=o},STl5:function(e,t,n){"use strict";n.r(t);var i=n("QQoL"),a=function(){var e=window.store,t="/feed?section=notifications";return Object(i.default)({url:t,count:e.notificationsCount,onclick:["nav.onMenuItemClick",t]})};t.default=a;window.uBell=a},Sn6X:function(e,t,n){var i;!function(t){"use strict";var a=function(){},r=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.msRequestAnimationFrame||function(e){return setTimeout(e,16)};function o(){this.reads=[],this.writes=[],this.raf=r.bind(t),a("initialized",this)}function s(e){e.scheduled||(e.scheduled=!0,e.raf(c.bind(null,e)),a("flush scheduled"))}function c(e){a("flush");var t,n=e.writes,i=e.reads;try{a("flushing reads",i.length),l(i),a("flushing writes",n.length),l(n)}catch(e){t=e}if(e.scheduled=!1,(i.length||n.length)&&s(e),t){if(a("task errored",t.message),!e.catch)throw t;e.catch(t)}}function l(e){var t;for(a("run tasks");t=e.shift();)t()}function u(e,t){var n=e.indexOf(t);return!!~n&&!!e.splice(n,1)}o.prototype={constructor:o,measure:function(e,t){a("measure");var n=t?e.bind(t):e;return this.reads.push(n),s(this),n},mutate:function(e,t){a("mutate");var n=t?e.bind(t):e;return this.writes.push(n),s(this),n},clear:function(e){return a("clear",e),u(this.reads,e)||u(this.writes,e)},extend:function(e){if(a("extend",e),"object"!=typeof e)throw new Error("expected object");var t=Object.create(this);return function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}(t,e),t.fastdom=this,t.initialize&&t.initialize(),t},catch:null};var d=t.fastdom=t.fastdom||new o;void 0===(i=function(){return d}.call(d,n,d,e))||(e.exports=i)}("undefined"!=typeof window?window:this)},T24x:function(e,t,n){"use strict";n.r(t);var i=n("BZzM"),a=(n("CQvH"),n("QMH7")),r=n("Y6JH"),o=n("qHA9"),s=n("9b/I"),c={onChange:se(),onChanged:se(),onReadyOrChanged:se(),onRestore:se(),fast_load:!1,need_hard_go:!1,getHash:function(e){if("#player"===e.hash)return e.path+e.hash;var t=qs2obj(e.params);return delete t.z,e.path+obj2qs(t)},getAlias:function(e){if(!e)return!1;var t=(e||"").split("?"),n=t[0],i=qs2obj(t[1]);return i.from&&delete i.offset,delete i.from,delete i.z,delete i.ref,Object.keys(i).forEach((function(e){0===e.indexOf("_")&&delete i[e]})),n+obj2qs(i)},set:function(e,t,n,r){void 0===n&&(n={});var s=window,l=s.zlayer,u=s.cur,d=s.nav,_=s.menu,f=s.audioplayer,p=$("body.fixed"),h=p?Math.abs(parseInt(getStyle(p,"top"),10)):scrollTop(),m=null;if(window.isNewMail){var v=e.split("?");toggleClass("vk__page_mail",window.bodyNode,Object(o.isNewMailPage)(v[0],v[1]))}l.opened()&&(h=l._st);var g=n.forceUpdate&&t.newHTML,A=!g&&d.hasUpdate(r,e,t),b=!!A||d.needUpdate(r,e,t),w=0;if(!n.force&&!A&&b||g?(w=scrollTop(),m=remove("m"),each(geByClass("_cntr",m),(function(){remove(this)})),each(geByClass("ScrollView",m),(function(){Object(a.unhealScroll)(this)})),remove(geByClass1("_cntrs",m))):each(geByClass("ScrollView",geByClass1("m")),(function(){Object(a.unhealScroll)(this)})),!n.after&&!c.fast_load){var y=c.getHash(d),O=r||t.options||{};r&&r.is_native_back&&(O.prev_tab=O.native_prev),c.save(y,{html:null,st:h,page:m,state:c.stash(),cur:window.cur,options:O},!0)}if(n.before||c.clear(),(n.before||!n.before&&!n.after)&&(window.lm_qsearch_counter?window.lm_qsearch_counter++:window.lm_qsearch_counter=1),n.before){var S=r&&r.target;c.fast_load=!0,S&&addClass("__al_target",S);var k=m.cloneNode(!0);S&&removeClass("__al_target",S);var C=geByClass1("__al_target",k);removeClass("__al_target",C),n.beforeAppend&&n.beforeAppend(k,C),after(k,"l"),scrollTop(w),u.toggleHeaderSearch&&u.toggleHeaderSearch(!1),n.afterAppend&&n.afterAppend(k),_&&_.clear_hover(),_&&_.closeSearch(),_&&_.enabled(!0)}else{r&&r.zProcess&&r.zProcess(0,!0)&&delete r.zProcess;var j=!1;if(r&&d.set(r),c.need_hard_go)return d.hard_go(d.cur,null,{replace:!0});if(!n.force&&!A&&b||g){var E;if(t.title&&(document.title=t.title),g?((E=ce("div",{className:"layout__basis",id:"m"})).setAttribute("role","main"),val(E,t.newHTML)):(E=t.page)?j=!0:((E=ce("div",{className:"layout__basis",id:"m"})).setAttribute("role","main"),val(E,t.html)),_.opened()){var T=ce("div",{id:"m_helper",onclick:_.close});append(T,E)}after(E,"l")}c.fast_load=!1,thover.clear(),!A&&b&&(t.lm&&_.refresh(t.lm),t.bc&&(window.bodyNode.className=t.bc),l.opened(),r&&r.zProcess?r.zProcess(0,!1)&&delete r.zProcess:l.close()),n.force||(j&&(window.qsearch.isCachedPage=!0),t.js&&evalJs(t.js),j&&(window.qsearch.isCachedPage=!1),t.state&&c.stash(t.state),t.cur&&extend(window.cur,t.cur),r&&(t.options=r),post.wallActionsHide(),c.save(e,t));var I=r?r.nav&&r.nav.hash:d.hash;if(A||b)if(A)Tabbar.showUpdateButton(A.currentCache.d.page);else if(t.st||!I){var M=window.isCustomScroll&&hasClass("ScrollView","mcont")?1:0;scrollTop(t.st||M),scrollTop(t.st||M,10)}else I?scrollToHash(I):n.no_scroll&&!n.force?(scrollTop(h),scrollTop(h,10)):scrollToHash();else;f&&f.initAudio(),AudioMessagePlayer&&AudioMessagePlayer.redrawWaves()}var P=window.Tabs;onBodyResize(P.actualizeShowMoreVisibility),P.actualizeShowMoreVisibility(),Object(i.resizePosters)(),c.onChange(!0,r&&r.nav&&r.nav.push),(n.al_transition||n.restored)&&c.onChanged(!0)},save:function(e,t,n){if(e){var i=window.nav,a=n?i.page_get(e,t.options.prev_tab):{};a&&i.page_set(e,extend(a,t),c.getAlias(e))}},restore:function(e){var t=window.nav,n=t.page_get(e);return n||(n=t.page_get(c.getAlias(e))),!!n&&(c.onRestore(!0),n)},stash:function(e){var t=window.cur;return window.cur&&t.stash&&t.stash(e)||!1},clear:function(){var e=window.cur,t=window.zlayer,n=window.menu,i=window.tooltip;onBodyScroll("__clear"),onBodyResize("__clear"),n&&n.initEvents(),t.isReady&&t.initEvents(),i&&i.clear(),window.cur&&e.destroy&&each(e.destroy,(function(){this()})),window.cur={destroy:[]}},hideHeader:function(e){var t=geByClass1("mhead",e);hide(t)},setMhead:function(e,t,n,i,a){void 0===a&&(a={});var o=geByClass1("mhead",e),c=geByClass1("mhb_logo",o),l=geByClass1("mh_header",e),u=!1,d=window.nav,_=document.body,f=geByClass1("SliderTabs",o),p=geByClass1("header__right",o),h=geByClass1("header__gear",o);f&&remove(f),p&&remove(p),h&&remove(h),removeClass("vk_header_tabs",_);var m="header__title hb_btn mh_header mhi_back";if(a.movable&&(m+=" header__title--movable header__title--initial-position"),n){!0===n?u=d.path+(d.params?"?"+d.params:""):n&&(u=n),t||(t=val(l)||"&nbsp;");var v=geByClass1("mhb_back",e),g="",A=hasClass("mh_nobr",v)?" mh_nobr":"",b=i?' onclick="'+i+'"':"";if("/"==u)g='<div class="hb_wrap mhb_back'+A+'"'+b+'><h1 class="hb_btn mh_header">'+t+"</h1></div>";else{var w=Wd.html(Object(r.default)(Object(s.getBackOutline28Icon)()));g='\n        <div class="header__center hb_wrap mhb_back '+A+'">\n          <a class="header__back al_back" href="'+escapeAttr(u)+'" accesskey="0" '+b+">"+w+'</a>\n          <h1 class="'+m+'">\n            <div class="header__text">\n                '+t+"\n            </div>\n          </h1>\n        </div>\n      "}if(o&&c){var y=geByClass1("mhb_notify",e);val(o,(window.al&&window.al.menu?'<a href="/" class="hb_wrap mhb_home" accesskey="*" onclick="return menu.toggle(event);"><div class="hb_btn mhi_home">&nbsp;</div></a>':'<a href="/" class="hb_wrap mhb_home mhb_vkhome" accesskey="*"><div class="hb_btn mhi_home mhi_vkhome">&nbsp;</div></a>')+'<div id="header_msgs" class="hb_wrap mhb_notify'+(!y||hasClass("mhb_no_notify",y)?" mhb_no_notify":"")+'">'+val(y)+"</div>"+g)}else v&&(v.outerHTML=g);var O=$(".header__center");O&&O.classList.toggle("is_unfold",$(".Unfold",O))}else t&&val(l,t)}};window.page=c,onDOMReady((function(){c.onReadyOrChanged(!0),c.onChanged((function(){c.onReadyOrChanged(!0)}))})),t.default=c},T3FL:function(e,t,n){"use strict";n.r(t),n.d(t,"navigationStat",(function(){return r}));var i=n("FbVm");n.d(t,"NavigationProductionStatEventTypes",(function(){return i.NavigationProductionStatEventTypes}));var a=new i.ProductionStatCollector,r=new i.NavigationStatCollector(a)},TAKr:function(e,t,n){"use strict";n.r(t),n.d(t,"showAlert",(function(){return k})),n.d(t,"POPUP_DISAPPEAR_TIME",(function(){return d})),n.d(t,"POPUP_NAV_PREFIX",(function(){return u}));var i=n("vWwi"),a=n("1By4"),r=n("Po+v"),o=n("UxAg"),s=n("j80l"),c=n("OcsD"),l=n("29dZ"),u="pop_",d=200;Object.assign(r.default,{open:function(e,t,n){void 0===n&&(n={});var a=n,r=a.hash,o=a.oncloseCallback,s=a.withoutCloning;if(S(e),g=Boolean(n.forceScrollDisable),t){if(!s){var l=e;(e=l.cloneNode(!0)).original=l}e.appendedToBody=!0,e.withoutCloning=s,document.body.appendChild(e)}e.classList.add(f);var d=e.$(v.scroll);Object(i.disableBodyScroll)(e,{forceScrollDisable:g}),o&&b.push([e,o]);if(d){if(y(e,d),e.onResizeHandler=function(){y(e,d)},Object(c.addEvent)(window,"resize",e.onResizeHandler),!window.MutationObserver)return e;e.scrollContentObserver=new MutationObserver(e.onResizeHandler),e.scrollContentObserver.observe(d,{childList:!0,subtree:!0})}if(r){var _="#"+u+r,p=nav.cur.split("#")[0];nav.go(p+_,!1,{push_only:!0}),A[_]=e}return e},close:O}),t.default=r.default,r.default._onOverlayClick=w;var _="Popup",f="Popup_open",p="Popup_hasScroll",h="ScrollView",m="Popup--closing",v={open:"."+f,popup:"."+_,wrap:"."+"Popup__wrap",content:"."+"Popup__content",scroll:".Popup__scroll",header:".Popup__header",footer:".Popup__footer"},g=!1,A={},b=[];function w(e,t,n){var i=e.closest(v.popup);Object(c.isFunction)(t)?t({$popup:i}):t&&a.default.handle(t,{$popup:i}),n&&O(i)}function y(e,t){var n=e.$(v.header),i=e.$(v.footer);t.scrollHeight-6>t.offsetHeight?(Object(c.addClass)(e,p),Object(c.addClass)(t,h),ContentScrollView.restore()):(Object(c.removeClass)(e,p),Object(c.removeClass)(t,h),t.scrollTop=0);var a=Object(c.getCh)(),r=0,o=0;n&&(r=n.offsetHeight),i&&(o=i.offsetHeight);var s=Math.min(a-r-o-100,420);Object(c.setStyle)(t,"max-height",s+"px")}function O(e,t){void 0===t&&(t={});var n=t,a=n.smooth,r=n.velocity,l=n.lastY;if(e&&!e.classList.contains(_)&&(e=e.closest(v.popup)),e||(e=Object(o.$)(v.open)),e){var d=Object(o.$)(v.wrap,e),p=Object(o.$)(v.content,e);if(a&&r&&l){var h=Object(c.getH)(p),A=(h-l)*r.y;return A>=300&&(A=200),A=Math.max(150,Math.min(300,A)),c.setStyle.animate(d,"transform",{duration:A,func:"cubic-bezier(0.0, 0.0, 0.2, 1)"}),c.setStyle.transform(d,1,[0,h+"px"]),e.classList.add(m),setTimeout((function(){O(e,{onClose:t.onClose})}),1.1*A)}if(a){e.classList.add(m);var w=Object(c.getH)(p);return c.setStyle.transform(d,1,[0,w+"px"]),setTimeout((function(){O(e,{onClose:t.onClose})}),200*1.1)}if(e.classList.remove(f),e.appendedToBody&&document.body.contains(e)&&Object(c.replace)(e,e.withoutCloning?e:e.original),e.classList.remove(m),c.setStyle.transform(d),Object(c.removeEvent)(window,"resize",e.onResizeHandler),e.scrollContentObserver&&e.scrollContentObserver.disconnect(),Object(o.$)(v.open)||Object(i.enableBodyScroll)(void 0,{forceScrollDisable:g}),nav.cur&&nav.cur.startsWith("#"+u)){var y=s.default.make(nav.path,qs2obj(nav.params));nav.set({nav:Object(c.extend)({},nav,{cur:nav.path,path:nav.path||"",push:y||""})})}var k,C=(k=e,(b.find((function(e){return e[0]===k}))||[])[1]);C&&(C(),S(e)),t.onClose&&t.onClose(),window.cur&&window.cur.app&&window.cur.app.frame&&window.cur.app.frame.focus()}}function S(e){var t=b.findIndex((function(t){return t[0]===e}));t>=0&&b.splice(t,1)}function k(e,t){void 0===e&&(e=""),void 0===t&&(t="");var n=Object(r.default)({scrollable:!0,header:{title:e},content:[t,{inner:[Object(l.default)({inner:[Object(c.getLang)("mobile_close")],theme:"secondary",class:"Popup__button",onClick:"Popup.close(this)",use_native_onclick:!0})],class:"Popup__buttons",tag:"div"}]});r.default.open(a.default.elem(n),!0)}nav.onPopState&&nav.onPopState((function(){var e=A[nav.cur];e&&(O(e),delete A[nav.cur])}))},TYsd:function(e,t,n){"use strict";n.r(t),n.d(t,"_Wd_toFlatArray",(function(){return a})),n.d(t,"_Wd_innerItemToString",(function(){return r}));var i=n("1By4");t.default=i.default;var a=i.default._Wd_toFlatArray,r=i.default._Wd_innerItemToString;window.Wd=i.default},Tjn9:function(e,t){function n(e){(e=ge(e))&&(addClass(e,"profileEdit_selected"),setTimeout((function(){addClass(e,"profileEdit_animated"),setTimeout((function(){removeClass(e,"profileEdit_selected"),removeClass(e,"profileEdit_animated")}),1e3)}),1500))}function i(e){(e=ge(e))&&setTimeout((function(){var t=getXY(e)[1],i=getSize("mhead")[1],a=scrollGetY(),r=getCh();t<i+a||t>a+r?setTimeout((function(){scrollTo(0,t-i),n(e)}),0):n(e)}),0)}window.ProfileEditor={init:function(){var e=(qs2obj(nav.params)||{}).hl;e&&i(geByClass1("_"+e))},highlightRow:n,scrollHighlightRow:i}},TxR4:function(e,t,n){"use strict";n.r(t),n.d(t,"emojiSymbolToByteHex",(function(){return a})),n.d(t,"emojiByteHexToSymbol",(function(){return r})),n.d(t,"emojiRemoveSkinToneModifiers",(function(){return o}));var i=n("S6+Z");function a(e){return encodeURIComponent(e.replace(/\uFE0F/gi,"")).replace(/%/gi,"").toLowerCase()}function r(e){var t,n=e.length%2==1,i=n?e.slice(0,1):"",a=n?e.slice(1):e,r="";try{r=decodeURIComponent("%"+(t=a,t.split("").reduce((function(e,t,n){return e+t+((n+1)%2==0?" ":"")}),"").trim().split(/\s+/)).join("%"))}catch(e){}return i+r}function o(e){return e.replace(Object(i.emojiRegex)(),s)}function s(e){return e.replace(i.skinToneModifierRegex,"")}},U34x:function(e,t){var n="dropdown_open",i={_onTogglerClick:function(e,t){preventEvent(e),stopEvent(e);var i=gpeByClass("dropdown",t);if(toggleClass(i,n),!1!==i.isFirstClick){i.isFirstClick=!1;var a=function(){removeClass(i,n)};addEvent(window,"click",a),window.cur.destroy.push((function(){removeEvent(window,"click",a),i.isFirstClick=!0}))}}};window.Dropdown=i},UWnA:function(e,t,n){"use strict";n.r(t);var i=n("WWoJ");n.d(t,"RowLabeledSelect",(function(){return i.RowLabeledSelect})),n.d(t,"RowLabeledInput",(function(){return i.RowLabeledInput})),t.default=i.default},Ubt6:function(e,t,n){"use strict";n.r(t);var i=n("z9sQ");t.default=function(e){return{class:[e.class,i.default.class("Tooltip",{pos:e.pos,onboarding:e.onboarding,theme:e.theme||"",closeOnOverlayClick:e.closeOnOverlayClick},"_")],"tooltip-id":e["tooltip-id"],inner:{class:i.default.class("Tooltip__inner",{pos:e.pos,theme:e.theme||""},"_"),inner:e.inner},style:e.style,onclick:e.onclick}}},UlUB:function(e,t,n){"use strict";function i(e,t){var n,i,a=!1;return function r(){if(a)return n=arguments,void(i=this);e.apply(this,arguments),a=!0,setTimeout((function(){a=!1,n&&(r.apply(i,n),n=i=null)}),t)}}n.r(t),n.d(t,"throttle",(function(){return i}))},UvyM:function(e,t,n){"use strict";n.r(t);var i=n("z9sQ"),a=n("BoyB"),r=n("TYsd"),o=n("fdw3");t.default=function(e){void 0===e&&(e={});var t=e.url,n=e.is_icon,s=e.icon,c=e.tag||"button",l=e.before||null,u=e.after||null,d=e.role||"button",_=e.on_click||e.onClick||e.onclick,f=e.use_native_onclick,p=e.inner||e.children;Object(o.isArray)(p)&&1===p.length&&"string"==typeof p[0]&&(p=p[0]);var h=!1;"function"==typeof _&&(f=!0,h=!0);_&&!f&&(_=["Btn._onClick","event","this",_]);var m={class:[e.class,i.default.class("Btn",{theme:e.theme||"regular",size:e.size||"",stretch:e.stretch,flex:!(!l&&!u)},"_")],onclick:_,ref:e.ref,attrs:e.attrs,tag:"div"};h&&(m.onClick=_,delete m.onclick);var v=e.hide?"; display: none;":"",g=e.style?e.style+v:v,A=null;e.isLoading&&(m.class.push("Btn_loading"),A=r.default.wrap(Object(a.default)({mix:"Btn__loader",white:"secondary"===e.theme?"white":"",large:!0,spinner:e.spinner||"white"!==e.theme})));if(t)return Object(o.mergeObjects)(m,{inner:[l,s?[{inner:[s],class:"Btn__icon",tag:"div"},{inner:[p],class:"Btn__text",tag:"div"}]:n?p:{inner:[p],class:"Btn__text",tag:"div"},u],_:r.default.getInternalData(),href:t,role:d,style:g,target:(e.open_in_new_tab?"_blank":e.target)||"",tag:"a"});var b=e.is_submit?"submit":null,w=e.type||b,y={inner:[s?[A,{inner:[s],class:"Btn__icon",tag:"div"},{inner:[p],class:"Btn__text",tag:"div"}]:n?[A,p]:[A,{inner:[p],class:"Btn__text",tag:"div"}]],_:r.default.getInternalData(),"aria-label":e["aria-label"]||"",style:g,disabled:e.disabled,type:w,tag:"div"};return y.tag=c,Object(o.mergeObjects)(m,y)}},V2dH:function(e,t,n){"use strict";n.r(t);var i=n("rKUZ"),a=n("iWgD"),r=function(){return Object(i.default)(o())};function o(){var e,t,n=store.mail.cur.peerId,i=Object(a.uTyping_getPeerTyping)(n);return i&&("mixed"===i.type?(e="dots",t="mixed"):"audio"===i.type?(e="audio",t="audio"):"text"===i.type&&(e="dots",t="")),{id:"curConvo",typing:Object(a.uTyping_getNames)(i),typingCount:i?i.count:0,dimmed:!0,animation:e,text:t}}Object.assign(r,{redraw:function(){if(!store.mail.cur.peerId)return;var e=i.default.getElem("curConvo"),t=o();q.parseClass("typing",e.className).animation===t.animation?i.default.setTyping(e,t):e.outerHTML=Object(i.default)(t)}});t.default=r;window.uCurConvoTyping=r},V4qE:function(e,t,n){"use strict";n.r(t),n.d(t,"init",(function(){return C})),n.d(t,"close",(function(){return T})),n.d(t,"SNACKBAR_POSITION_COMMON",(function(){return v})),n.d(t,"SNACKBAR_POSITION_MAIL",(function(){return g})),n.d(t,"SNACKBAR_TYPE_SUCCESS",(function(){return w})),n.d(t,"SNACKBAR_TYPE_ERROR",(function(){return y})),n.d(t,"SNACKBAR_TYPE_BOOKMARK",(function(){return O})),n.d(t,"SNACKBAR_TYPE_BULLYING",(function(){return S}));var i=n("z9sQ"),a=n("29dZ"),r=n("Y6JH"),o=n("fdw3"),s=n("xlrz"),c=n("XJmI"),l=n("EXPB"),u=n("0qaj"),d=function(e){void 0===e&&(e={});var t=e.position||"bottom",n=!(!e.type||e.image),d={class:i.default.class("SnackbarItem__cell",{left:!0,image:!!e.image,top:e.avatar&&"left"===e.avatar_position,icon:n},"_")},_={class:i.default.class("SnackbarItem__cell",{right:!0,avatar:!!e.avatar},"_")},f=!1,p=!1;if(e.type){f=!0;var h=null;switch(e.type){case 1:h=Object(r.default)(Object(s.getSnackbarDone24Icon)());break;case 2:h=Object(r.default)(Object(c.getSnackbarError24Icon)());break;case 3:h=Object(r.default)(Object(l.getFavorites24Icon)());break;case 4:h=Object(r.default)(Object(u.getErrorFill24Icon)())}d.inner={class:"SnackbarItem__icon",inner:h}}e.image&&(f=!0,d.inner={class:"SnackbarItem__image",inner:{tag:"img",src:e.image}});e.action&&(p=!0,_.inner=Object(a.default)({theme:"none",class:"SnackbarItem__action",url:e.action.url,target:e.action.target,on_click:e.action.onclick,use_native_onclick:!0,inner:Wd.wrap(e.action.text),attrs:e.action.attrs}));if(e.avatar){var m={tag:"img",class:"SnackbarItem__avatar",src:e.avatar};e.avatar_position&&"right"!==e.avatar_position?"left"===e.avatar_position&&(f=!0,d.inner=m):(p=!0,_.inner=m)}return{style:e.style?e.style:"",class:["SnackbarItem_"+e.id,"SnackbarItem--"+t+" ",i.default.class("SnackbarItem",{static:!!e.static,vertical:!!e.vertical,hasIcon:n}),e.className||e.class],attrs:{"data-snackbar-id":e.id},inner:[{class:"SnackbarItem__table",inner:[f?d:null,e.text?{class:i.default.class("SnackbarItem__cell",{text:!0},"_"),inner:{class:"SnackbarItem__text",inner:Object(o.isObject)(e.text)?e.text:Wd.wrap(e.text)}}:null,p?_:null]}]}};var _=n("OcsD"),f=n("UxAg"),p=n("kr3z"),h=n("zq7H"),m=n("ZMWW");window.Snackbar={init:C,close:T,_onActionClick:function(e,t){var n=b[t];if(!n)return void Object(_.hide)(t);var i=n.callback,a=n.url;i?"function"==typeof i?i.call(null,e,{id:t,url:a}):Wd.handle2(i,e,{id:t,url:a}):Object(_.hide)(t)},_onRestoreClick:function(e,t,n){var i=t.closest(".SnackbarItem"),a=Object(_.domData)(i,"snackbar-id"),r=b[a];e.stopPropagation(),e.preventDefault();var o=r.callback;o&&("function"==typeof o?o.call(null,e,{id:a,url:n}):Wd.handle2(o,e,{id:a,url:n}));T(a),p.default.click(n,null,{url_params:{_ajax:1,_snackbar:1}})}};var v="common",g="mail",A=0,b={},w=1,y=2,O=3,S=4,k=[];function C(e){if(!m.SAKIntegration.isIntegrated){var t=isFinite(e.duration)?e.duration:5e3,n=A++,i=e.action&&e.action.callback,a=e.action&&e.action.url;e.position=e.position||v;var r=e.position;e.id=n,i&&!e.action.onclick&&(e.action.onclick=["Snackbar._onActionClick","event",n]),e.bottom&&(e.style="bottom: "+e.bottom+"px");var o,s=Wd.elem(SnackbarItem(e));return function(e,t){if(t.position===v)Object(_.append)(e,document.body);else if(t.position===g){var n="msg"===window.store.mail.cur.page?Object(f.$)(".messenger__layer_page .messenger__header"):Object(f.$)(".messenger__layer_convo .messenger__header");Object(_.append)(e,n)}setTimeout((function(){e.classList.add("SnackbarItem_added")}),100)}(s,e),t&&(o=E(n,t)),Object(_.addEvent)(s,"touchstart",R,{passive:!0}),Object(_.addEvent)(s,"touchmove",N,{capture:!1}),Object(_.addEvent)(s,"touchcancel touchend",F,{passive:!0}),b[n]={id:n,timer:o,callback:i,url:a,duration:t,position:r},k.push(n),j(),n}m.SAKIntegration.sendMessage("show_snackbar",{type:e.type,text:e.text})}function j(){var e=(k=k.filter((function(e){var t=b[e],n=I(e);return!(!t||!n)}))).reduce((function(e,t){var n=b[t];return e[n.position]||(e[n.position]=[]),e[n.position].push(t),e}),{});Object.keys(e).forEach((function(t){var n=e[t],i=0,a=t===g?8:12;n.forEach((function(e,n){var r=I(e),o=Object(_.getH)(r);b[e].vertical=t===g?i:-i,_.setStyle.transform(r,1,[0,b[e].vertical]),i+=o+a}))}))}function E(e,t){return setTimeout((function(){T(e,!1)}),t)}function T(e,t){var n=b[e],i=I(e);n&&(n.timer&&clearTimeout(n.timer),delete b[e]),i&&function(e,t){if(Object(_.removeEvent)(e,"touchstart",R,{passive:!0}),Object(_.removeEvent)(e,"touchmove",N,{capture:!1}),Object(_.removeEvent)(e,"touchcancel touchend",F,{passive:!0}),t)return Object(_.remove)(e),void j();e.classList.add("SnackbarItem--closing");if(!e)return;e.classList.add("SnackbarItem_removed"),setTimeout((function(){Object(_.remove)(e),j()}),600)}(i,t)}function I(e){return Object(f.$)(".SnackbarItem_"+e)}onDOMReady((function(){onBodyResize(j)}));var M=!1,P=null,D=!1,x=0,L=!1,B=Object(_.getCw)();function R(e){if(B=Object(_.getCw)(),e.touches&&e.touches.length>1)M=!1;else{var t=e.target.closest(".SnackbarItem");t.classList.add("SnackbarItem--dragging");var n=Object(_.domData)(t,"snackbar-id");if(B>=h.DESKTOP_WIDTH&&(L=!0),b[n].position===g){L=!1;var i=Object(f.$)(".messenger");B=Object(_.getW)(i),b[n].parentXY=Object(_.getXY)(i)}else b[n].parentXY=Object(_.getXY)(bodyNode);b[n].timer&&clearTimeout(b[n].timer),P=e.touches[0],x=e.touches[0].clientX,M=!0,D=n,document.body.style.overflow="hidden"}}function N(e){var t=D;if(e.preventDefault(),e.touches&&e.touches.length>1)M=!1;else if(P&&M){var n=e.touches[0],i=e.target.closest(".SnackbarItem"),a=-(x-n.clientX);L&&(a=Math.min(a,0));var r=Object(_.getX)(i),o=(Object(_.getW)(i)+a)/2+r-b[t].parentXY[0],s=o>=.95*B||o<=B/.95-B;b[t].canClose=s,_.setStyle.transform(i,1,[a,b[t].vertical])}}function F(e){var t=e.target.closest(".SnackbarItem");t.classList.remove("SnackbarItem--dragging");var n=Object(_.domData)(t,"snackbar-id"),i=b[n];if(b[n].dragging=!1,D=!1,document.body.style.overflow="visible",i.canClose){var a=Object(_.getX)(t)>0?Object(_.getCw)():-Object(_.getCw)();return Object(_.getCw)()>=h.DESKTOP_WIDTH&&(a=Object(_.getX)(t)>Object(_.getCw)()/2?Object(_.getCw)():-Object(_.getCw)()),_.setStyle.transform(t,1,[a,b[n].vertical||0]),void T(n)}b[n].timer=E(n,i.duration),t&&_.setStyle.transform(t,1,[0,b[n].vertical||0])}t.default=d;window.SnackbarItem=d},VRji:function(e,t,n){"use strict";n.r(t),n.d(t,"initAutogrow",(function(){return o}));var i=n("fdw3");var a=function(e){return void 0===e&&(e={}),Object(i.extend)({inner:[e.text],class:["Textarea",e.mix],name:e.name,placeholder:e.placeholder,rows:e.rows?e.rows:3,maxlength:e.maxlength,tag:"textarea"},e.attrs)},r=n("OcsD");function o(e,t){void 0===t&&(t=3);var n=Object(r.ce)("span",{className:"Textarea__ghost"});Object(r.setStyle)(n,{width:e.clientWidth+"px",padding:Object(r.getStyle)(e,"padding"),lineHeight:Object(r.getStyle)(e,"line-height")}),n.innerText="_",Object(r.append)(n,e.parentNode);var i=n.clientHeight;Object(r.addEvent)(e,"input",(function(){var a=e.value.replace(/ /g,"&nbsp;").replace(/\n/g,"<br />");("\n"===Object(r.last)(a)||a.endsWith("<br />"))&&(a+="&nbsp;"),n.innerHTML=a,e.rows=Math.max(1,Math.min(t,Math.ceil(n.clientHeight/i)))}))}t.default=a},VzJG:function(e,t,n){"use strict";n.r(t),n.d(t,"rebuildNotifications",(function(){return s})),n.d(t,"recordClick",(function(){return c})),n.d(t,"showMenuItems",(function(){return l}));var i=n("UxAg"),a=n("TYsd"),r=n("dONA"),o=n("zq7H");function s(){var e=Object(i.$)(".MainMenu__menu");if(e){var t=window.store.menuNotifications;if(t){var n=Object(i.$)(".MainMenu__menuItem--apps .MainMenu__menuItemTitle",e);if(n){var s=Object(i.$)('[data-id="menu-apps-notification"]',n);!t[o.COUNTERS_POS_APPS]&&s&&s.remove(),t[o.COUNTERS_POS_APPS]&&!s&&(n.innerHTML+=a.default.render(Object(r.default)({id:"menu-apps-notification"})))}}}}function c(e){window.ajax.post("/",{act:"menu_item_click_record",menu_item:e})}function l(e){Object(i.$$)(".MainMenu__menuItem--hidden").forEach((function(e){e.classList.remove("MainMenu__menuItem--hidden")})),e.classList.add("MainMenu__menuItem--hidden")}},W0P9:function(e,t,n){"use strict";n.r(t),n.d(t,"log",(function(){return r})),n.d(t,"warn",(function(){return o})),n.d(t,"error",(function(){return s})),n.d(t,"debug",(function(){return c}));var i=n("W9Tc");function a(){return window.console&&Object(i.partConfigEnabled)("js_console_logs")}function r(){var e;a()&&(window.console.log&&(e=window.console).log.apply(e,arguments))}function o(){var e;a()&&(window.console.warn?(e=window.console).warn.apply(e,arguments):r.apply(void 0,arguments))}function s(){var e;a()&&(window.console.error?(e=window.console).error.apply(e,arguments):r.apply(void 0,arguments))}function c(){var e;a()&&(window.console.debug?(e=window.console).debug.apply(e,arguments):r.apply(void 0,arguments))}},W38l:function(e,t,n){"use strict";n.r(t),n.d(t,"log",(function(){return s})),n.d(t,"mark",(function(){return c})),n.d(t,"error",(function(){return l})),n.d(t,"clean",(function(){return u})),n.d(t,"logQueueSize",(function(){return d}));var i={bluetooth:"2g",cellular:"2g",ethernet:"4g",mixed:"unknown",none:"none",other:"unknown",unknown:"unknown",wifi:"3g",wimax:"4g"};function a(){if(!1===navigator.onLine)return"none";var e=navigator.connection||navigator.webkitConnection||navigator.mozConnection;if(!e)return"unknown";if(e.effectiveType)return e.effectiveType;var t=+(e.downlinkMax||e.downlink);return t?t<50?"slow-2g":t<70?"2g":t<700?"3g":"4g":i[e.type]||"unknown"}var r=n("WwUR"),o={};function s(e,t){var n={action:t,startTime:Date.now(),networkType:a(),lpState:r.default.isLongPollingEnabled()};o[e]=n}function c(e,t){if(o[e]){var n=o[e],i=n.startTime,a=n.action,r=n.lpState,s=n.networkType;statlogsValueEvent("mvk_mail_send_time",Date.now()-i,a,t,r,s)}}function l(e,t,n){if(o[e]){var i=o[e],a=i.action,r=i.lpState,s=i.networkType;statlogsValueEvent("mvk_mail_send_error",0,a,t,n,r,s)}}function u(e){delete o[e]}function d(e){statlogsValueEvent("mvk_mail_send_queue_size",e,a())}},WCKs:function(e,t){},WWoJ:function(e,t,n){"use strict";n.r(t),n.d(t,"Row",(function(){return u})),n.d(t,"RowBtn",(function(){return d})),n.d(t,"RowLabeledText",(function(){return _})),n.d(t,"RowLabeledInput",(function(){return f})),n.d(t,"RowLabeledSelect",(function(){return p}));var i=n("8ZMO"),a=n("p5n7"),r=n("I7Du"),o=n("9y81"),s=n("29dZ"),c=n("z9sQ"),l=n("uBUF");function u(e){void 0===e&&(e={});var t=e.anchor,n=e.attrs||{},a=e.style||{},r=e.url,s=e.count,u=r&&!a.no_go_icon&&!s,d=e.tag;d||(d=r?"a":"div");var _=null;return u?_=Wd.wrap(Object(o.default)({mix:"Row__right",icon:"chevron_right"})):s&&(_={inner:[s],class:"Row__right Row__count",tag:"div"}),Object(l.CustomTag)({inner:[t?Object(i.default)({id:t}):null,_,e.icon?{inner:[e.icon],class:"Row__icon "+e.icon_class,tag:"div"}:null,e.content||e.inner],tag:d,class:[e.mix||e.class,c.default.class("Row",{go:u,style_withBorder:a.with_border,style_withBorderForce:a.with_border_force,style_withHover:a.with_hover,style_smallPaddings:a.small_paddings,style_noPaddingTop:a.no_padding_top,style_noPaddingBottom:a.no_padding_bottom,style_tinyPaddingTop:a.tiny_padding_top,style_tinyPaddingBottom:a.tiny_padding_bottom,paddingTop_short:a.padding_top_short},"_")],attrs:n,href:r,role:e.role})}function d(e){return u({content:Object(s.default)(e)})}function _(e){return h({anchor:e.anchor,url:e.url,label:e.label,content:e.text,is_mini:!0})}function f(e){return h({anchor:e.anchor,label:e.label,style:e.style,content:Object(a.default)(e)})}function p(e){return h({anchor:e.anchor,style:e.style,label:e.label,content:Object(r.default)(e)})}function h(e){return u({anchor:e.anchor,url:e.url,style:e.style,content:[m({is_mini:e.is_mini,label:e.label}),v({content:e.content})]})}function m(e){return{inner:[e.label],class:[c.default.class("Row__label",{mini:e.is_mini},"_"),e.class||""].join(" "),tag:"div"}}function v(e){return{inner:[e.content],class:["Row__labeledContent",e.class||""].join(" "),tag:"div"}}t.default=u},WwUR:function(e,t,n){"use strict";n.r(t);var i,a=n("OcsD"),r=n("+cqQ"),o=n("DM26"),s=n("cGUQ"),c=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),a=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,a++)i[a]=r[o];return i};!function(e){e[e.MENTIONS=1]="MENTIONS",e[e.CASPER=2]="CASPER"}(i||(i={}));var l=n("rudk"),u=function(e){var t=e[0],n=e[1],a=e[2],r=e[3],o=e[4],s=e[5],c=e[6],u=e[7],d=e[8],_=e[9],f=Object.assign({},s||{},c||{});return Array.isArray(f.marked_users)&&(f.marked_users=f.marked_users.filter((function(e){return Object.values(i).includes(e[0])}))),{messageId:t,flags:n,peerId:a,date:r,attaches:Object(l.convertKludgesToAttaches)(f,t),subject:s.title||"",text:o,kludges:f,randomId:u,userId:Object(l.isChatPeer)(a)?Number(f.from)||0:a,update_time:_,chat_local_id:d}};n("jE6c");var d=function(){return(d=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function _(e){switch(e[0]){case 0:return{type:"event_delete",localId:e[1]};case 1:return function(e){var t=e[1],n=e[2],i=e[3];return{type:"event_replace_flags",messageId:t,mask:n,peerId:i}}(e);case 2:return function(e){var t=e[1],n=e[2],i=e[3];return{type:"event_set_flags",messageId:t,flags:n,peerId:i}}(e);case 3:return function(e){var t=e[1],n=e[2],i=e[3];return{type:"event_reset_flags",messageId:t,flags:n,peerId:i}}(e);case 4:return function(e){var t=e[1],n=e[2],i=e[3],a=e[4],r=e[5],o=e[6],s=e[7],c=e[8],l=e[9],_=e[10],f=e[11];return d(d({type:"event_add_message"},u([Number(t),Number(n),Number(a),Number(r),o,s,c,l,_,f])),{minorSortId:i})}(e);case 5:return f(e);case 6:return function(e){var t=e[1],n=e[2],i=e[3];return{type:"event_read_inbound",peerId:t,upToId:n,unread:i}}(e);case 7:return function(e){var t=e[1],n=e[2],i=e[3];return{type:"event_read_outbound",peerId:t,upToId:n,unread:i}}(e);case 10:return function(e){var t=e[1],n=e[2],i=e[3];return{type:"event_reset_directories",peerId:t,mask:n,local:void 0!==i&&i}}(e);case 11:return function(e){var t=e[1],n=e[2];return{type:"event_replace_directories",peerId:t,mask:n}}(e);case 12:return function(e){var t=e[1],n=e[2],i=e[3];return{type:"event_set_directories",peerId:t,mask:n,local:void 0!==i&&i}}(e);case 13:return function(e){var t=e[1],n=e[2];return{type:"event_delete_dialog",peerId:t,localId:n}}(e);case 18:return function(e){var t=e[1],n=e[2],i=e[3],a=e[4],r=e[5],o=e[6],s=e[7],c=e[8],l=e[9],_=e[10];return d({type:"event_replace_message"},u([Number(t),Number(n),Number(i),Number(a),r,o,s,c,l,_]))}(e);case 19:return function(e){var t=e[1];return{type:"event_invalidate_event",messageId:t}}(e);case 20:return function(e){var t=e[1],n=e[2];return{type:"event_convo_major_id_changed",peerId:t,majorId:n}}(e);case 21:return function(e){var t=e[1],n=e[2];return{type:"event_convo_minor_id_changed",peerId:t,minorId:n}}(e);case 23:return function(e){var t=e[1],n=e[2];return{type:"peer_tags_changed",peerId:t,peerTagsMask:n}}(e);case 51:return function(e){var t=e[1],n=e[2];return{type:"event_chat_changed",chatId:t,self:n}}(e);case 52:return function(e){var t=e[1],n=e[2],i=e[3];return{type:"event_chat_updated",peerId:n,updateType:t,updateArg:i}}(e);case 63:return function(e){var t=e[1],n=e[2],i=e[3],a=e[4];return{type:"event_typing",peerId:t,userIds:n,totalCount:i,ts:a}}(e);case 64:return function(e){var t=e[1],n=e[2],i=e[3],a=e[4];return{type:"event_recoding_audio",peerId:t,userIds:n,totalCount:i,ts:a}}(e);case 70:return function(e){var t=e[1],n=e[2];return{type:"event_video_call",userId:t,callId:n}}(e);case 80:return function(e){var t=e[1],n=e[2],i=e[3];return{type:"event_unread_count",count:t,countNotMuted:n,showOnlyNotMuted:i}}(e);case 114:return function(e){var t=e[1]||{},n=t.peer_id,i=t.sound,a=t.disabled_until;return{type:"event_notify_settings_changed",peerId:n,sound:i,disabledUntil:a}}(e);case 115:return function(e){var t=e[1];return{type:"incoming_call",payload:t}}(e);case 116:return function(e){var t=e[1]||{},n=t.id,i=t.flags,a=t.peer_id,r=t.date,o=t.message,s=t.kludges,c=t.random_id,l=t.chat_local_id,u=t.update_time,d=t.title;return f([5,n,i,a,r,o,Object.assign({},s||{},{title:d||""}),{},c,l,u])}(e);case 117:return function(e){var t=e[1]||{},n=t.uuid,i=t.device_name;return{type:"event_audio_start",uuid:n,deviceName:void 0===i?"":i}}(e);case 119:return function(e){var t=e[1],n=t.event_id,i=t.owner_id,a=t.peer_id,r=t.action;return{type:"event_keyboard_callback_received",event_id:n,owner_id:i,peer_id:a,action:r}}(e);case 120:return{type:"peer_profile_tags_changed"};case-1:return{type:"event_resync"};case-2:return function(e){var t=e[1],n=e[2];return{type:"event_refresh_lp_key",key:t,url:n}}(e);case-3:return function(e){var t=e[1];return{type:"event_waiting_for_reconnect",timeout:t}}(e);case-4:return{type:"event_reconnecting"};case-5:return{type:"event_reconnected"};default:return function(e){return{type:"event_empty",params:e}}(e)}}function f(e){var t=e[1],n=e[2],i=e[3],a=e[4],r=e[5],o=e[6],s=e[7],c=e[8],l=e[9],_=e[10];return d({type:"event_edit_message"},u([Number(t),Number(n),Number(i),Number(a),r,o,s,c,l,_]))}var p=function(){return(p=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function h(e,t){e.waitAbortFns.push(t)}function m(e){if(e.isStoppedFn())return Promise.resolve({ts:0,updates:[]});var t=function(e,t,n){void 0===n&&(n={});var i=new XMLHttpRequest;return{request:new Promise((function(a,r){var o,c=Date.now(),l=n.timeout||60,u=Object(s.toQueryString)(t);i.onreadystatechange=function(){4==i.readyState&&(window.clearInterval(o),i.status>=200&&i.status<300?a([i.responseText,i]):r([i.responseText,i]))};try{i.open("GET",e+"?"+u,!0)}catch(e){return r([e,i])}i.send(),o=window.setInterval((function(){Date.now()-c>1e3*l&&(window.browser.safari&&i.abort(),r(["",{}]),window.clearInterval(o))}),1e3)})),cancel:function(){i.abort()}}}(e.url,{act:"a_check",key:e.key,version:e.version,ts:e.ts,wait:25,mode:e.mode}),n=t.request,i=t.cancel;return e.stopFn=i,window.lpDebug={startedAt:Date.now(),finishedAt:null,error:!1,request:n,cancel:i},n.then((function(t){var n=t[0],i=t[1];return window.lpDebug&&(window.lpDebug=p(p({},window.lpDebug),{finishedAt:Date.now(),request:null,cancel:null})),e.onData(e,i),e.waitTimeout=2,JSON.parse(n)})).catch((function(t){var n=t[1];return window.lpDebug&&(window.lpDebug=p(p({},window.lpDebug),{finishedAt:Date.now(),error:!0,request:null,cancel:null})),e.onData(e,n),Promise.reject(new Error(""))})).then((function(t){return function(e,t){var n=t.failed?Object(o.abortablePause)(4,null):{abort:function(){},pause:function(){return Promise.resolve()}},i=n.abort,a=n.pause;switch(t.failed){case 1:return h(e,i),e.onHistoryLost(e,t).then((function(){return e.onResult({ts:t.ts,updates:[[-1]]})})).then(a).then((function(){return m(e)}));case 2:return h(e,i),e.onKeyExpired(e,t).then((function(t){var n=t[0],i=t[1],a=t[2],r=t[3];return e.onResult({ts:+r,updates:[[-2,n,i+"/"+a],[-1]]})})).then(a).then((function(){return m(e)}));case 3:return e.onLpBroken(e,t);default:return Promise.resolve(t)}}(e,t)}))}function v(e){e.isStoppedFn()||m(e).then(e.onResult.bind(e)).then((function(){return e.isReconnecting&&g(e,-5)})).catch((function(t){return function(e,t){if(e.isStoppedFn())return;e.onRequestError(t),e.waitTimeout=Math.min(60,2*e.waitTimeout),g(e,-3);var n=Object(o.abortablePause)(e.waitTimeout,null),i=n.abort,a=n.pause;return h(e,i),a().then((function(){return g(e,-4)}))}(e,t)})).then((function(){return v(e)}))}function g(e,t){e.isReconnecting=-4===t,e.onResult({ts:e.ts,updates:[[t,e.waitTimeout]]})}function A(e){return e||function(){}}function b(e){return e?function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Promise.resolve(e.apply(void 0,t))}:function(){return Promise.reject()}}function w(e,t,n){var i=0,a=e,r=[],o=!1;function s(){!r.length||i>0||o||(t(r),r=[])}return{pause:function(){i++},resume:function(){i>0&&(i--,s())},onLp:function(e,t,i){o||(a>=e?(a=t,r.push.apply(r,i),s()):n&&(o=!0,n(a).then((function(e){var t=e[1],n=e[2];a=t,o=!1,r.push.apply(r,n),s()}))))}}}var y,O=function(){return(O=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};!function(e){e.Online="online"}(y||(y={}));var S=function(e){var t=this,n=e.getQueue,i=e.registerQueue;this.QUEUE_KEY_TTL=3e3,this.MAX_RETRIES=5,this.listeners=[],this.retriesLeft=this.MAX_RETRIES,this.restart=function(){t.intervalId&&clearInterval(t.intervalId),0!==t.retriesLeft&&(t.retriesLeft--,t.getQueue().then((function(e){t.retriesLeft=t.MAX_RETRIES;var n=O({},e);t.intervalId=window.setInterval((function(){t.registerQueue(n,(function(e,i){if(function(e){return void 0!==e.err}(i))t.restart();else{n.ts=i.ts;for(var a=0,r=i.events;a<r.length;a++)for(var o=r[a],s=0,c=t.listeners;s<c.length;s++)(0,c[s])(o)}}))}),t.QUEUE_KEY_TTL)})).catch((function(e){console.error(e),setTimeout(t.restart,t.QUEUE_KEY_TTL)})))},this.subscribe=function(e){return t.listeners.push(e),1===t.listeners.length&&t.restart(),function(){t.listeners=t.listeners.filter((function(t){return t!==e})),0===t.listeners.length&&(t.retriesLeft=t.MAX_RETRIES,t.intervalId&&clearInterval(t.intervalId))}},this.registerQueue=i,this.getQueue=n};var k=n("qHA9"),C=n("ZMWW"),j=n("L9Nh"),E={onNewMsg:Object(r.default)("{ peerId, msgId, authorId, text, date, hasAttachments, flags, isService }"),onEditMsg:Object(r.default)("{ peerId, msgId, authorId, text, date, hasAttachments, flags }"),onMsgReadByMe:Object(r.default)("msgId","dialogId"),onMsgReadByOther:Object(r.default)("msgId","dialogId"),onOnlineChange:Object(r.default)("{ userId, isOnline, onlinePlatform, lastActionTime }"),onConvoMinorIdChanged:Object(r.default)("peerId","{ minorSortId }"),onConvoMajorIdChanged:Object(r.default)("peerId","{ majorSortId }"),onTyping:Object(r.default)("dialogId","authorId"),onMultiTyping:Object(r.default)("peerId","userIds","totalCount"),onRecordingAudio:Object(r.default)("peerId","userIds","totalCount"),onMsgImportantRemove:Object(r.default)("msgId"),onMsgImportantAdd:Object(r.default)("msgId"),onMsgRequestChange:Object(r.default)("peerId","type"),onCallInProgress:Object(r.default)("peerId","inProgress"),onMsgRemove:Object(r.default)("msgId"),onMsgListen:Object(r.default)("msgId"),onMsgRestore:Object(r.default)("msgId"),onPeerKeyboard:Object(r.default)("peerId"),onPeerBanner:Object(r.default)("peerId"),onPeerConvert:Object(r.default)("peerId","convertId"),onPeerAdmin:Object(r.default)("peerId","userId","isAdmin"),onDialogImportant:Object(r.default)("peerId","isImportant"),onDialogMarkedUnread:Object(r.default)("peerId","isMarkedUnread"),onDialogPin:Object(r.default)("peerId"),onDialogUnpin:Object(r.default)("peerId"),onDialogAdTag:Object(r.default)("peerId"),onDialogRemove:Object(r.default)("peerId"),onUnreadCount:Object(r.default)("event"),onIncomingCall:Object(r.default)("event"),onKeyboardCallback:Object(r.default)("eventId","peerId","ownerId","action"),onResync:Object(r.default)(),_onLpEvents:Object(r.default)("Array<Object>"),init:function(e){E._lpConnect&&(E._onLpEvents.off(),E._lpConnect.stopConnection(),E._lpQueue=null,E._lpConnect=null),E._unsubscribeEventQueue&&(E._unsubscribeEventQueue(),E._unsubscribeEventQueue=null),E._lpConfig=e},isLongPollingEnabled:function(){return!(!E._lpConnect||E._lpConnect.isStopped())},on:function(){clog("[longpoll] start"),window.addEventListener("online",T),window.addEventListener("offline",T),E._unsubscribeEventQueue||E._createEventQueue(),E._lpConnect?E._lpConnect.reinitConnection():E._createLongpoll(E._lpConfig)},off:function(){clog("[longpoll] stop"),window.removeEventListener("online",T),window.removeEventListener("offline",T),E._lpConnect&&E._lpConnect.stopConnection(),E._unsubscribeEventQueue&&(E._unsubscribeEventQueue(),E._unsubscribeEventQueue=null)},pause:function(){clog("[longpoll] pause"),E._lpQueue&&E._lpQueue.pause()},resume:function(){clog("[longpoll] resume"),E._lpQueue&&E._lpQueue.resume()},abortWaiting:function(){clog("[longpoll] abort waiting"),E._lpConnect.abortWaiting()},_createLongpoll:function(e){if(!E._lpConnect){var t=w(e.ts,(function(e){E._onLpEvents(e)})),n=function(e,t){var n=!!e.stopped,i={id:e.id,key:e.key,ts:e.ts,url:e.url,lpstat:e.lpstat||0,version:e.version||14,mode:1226,waitTimeout:2,waitAbortFns:[],isReconnecting:!1,isStoppedFn:function(){return n},onResult:function(e){e.ts&&r(i.ts,e.ts,e.updates.map(_))},onData:A(t.onData),onRequestError:A(t.onRequestError),onHistoryLost:b(t.onHistoryLost),onKeyExpired:b(t.onKeyExpired),onLpBroken:b(t.onHistoryLost)},a=t.onEvents;function r(e,t,n){i.ts=t;for(var r=0;r<n.length;++r)"event_refresh_lp_key"===n[r].type&&(i.key=n[r].key||"",i.url=n[r].url||"");a(e,t,n)}var o={options:i,isStopped:function(){return n},stopConnection:function(){n=!0,i.stopFn&&i.stopFn(),i.stopFn=void 0,document.removeEventListener("resume",s),this.abortWaiting()},reinitConnection:function(){this.stopConnection(),document.addEventListener("resume",s),g(i,-4),n=!1,v(i)},abortWaiting:function(){i.waitAbortFns.forEach((function(e){return e()})),i.waitAbortFns=[],i.waitTimeout=2},onLp:r};function s(){o.abortWaiting()}return document.addEventListener("resume",s),v(i),o}(e,{onEvents:function(e,n,i){i.length?i.forEach((function(i){t.onLp(e,n,[i])})):t.onLp(e,n,[])},onHistoryLost:function(){clog("[longpoll] ts expired")},onKeyExpired:function(e){return clog("[longpoll] key expired"),t="/mail",(n={act:"get_key",user_id:e.id})&&(n.im_v=3),new Promise((function(e,a){window.ajax.post(t,n,{timeout:i,onDone:function(){e.apply(null,[c(arguments)])},onFail:function(){return a.apply(null,c(arguments)),!0}})}));var t,n,i},onLpBroken:function(){clog("[longpoll] broken, reload"),window.location.reload()}});E._lpQueue=t,E._lpConnect=n,E._onLpEvents((function(e){try{e.forEach(E._onEvent)}catch(e){console.error(e)}}))}},_onEvent:function(e){var t=e.type;switch("edu"===C.SAKIntegration.type&&C.SAKIntegration.sendMessage("longpoll",{event:e},"mvk_embedded_background"),t){case"event_replace_flags":var n=e.flags,i=e.messageId;e.peerId;8&n?E.onMsgImportantAdd(i):E.onMsgImportantRemove(i),128&n||64&n?E.onMsgRemove(i):E.onMsgRestore(i);break;case"event_set_flags":var r=e.flags,o=e.messageId;e.peerId;8&r&&E.onMsgImportantAdd(o),(128&r||64&r)&&E.onMsgRemove(o),4096&r&&E.onMsgListen(o);break;case"event_reset_flags":var s=e.flags,c=e.messageId;e.peerId;8&s&&E.onMsgImportantRemove(c),(128&s||64&s)&&E.onMsgRestore(c);break;case"event_add_message":case"event_edit_message":case"event_replace_message":var l=e.messageId,u=e.peerId,d=e.randomId,_=e.text,f=e.minorSortId,p=e.flags,h=e.attaches,m=e.kludges,v=e.date,g=Object(a.toInt)(m.from_admin)||null,A=function(e){if(2&e.flags)return E._lpConfig.id;return e.userId}(e),b=!!m.source_act,w="event_edit_message"===t||"event_replace_message"===t,y=2&p,O=!!(65536&p),S={peerId:u,id:l,authorId:A,attaches:h,text:_,ts:v,flags:p,adminId:g,randomId:d,isService:w?void 0:b,edited:!!w||void 0,replaced:"event_replace_message"===t,keyboard:m.keyboard,isStealth:O,isOut:y,hasReply:function(e,t){t&1<<21&&function(e){e.fwd_count}(e)}(m,p),hasTemplate:!!m.has_template,ttl:m.ttl||m.expire_ttl&&parseInt(m.expire_ttl)||null,isExpired:m.is_expired};w?E.onEditMsg(S):E.onNewMsg(S,f);break;case"event_read_inbound":case"event_read_outbound":var k=e.peerId,j=e.upToId;e.unread;"event_read_inbound"===t?E.onMsgReadByMe(j,k):E.onMsgReadByOther(j,k);break;case"event_reset_directories":case"event_set_directories":var T=e.mask,I=e.peerId;e.local;1&T?E.onDialogImportant(I,"event_set_directories"===t):32768&T?E.onDialogAdTag(I):T&1<<20&&E.onDialogMarkedUnread(I,"event_set_directories"===t);break;case"event_replace_directories":var M=e.mask,P=e.peerId;e.local;E.onDialogImportant(P,!!(1&M));break;case"event_delete_dialog":var D=e.peerId;E.onDialogRemove(D);break;case"event_convo_major_id_changed":var x=e.peerId,L=e.majorId;E.onConvoMajorIdChanged(x,{majorSortId:L});break;case"event_convo_minor_id_changed":var B=e.peerId,R=e.minorId;E.onConvoMinorIdChanged(B,{minorSortId:R});break;case"event_chat_updated":var N=e.peerId,F=e.updateType,H=e.updateArg;if(11===F&&E.onPeerKeyboard(N),10===F&&E.onPeerBanner(N),13===F&&E.onPeerConvert(H,N),12===F){var U="";switch(H){case 3:U="created";break;case 2:U="rejected";break;case 1:U="accepted";break;case 0:U="canceled"}E.onMsgRequestChange(N,U)}3===F&&E.onPeerAdmin(N,H,!0),9===F&&E.onPeerAdmin(N,H,!1),19===F&&E.onCallInProgress(N,H);break;case"event_typing":var V=e.peerId,W=e.userIds,$=e.totalCount;e.ts;E.onMultiTyping(V,W,$);break;case"event_recoding_audio":var q=e.peerId,z=e.userIds,Y=e.totalCount;e.ts;E.onRecordingAudio(q,z,Y);break;case"event_video_call":break;case"event_unread_count":E.onUnreadCount(e);break;case"event_notify_settings_changed":break;case"incoming_call":E.onIncomingCall(e);break;case"event_keyboard_callback_received":var G=e.owner_id,K=e.peer_id,Q=e.event_id,X=e.action;E.onKeyboardCallback(Q,K,G,X);break;case"event_resync":E.onResync()}},_createEventQueue:function(){if(!E._unsubscribeEventQueue){var e=new S({getQueue:function(){return Object(k.mailRequest)("/mail",{act:"queue_params"})},registerQueue:function(e,t){j.QueueManager.addQueue(e,t),j.QueueManager.start()}});E._unsubscribeEventQueue=e.subscribe(E._onEventQueueEvent)}},_onEventQueueEvent:function(e){switch(e.entity_type){case y.Online:E.onOnlineChange({userId:e.data.user_id,isOnline:e.data.online,onlinePlatform:[1,2,3,4,5].includes(e.data.platform)?"mobile":"desktop",lastActionTime:e.data.last_seen})}}};t.default=E;function T(e){"online"===e.type?(clog("[longpoll] online"),E._lpConnect.reinitConnection()):(clog("[longpoll] offline"),E._lpConnect.stopConnection())}},XCiN:function(e,t,n){"use strict";n.r(t);var i=n("izth");window.isBootstrapInited||(window.cur={destroy:[]},window.lang={},Object(i.setDocumentDomain)(),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),window.isBootstrapInited=!0)},XHVZ:function(e,t,n){"use strict";n.r(t),n.d(t,"ModuleNavigationStatMarks",(function(){return o})),n.d(t,"ModuleNavigationStatCollector",(function(){return s}));var i=n("o5u5"),a=n("XMCv"),r=n("T3FL"),o={web:{PERF_MARK:"__navmark",PERF_MEASURE:"__navmeasure"},mvk:{PERF_MARK:"__navmark_mvk",PERF_MEASURE:"__navmeasure_mvk"}},s=function(){function e(e){this.moduleNavigationStatCollector=e}return e.prototype.logEvent=function(e){var t,n,s,c=o[e],l=c.PERF_MARK,u=c.PERF_MEASURE,d=a.default.getConnectionEffectiveType(),_=r.navigationStat.getModule();try{window.performance.measure(u,l),s=null===(n=window.performance.getEntriesByType("measure").find((function(e){return e.name===u})))||void 0===n?void 0:n.duration}catch(e){}"performance"in window&&(window.performance.clearMeasures(u),window.performance.clearMarks(l)),s&&[d,_].every(Boolean)&&"unknown"!==_&&this.moduleNavigationStatCollector.logEvent(((t={network_type:"UNKNOWN",network_effective_type:d,type:i.NetworkStatEventTypes.TYPE_MODULE_NAVIGATION_STATS_ITEM})[i.NetworkStatEventTypes.TYPE_MODULE_NAVIGATION_STATS_ITEM]={value:Math.round(s).toString(),module:_},t))},e}()},XLP4:function(e,t){window.FeedAssistanceImportContacts={importContacts:function(e,t,i){if(!window.XMLHttpRequest||i)return;var a=domData(e,"service-id");return window.open(t),n[a]=e,!1}};var n={},i="feedAssistanceImportContacts__desc",a=!1;FeedAssistanceStats.registerTrackingCls("feedAssistance_importContacts"),FeedAssistanceStats.onStartViewElement((function(e){FeedAssistanceStats.getElementType(e)===FeedAssistanceStats.BLOCKS.BLOCK_TYPE_IMPORT_CONTACTS&&(a=!0)})),Friends.onImportSuccess((function(){var e=arguments[0],t=arguments[2],r=n[e];if(r){var o=geByClass1(i,r);o.textContent=getLang("mobile_join_friends_found_count",t)}a&&FeedAssistanceStats.dispatchEvent({type:FeedAssistanceStats.EVENTS.EVENT_FEED_ASSISTANCE,data:FeedAssistanceStats.serializeEventData(FeedAssistanceStats.EVENTS.EVENT_FEED_ASSISTANCE,r,"m_mp",FeedAssistanceStats.EVENTS.SUB_EVENT_FILLED)})})),Friends.onImportFailed((function(e){var t=n[e];t&&(geByClass1(i,t).textContent=getLang("mobile_friends_import_error"))}))},XMCv:function(e,t,n){"use strict";function i(){return navigator.connection||navigator.mozConnection||navigator.webkitConnection}function a(){var e=i();return e&&e.type||"unknown"}function r(){var e=i();return e&&e.effectiveType||"unknown"}n.r(t),t.default={getConnection:i,getConnectionType:a,getConnectionEffectiveType:r,getConnectionTypeID:function(){return{unknown:0,bluetooth:1,cellular:2,ethernet:3,none:4,wifi:5,wimax:6,other:7}[a()]||0},getConnectionEffectiveTypeID:function(){return{unknown:0,"slow-2g":1,"2g":2,"3g":3,"4g":4}[r()]||0}}},XNGt:function(e,t,n){"use strict";function i(e){for(var t=Array.from(e),n=[],i=0,a=null,r=0;r<t.length;r+=1){var o=t[r],s=o.offsetWidth,c=o.offsetLeft,l=o.offsetHeight;a=0===r?c:a,n.push({width:s,height:l,offsetLeft:c,marginLeft:a}),i<s&&(i=s)}for(var u=0;u<n.length;u+=1)n[u].width=i;return n}function a(e,t){Array.from(e).forEach((function(e,n){e.style.marginLeft=t[n].marginLeft+"px",e.style.width=t[n].width+"px",e.style.height=t[n].height+"px",e.style.flex="none"}))}function r(e,t,n){return-1*(e[t].offsetLeft+e[t].width/2-n/2)}function o(e,t){var n=e.timeStamp,i=e.touches,a=i?i[0]:e,r=a.clientX,o=a.clientY,s=t.to||{},c=s.x,l=void 0===c?r:c,u=s.y,d={x:r-l,y:o-(void 0===u?o:u)},_=n-(t.time||0);return{to:{x:r,y:o},offset:d,time:n,speed:{x:d.x/_,y:d.y/_},duration:_}}n.r(t),n.d(t,"LoopSlider",(function(){return u}));var s,c,l=n("OcsD"),u=function(){function e(e,t){this.container=null,this.scrollEl=null,this.items=null,this.centralElementIndex=0,this.dimensions=[],this.currentIndex=0,this.isTouchActive=!1,this.startOffset=null,this.startInfo=null,this.currentInfo=null,this.state=null,this.container=e,this.scrollEl=t,this.items=this.scrollEl.childNodes,this.handleTouchStart=this.handleTouchStart.bind(this),this.handleTouchMove=this.handleTouchMove.bind(this),this.handleTouchEnd=this.handleTouchEnd.bind(this),this.handleTransitionEnd=this.handleTransitionEnd.bind(this),this.resortSlides=this.resortSlides.bind(this),this.handleWindowDimensionsChange=this.handleWindowDimensionsChange.bind(this),this.handleDragstart=this.handleDragstart.bind(this),this.init()}var t=e.prototype;return t.init=function(){this.items.length<=1||(this.cloneSlides(),this.dimensions=i(this.items),a(this.items,this.dimensions),this.dimensions=i(this.items),this.setCentralSlidePosition(),this.scrollEl.style.width="max-content",this.setupCallbacks(),this.enableAutoscroll(),this.state="idle")},t.setupCallbacks=function(){Object(l.addEvent)(this.container,"dragstart",this.handleDragstart),Object(l.addEvent)(this.container,"mousedown touchstart",this.handleTouchStart),Object(l.addEvent)(this.container,"mousemove touchmove",this.handleTouchMove,{passive:!1}),Object(l.addEvent)(this.container,"mouseleave mouseup touchend touchcancel dragend",this.handleTouchEnd),Object(l.addEvent)(this.scrollEl,"transitionend",this.handleTransitionEnd),window.addEventListener("orientationchange",this.handleWindowDimensionsChange)},t.destroy=function(){this.disableAutoscroll(),cancelAnimationFrame(c),Object(l.removeEvent)(this.container,"dragstart",this.handleDragstart),Object(l.removeEvent)(this.container,"mousedown touchstart click",this.handleTouchStart),Object(l.removeEvent)(this.container,"mousemove touchmove",this.handleTouchMove),Object(l.removeEvent)(this.container,"mouseleave mouseup touchend touchcancel dragend",this.handleTouchEnd),Object(l.removeEvent)(this.scrollEl,"transitionend",this.handleTransitionEnd),window.removeEventListener("orientationchange",this.handleWindowDimensionsChange)},t.handleDragstart=function(e){e.target!==this.scrollEl&&(e.preventDefault(),e.stopPropagation())},t.handleTouchStart=function(e){this.isTouchActive||(this.initTouchEvent(e),this.disableAutoscroll())},t.initTouchEvent=function(e){this.startOffset=this.getScrollPosition(),this.startInfo=o(e,{}),this.currentInfo=this.startInfo},t.handleTouchMove=function(e){if(this.startInfo)if(this.currentInfo=o(e,this.startInfo),this.isTouchActive){e.cancelable&&e.preventDefault();var t=this.startOffset+this.currentInfo.offset.x;this.setScrollPosition(t)}else this.shouldMove(this.currentInfo)&&(this.isTouchActive=!0,this.initTouchEvent(e))},t.shouldMove=function(e){if("moving"===this.state||"resort"===this.state||"recalculating"===this.state)return!1;var t=e.offset;return 180*Math.atan(Math.abs(t.y)/Math.abs(t.x))/Math.PI<30},t.handleTouchEnd=function(e){if(this.startInfo=null,!this.isTouchActive||function(e){if(!e)return!1;var t=e.offset,n=e.duration;return Math.abs(t.x)<1&&Math.abs(t.y)<1&&n<200}(this.currentInfo))return t=e.target,void((n=t.closest("a"))&&n.href&&(window.location=n.href));var t,n;e.preventDefault(),e.stopPropagation(),this.go(this.currentInfo),this.enableAutoscroll(),this.isTouchActive=!1},t.cloneSlides=function(){var e=this.items;this.centralElementIndex=e.length;for(var t=document.createDocumentFragment(),n=document.createDocumentFragment(),i=0;i<e.length;i+=1)t.appendChild(e[i].cloneNode(!0)),e.length<4&&n.appendChild(e[i].cloneNode(!0));this.scrollEl.insertBefore(t,this.scrollEl.firstChild),this.scrollEl.appendChild(n)},t.go=function(e){var t=e.speed.x,n=Math.abs(t);if(0!==n){var i=t<0?-1:1,a=this.getScrollPosition();n>.6&&Math.abs(e.offset.x)<150&&(a+=i*Math.min(600*n,this.getContainerWidth()));var r=function(e,t,n){for(var i=null,a=null,r=n/2-e,o=0;o<t.length;o+=1){var s=t[o].offsetLeft+t[o].width/2,c=Math.abs(s-r);(null===i||c<i)&&(i=c,a=o)}return a}(a,this.dimensions,this.getContainerWidth());r===this.currentIndex&&n>.1&&(r=this.currentIndex-i),r-this.currentIndex>1&&(r=this.currentIndex+1),r-this.currentIndex<-1&&(r=this.currentIndex-1),this.scrollToSlide(r)}},t.resortSlides=function(){var e=this.centralElementIndex,t=this.scrollEl,n=this.currentIndex;if(e!==n){var i=document.createDocumentFragment();if(n>e){for(var a=n-e;a>0;)i.appendChild(t.childNodes[0]),a-=1;t.appendChild(i)}if(n<e){for(var r=e-n,o=t.childNodes.length-r;r>0;)i.appendChild(t.childNodes[o]),r-=1;t.insertBefore(i,t.firstChild)}this.setCentralSlidePosition()}},t.setScrollPosition=function(e){this.scrollEl.style.transform="translateX("+e+"px)"},t.getScrollPosition=function(){return parseFloat(this.scrollEl.style.transform.replace("translateX(",""))},t.getContainerWidth=function(){return this.container.offsetWidth},t.setCentralSlidePosition=function(){var e=r(this.dimensions,this.centralElementIndex,this.getContainerWidth());this.currentIndex=this.centralElementIndex,this.setScrollPosition(e)},t.scrollToSlide=function(e){this.state="moving",this.scrollEl.style.transition="transform 200ms cubic-bezier(.42,.65,.27,.99)";var t=r(this.dimensions,e,this.getContainerWidth());this.setScrollPosition(t),this.currentIndex=e},t.handleTransitionEnd=function(){var e=this;this.scrollEl.style.transition=null,this.state="resort",c=window.requestAnimationFrame((function(){e.resortSlides(),e.state="idle"}))},t.scrollToNext=function(){var e=(this.currentIndex+1)%this.items.length;this.scrollToSlide(e)},t.enableAutoscroll=function(){var e=this;s&&clearInterval(s),s=setInterval((function(){e.scrollToNext()}),4e3)},t.disableAutoscroll=function(){s&&(clearInterval(s),s=null)},t.handleWindowDimensionsChange=function(){var e,t=this;this.state="recalculating",e=this.items,Array.from(e).forEach((function(e){e.style.marginLeft="",e.style.width="",e.style.height="",e.style.flex=""})),this.scrollEl.style.width="",window.requestAnimationFrame((function(){setTimeout((function(){t.dimensions=i(t.items),a(t.items,t.dimensions),t.dimensions=i(t.items),t.setCentralSlidePosition(),t.state="idle"}))}))},e}()},Y6JH:function(e,t,n){"use strict";n.r(t);var i=n("fdw3");var a=function(e,t){void 0===t&&(t="");var n,a,r,o,s=e;if(t){var c=Object(i.inlineIconResolver)(t);c&&(s=c)}else Object(i.isObject)(e)&&Object(i.isObject)(e.icon)&&(s=e.icon);return Object(i.isObject)(s)||(s={name:e,icon:""}),Object(i.isSVGIconsPlaceholdersExperimentEnabled)()&&!Object(i.isJS)()?{name:s.name,tag:"svg-icon"}:(n={name:s.name,icon:s.icon},a=n.name,r=n.icon,o=Object(i.classNames)("svgIcon","svgIcon-"+a),{inner:[Wd.wrap(r)],"aria-hidden":"true",class:o,tag:"div"})};t.default=a;window.SVGIcon=a},"YU/R":function(e,t,n){"use strict";n.r(t),n.d(t,"ContextMenu",(function(){return r})),n.d(t,"ContextMenuItem",(function(){return o}));var i=n("OcsD"),a=n("wTbK");function r(e){return Object(a.default)({on_overlay_click:["return ContextMenu.close","this"],class:"ContextMenu",close:!0,onClose:["return ContextMenu.close","this"],items:[e.list?{tag:"ul",class:"ContextMenu__list",inner:e.withoutWrap?e.list:Wd.wrap(e.list)}:null]})}function o(e){return{inner:[{inner:[e.title],attrs:e.attrs,"data-ref":e.ref,href:e.href,target:e.target,class:"ContextMenu__listLink",onClick:e.onclick,tag:"a"}],class:"ContextMenu__listItem","data-name":e.name,tag:"li"}}var s=n("t7Ww"),c=n("UxAg"),l={open:function(e,t,n){void 0===n&&(n={});var i=n.menuEl;if(!i){var a=e.closest(t);i=Object(c.$)(d,a)}if(i)return i=s.default.open(i,n.appendToBody,"",{withoutPopupCloning:n.withoutPopupCloning}),u=function(){f(i)},nav.onBeforeGo(u),i;return!1},close:f},u=function(){},d=".ContextMenu",_=".ContextMenu.Popup_open";function f(e){return e||(e=Object(c.$)(".Popup_open.ContextMenu")||Object(c.$)(_)),e&&s.default.close(e),nav.onBeforeGo.off(u),!1}Object(i.extend)(r,l);t.default=r;window.ContextMenu=r},YuTi:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},ZD4m:function(e,t,n){"use strict";function i(e){var t=e.getBoundingClientRect();return{left:t.left,top:t.top}}function a(){var e=document.documentElement;return{width:e.clientWidth,height:e.clientHeight}}function r(e){var t=e.getBoundingClientRect(),n=t.width,i=t.height;return n&&i?{width:n,height:i}:{width:e.offsetWidth,height:e.offsetHeight}}n.r(t),n.d(t,"getElementOffset",(function(){return i})),n.d(t,"getViewportSize",(function(){return a})),n.d(t,"getElementSize",(function(){return r})),n.d(t,"getJsonDataValue",(function(){return o})),n.d(t,"setGlobalCustomProperty",(function(){return s}));var o=function(e,t){var n=e.getAttribute(t);if(n)try{return JSON.parse(n)}catch(e){return}},s=function(e,t){document.documentElement.style.setProperty(e,t)}},ZMWW:function(e,t,n){"use strict";n.r(t),n.d(t,"SAKIntegration",(function(){return a}));var i=n("Bm7g"),a={isIntegrated:!1,origin:"",name:"",type:"",onMessage:new(n("uQjJ").default),init:function(e){if(a.isIntegrated=!0,a.origin=function(e){var t=e.origin;if(!t)try{t=sessionStorage.getItem("_sak_embed_origin")}catch(e){}if(t)try{sessionStorage.setItem("_sak_embed_origin",t)}catch(e){}return t||""}(e),a.type=e.type,a.isNewMail=e.isNewMail,a._cleanUrl(),a.origin||window.parent!==window){var t=e.name||(a.isNewMail?"mvk_embedded_mail":"mvk_embedded_other");document.documentElement.style.setProperty("visibility","hidden","important"),a.name=t,a.embedded=new i.Embedded({name:t,target:window.parent,origin:a.origin,onMessage:function(e,t){a.onMessage.emit("embed",e,t),"click"===e&&a.doClick(t.selector)}}),a._ready=a.embedded.sendMessage("ready",{}).then((function(){document.documentElement.classList.remove("vk_sak_embed_hidden"),document.documentElement.style.removeProperty("visibility")}))}else document.documentElement.classList.remove("vk_sak_embed_hidden")},sendMessage:function(e,t,n){if(void 0===n&&(n=""),a.isIntegrated)if(a._ready){if(!n||!a.name||a.name===n)return a._ready.then((function(){return a.embedded.sendMessage(e,t)}))}else console.error("SAKIntegration not ready")},doClick:function(e){if(e){var t=document.querySelector(e);t&&t.click()}},reauth:function(){return a.embedded.sendMessage("sak:reauth",{}).catch((function(){return{}}))},_cleanUrl:function(){var e=location.search.slice(1).split("&").reduce((function(e,t){return t.startsWith("_sak_embed")||e.push(t),e}),[]).join("&");history.replaceState(null,"",location.pathname+"?"+e+location.hash)}}},a0wW:function(e,t,n){"use strict";n.r(t),n.d(t,"FLAG_MP4",(function(){return o})),n.d(t,"FLAG_GIF_AUTOPLAY",(function(){return s})),n.d(t,"FLAG_SUPPORTS_HISTORY_API",(function(){return c})),n.d(t,"FLAG_SUPPORTS_AUDIO_MESSAGES",(function(){return l}));var i=n("jk6M"),a=n("J8bf"),r={},o=0,s=1,c=2,l=3,u=[o,s,c,l],d=null,_=function(){function e(){}return e.getFeatures=function(){return r},e.detectMp4Support=function(){var t=i.default.meizu||i.default.mi||i.default.uc_mini||0!==i.default.ios&&i.default.ios<10||i.default.chrome&&i.default.version.split(".")[0]<53,n=!1,a=document.createElement("video");return a.canPlayType&&""!==a.canPlayType("video/mp4")&&(n=!0),r.mp4=n,e.setFlag(o,n&&!t),n},e.detectAutoplay=function(){var e=this;return new Promise((function(t){if(r.autoplay)t(!0);else{if(i.default.ios&&i.default.safari_mobile&&parseInt(i.default.version,10)>=10)return r.autoplay=!0,void t(!0);r.autoplay=!1;var n=ce("video"),a=ce("source");a.src="data:video/mp4;base64,AAAAFGZ0eXBNU05WAAACAE1TTlYAAAOUbW9vdgAAAGxtdmhkAAAAAM9ghv7PYIb+AAACWAAACu8AAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAnh0cmFrAAAAXHRraGQAAAAHz2CG/s9ghv4AAAABAAAAAAAACu8AAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAFAAAAA4AAAAAAHgbWRpYQAAACBtZGhkAAAAAM9ghv7PYIb+AAALuAAANq8AAAAAAAAAIWhkbHIAAAAAbWhscnZpZGVBVlMgAAAAAAABAB4AAAABl21pbmYAAAAUdm1oZAAAAAAAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAVdzdGJsAAAAp3N0c2QAAAAAAAAAAQAAAJdhdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAFAAOABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAAEmNvbHJuY2xjAAEAAQABAAAAL2F2Y0MBTUAz/+EAGGdNQDOadCk/LgIgAAADACAAAAMA0eMGVAEABGjuPIAAAAAYc3R0cwAAAAAAAAABAAAADgAAA+gAAAAUc3RzcwAAAAAAAAABAAAAAQAAABxzdHNjAAAAAAAAAAEAAAABAAAADgAAAAEAAABMc3RzegAAAAAAAAAAAAAADgAAAE8AAAAOAAAADQAAAA0AAAANAAAADQAAAA0AAAANAAAADQAAAA0AAAANAAAADQAAAA4AAAAOAAAAFHN0Y28AAAAAAAAAAQAAA7AAAAA0dXVpZFVTTVQh0k/Ou4hpXPrJx0AAAAAcTVREVAABABIAAAAKVcQAAAAAAAEAAAAAAAAAqHV1aWRVU01UIdJPzruIaVz6ycdAAAAAkE1URFQABAAMAAAAC1XEAAACHAAeAAAABBXHAAEAQQBWAFMAIABNAGUAZABpAGEAAAAqAAAAASoOAAEAZABlAHQAZQBjAHQAXwBhAHUAdABvAHAAbABhAHkAAAAyAAAAA1XEAAEAMgAwADAANQBtAGUALwAwADcALwAwADYAMAA2ACAAMwA6ADUAOgAwAAABA21kYXQAAAAYZ01AM5p0KT8uAiAAAAMAIAAAAwDR4wZUAAAABGjuPIAAAAAnZYiAIAAR//eBLT+oL1eA2Nlb/edvwWZflzEVLlhlXtJvSAEGRA3ZAAAACkGaAQCyJ/8AFBAAAAAJQZoCATP/AOmBAAAACUGaAwGz/wDpgAAAAAlBmgQCM/8A6YEAAAAJQZoFArP/AOmBAAAACUGaBgMz/wDpgQAAAAlBmgcDs/8A6YEAAAAJQZoIBDP/AOmAAAAACUGaCQSz/wDpgAAAAAlBmgoFM/8A6YEAAAAJQZoLBbP/AOmAAAAACkGaDAYyJ/8AFBAAAAAKQZoNBrIv/4cMeQ==";var o=ce("source");o.src="data:video/webm;base64,GkXfo0AgQoaBAUL3gQFC8oEEQvOBCEKCQAR3ZWJtQoeBAkKFgQIYU4BnQI0VSalmQCgq17FAAw9CQE2AQAZ3aGFtbXlXQUAGd2hhbW15RIlACECPQAAAAAAAFlSua0AxrkAu14EBY8WBAZyBACK1nEADdW5khkAFVl9WUDglhohAA1ZQOIOBAeBABrCBCLqBCB9DtnVAIueBAKNAHIEAAIAwAQCdASoIAAgAAUAmJaQAA3AA/vz0AAA=",append(o,n),append(a,n),n.style.position="fixed",n.style.left="5000px",attr(n,"id","base64testvideo"),attr(n,"playsinline","playsinline"),attr(n,"webkit-playsinline","webkit-playsinline"),attr(n,"muted","muted"),attr(n,"autoplay","autoplay"),attr(n,"loop","loop"),append(n,document.body);var s=ge("base64testvideo");if(i.default.mobile&&i.default.ios&&i.default.ios<10)return r.autoplay=!1,remove(n),t(!1),void clearTimeout(e.autoDetectTimeout);if(!i.default.safari_mobile||i.default.safari_mobile&&parseInt(i.default.version,10)>=10){var c=n.play();void 0!==c&&c.then((function(){r.autoplay=!0,remove(n),t(!0),clearTimeout(e.autoDetectTimeout)})).catch((function(i){r.autoplay=!1,remove(n),t(!1),clearTimeout(e.autoDetectTimeout)}))}s.onplay=function(){r.autoplay=!0,remove(n),t(!0),clearTimeout(e.autoDetectTimeout)},e.autoDetectTimeout=setTimeout((function(){s.paused||(r.autoplay=!0),remove(n),t(r.autoplay)}),250)}}))},e.detectAudioMessagesSupport=function(){var t=!(!window.AudioContext&&!window.webkitAudioContext)&&window.isNewMail,n=e.getFlag(l);this.setFlag(l,t),!n&&t&&window.cur.module},e.getFlags=function(){return(d||Object(a.getCookie)("remixff")||"").split("").map((function(e){return+e?"1":"0"})).join("")},e.getFlag=function(e){var t=this.getFlags();return!!toInt(t[e])},e.setFlag=function(e,t){void 0===t&&(t=!1),Object(a.setCookie)("remixff","",-1,!0,"None",location.host,{withoutSubdomains:!0});var n=(Object(a.getCookie)("remixff")||"").split(""),i=new Array(u.length).fill("0").map((function(e,t){return n[t]||"0"}));i[e]=t?"1":"0";var r=i.join("");d=r,Object(a.setCookie)("remixff",r,10,!0)},e}();onDOMReady((function(){_.detectAudioMessagesSupport(),_.detectMp4Support()})),t.default=_},aJgW:function(e,t,n){"use strict";n.r(t),n.d(t,"ColorSchemeMode",(function(){return i})),n.d(t,"ColorSchemeName",(function(){return a})),n.d(t,"ColorScheme",(function(){return s})),n.d(t,"colorScheme",(function(){return o}));var i,a,r=n("J8bf");!function(e){e.Light="light",e.Dark="dark",e.Auto="auto"}(i||(i={})),function(e){e.Dark="space_gray",e.Light="bright_light"}(a||(a={}));var o,s=function(){function e(){this.currentMode="",this.subscribers=[],this.initSubscribers=[],this.isExecuted=!1,this.isModeSavingAllowed=!0,this.isSchemeSavingAllowed=!0}return e.prototype.init=function(t){var n=this;this.isExecuted||(this.schemesMap=t.schemesMap,this.setMode(t.mode),this.initSubscribers.forEach((function(e){e()})),e.isSchemesAutoSwitchingSupported()&&(window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(function(e){n.currentMode===i.Auto&&n.setScheme(e.matches)})),this.isExecuted=!0))},e.prototype.setScheme=function(t){e.isSchemesSupported()&&(this.applyScheme(document.body,t?a.Dark:a.Light),this.currentIsDark=t,this.isSchemeSavingAllowed&&Object(r.setCookie)("remixdark_color_scheme",Number(t),365),this.subscribers.forEach((function(e){e()})))},e.prototype.isDarkScheme=function(){return this.currentIsDark},e.prototype.getMode=function(){return this.currentMode},e.prototype.setMode=function(t){this.currentMode=t;var n=!1;switch(t){case i.Light:n=!1;break;case i.Dark:n=!0;break;case i.Auto:if(e.isSchemesAutoSwitchingSupported())n=window.matchMedia("(prefers-color-scheme: dark)").matches}this.setScheme(n),this.isModeSavingAllowed&&Object(r.setCookie)("remixcolor_scheme_mode",t,365)},e.prototype.applyScheme=function(e,t){var n,i=(null===(n=this.schemesMap)||void 0===n?void 0:n[t])||t;e.setAttribute("scheme",i)},e.prototype.subscribe=function(e){var t=this;return this.subscribers.push(e),function(){t.subscribers=t.subscribers.filter((function(t){return e!==t}))}},e.prototype.onInit=function(e){var t=this;return this.initSubscribers.push(e),function(){t.initSubscribers=t.initSubscribers.filter((function(t){return e!==t}))}},e.isSchemesSupported=function(){return window.isNewMail&&window.CSS&&CSS.supports&&CSS.supports("color","var(--custom-property)")},e.isSchemesAutoSwitchingSupported=function(){return window.matchMedia&&window.matchMedia("(prefers-color-scheme)").matches},e}();o=window.colorScheme?window.colorScheme:new s,window.colorScheme=o,window.isSchemesSupported=s.isSchemesSupported.bind(null)},"aiw/":function(e,t,n){"use strict";n.r(t),n.d(t,"onOpen",(function(){return q})),n.d(t,"onClose",(function(){return z})),n.d(t,"isKeyboardOpen",(function(){return Y})),n.d(t,"onCloseCallback",(function(){return G})),n.d(t,"offCloseCallback",(function(){return K})),n.d(t,"onOpenCallback",(function(){return Q})),n.d(t,"offOpenCallback",(function(){return X}));var i=0,a=0,r=null,o=null;function s(){var e=pageYOffset;e!==i&&999999!==e&&(i=e,a=Math.max(a,e),scrollTo(0,999999)),clearTimeout(o),o=setTimeout((function(){o=null,window.removeEventListener("scroll",s),scrollTo(0,999999),setTimeout((function(){return scrollTo(0,999999)}),1e3)}),150)}var c,l,u,d,_,f,p,h,m,v=n("H5mD"),g=0,A=0,b="",w=!1,y={},O=0;function S(e){if(b=e,w=!1,c=!1,u=0,d=0,f=0,p=0,y={},void 0,h="start",m=0,O=0,v.isIPhone)if("top"===b||"bottom"===b){I()<v.IPHONE_KEYBOARD_REJECT_OFFSET&&M(0);var t=document.body;_=t.offsetHeight,t.offsetWidth,window.addEventListener("scroll",C),"top"===b&&Object(v.isLandscapePhone)()||(E(),j())}else document.body.classList.add("ScrollViewsDisabled")}function k(){"top"===b||"bottom"===b?(l&&clearTimeout(l),window.removeEventListener("scroll",C)):document.body.classList.remove("ScrollViewsDisabled"),w=!1,b="",c=!1,_=0,0}function C(){if(E(),"top"!==b){if("bottom"===b){var e=pageYOffset,t=I();c&&(c=!1,e===f)||(v.isWKWebView?p<=5&&j():e>v.IPHONE_KEYBOARD_REJECT_OFFSET?e>t?(M(e),v.isWKWebView||j()):e<t?y[e]||e>T(t)?(y[e]=!0,j(_)):j():e!==T(t)&&j():t||(e<v.IOS_NO_KEYBOARD_ALLOWED_OFFSET?(u===e?d++:(u=e,d=1),d>=3&&(window.removeEventListener("scroll",C),M(u)),setTimeout((function(){j()}),300)):j()))}}else{if(Object(v.isLandscapePhone)())return;if(v.isWKWebView)return void(0!==pageYOffset&&j(0));var n=innerHeight;if("start"===h&&(n<_?h="animate":j(1)),"animate"===h)if(m=_-n,O||(O=Math.max(1,Math.min(4,Math.floor(m/10)))),m<=0)h="stop";else{var i=v.isIPad?v.iosMajor<11?3:2:1;j(Math.min(m,O)*i)}"stop"===h&&j(1)}}function j(e){c=!0;var t,n=I();"bottom"===b?t=e||(!n||v.isWKWebView||v.isIPad?_:T(n)):"top"===b&&(t=isFinite(e)?e:1),p++,f=t,window.scrollTo(0,t)}function E(){l&&clearTimeout(l),w||(l=setTimeout((function(){w=!0,l=null,window.removeEventListener("scroll",C)}),500))}function T(e){return v.isIPad||v.isWKWebView||90===Math.abs(window.orientation)&&screen.width>=375||(v.isIPhoneX?e-=v.IPHONE_X_SAFARI_BOTTOM_BAR:e-=v.IPHONE_SAFARI_BOTTOM_BAR),e}function I(){return 90===Math.abs(window.orientation)?g:A}function M(e){90===Math.abs(window.orientation)?g=e:A=e}var P=null,D=0,x=0;function L(){if(!(visualViewport.height>=D)){var e=D-visualViewport.height;x!==e&&(!v.isWKWebView&&e<v.IOS_NO_KEYBOARD_ALLOWED_OFFSET?scrollTo(0,0):scrollTo(0,e))}}var B=!1,R=!1,N=!1,F=null,H=[],U=[],V=null,W=v.isScrollBasedViewport&&(v.isIPad||v.isWKWebView),$=v.isScrollBasedViewport&&v.iosMajor<=12;function q(e,t){void 0===e&&(e="default");var n=(void 0===t?{}:t).exitIfStarted,c=void 0!==n&&n;if(v.isIOS&&!(v.iosMajor<8)&&!(R&&c||B)){if(V=e,R=!0,F&&(clearTimeout(F),F=null),"bottom"===e){if((Object(v.isLandscapePhone)()||!W&&!$)&&!function(){if(P||(P={onceBlocked:!1}),P.onceBlocked&&(P.opened=!0),!P.onceBlocked&&!P.opened){P.onceBlocked=!0;var e=document.activeElement;return e.blur(),e.focus(),!1}return P.opened=!0,window.visualViewport&&(D=visualViewport.height,x=0,setTimeout(L),visualViewport.addEventListener("scroll",L),visualViewport.addEventListener("resize",L)),!0}())return;!W&&$&&S(e),W&&function(e){void 0===e&&(e="default"),r&&(clearTimeout(r),r=null),o&&(clearTimeout(o),o=null),i=0,0,0,a=0,window.addEventListener("scroll",s),setTimeout((function(){scrollTo(0,999999)}),10),setTimeout((function(){scrollTo(0,999999)}),100),setTimeout((function(){scrollTo(0,999999)}),200),setTimeout((function(){scrollTo(0,999999)}),300),setTimeout((function(){scrollTo(0,999999)}),400),setTimeout((function(){scrollTo(0,999999)}),500)}()}else!W&&$&&S(e);U.length&&U.forEach((function(e){return e()})),B=!0,R=!1}}function z(e){var t=(void 0===e?{}:e).exitIfStarted,n=void 0!==t&&t;if(v.isIOS&&!(v.iosMajor<8)&&(!N||!n)){if(N=!0,"bottom"===V){if((Object(v.isLandscapePhone)()||!W&&!$)&&(!P||P.onceBlocked&&!P.opened||(window.visualViewport&&(setTimeout(L),visualViewport.removeEventListener("scroll",L),visualViewport.removeEventListener("resize",L)),P=null,D=0,x=0,0)))return;if(!B)return;!W&&$&&k(),W&&(clearTimeout(r),clearTimeout(o),i=0,0,0,r=null,o=null,window.removeEventListener("scroll",s))}else!W&&$&&k();B=!1,N=!1,V=null,F&&clearTimeout(F),F=setTimeout((function(){scrollTo(0,0),H.length&&H.forEach((function(e){return e()}))}),10)}}function Y(){return B}function G(e){-1===H.indexOf(e)&&H.push(e)}function K(e){var t=H.indexOf(e);-1!==t&&H.splice(t,1)}function Q(e){-1===U.indexOf(e)&&U.push(e)}function X(e){var t=U.indexOf(e);-1!==t&&U.splice(t,1)}},asMm:function(e,t,n){"use strict";n.r(t),n.d(t,"ORDER_PAYMENT_SUCCESS_WAITING_TIME_IN_SEC",(function(){return p})),n.d(t,"getPaymentSessionInitialData",(function(){return h})),n.d(t,"handlePaymentComponentChange",(function(){return m})),n.d(t,"handlePaymentComponentDestroy",(function(){return v})),n.d(t,"handleRequestAbortOnDestroy",(function(){return g})),n.d(t,"getPaymentWindow",(function(){return A})),n.d(t,"getOrderPaymentWindow",(function(){return b})),n.d(t,"closePaymentWindow",(function(){return w})),n.d(t,"getOrderPaymentUrl",(function(){return y})),n.d(t,"getOrderIsPaidCheckUrl",(function(){return O})),n.d(t,"showOrderPaymentInfo",(function(){return S})),n.d(t,"showOrderPaymentInfoSuccess",(function(){return k})),n.d(t,"showOrderPaymentInfoError",(function(){return C})),n.d(t,"showOrderPaymentInfoTimeout",(function(){return j})),n.d(t,"showOrderPaymentInfoLoading",(function(){return E})),n.d(t,"startPaymentWaiting",(function(){return T})),n.d(t,"startOrderPaymentWaiting",(function(){return I}));var i=n("+cqQ"),a=n("UxAg"),r=n("j80l"),o=n("OcsD"),s=n("TYsd"),c=n("NroU"),l=n("Y6JH"),u=n("qDz2"),d=n("P6H+"),_=n("Fbxv"),f=n("qBU/"),p=40,h=function(){return{id:0}},m=function(e,t){void 0===e&&(e=h());var n=e.id+1;e.id=n,t.sessionId=n},v=function(e,t){Object(i.onEmitOnce)(window.nav.onBeforeGo,(function(){return m(e,t)}))},g=function(e){Object(i.onEmitOnce)(window.nav.onBeforeGo,(function(){return e.abort()}))},A=function(e){var t=window.open("");return null==t||t.focus(),null==t||t.document.write(e),Object(i.onEmitOnce)(window.nav.onBeforeGo,(function(){return null==t?void 0:t.close()})),t||void 0},b=function(){return A(Object(o.getLang)("mobile_market_cart_payment_info_waiting"))},w=function(e){return e&&e.close()},y=function(e){var t=e.userId,n=e.orderId,i=e.hash,a=window.ajax.post("/market.php",{act:"cart_get_payment_url_by_order",order_user_id:t,order_id:n,hash:i});return g(a),a.promise.then((function(e){var t=e.json;if(!e.skip){if(!t||!t.data||!t.data.length)throw Error();return decodeURIComponent(t.data[0])}}))},O=function(e){var t=e.orderId,n=e.userId;return Object(r.makeUrl)("/market.php",{act:"cart_check_payment_by_order",order_id:t,order_user_id:n})},S=function(e){var t=e.icon,n=e.title,i=e.description,r=e.type,p=e.continueButtonURL,h=Object(a.$)('[data-section-ref="payment_content"]');if(h){var m=t||function(e){switch(e){case"error":return{inner:[Object(l.default)({icon:Object(d.getErrorOutline56Icon)()})],class:"SplashScreen__icon",tag:"div"};case"timeout":return{inner:[Object(l.default)({icon:Object(f.getRecentOutline56Icon)()})],class:"SplashScreen__icon",tag:"div"};case"loading":return{inner:[Object(l.default)({icon:Object(_.getLoading40Icon)()})],class:"SplashScreen__icon SplashScreen__icon--loading",tag:"div"};case"success":default:return{inner:[Object(l.default)({icon:Object(u.getCheckCircleOutline56Icon)()})],class:"SplashScreen__icon",tag:"div"}}}(r);try{h.innerHTML=s.default.html(Object(c.CartOrder_info)({icon:m,title:n||Object(o.getLang)("mobile_market_cart_payment_info_error"),description:i||"",actionText:Object(o.getLang)("mobile_market_cart_payment_button"),actionUrl:p||window.nav.path}))}catch(e){console.error(e)}}},k=function(e){var t=e.description,n=e.continueButtonURL;S({description:t,continueButtonURL:n,title:Object(o.getLang)("mobile_market_cart_payment_info_success"),type:"success"})},C=function(e){var t=(void 0===e?{continueButtonURL:void 0}:e).continueButtonURL;S({continueButtonURL:t,title:Object(o.getLang)("mobile_market_cart_payment_info_error"),description:Object(o.getLang)("mobile_market_cart_payment_info_canceled_text"),type:"error"})},j=function(e){var t=(void 0===e?{continueButtonURL:void 0}:e).continueButtonURL;S({continueButtonURL:t,title:Object(o.getLang)("mobile_market_cart_payment_info_success"),description:Object(o.getLang)("mobile_market_cart_payment_info_success_later_text"),type:"timeout"})},E=function(e){var t=e.title,n=e.description,i=e.continueButtonURL;S({title:t,description:n,continueButtonURL:i,type:"loading"})},T=function(e){var t=e.sessionIdCurrent,n=e.paymentURL,a=e.paymentWindow,r=e.waitingTimeSec,o=void 0===r?5:r,s=e.getIsSuccess,c=e.onLoading,l=e.onResponse,u=e.onCancel,d=e.onFailure,_=e.onTimeout,f=t;window.clog("Open VK Pay window. Starting payment check"),a.location.href=n,c();var p=setInterval((function(){if(f!==t)return clearInterval(p),void m();a&&a.window&&!a.window.closed||(window.clog("VK Pay window was manually closed. Unsubscribing from events"),clearInterval(p),m(),u())}),500),h=function(e){if(f===t)if("externalAppDone"===e.data.method&&e.data.params.status){window.clog("Received VK Pay done event. Waiting for payment success check"),m(),clearInterval(p);var n=Date.now(),i=!0,a=setInterval((function(){return f!==t?(clearInterval(a),void(i=!1)):i?Date.now()-n>=1e3*o?(window.clog("Payment check timeout. Showing done info."),clearInterval(a),i=!1,void _()):void s().then((function(e){if(!i||!e)return!1;window.clog("Payment check succeeded. Showing done info"),clearInterval(a),i=!1})).catch((function(){window.clog("Received VK Pay close or fail event. Unsubscribing from events"),clearInterval(a),d()})):void 0}),1e3);l&&l()}else"closeApp"!==e.data.method&&"externalAppFail"!==e.data.method||(window.clog("Received VK Pay close or fail event. Unsubscribing from events"),m(),d());else m()};window.addEventListener("message",h,!1);var m=function(){window.removeEventListener("message",h,!1)};Object(i.onEmitOnce)(window.nav.onBeforeGo,(function(){m()}))},I=function(e){var t=e.paymentComponent,n=e.checkIsPaidUrl,i=e.sessionIdCurrent,a=e.paymentURL,r=e.paymentWindow,s=e.onCancel,c=e.onFail,l=e.onTimeout;return T({sessionIdCurrent:i,paymentURL:a,paymentWindow:r,waitingTimeSec:p,getIsSuccess:function(){var e=window.ajax.post(n,{});return g(e),e.promise.then((function(e){var n,a=e.json;if(!e.skip){if(i!==t.sessionId)throw Error();if(!a)throw Error();return!!(null===(n=null==a?void 0:a.data)||void 0===n?void 0:n[0].status)&&(k({description:a.data[0].text}),!0)}}))},onLoading:function(){E({title:Object(o.getLang)("mobile_market_cart_payment_info_waiting"),description:Object(o.getLang)("mobile_market_cart_payment_info_waiting_text")})},onCancel:function(){s&&s(),C()},onFailure:function(){c&&c(),C()},onTimeout:function(){l&&l(),j()}})}},b6Sp:function(e,t,n){"use strict";function i(e,t){var n=t;return e&&(n=[e]).push(t),n}function a(e){var t=e.elements,n={};return Array.from(t).forEach((function(e){if(e.name)switch(e.type){case"submit":break;case"radio":e.checked&&(n[e.name]=e.value);break;case"checkbox":e.checked&&(n[e.name]=i(n[e.name],e.value));break;default:n[e.name]=i(n[e.name],e.value)}})),n}n.r(t),n.d(t,"getFormValues",(function(){return a}))},bKAG:function(e,t,n){"use strict";n.r(t),n.d(t,"MAX_STORY_VIDEO_DURATION",(function(){return l})),n.d(t,"StoryType",(function(){return i})),n.d(t,"StoryEntryPoint",(function(){return a})),n.d(t,"StorySource",(function(){return r})),n.d(t,"getStoryUploadUrl",(function(){return u})),n.d(t,"uploadStoryBlobToServer",(function(){return d})),n.d(t,"saveStoryOnServer",(function(){return _}));var i,a,r,o=n("jE6c"),s=n("PU8N"),c=function(){return(c=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},l=16;function u(e){return new Promise((function(t,n){window.ajax.post(Object(s.isMvk)()?"stories.php":"al_stories.php",c({act:"get_upload_url"},e),{onDone:t,onError:n,onFail:n})}))}function d(e,t){var n=new FormData,i=encodeURIComponent("edited_"+Object(o.irand)(0,99999)+".jpg");return n.append("file0",e,i),fetch(t,{method:"POST",body:n}).then((function(e){return e.json()}))}function _(e,t){return new Promise((function(n,i){window.ajax.post(Object(s.isMvk)()?"stories.php":"al_stories.php",{act:"save",upload_result:e,hash:t},{onDone:n,onError:i,onFail:i})}))}!function(e){e.PHOTO="photo",e.VIDEO="video"}(i||(i={})),function(e){e.SWIPE="swipe",e.NAVIGATION_BUTTON="navigation_button",e.SIT_POSTING="sit_posting",e.LINK="link",e.STORY_REPLY="story_reply",e.STORY_REPOST="story_repost",e.CATALOG_ADD="catalog_add",e.DIALOG="dialog",e.STORY_LIVE_FINISHED="story_live_finished",e.DIALOG_VKME="dialog_vkme",e.STORY_VIEWER_FINISHED="story_viewer_finished",e.PUSH_TRY_MASK="push_try_mask",e.STORY_VIEWER_TRY_MASK="story_viewer_try_mask",e.LINK_MASK="link_mask",e.POSTING="posting",e.NEW_STORY_AVATAR="new_story_avatar",e.STORY_REPLIES_LIST="story_replies_list",e.STORIES_FEED="stories_feed",e.STORIES_SEARCH_NEWS="stories_search_news",e.QUESTION_STICKER="question_sticker",e.LIST_MIDDLE="list_middle",e.ARCHIVE_EMPTY_BUTTON="archive_empty_button",e.ARCHIVE_MENU_BUTTON="archive_menu_button",e.IM="im",e.PROFILE_BUTTON="profile_button",e.SHARE="share",e.MINI_APP="mini_app",e.SYSTEM_SHARING="system_sharing",e.SHORTCUT="shortcut",e.ARCHIVE_SHARING="archive_sharing",e.STORY_VIEWER_CAMERA_BUTTON="story_viewer_camera_button",e.STORY_VIEWER_MUSIC="story_viewer_music",e.STORY_VIEWER_MUSIC_SHEET="story_viewer_music_sheet",e.REPOST_TO_STORY_ACTIVITY="repost_to_story_activity",e.CHANGE_AVATAR="change_avatar"}(a||(a={})),function(e){e.FEED="feed",e.FEED_MIDDLE="feed_middle",e.LINK="link",e.PROFILE="profile",e.IM_DIALOGS="im_dialogs",e.IM_DIALOG_HEADER="im_dialog_header",e.SNIPPET="snippet",e.REPLY="reply",e.REPLIES_LIST="replies_list",e.REPLY_STORY="reply_story",e.DISCOVER="discover",e.STORIES_MANAGE="stories_manage",e.USER_PERSONAL_CARD="user_personal_card",e.GROUP_PERSONAL_CARD="group_personal_card",e.NARRATIVE_SNIPPET="narrative_snippet",e.NARRATIVE_STORY="narrative_story",e.NARRATIVE_LINK="narrative_link",e.NARRATIVE_RECOMMENDATIONS="narrative_recommendations",e.NARRATIVE_SECTION="narrative_section",e.FAVE="fave",e.SPAMFEED="sf",e.ADS_PREVIEW="ads_preview",e.LIST_MIDDLE="list_middle",e.PLACE_STORY_LIST="place_story_list",e.SEARCH_STORY_LIST="search_story_list",e.STORY_ARCHIVE="story_archive",e.IM_MSG_LIST="im_msg_list",e.NOSPAM="nospam",e.PROFILE_SNACKBAR="profile_snackbar"}(r||(r={}))},bRFj:function(e,t){window.Friends={onImportSuccess:befall("serviceId","friendsHtml","total"),onImportFailed:befall("serviceId"),accept:function(e,t,i,a,r,o,s,c){void 0===i&&(i="");void 0===a&&(a=null);void 0===r&&(r="");void 0===o&&(o="");void 0===s&&(s=null);void 0===c&&(c=null);n("accept",e,t,i,a,r,o,s,c)},decline:function(e,t,i,a,r,o,s,c){void 0===i&&(i="");void 0===a&&(a=null);void 0===r&&(r="");void 0===o&&(o="");void 0===s&&(s=null);void 0===c&&(c=null);n("decline",e,t,i,a,r,o,s,c)},makeImportRequest:function(e,t,n){if(!window.XMLHttpRequest)return void(window.location=e);ajax.plainpost(e,{_ajax:1},(function(e){return function(e,t,n){var a=parseJSON(e),r=a.user,o=a.user_hash,s=a.contacts,c="/friends.php?act=save_contacts&type="+n;if(a.error)return void i(n);ajax.post(c,{_ajax:1,user:r,userhash:o,hash:t,contacts:s},{onDone:function(e,t){return function(e,t,n){var i=geByClass1("friendsImport__loading"),a=geByClass1("friendsImport__result");addClass("friendsImport__loading_hidden",i),a&&(a.innerHTML=t,addClass("friendsImport__result_shown",a));autoScroll((function(){return geByClass1("friendsList__footerBtn_showMore")}),ImportedFriends,{no_cache:!0}),Friends.onImportSuccess(e,t,n),window.opener&&window.opener.Friends.onImportSuccess(e,t,n)}(n,e,t)},onFail:function(){return i(n)}})}(e,t,n)}),(function(){return i(n)}),!0)}};function n(e,t,n,i,a,r,o,s,c){var l={act:e,hash:n,id:t};i&&(l.from=i),a&&(l.block_id=a),r&&(l.ref=r),o&&(l.track_code=o);var u="/friends"+obj2qs(l);ajax.post(u,{_ajax:1},{onDone:s,onFail:c})}function i(e){Friends.onImportFailed(e),window.opener&&(window.opener.Friends.onImportFailed(e),window.close())}},"bZ/P":function(e,t,n){"use strict";n.r(t);var i={};function a(e,t){return e+'="'+t+'"'}function r(e){return function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return a(e,o(n))}}function o(e){return e[0]+"("+e.slice(1).map(s).join(", ")+")"}function s(e){return"number"==typeof e||"event"===e||"this"===e?e:JSON.stringify(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(e,t){var n,i=[];"string"==typeof t&&((n={})[t]=!0,t=n);return Object.keys(t).forEach((function(n){var a=t[n];!0===a?i.push(e+"_"+n):a&&i.push(e+"_"+n+"_"+a)})),i}Object.assign(i,{html:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];var a="";return e.forEach((function(e,t){var i=n[t];a+=e+(i||0===i?i:"")})),a}}),Object.assign(i,{attr:a,onBlur:r("onblur"),onClick:r("onclick"),onFocus:r("onfocus"),onInput:r("oninput"),onKeyDown:r("onkeydown"),onKeyPress:r("onkeypress"),onKeyUp:r("onkeyup"),onMouseDown:r("onmousedown"),onMouseUp:r("onmouseup"),onScroll:r("onscroll"),onSubmit:r("onsubmit"),onTouchEnd:r("ontouchend"),onTouchMove:r("ontouchmove"),onTouchStart:r("ontouchstart"),onWheel:r("onwheel"),onChange:r("onchange")}),Object.assign(i,{list:function(e,t){void 0===t&&(t=null);Array.isArray(e)||(e=[e]);return t?e.map(t).join(""):e.join("")}}),Object.assign(i,{class:function(){for(var e=[],t=null,n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return i.forEach((function(n){"string"==typeof n?(e.push(n),t=n):n&&(e=e.concat(c(t,n)))})),e.join(" ")},parseClass:function(e,t){var n={};return t.trim().split(/\s+/).forEach((function(t){if(t!==e){var i=t.replace(e+"_","").split("_");n[i[0]]=!(i.length>1)||i[1]}})),n}});t.default=i;window.q=i},cGUQ:function(e,t,n){"use strict";n.r(t),n.d(t,"fromQueryString",(function(){return c})),n.d(t,"toQueryString",(function(){return s}));var i=n("jE6c"),a={},r=function(e){if(a[e])return e;try{return encodeURIComponent(e)}catch(e){return""}},o=function(e){try{return decodeURIComponent(e)}catch(t){return a[e]=1,e}};function s(e,t){var n=[];for(var a in e)if(e.hasOwnProperty(a)&&null!=e[a]&&!Object(i.isFunction)(e[a]))if(Object(i.isArray)(e[a]))for(var o=0,s=0,c=e[a].length;o<c;++o)null==e[a][o]||Object(i.isFunction)(e[a][o])||(n.push(r(a)+"["+s+"]="+r(e[a][o])),++s);else n.push(r(a)+"="+r(e[a]));return t||n.sort(),n.join("&")}function c(e){if(!e)return{};var t={};return e=e.split("&"),Object(i.each)(e,(function(e,n){var i=n.split("=");if(i[0]){var a=o(i[1]+"");if("[]"===i[0].substr(i.length-2)){var r=o(i[0].substr(0,i.length-2));t[r]||(t[r]=[]),t[r].push(a)}else t[o(i[0])]=a}})),t}},cLcH:function(e,t){function n(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(e,t)}(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}window.FeedAssistanceExploreBait={onSubscribeLinkClick:function(e,t,n,i,a,r){var s=hasClass(e,"post__subscribeBtn_unsubscribe"),c=s?i:n,l=s?getLang("mobile_groups_public_subscribe"):getLang("mobile_groups_you_are_in_public"),u=!s,d=geByClass1("post__subscribeBtnIcon",e),_=(f=e,p=domCA(f,".post_exploreBait"),intval(domData(p,"block-id")));var f,p;d&&(toggleClass("post__subscribeBtnIcon_unsubscribe",d,u),toggleClass("post__subscribeBtnIcon_subscribe",d,!u));attr(e,"aria-label",escapeAttr(l)),toggleClass("post__subscribeBtn_unsubscribe",e,u),"group"===a?function(e,t,n,i){var a=n?Groups.leave:Groups.enter,r=n?FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_UNSUBSCRIBE:FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_SUBSCRIBE;i&&o(r),a.call(Groups,e,t,"feed")}(t,c,s,r):function(e,t,n,i,a){var r=n?Friends.decline:Friends.accept,s=n?FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_UNSUBSCRIBE:FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_SUBSCRIBE;a&&o(s),r.call(Friends,e,t,"feed",i)}(t,c,s,_,r);return!1}},FeedAssistanceStats.registerTrackingCls("post_exploreBait"),FeedAssistanceStats.onStartViewElement((function(e){if(FeedAssistanceStats.getElementType(e)===FeedAssistanceStats.BLOCKS.BLOCK_TYPE_EXPLORE_BAIT){if(e._exploreBaitClickHandlerAdded)return;a=!0,addEvent(e,"click",(function(e){!function(e){for(var t,i=e.target,a=n(s);!(t=a()).done;){if(!0===t.value.call(null,i))return}}(e)})),e._exploreBaitClickHandlerAdded=!0}})),nav.onBeforeGo((function(e){if(!a)return void(r=!1);if(!function(e){return e.tagName&&"explore-bait"===domData(e,"post-type")}(e))return;r=hasClass("item_replies",e),function(e){for(var t=0,n=["pi_text_more","wi_date","pi_text","i_replies","v_replies","item_replies"];t<n.length;t++){if(hasClass(n[t],e))return o(FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_OPENED),!0}}(e)})),window.page&&page.onChange((function(){if(!a)return;r&&function(){var e=ge("nc_submit");addEvent(e,"click",(function(){o(FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_COMMENT)}))}()}));var a=!1,r=!1;function o(e){FeedAssistanceStats.dispatchEvent({type:FeedAssistanceStats.EVENTS.EVENT_EXPLORE_BAIT,data:FeedAssistanceStats.serializeEventData(FeedAssistanceStats.EVENTS.EVENT_EXPLORE_BAIT_SUB,e)})}var s=[function(e){var t;if("A"!==e.tagName||!hasClass("item_sel",e))return hasClass("item_like",e)||(null==e||null==(t=e.classList)?void 0:t.contains("Socials__button--reactions"))||(hasClass("i_like",e)||hasClass("v_like",e))&&!hasClass("item_sel",domPN(e))?(o(FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_LIKE),!0):void 0},function(e){if(domData(e,"post-owner-type"))return o("user"===domData(e,"post-owner-type")?FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_OPEN_USER:FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_OPEN_GROUP),!0},function(e){var t={report:FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_REPORT,hide:FeedAssistanceStats.EVENTS.SUB_EVENT_EXPLORE_BAIT_HIDE}[domData(e,"post-action")];if(t)return o(t),!0}]},cZev:function(e,t,n){"use strict";n.r(t);var i=n("Xrg9"),a=n("J8bf"),r=n("kr3z"),o=n("fdw3"),s=n("+cqQ"),c=n("UxAg"),l=n("zvhO"),u=n("OcsD"),d=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),a=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,a++)i[a]=r[o];return i},_=function(){function e(){}return e.saveStickerPanel=function(e,t){i.default.set("sticker_panel",e),t&&Object(a.setCookie)("remixstickers_hash",t),window.cur.sticker_panel=e},e.getStickerPanel=function(e){void 0===e&&(e=""),e||(e=Object(o.getState)("target")||"");var t=i.default.get("sticker_panel")||window.cur.sticker_panel;return t?e?t.replace(/mail0/g,e):t:""},e.saveStickers=function(t){e.stickers=t,i.default.set("stickers",t)},e.setStickerTab=function(e,t){return void 0===t&&(t=[]),this.getStickers(),this.stickers[e]||(this.stickers[e]=[]),t&&(this.stickers[e]=t),this.saveStickers(this.stickers),this.stickers[e]},e.getStickers=function(){if(this.stickers)return this.stickers;var t=i.default.get("stickers");return!t&&cur.stickers&&(t=cur.stickers,this.saveStickers(t)),e.stickers||(e.stickers=t),e.stickers},e.setNewStickersCount=function(t,n){var i=n||e.getStickerPanel();if(!Object(l.isNumber)(t))return n;var a=ce("div");a.innerHTML=i;var r=Object(c.$)(".sp_badge",a),o=window.devicePixelRatio>=1.5?"_2x":"";return Object(u.setStyle)(r,{"background-image":t>0?"url(/images/mobile/badge"+t+o+".png)":""}),a.innerHTML},e.checkStickers=function(t){var n=this;if(void 0===t&&(t={}),!window.vk)return setTimeout((function(){var t;return(t=n.checkStickers).call.apply(t,d([e],arguments))}),1e3);if(window.vk.id){if(this.getStickers()&&this.getStickerPanel()&&Object(a.getCookie)("remixstickers_hash")){if(!t.force&&Date.now()-i.default.get("stickers_last_load")<3e5)return clog("[StickerCache] Stickers check was fired in less than 5 minutes. Prevent loading"),!1}else clog("[StickerCache] Stickers cache isn't loaded or broken"),Object(a.setCookie)("remixstickers_hash","");t.ignore_hash&&Object(a.setCookie)("remixstickers_hash",""),i.default.set("stickers_last_load",Date.now()),r.default.post("/?act=load_stickers",{},{onDone:function(t){if(i.default.set("stickers_last_load",Date.now()),t){if(t.part_load){clog("[StickerCache] Force loaded some categories");var n=t.stickers_data,a=t.new_items;if(Object(l.isNumber)(a)){var r=e.setNewStickersCount(a);e.saveStickerPanel(r)}var o=extend(e.getStickers()||{},n);e.saveStickers(o)}else{clog("[StickerCache] New version of stickers async loaded");r=t.sticker_panel,n=t.stickers_data;e.saveStickerPanel(r,t.hash),e.saveStickers(JSON.parse(n))}e.onStickerPanelUpdate()}else clog("[StickerCache] Stickers already exists.")}})}else clog("[StickerCache] User unauthorized.")},e.stickers=null,e.onStickerPanelUpdate=Object(s.default)(),e}();t.default=_},ciqL:function(e,t){var n={show:function(e,t){window.grecaptcha?grecaptcha.reset():(window.recaptchaCallback=function(){n.onCallback(e)},document.body.appendChild(ce("script",{type:"text/javascript",src:"https://www.google.com/recaptcha/api.js?onload=recaptchaCallback&render=explicit&hl="+t})))},onResponse:function(e){ge("field_recaptcha").value=e,ge("recaptcha_form").submit()},onCallback:function(e){if(grecaptcha&&e){var t=geByClass1("recaptcha_box"),i=geByClass1("recaptcha",t);i&&(val(i,""),grecaptcha.render(i,{sitekey:e,callback:n.onResponse}))}}};window.ReCaptcha=n},dONA:function(e,t,n){"use strict";n.r(t);var i=function(e){return{class:"MainMenuNotificationDot","data-id":e.id,tag:"span"}};t.default=i},dmnf:function(e,t,n){"use strict";function i(e,t,n){return void 0===t&&(t=""),e&&n?new Promise((function(i,a){window.ajax.post("/?act=track_event",{type:e,value:t,hash:n},{onDone:function(){i()},onFail:function(e){return a(e),!0}})})):Promise.reject()}n.r(t),n.d(t,"trackEvent",(function(){return i}))},drfJ:function(e,t,n){"use strict";n.r(t),n.d(t,"uMailHat_getPeerActions",(function(){return w}));var i=n("STl5"),a=n("DkIl"),r=n("fdw3"),o=n("UknS"),s=n("vmnM"),c=n("/Nch"),l=n("SCqW"),u=n("2cdU"),d=n("gmmu"),_=n("+7CI"),f=n("K95L"),p=n("OwA7"),h=n("iNof"),m=n("NTGm"),v=n("jyox"),g=n("PssS"),A=n("0jkK"),b=n("IxZu");function w(e){var t=store.mail,n=t.peers[e].actionUrls,i=t.peers[e].isChannel,a=t.rolls.peer[e],o=!a||!a.length,s=[];if(!n)return s;var c=y("markAsUnread",null,'onmousedown="uMessenger.onMarkDialogAsUnreadClick()"'),l=!o&&n.canPinDialog?y("pinConvo",null,'onmousedown="uMessenger.onPinDialogClick()"'):"",u=!o&&n.canPinDialog?y("unpinConvo",null,'onmousedown="uMessenger.onUnpinDialogClick()"'):"";return s=e>-2e9&&e<0?[!o&&y("showMedias",n.showMedia),c,l,u,!o&&y("deleteHistory",n.flushHistory),y("blockCommunity",n.blockCommunity),y("unblockCommunity",n.unblockCommunity),y("blockNotify",n.blockNotify)]:Object(r.isChatPeer)(e)?[y("chatInfo",n.chatInfo,"",i),y("chatAdd",n.addToChat),Object(r.isSAKIntegration)()?"":y("inviteLink",n.inviteLink,"",i),!o&&y("showMedias",n.showMedia),n.unpinMsg?y("chatUnpinMsg",n.unpinMsg):"",n.unpinMsg?y("chatShowPinnedMsg",null,'onmousedown="uMessenger.onShowPinnedMsgClick()"'):"",n.unpinMsg?y("chatHidePinnedMsg",null,'onmousedown="uMessenger.onHidePinnedMsgClick()"'):"",c,l,u,!o&&y("chatDeleteHistory",n.flushHistory),y("chatReturn",n.returnToChat,"",i),y("chatLeave",n.leaveChat,"",i)]:t.cur.groupId?[!o&&y("showMedias",n.showMedia),Object(r.isSAKIntegration)()?"":y("markAsAnswered",n.communityMarkAsAnswered),c,n.isDialogImportant?y("removeImportantMark",n.communityToggleImportant):y("markAsImportant",n.communityToggleImportant),Object(r.isSAKIntegration)()?"":n.isBlacklisted?y("unbanUser",n.userBan):y("banUser",n.userBan),!o&&y("deleteHistory",n.flushHistory)]:[!o&&y("showMedias",n.showMedia),c,l,u,!o&&y("deleteHistory",n.flushHistory)]}function y(e,t,n,i){void 0===n&&(n=""),void 0===i&&(i=!1);var a=window.lang;if(!t&&!n)return null;var w=Object(r.isEduIntegration)(),y=w?a.mobile_mail_edu_chat_info:a.mobile_mail_chat_info,O=w?a.mobile_mail_edu_chat_return:a.mobile_mail_chat_return,S=w?a.mobile_mail_edu_leave_chat:a.mobile_mail_chat_leave,k=w?a.mobile_mail_edu_clean_chat:a.mobile_mail_delete_chat_history,C={showMedias:[a.mobile_mail_show_medias,Object(o.getPictureOutline28Icon)()],deleteHistory:[a.mobile_mail_delete_history,Object(s.getDeleteOutline28Icon)()],blockCommunity:[a.mobile_mail_block_community,Object(c.getRemoveCircleOutline28Icon)()],blockNotify:[a.mobile_mail_block_community_notify,Object(c.getRemoveCircleOutline28Icon)()],unblockCommunity:[a.mobile_mail_unblock_community,Object(l.getAddCircleOutline28Icon)()],chatAdd:[a.mobile_mail_add_to_chat,Object(l.getAddCircleOutline28Icon)()],chatUnpinMsg:[a.mobile_mail_unpin_msg,Object(u.getUnpinOutline28Icon)(),"unpin"],chatShowPinnedMsg:[a.mobile_mail_pin_show,Object(d.getPinOutline28Icon)(),"showPinned"],chatHidePinnedMsg:[a.mobile_mail_pin_hide,Object(_.getHideOutline28Icon)(),"hidePinned"],chatInfo:[y,Object(f.getInfoOutline28Icon)()],chatDeleteHistory:[k,Object(s.getDeleteOutline28Icon)()],chatReturn:[i?a.mobile_mail_return_to_channel:O,Object(p.getChevronLeftOutline28Icon)(),"returnToChat"],chatLeave:[i?a.mobile_mail_channel_leave:S,Object(h.getCancelCircleOutline28Icon)(),"leaveChat"],markAsAnswered:[a.mobile_mail_mark_as_answered,Object(m.getDoubleMarkOutline28Icon)()],removeImportantMark:[a.mobile_mail_remove_important_mark,Object(v.getUnfavoriteOutline28Icon)()],markAsImportant:[a.mobile_mail_mark_as_important,Object(g.getFavoriteOutline28Icon)()],markAsUnread:[a.mobile_mail_mark_as_unread,Object(A.getMarkUnreadOutline28Icon)()],unbanUser:[a.mobile_settings_blacklist_unban_user,Object(l.getAddCircleOutline28Icon)()],banUser:[a.mobile_settings_blacklist_ban_user,Object(c.getRemoveCircleOutline28Icon)()],inviteLink:[i?a.mobile_mail_channel_invite_link:a.mobile_mail_invite_link,Object(b.getLinkOutline28Icon)()],pinConvo:[a.mobile_mail_pin_conversation,Object(d.getPinOutline28Icon)(),"pinConvo"],unpinConvo:[a.mobile_mail_unpin_conversation,Object(u.getUnpinOutline28Icon)(),"unpinConvo"]},j={text:C[e][0],icon:SVGIcon(C[e][1]),attrs:n,url:t};return C[e][2]&&(j.name=C[e][2]),j}t.default=function(){var e=store.mail.cur.peerId,t=store.mail.cur.page;if(e)return function(e){var t=store.mail,n=t.peers[e],i=Object(r.isChatPeer)(e),o=Object(r.isContactPeer)(e),s={title:n.title,photos:n.avatarImages,actions:w(e),editing:t.cur.editing,peerProfile:{isEnabled:t.flags.isPeerProfileEnabled,tagsData:n.peerProfileTagsData||{},tags:t.peerProfileTags||[]},canCall:!!n.canCall};if(i){var c=i?e-2e9:null;if(s.url="/mail?act=info&chat="+c,s.membersCount=n.countMembers,s.hasPinnedMsg=n.hasPinnedMsg,s.isChannel=n.isChannel,s.isCasper=n.isCasper,s.isChannel||n.isCommunityChat){var l=-n.ownerId;s.url="/club"+l}else if(n.viewerId<0){var u=-n.viewerId;s.url="/mail?act=info&chat="+c+"&community="+u}}else s.url=n.profileUrl,s.isOnline=n.isOnline,s.onlinePlatform=n.onlinePlatform,s.offlineText=n.offlineText,s.isContact=o;return Object(a.MailHat_convo)(s)}(e);if(t)return function(e){return Object(a.MailHat_page)(e)}(t);return function(){var e=store.mail.cur,t=Math.abs(e.groupId),n=!!t,o=n?"&community="+t:"",s=n?"?community="+t:"",c=!Object(r.isSAKIntegration)()&&n;return Object(a.MailHat_main)({folder:e.folder,urls:{all:"/mail"+s,unrespond:"/mail?act=unrespond"+o,unread:"/mail?act=unread"+o,important:"/mail?act=important"+o,adTag:"/mail?act=ad_tag"+o,createChatUrl:"/mail?act=new_chat"},importantCount:e.countImportant,withUnrespond:n,withAdTag:c,forwarding:!!e.forwardFromId,notifier:Object(i.default)()})}()}},eGQV:function(e,t,n){"use strict";n.r(t),n.d(t,"init",(function(){return u})),n.d(t,"isStandalone",(function(){return d})),n.d(t,"isOfflineCapable",(function(){return _}));var i=function(){function e(){this.registration=null,this._handlers=[],this.params=null}e.isSupported=function(){try{return!(!window.fetch||window.fetch.polyfill&&!window.fetch.forcedPolyfill||!navigator.serviceWorker)}catch(e){return!1}};var t=e.prototype;return t.listenMessages=function(){navigator.serviceWorker.addEventListener("message",this._onmessage.bind(this))},t.register=function(t){if(!e.isSupported())return Promise.reject("SW: serviceWorker is unavailable");var n=t&&t.url;return n?(this.params=t,navigator.serviceWorker.register(n,{scope:"/",updateViaCache:"none"}).then(function(e){return this.registration||(this.registration=e),e}.bind(this))):Promise.reject("SW: incorrect url")},t.getRegistration=function(){return e.isSupported()?navigator.serviceWorker.ready.then(function(e){return this.registration||(this.registration=e),e}.bind(this)):Promise.reject("SW: serviceWorker is unavailable")},t.unregister=function(){this.registration&&this.registration.unregister(),this._handlers.forEach((function(e){return e[0].removeEventListener(e[1],e[2])})),this._handlers=[]},t.update=function(){this.registration&&this.registration.update()},t.getParams=function(){return this.params||{}},t._addEventListener=function(e,t,n,i){void 0===i&&(i=!0);var a=!1;this._handlers.forEach((function(i){i[0]===e&&i[1]===t&&i[2]===n&&(a=!0)})),a&&!i||(this._handlers.push([e,t,n]),e.addEventListener(t,n))},t.action_devicePixelRatio=function(){return window.devicePixelRatio},t.action_pushHash=function(){return this.getParams().push_hash},t.storePushHash=function(){var e=this.getParams().push_hash;this.action("storePushHash",{hash:e})},t.action=function(e,t){var n=null;return n=Array.isArray(e)?e:[[e,t]],this._message({actions:n}).then((function(e){return e.answers?Promise.resolve(1===n.length?e.answers[0]:e.answers):Promise.reject(new Error("ServiceWorker answer is incorrect"))}))},t._message=function(e){var t=this;return this.getRegistration().then((function(){return new Promise(function(t,n){var i=new MessageChannel;i.port1.onmessage=function(e){this._messageCheck(e)?t(e.data.data):n(new Error("ServiceWorker message is incorrect"))}.bind(this),this.registration.active.postMessage(this._messageWrap(e),[i.port2])}.bind(t))}))},t._onmessage=function(e){if(this._messageCheck(e)){var t=e.data.data;if(t.actions&&Array.isArray(t.actions)){var n=[];t.actions.forEach(function(t){var i="action_"+t[0],a=t[1],r=this[i]?this[i](a,e):void 0;r instanceof Promise||(r=Promise.resolve(r)),n.push(r)}.bind(this)),Promise.all(n).then(function(t){var n={};t.forEach((function(e,t){void 0!==e&&(n[t]=e)})),Object.keys(n).length&&e.ports[0].postMessage(this._messageWrap({answers:n}))}.bind(this))}}},t._messageCheck=function(e){return(""===e.origin||e.origin.match(/^https:\/\/([a-zA-Z0-9\-\.]+\.)?vk\.com$/))&&e.data&&e.data.data&&"sw"===e.data.type},t._messageWrap=function(e){return{type:"sw",data:e}},e}();i.SW_NOT_AVAILABLE_ERROR="SW: serviceWorker is unavailable";var a,r=n("H5mD"),o=function(){if(!("fetch"in window))return function(){};var e=["standalone","fullscreen","minimal-ui"],t=navigator.vendor&&-1!==navigator.vendor.indexOf("Apple");function n(e,t,n){void 0===n&&(n=!1);var a=i(e);if((a.drawImage(e,0,0),!n)&&255==a.getImageData(0,0,1,1).data[3])return null;return a.globalCompositeOperation="destination-over",a.fillStyle=t,a.fillRect(0,0,e.width,e.height),a.canvas.toDataURL()}function i(e){var t=void 0===e?{width:1,height:1}:e,n=t.width,i=t.height,a=document.createElement("canvas");return a.width=n,a.height=i,a.getContext("2d")}return function(){if(t){var a=document.head.querySelector('link[rel="manifest"]'),o=a?a.href:"",s=function(e){for(var t=function(t){var n=e[t];try{return new URL("",n),{v:function(e){return new URL(e,n).toString()}}}catch(e){}},n=0;n<e.length;++n){var i=t(n);if("object"==typeof i)return i.v}return function(e){return e}}([o,window.location]);Promise.resolve().then((function(){if(!o)throw'can\'t find <link rel="manifest" href=".." />\'';var e={};return"use-credentials"===o.crossOrigin&&(e.credentials="include"),window.fetch(o,e)})).then((function(e){return e.json()})).then((function(t){return function(t,a){var o=(t.icons||[]).filter((function(e){return"apple-splashscreen"===e.purpose}));o.sort((function(e,t){return parseInt(t.sizes,10)-parseInt(e.sizes,10)}));var s=o.map((function(e){return{href:a(e.src),sizes:e.sizes}})),c=t.display,l=-1!==e.indexOf(c);(function(e){var t=function(e){var t=i();return t.fillStyle=e,t.fillRect(0,0,1,1),t.getImageData(0,0,1,1).data}(e).map((function(e){var t=e/255;return t<.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)})),n=.2126*t[0]+.7152*t[1]+.0722*t[2];Math.abs(1.05/(n+.05))})(t.background_color||"#ffffff"),t.name||t.short_name||document.title;navigator.standalone||(u="apple-mobile-web-app-capable",(d=l)&&(!0===d&&(d="yes"),function(e,t){var n=document.createElement(e);for(var i in t)n.setAttribute(i,t[i]);document.head.appendChild(n)}("meta",{name:u,content:d})));var u,d;function _(e,n,a){var r=e.width,o=e.height,s=window.devicePixelRatio,c=i({width:r*s,height:o*s});if(c.scale(s,s),c.fillStyle=t.background_color||"#ffffff",c.fillRect(0,0,r,o),c.translate(r/2,(o-32)/2),a){var l=a.width/s,u=a.height/s;u>128&&(l/=u/128,u=128),l>=48&&u>=48&&(c.drawImage(a,l/-2,u/-2,l,u),c.translate(0,u/2+32))}var d=document.createElement("link");return d.setAttribute("rel","apple-touch-startup-image"),d.setAttribute("media","screen and (orientation: "+n+")"),d.setAttribute("href",c.canvas.toDataURL()),d}var f=new Set;function p(e){var t=_(window.screen,"portrait",e),n=_({width:window.screen.height,height:r.isIPad?window.screen.height:window.screen.width},"landscape",e);f.forEach((function(e){return e.remove()})),document.head.appendChild(t),document.head.appendChild(n),f.add(t),f.add(n)}if(p(null),!s.length)return;var h=s[0],m=new Image;m.crossOrigin="anonymous",m.onload=function(){if(p(m),t.background_color){var e=n(m,t.background_color);null!==e&&(h.href=e,s.slice(1).forEach((function(e){var i=new Image;i.crossOrigin="anonymous",i.onload=function(){var a=n(i,t.background_color,!0);e.href=a},i.src=e.href})))}},m.src=h.href}(t,s)})).catch((function(e){return console.warn("pwacompat.js error",e)}))}}}(),s=n("OGfC"),c=new i;window.sw_client=c,window.SWClient=i,window.initPushNotifier=function(){try{window.PushNotifier=s.default,window.pushNotifier=new s.default(c,i)}catch(e){}};var l=!1;function u(){window.addEventListener&&(!function(){if(l=!0===navigator.standalone||window.matchMedia&&matchMedia("(display-mode: standalone)").matches,!history.replaceState)return;var e=location.search;if((e=(e=(e=e.replace(/(\?|&)mode\=([^&]+)(&)?/,"$1")).replace(/(\?|&)__appshell_fallback\=([^&]+)(&)?/,"$1")).replace(/(\?|&)+$/,""))!==location.search){var t=location.pathname+e+location.hash;history.replaceState(null,"",t)}}(),function(){if(!i.isSupported())return;c.listenMessages()}(),window.addEventListener("beforeinstallprompt",(function(e){e.preventDefault()})),window.addEventListener("appinstalled",(function(){statlogsValueEvent("pwa_installed_event",1)})),"complete"===document.readyState?f():window.addEventListener("load",(function(){f()})))}function d(){return l}function _(){return void 0===a&&(a=!(!i.isSupported()||!navigator.serviceWorker.controller)),a}function f(){window.vk&&window.vk.sw&&(c.register(window.vk.sw).then((function(e){c.storePushHash()}),(function(e){if(e!==i.SW_NOT_AVAILABLE_ERROR)throw e})),i.isSupported()&&navigator.serviceWorker.getRegistration().then((function(e){!function(e){if(!_())return;e&&e.active&&e.installing&&e.installing.postMessage({action:"activate"})}(e)})),o())}u()},eJy5:function(e,t,n){"use strict";n.r(t);var i=n("OcsD"),a=Object(i.need)("Voting");function r(e){s(e.$voting,e.url)}function o(e,t){s(t.$voting,e,!0)}function s(e,t,n){var r=setTimeout((function(){a.setLoading(e)}),140);window.ajax.post(t,{_ajax:1},{onDone:function(t,o){Object(i.domData)(e,"is-web-view")&&a._onPollChanged&&a._onPollChanged(e,n),clearTimeout(r),a.setHtml(t,o)}})}window.uVoting={},window.uVoting._onSubmit=r,window.uVoting._onRevoteClick=o},eWFs:function(e,t,n){"use strict";n.r(t),n.d(t,"uConvo_getLastMsgId",(function(){return f}));n("bZ/P");var i=n("TYsd"),a=(n("Mc5h"),n("s0aB")),r=n("iWgD"),o=n("/Id8"),s=n("fdw3"),c=function(e,t,n){void 0===t&&(t=null);void 0===n&&(n={});var i="last"===t,r=store.mail,o=r.peers[e],c=Object(s.isContactPeer)(e),_=o.url,f=null;if(t){var m;i||(_=_+"&msg="+t),(m=i?p(e):r.msgs[t])&&(f={text:l(m),date:m.dateShort,unreadCount:d(e),muted:o.isMuted,typing:h(e),pending:m.pending,failed:m.failed})}return Object(a.default)({id:e,url:_,photos:o.avatarImages,title:o.title,online:u(o),important:o.isImportant,profileUrl:o.profileUrl,isLast:i,peerProfile:{tagsData:o.peerProfileTagsData||{},tags:r.peerProfileTags||[]},isMarkedUnread:o.isMarkedUnread,more:f,isCasper:o.isCasper,isContact:c,name:o.title,majorSortId:o.majorSortId,isWithoutMessage:n.isWithoutMessage})};function l(e){var t=window.lang,n=store.mail,a=!!e.attaches.call;if(e.isExpired){var r=Object(s.getLang)("mobile_mail_you")+": "+Object(s.getLang)("mobile_casper_chat_message_disappeared");return i.default.html({inner:[r],tag:"span"})}if(e.isService&&!a)return i.default.html({tag:"span",inner:[i.default.wrap(e.serviceText)]});var c=e.body?i.default.wrap(Object(o.Msg__textPreview)(e.body)):function(e){return{tag:"span",class:"convo__msgAttach",inner:Object(o.Msg__attachPreview)(e)}}(e),l="";return e.authorId===n.cur.userId&&e.peerId!==n.cur.userId?l=t.mobile_mail_you:Object(s.isChatPeer)(e.peerId)&&e.authorId&&(l=(l=n.members[e.authorId].shortName).replace(/\.$/,"")),l&&(l+=": "),i.default.html({tag:"span",inner:[i.default.wrap(l),c]})}function u(e){return!!e.isOnline&&("desktop"===e.onlinePlatform?"desktop":"mobile")}function d(e){var t=_(e).countUnread;if(0===t){var n=store.mail,i=p(e);i&&i.isUnread&&i.authorId===n.cur.viewerId&&(t=-1)}return t}function _(e){return store.mail.peers[e]}function f(e){var t=store.mail,n=t.rolls.peer[e],i=t.presend&&t.presend.pending[e],a=t.presend&&t.presend.failed[e];if(i&&i.length)for(var r=i.length-1;r>=0;r--){var o=i[r];if(-1===o.indexOf("edit"))return o}if(a&&a.length)for(var s=a.length-1;s>=0;s--){var c=a[s];if(-1===c.indexOf("edit"))return c}return n&&n.length?last(n):null}function p(e){var t=store.mail.msgs,n=store.mail.presend,i=n&&n.msgs,a=f(e);return i&&i[a]?i[a]:a?t[a]:null}function h(e){var t,n,i=Object(r.uTyping_getPeerTyping)(e),a=i&&1===i.count&&i.users[0]===e;return i?("mixed"===i.type?(t="simple-dots",n="mixed"):"audio"===i.type?(t="audio",n="audio"):"text"===i.type&&(t="simple-dots",n=""),{typing:!!a||Object(r.uTyping_getNames)(i),typingCount:i.count,animation:t,text:n,dimmed:!1,compact:!0}):""}n("+cqQ");var m=n("rudk");Object.assign(c,{onTap:a.default.onTap,redrawOnline:function(e){var t=store.mail.peers[e];if(t){var n=u(t);a.default.setOnline(e,n)}},redrawUnread:function(e){if(!store.mail.peers[e])return;var t=d(e),n=_(e).isMarkedUnread;a.default.setUnreadCount(e,t,n)},redrawLastMsg:function(e){var t=p(e);t&&a.default.setLastMsg(e,l(t),{dateShort:t.dateShort,pending:t.pending,failed:t.failed})},redrawTyping:function(e){if(!store.mail.cur)return;var t=Object(r.uTyping_getPeerTyping)(e),n=(t&&1===t.count&&t.users[0],h(e));a.default.setTyping(e,n)},redrawImportant:function(e,t){a.default.setImportant(e,t)},updateAdTag:function(e){var t=store.mail.peers[e];a.default.updateAdTag(e,t.peerProfileTagsData)},redrawPinned:function(e){var t=store.mail.peers[e];if(t){var n=Object(m.isPinnedSortId)(t.majorSortId);a.default.updatePinned(e,n)}}});t.default=c;window.uConvo=c},eoxF:function(e,t){var n=function(){var e=null,t=!1,i=!1,a={},r=[],o=0,s=null,c="",l="";function u(e,t){return!t&&g(e)}function d(e){i=!1;var n=ge("medias_map"),a=ge("attached_wrap");n||(n=ce("div",{id:"medias_map",className:"pi_medias"}),append(n,a));var r=+e[1]||0,o=e[3]||"",s=e[4]||"",c=e[5]||"",l=(+e[6].lat||0)+"_"+(+e[6].lng||0),u=geByClass1("medias_map",n),d='<div class="medias_map_close" onclick="checkin.remove();"><i class="i_close">&nbsp;</i></div><div class="medias_map_label" onclick="checkin.changePlace();">'+o+(c?", "+c:s?", "+s:"")+"</div>",_='<input type="hidden" name="place_id" value="'+r+'"><input type="hidden" name="place" value="'+l+'">';if(u)val(u,d+_);else{d='<div class="medias_map">'+d+_+"</div>";val(n,d)}addClass("cp_geo_btn_sel","geo_btn"),t=!0,show(n)}function _(t){return g(e)}function f(){val("place_add_box",""),hide("place_add_box"),show("places_box")}function p(t,n){h();var i=a[n];i&&(e={latitude:+i[6].lat||0,longitude:+i[6].lng||0},n?d(i):m(e,i))}function h(e){if(!s)return!0;val("m",s),s=null,scrollToEl(geByClass1("create_post_extra","mcont"));var t=nav.path+(nav.params?"?"+nav.params:"");return nav.go(t,null,{push_only:!0,no_push:e}),!1}function m(e,n){i=!0;var a=ge("medias_map"),r=ge("attached_wrap");a||(a=ce("div",{id:"medias_map",className:"pi_medias"}),r.appendChild(a));var o=e.latitude,s=e.longitude,c=(window.devicePixelRatio,n&&n[4]||!1),l=geByClass1("medias_map",a),u=c?'<div class="medias_map_close" onclick="checkin.remove();"><i class="i_close">&nbsp;</i></div><div class="medias_map_label" onclick="checkin.changePlace();">'+c+"</div>":"",d='<input type="hidden" name="map" value="'+(o+"_"+s+"_0")+'">';l?val(l,u+""+d):val(a,'<div class="medias_map">'+u+d+"</div>");t=!0,addClass("cp_geo_btn_sel","geo_btn"),show(a)}function v(){e=null,a={},r=[],o=0,ajax.post(l,{_ajax:1}),remove("medias_map")}function g(e){var t=window.al;remove("feed_extra_field");var n=Math.round(1e8*e.latitude)/1e8,i=Math.round(1e8*e.longitude)/1e8,a=gpeByTag("form","geo_btn"),r=ce("input",{id:"feed_extra_field",type:"hidden",name:"add_place",value:n+","+i});if(!a)return nav.go(nav.path+"?act=places&lat="+n+"&lng="+i);var o=!1;return each(a,(function(e,t){if("submit"===t.type)return o=t,!1})),o?(append(r,a),window.al&&t.ver?nav.go(o,null,{removeAfterNextResponse:!1}):a.submit()):void 0}function A(t){t&&t.coords&&u(e={latitude:+t.coords.latitude||0,longitude:+t.coords.longitude||0})}function b(e){n.remove(),hide("geo_waiting")}return{toggle:function(){t?n.remove():n.add()},addNewPlace:function(){var t=val("place_name_fld"),n=val("place_address_fld");return t?(lockButton("place_add_btn"),ajax.post("/places.php",{_ajax:1,act:"add_place",latitude:e.latitude,longitude:e.longitude,title:t,address:n,hash:c},{onDone:function(e,t){if(unlockButton("place_add_btn"),e){var n={};n[e]=t,extend(a,n),r.splice(r[0]?0:1,0,e),f(),p(null,e)}},onFail:function(){unlockButton("place_add_btn");var e=Array.prototype.slice.call(arguments),t=e.shift(),n=ge("place_add_form");switch(t){case 2:n&&n.submit()}}}),!1):(elfocus("place_name_fld"),!1)},addPlaceShow:function(t,n){var i=window.lang,a="/places.php"+obj2qs({act:"add_place",latitude:e.latitude,longitude:e.longitude,hash:c});val("place_add_box",'<h3 class="sub_header">'+i.mobile_geo_new_place_header+'</h3><div class="form_item fi_fat"><form id="place_add_form" action="'+a+'" method="post"><dl class="fi_row"><dt class="fi_label">'+i.mobile_geo_place_name_label+'</dt><dd class="iwrap"><input type="text" class="textfield" id="place_name_fld" name="title" /></dd></dl><dl class="fi_row"><dt class="fi_label">'+i.mobile_geo_place_address_label+'</dt><dd class="iwrap"><input type="text" class="textfield" id="place_address_fld" name="address" /></dd></dl><dl class="fi_row"><dd><input class="button" type="submit" id="place_add_btn" value="'+i.mobile_geo_place_add_btn+'" onclick="return checkin.addNewPlace(this);" /><a class="near_btn" onclick="checkin.addPlaceCancel(); return false;">'+i.mobile_cancel+"</a></dd></dl></form></div>"),val("place_name_fld",unescapeAttr(t)||""),val("place_address_fld",unescapeAttr(n)||""),hide("places_box"),show("place_add_box"),t?elfocus("place_address_fld"):elfocus("place_name_fld")},addPlaceCancel:f,selectPlace:p,changePlace:_,back:h,refreshCurrentPosition:function(){geo.getCurrentPosition(A,b)},getCurrentAddress:function(){return a[0]&&a[0][5]||""},savePlaces:function(e){extend(a,e)},add:function(n){if(!n&&t)return _();n&&(n.latitude||n.longitude)&&n.place?(e={latitude:+n.latitude||0,longitude:+n.longitude||0},n.place[1]?d(n.place):m(e,n.place),u(e,!0)):(geo.getCurrentPosition(A,b),show("geo_waiting"))},add_place:function(n){if(!n&&t)return _();n&&(n.latitude||n.longitude)&&n.place?(e={latitude:+n.latitude||0,longitude:+n.longitude||0},n.place[1]?d(n.place):m(e,n.place),u(e,!0)):(geo.getCurrentPosition(A,b),show("geo_waiting"))},remove:function(){t=!1,removeClass("cp_geo_btn_sel","geo_btn"),v()},stash:function(n){if(!n)return[e,t,i,a,r,o,s];e=n[0],t=n[1],i=n[2],a=n[3],r=n[4],o=n[5],s=n[6]},init:function(u,d,_){return hide("geo_waiting"),e=null,t=!1,i=!1,a={},r=[],o=0,s=null,c=d||"",l=_||"",u&&n.add(u),geo.init()}}}();window.checkin=n},fWqt:function(e,t,n){"use strict";n.r(t);var i={};n.r(i),n.d(i,"onConfirmDelete",(function(){return u})),n.d(i,"open",(function(){return d})),n.d(i,"close",(function(){return _})),n.d(i,"isDeleteMessagesForAll",(function(){return f}));var a=n("MUpH"),r=n("bZ/P"),o=n("+cqQ"),s=n("iS9e");function c(){var e=Object(a.default)(["\n    ","\n    ","\n  "]);return c=function(){return e},e}var l=null,u=Object(o.default)();function d(e){s.default.open({body:p(e),confirmText:lang.mobile_mail_delete_popup_delete,cancelText:lang.mobile_mail_delete_popup_cancel,onConfirm:r.default.onClick("MsgDeleteDialog.onConfirmDelete"),onClose:r.default.onClick("MsgDeleteDialog.close")})}function _(){var e=$(".MsgDeleteDialog__checkboxInput");e&&(l=e.checked,lsSet("delete_message_for_all_checked",l)),s.default.close()}function f(){var e=$(".MsgDeleteDialog__checkboxInput");return!!e&&e.checked}function p(e){var t,n,i=e.isEditing,a=e.canDeleteForAll;if(i)t=lang.mobile_mail_dialog_msg_delete_for_all;else{var o=Object.keys(store.mail.cur.msgSelected).length;t=langNumeric(o,lang.mobile_mail_dialog_msg_delete_N)}if(!i&&a){var s=lang.mobile_mail_delete_for_all;n='\n      <div class="MsgDeleteDialog__checkbox">\n        <label class="MsgDeleteDialog__checkboxIn">\n          <input type="checkbox" class="MsgDeleteDialog__checkboxInput" '+(function(){if("boolean"!=typeof l){var e=!!lsGet("delete_message_for_all_checked");l=e}return l}()?"checked":"")+'>\n          <span class="MsgDeleteDialog__checkboxLabel">'+s+"</span>\n        </label>\n      </div>\n    "}return r.default.html(c(),t,n)}t.default=i;window.MsgDeleteDialog=i},fYoA:function(e,t){window.SettingsNotifyGroup={},SettingsNotifyGroup._onChange=a;var n=".settingsNotifyGroup",i=".settingsNotifyGroup__description";function a(e,t){t.$control.closest(n).$(i).innerHTML=e}},fdw3:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"isObject",(function(){return isObject})),__webpack_require__.d(__webpack_exports__,"isJS",(function(){return isJS})),__webpack_require__.d(__webpack_exports__,"isSVGIconsPlaceholdersExperimentEnabled",(function(){return isSVGIconsPlaceholdersExperimentEnabled})),__webpack_require__.d(__webpack_exports__,"log",(function(){return log})),__webpack_require__.d(__webpack_exports__,"mergeObjects",(function(){return mergeObjects})),__webpack_require__.d(__webpack_exports__,"mergeArrays",(function(){return mergeArrays})),__webpack_require__.d(__webpack_exports__,"concatValues",(function(){return concatValues})),__webpack_require__.d(__webpack_exports__,"isFinite",(function(){return isFinite})),__webpack_require__.d(__webpack_exports__,"getLang",(function(){return getLang})),__webpack_require__.d(__webpack_exports__,"getLangNumeric",(function(){return getLangNumeric})),__webpack_require__.d(__webpack_exports__,"langNumeric",(function(){return langNumeric})),__webpack_require__.d(__webpack_exports__,"insertBetween",(function(){return insertBetween})),__webpack_require__.d(__webpack_exports__,"stringifyJSON",(function(){return stringifyJSON})),__webpack_require__.d(__webpack_exports__,"parseJSON",(function(){return parseJSON})),__webpack_require__.d(__webpack_exports__,"wrapCommunityMailUrl",(function(){return wrapCommunityMailUrl})),__webpack_require__.d(__webpack_exports__,"mailReplaceMentions",(function(){return mailReplaceMentions})),__webpack_require__.d(__webpack_exports__,"mailReplaceDomainMentions",(function(){return mailReplaceDomainMentions})),__webpack_require__.d(__webpack_exports__,"mailWrapMention",(function(){return mailWrapMention})),__webpack_require__.d(__webpack_exports__,"getState",(function(){return getState})),__webpack_require__.d(__webpack_exports__,"wdToFlatArray",(function(){return wdToFlatArray})),__webpack_require__.d(__webpack_exports__,"fromCharCode",(function(){return fromCharCode})),__webpack_require__.d(__webpack_exports__,"timestamp",(function(){return timestamp})),__webpack_require__.d(__webpack_exports__,"getDayNumberFromUnixtime",(function(){return getDayNumberFromUnixtime})),__webpack_require__.d(__webpack_exports__,"getMonthNumberFromUnixtime",(function(){return getMonthNumberFromUnixtime})),__webpack_require__.d(__webpack_exports__,"formatDuration",(function(){return formatDuration})),__webpack_require__.d(__webpack_exports__,"arrayUnique",(function(){return arrayUnique})),__webpack_require__.d(__webpack_exports__,"arrayFlat",(function(){return arrayFlat})),__webpack_require__.d(__webpack_exports__,"toArray",(function(){return toArray})),__webpack_require__.d(__webpack_exports__,"arrayLength",(function(){return arrayLength})),__webpack_require__.d(__webpack_exports__,"isArray",(function(){return isArray})),__webpack_require__.d(__webpack_exports__,"arrayIncludes",(function(){return arrayIncludes})),__webpack_require__.d(__webpack_exports__,"inlineIconResolver",(function(){return inlineIconResolver})),__webpack_require__.d(__webpack_exports__,"isIconAlreadyInBundle",(function(){return isIconAlreadyInBundle})),__webpack_require__.d(__webpack_exports__,"isSAKIntegration",(function(){return isSAKIntegration})),__webpack_require__.d(__webpack_exports__,"isEduIntegration",(function(){return isEduIntegration})),__webpack_require__.d(__webpack_exports__,"classNames",(function(){return classNames})),__webpack_require__.d(__webpack_exports__,"langTag",(function(){return langTag})),__webpack_require__.d(__webpack_exports__,"arraySomeEqual",(function(){return arraySomeEqual})),__webpack_require__.d(__webpack_exports__,"preactCallback",(function(){return preactCallback})),__webpack_require__.d(__webpack_exports__,"getLangReplace",(function(){return getLangReplace})),__webpack_require__.d(__webpack_exports__,"winToUtf",(function(){return winToUtf})),__webpack_require__.d(__webpack_exports__,"getNumShort",(function(){return getNumShort}));var _mobile_emoji_html__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("9M99");__webpack_require__.d(__webpack_exports__,"emojiToHTML",(function(){return _mobile_emoji_html__WEBPACK_IMPORTED_MODULE_0__.emojiToHTML}));var _mobile_lib_Mail__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("qHA9");__webpack_require__.d(__webpack_exports__,"isChatPeer",(function(){return _mobile_lib_Mail__WEBPACK_IMPORTED_MODULE_1__.isChatPeer})),__webpack_require__.d(__webpack_exports__,"isContactPeer",(function(){return _mobile_lib_Mail__WEBPACK_IMPORTED_MODULE_1__.isContactPeer})),__webpack_require__.d(__webpack_exports__,"isCommunityPeer",(function(){return _mobile_lib_Mail__WEBPACK_IMPORTED_MODULE_1__.isCommunityPeer})),__webpack_require__.d(__webpack_exports__,"isForwardedMessageId",(function(){return _mobile_lib_Mail__WEBPACK_IMPORTED_MODULE_1__.isForwardedMessageId}));var _mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("OcsD");__webpack_require__.d(__webpack_exports__,"extend",(function(){return _mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_2__.extend})),__webpack_require__.d(__webpack_exports__,"isFunction",(function(){return _mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_2__.isFunction}));var _shared_im_helpers__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("rudk");__webpack_require__.d(__webpack_exports__,"isPinnedSortId",(function(){return _shared_im_helpers__WEBPACK_IMPORTED_MODULE_3__.isPinnedSortId}));var _mobile_lib_Url__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("j80l");__webpack_require__.d(__webpack_exports__,"makeUrl",(function(){return _mobile_lib_Url__WEBPACK_IMPORTED_MODULE_4__.makeUrl}));var _mobile_lib_Withdom__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("TYsd"),_shared_lib_SAKIntegration__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("ZMWW"),_vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("xt6h");function _createForOfIteratorHelperLoose(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=_unsupportedIterableToArray(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function isObject(e){return Object(_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_2__.isObject)(e)}function isJS(){return!0}function isSVGIconsPlaceholdersExperimentEnabled(){return!1}function log(){var e;(e=console).log.apply(e,arguments)}function mergeObjects(){return Object.assign.apply(Object,arguments)}function mergeArrays(e,t){return Array.isArray(e)&&Array.isArray(t)?e.concat(t):[]}function concatValues(e,t){return e+t}function isFinite(e){return window.isFinite(e)}function getLang(){var e;return(e=window).getLang.apply(e,arguments)}function getLangNumeric(){return _mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_2__.langNumeric.apply(void 0,arguments)}function langNumeric(e,t,n){return void 0===n&&(n=!1),Object(_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_2__.langNumeric)(e,t,n)}function insertBetween(e,t){var n=[];return e.forEach((function(i,a){var r=e[a+1],o=e[a+2];i&&n.push(i),i&&(r||o)&&n.push(t)})),n}function stringifyJSON(e){return JSON.stringify(e)}function parseJSON(e){return JSON.parse(e)}function wrapCommunityMailUrl(e){return Object(_mobile_lib_Mail__WEBPACK_IMPORTED_MODULE_1__.wrapCommunityUrl)(e)}function mailReplaceMentions(e,t){return e.replace(_mobile_lib_Mail__WEBPACK_IMPORTED_MODULE_1__.MENTION_REGEXP,t)}function mailReplaceDomainMentions(e,t){return e.replace(_mobile_lib_Mail__WEBPACK_IMPORTED_MODULE_1__.MENTION_DOMAIN_REGEXP,t)}function mailWrapMention(e){return Object(_mobile_lib_Mail__WEBPACK_IMPORTED_MODULE_1__.wrapMention)(e)}function getState(e){return window.isomorphicState&&window.isomorphicState[e]||[]}function wdToFlatArray(e){return _mobile_lib_Withdom__WEBPACK_IMPORTED_MODULE_5__.default.toFlatArray(e).map(_mobile_lib_Withdom__WEBPACK_IMPORTED_MODULE_5__.default.innerItemToString)}function fromCharCode(e){return String.fromCharCode(e)}function timestamp(){return Date.now()/1e3}function getDayNumberFromUnixtime(e){return new Date(1e3*e).getDate()}function getMonthNumberFromUnixtime(e){return new Date(1e3*e).getMonth()+1}function formatDuration(e){if(!e)return"";var t=Math.floor(e/3600),n=Math.floor(e/60)%60,i=e%60;return i>=3600?[t].concat([n,i].map((function(e){return e<10?"0"+e:""+e}))).join(":"):[n].concat([i].map((function(e){return e<10?"0"+e:""+e}))).join(":")}function arrayUnique(e){return e.filter((function(e,t,n){return n.indexOf(e)===t}))}function arrayFlat(e,t){return void 0===t&&(t=1),e.flat(t)}function toArray(e){return Array.from(e)}function arrayLength(e){return e.length}function isArray(e){return Array.isArray(e)}function arrayIncludes(e,t){return e.includes(t)}function inlineIconResolver(){return null}function isIconAlreadyInBundle(){return!1}function isSAKIntegration(){return _shared_lib_SAKIntegration__WEBPACK_IMPORTED_MODULE_6__.SAKIntegration.isIntegrated}function isEduIntegration(){return _shared_lib_SAKIntegration__WEBPACK_IMPORTED_MODULE_6__.SAKIntegration.isIntegrated&&"edu"===_shared_lib_SAKIntegration__WEBPACK_IMPORTED_MODULE_6__.SAKIntegration.type}function classNames(){return _vkontakte_vkjs__WEBPACK_IMPORTED_MODULE_7__.classNames.apply(void 0,arguments)}function langTag(e,t,n,i){return void 0===i&&(i="tag"),n=(n=n.replace("{"+i+"}",e)).replace("{/"+i+"}",t)}function arraySomeEqual(e,t,n){for(var i,a=_createForOfIteratorHelperLoose(e);!(i=a()).done;){if(i.value[t]===n)return!0}return!1}function preactCallbackKeywordsReplace(e,t,n){return e.map((function(e){return"event"===e?n:"this"===e?t:e}))}var evalCaller=function evalCaller(code,context){return function(){code=code.replace(/function\s?\(/gim,(function(e,t){return"function f"+t+"("}));var result=eval("(function(event) { "+code+" }).call(this, event)");return code.includes("return")?result:void 0}.call(context)};function preactCallback(e){if(!e)return null;if(Object(_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_2__.isFunction)(e))return e;if(isArray(e)){if(Object(_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_2__.flatArray)(e).every((function(e){return!Boolean(e)})))return null;if(e.every(Array.isArray)){var t=e.map((function(e){return preactCallback(e[0])}));return function(e){var n=e.currentTarget;t.map((function(t){return t.call(n,e)}))}}}return function(t){var n=t.currentTarget;if(Object(_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_2__.isString)(e))return evalCaller(e,n);if(isArray(e)){var i=e[0],a=e.slice(1),r=preactCallbackKeywordsReplace(a,n,t);if(Object(_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_2__.isFunction)(i))return i.apply(void 0,r);if(Object(_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_2__.isString)(i)){var o=a.reduce((function(e,t,n,i){return e+="event"!==t&&"this"!==t?"'"+t+"'":t,n!==i.length-1&&(e+=", "),e}),"").trim();return evalCaller(i+"("+o+");",n)}}}}function getLangReplace(e,t){for(var n in void 0===t&&(t={}),t)if(t.hasOwnProperty(n)){var i="{"+n+"}";e=e.replace(i,t[n])}return e}function winToUtf(e){return Object(_mobile_lib_Utils__WEBPACK_IMPORTED_MODULE_2__.winToUtf)(e)}function getNumShort(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0);var i=e;(e>=1e4&&e<1e6?i=Math.floor(e/1e3)+"K":e>=1e6&&(i=Math.round(e/1e6,1)+"M"),t)&&(i=e<1e4?getLangNumeric(e,t,n):getLangNumeric(789,t).replace(new RegExp(789,"g"),i));return i}},g3t9:function(e,t,n){"use strict";n.r(t),n.d(t,"Separator",(function(){return a}));var i=n("z9sQ");function a(e){return void 0===e&&(e={}),{class:[e.class,i.default.class("Separator",{hideOnDesktop:e.hideOnDesktop,noOffset:e.noOffset,gray:e.gray})],tag:"div"}}t.default=a},g5Vw:function(e,t,n){"use strict";n.r(t),n.d(t,"CartOrderSellerComment",(function(){return a})),n.d(t,"CartOrderSellerComment0",(function(){return o}));var i=n("fdw3");function a(e){return{inner:[{inner:[e.text],class:"CartOrderSellerComment__text",id:"cart_order_seller_comment_text",tag:"p"},{inner:[Object(i.getLang)("market_seller_comment_more_btn")],class:"CartOrderSellerComment__link",href:"?act=cart_seller_comment","aria-hidden":"true",id:"cart_order_seller_comment_link",tag:"a"}],class:"CartOrderSellerComment",tag:"div"}}var r=n("UlUB"),o={init:function(){var e;o.toggleSellerComment();var t=Object(r.throttle)(o.toggleSellerComment,200);window.addEventListener("resize",t),null===(e=window.cur.destroy)||void 0===e||e.push((function(){window.removeEventListener("resize",t)}))},toggleSellerComment:function(){var e=document.getElementById("cart_order_seller_comment_text"),t=document.getElementById("cart_order_seller_comment_link");if(e&&t){var n=e.scrollHeight<=e.offsetHeight;t.classList.toggle("CartOrderSellerComment__link--hidden",n)}}}},gF8j:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return s})),n.d(t,"getVisibilityState",(function(){return u})),n.d(t,"getVisiblityEvent",(function(){return d}));var i=n("uQjJ"),a=n("PU8N"),r=n("DLiR"),o=browser.iphone||browser.ipad||browser.ipod;function s(e){this.started=!1,this.is_idle=!0,this.activeTimeStart=null,this.cbActiveB=this.cbActive.bind(this),this.cbInactiveB=this.cbInactive.bind(this),this.onVisiblityChange=this.onVisiblityChange.bind(this),this.opts=extend({triggerEvents:"mousemove keydown",onIdleCb:function(){},onUnIdleCb:function(){},focusElement:e.element,element:null,idleTimeout:3e4},e)}function c(e,t,n){Object(a.isMvk)()?window.addEvent(e,t,n,{passive:!0}):window.addEvent(e,t,n)}function l(e,t,n){Object(a.isMvk)()?window.removeEvent(e,t,n,{passive:!0}):window.removeEvent(e,t,n)}function u(){return document.visibilityState||document.webkitVisibilityState}function d(){var e="visibilitychange";return document.visibilityState||(document.webkitVisibilityState?e+="webkit":e=""),e}extend(s.prototype,i.default.prototype),extend(s.prototype,{stop:function(){this.started=!1,l(this.opts.element,this.opts.triggerEvents,this.cbActiveB),Object(a.isMvk)()&&this._isTopLevel()&&d()&&l(document,d(),this.onVisiblityChange),Object(a.isMvk)()&&o||(l(this.opts.focusElement,"focus",this.cbActiveB),l(this.opts.focusElement,"blur",this.cbInactiveB)),clearTimeout(this.setIdleTo),clearTimeout(this.checkIdleCbTo),clearTimeout(this.sendCbTO),this.is_idle=!0,this.opts.parentManager&&this.opts.parentManager.off("idle",this.cbInactiveB)},idle:function(e){this.is_idle=!0,e||this.opts.onIdleCb(),this.emit("idle")},unidle:function(e){this.is_idle=!1,e||this.opts.onUnIdleCb(),this.emit("unidle")},start:function(){this.started=!0,!Object(a.isMvk)()&&browser.mobile||(this.is_idle=!this._isFocused(),this.opts.parentManager&&this.opts.parentManager.on("idle",this.cbInactiveB),Object(a.isMvk)()&&this._isTopLevel()&&d()&&c(document,d(),this.onVisiblityChange),Object(a.isMvk)()&&o||(c(this.opts.focusElement,"focus",this.cbActiveB),c(this.opts.focusElement,"blur",this.cbInactiveB)),clearTimeout(this.checkIdleCbTo),this.checkIdleCb(),this.checkIdleCbTo=setTimeout(this.checkIdleCb.bind(this),this.opts.idleTimeout))},checkIdleCb:function(){this.started&&(c(this.opts.element,this.opts.triggerEvents,this.cbActiveB),clearTimeout(this.setIdleTo),this.setIdleTo=setTimeout(this.cbInactiveB,this.opts.idleTimeout))},cbActive:function(){this.started&&(this.activeTimeStart=(new Date).getTime(),clearTimeout(this.setIdleTo),this.is_idle&&(this.is_idle=!1,clearTimeout(this.sendCbTO),this.sendCbTO=setTimeout(function(){this.emit("unidle"),this.opts.onUnIdleCb&&this.opts.onUnIdleCb()}.bind(this),100)),l(this.opts.element,this.opts.triggerEvents,this.cbActiveB),clearTimeout(this.checkIdleCbTo),this.checkIdleCbTo=setTimeout(this.checkIdleCb.bind(this),this.opts.idleTimeout))},cbInactive:function(){this.started&&(r.screenWakeLocker.isLocked()||(this.activeTimeStart=null,this.is_idle||(this.is_idle=!0,clearTimeout(this.sendCbTO),this.sendCbTO=setTimeout(function(){this.emit("idle"),this.opts.onIdleCb&&this.opts.onIdleCb()}.bind(this),100)),clearTimeout(this.checkIdleCbTo),l(this.opts.element,this.opts.triggerEvents,this.cbActiveB),c(this.opts.element,this.opts.triggerEvents,this.cbActiveB),this.checkIdleCbTo=setTimeout(this.checkIdleCb,this.opts.idleTimeout)))},getActiveTime:function(){return!this.is_idle&&this.activeTimeStart?(new Date).getTime()-this.activeTimeStart:0},onVisiblityChange:function(){"visible"===u()?this.cbActiveB():this.cbInactiveB()},_isTopLevel:function(){var e=this.opts.focusElement;return e===window||e===document},_isFocused:function(){var e=this.opts.focusElement;if(this._isTopLevel()){var t=u();return"string"==typeof t&&"visible"===t}return document.activeElement===e}})},gNTM:function(e,t){var n=function(){var e=null,t=!1;function i(e,t){var n=ge("medias_map"),i=ge("attached_wrap");n||(n=ce("div",{id:"medias_map",className:"pi_medias"}),i.appendChild(n));var a=e.latitude,r=e.longitude,o=(window.devicePixelRatio,geByClass1("medias_map",n)),s=t?'<div class="medias_map_close"><i class="i_close">&nbsp;</i></div><div class="medias_map_label">'+t+"</div>":"",c='<input type="hidden" name="map" value="'+(a+"_"+r+"_0")+'">';o?val(o,s+""+c):val(n,'<div class="meias_row medias_map" onclick="geoloc.remove();">'+s+c+"</div>");show(n)}function a(){e=null,remove("medias_map")}function r(t){var n;t&&t.coords&&(e={latitude:+t.coords.latitude||0,longitude:+t.coords.longitude||0},n=e,ajax.post("/places.php",{_ajax:1,act:"map_label",lat:n.latitude,lng:n.longitude},{onDone:function(e){hide("geo_waiting"),i(n,e)},onFail:o}))}function o(e){n.remove(),hide("geo_waiting")}return{toggle:function(){t?n.remove():n.add()},add:function(n){!n&&t||(t=!0,addClass("cp_geo_btn_sel","geo_btn"),n&&(n.latitude||n.longitude)?i(e={latitude:+n.latitude||0,longitude:+n.longitude||0},n.label):(geo.getCurrentPosition(r,o),show("geo_waiting")))},remove:function(){t&&(t=!1,removeClass("cp_geo_btn_sel","geo_btn"),a())},init:function(e){return e&&n.add(e),geo.init()}}}();window.geoloc=n},gy8s:function(e,t,n){"use strict";n.r(t);var i=n("bZ/P"),a=n("Mc5h"),r=n("9y81"),o=n("AXyT"),s=n("Y6JH"),c=n("0oyq"),l=n("uBUF"),u=n("fdw3"),d=function(e){var t="unfold-"+Date.now()+"-"+Math.round(9999*Math.random());e.uniqueId=t;var n=i.default.class(e.mix,"Unfold",{position:e.position,asIcon:!!e.icon||!!e.icon_html,open:e.opened,withTitle:!!e.title}),a=i.default.list(e.items,f);return Wd.html({inner:[Object(l.CustomTag)({inner:[_(e)],tag:e.triggerWrapperTag,class:"Unfold__trigger"}),{inner:[Wd.wrap(a)],id:t,class:["Unfold__popup","ScrollView",e.popup_class].filter((function(e){return e})).join(" "),role:"menu",tag:"div"}],class:n,"data-name":e.name,onclick:e.onclick,tag:"div"})};function _(e){var t,n=e.title;if(e.icon)t=Object(r.default)({icon:e.icon});else if(e.icon_html)t=e.icon_html;else{for(var o=e.items,l=o.length,d="",_="",f=0;f<l;f++){var p=o[f];if(p&&p.active){d=p.text,_=p.activeCount;break}}t=[Object(a.default)({mix:"Unfold__triggerText",tag:"div",inner:Wd.html({inner:[n?[{inner:[n],class:"Unfold__triggerContentTitle",tag:"div"},{inner:[d],class:"Unfold__triggerContentSubTitle",tag:"div"}]:[d]],class:"Unfold__triggerContent",tag:"div"})}),!n&&_?Object(a.default)({mix:"Unfold__triggerTextCount",inner:_}):"",Wd.html({inner:[Object(s.default)(Object(c.getDropdown16Icon)())],class:"Unfold__triggerIcon",tag:"div"})],t=i.default.list(t)}var h=e.opened?e.close_url:e.open_url,m=Object(u.mergeObjects)({},e.trigger_attrs);return e.isDisabled&&(m.disabled=!0),{inner:[Wd.wrap(t)],type:"button","aria-haspopup":"true","aria-expanded":"false","aria-controls":e.uniqueId,href:h,class:"Unfold__trigger",onclick:["Unfold._onTriggerClick","this"],attrs:m,tag:"button"}}function f(e){if(!e)return"";var t="";return e.svgIcon?t=Wd.html({inner:[e.svgIcon],class:"Unfold__itemIcon",tag:"div"}):e.icon&&(t="string"==typeof e.icon?Object(r.default)({mix:"Unfold__itemIcon",icon:e.icon}):Object(a.default)({mix:i.default.class("Unfold__itemIcon"),inner:Wd.html(e.icon)})),e.attrs+=' data-name="'+e.name+'" role="menuitem" tabindex="-1"',e.active&&(e.attrs+=' aria-current="true"'),e.preventNavigation&&(e.attrs+=' data-prevent-navigation="1"'),Object(a.default)({inner:[t,Object(a.default)({inner:[e.text,e.count?Object(a.default)({mix:"Unfold__itemCountHidden",inner:e.count}):""],mix:"Unfold__itemText"}),e.count?Object(o.default)({mix:"Unfold__itemCount",gray:!0,value:e.count}):""],mix:i.default.class(e.mix,"_touched","replaceState","Unfold__item",{active:e.active,name:e.name,disabled:e.disabled,replaceState:e.replaceState}),url:e.url,tag:e.tag,attrs:e.attrs})}var p=n("OcsD"),h=n("UxAg"),m=n("jk6M"),v=n("CQvH");Object.assign(d,{onOpen:befall.kind("unfoldName"),getByName:function(e){return Object(h.$)(C.unfoldByName(e))},setActive:j,setCount:function(e,t,n){var i=e.$(C.itemCountByName(t));o.default.setValue(i,n)},setTitle:function(e,t,n){e.$(C.itemByName(t)).$(C.itemText).innerText=n},toggleItemEnabled:function(e,t,n){void 0===n&&(n=!0);if(!e)return;var i=e.$(C.itemByName(t));i&&i.classList.toggle(A,!n)},changePosition:function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!1);var i;e.classList.remove(w,y,O,S),i=t?n?w:O:n?y:S;e.classList.add(i)}}),d._onTriggerClick=E;var g="Unfold__item_active",A="Unfold__item_disabled",b="Unfold_open",w="Unfold_position_topLeft",y="Unfold_position_topRight",O="Unfold_position_bottomLeft",S="Unfold_position_bottomRight",k="Unfold__item_replaceState",C={unfold:".Unfold",unfoldByName:function(e){return'.Unfold[data-name="'+e+'"]'},itemActive:"."+g,itemByName:function(e){return".Unfold__item_name_"+e},itemCountByName:function(e){return C.itemByName(e)+" .Unfold__itemCount"},item:".Unfold__item",itemDisabled:"."+A,triggerText:".Unfold__triggerText",itemText:".Unfold__itemText",popup:".Unfold__popup"};function j(e,t){var n,i;if(1===arguments.length?e=(i=e).closest(C.unfold):i=e.$(C.itemByName(t)),(n=e.$(C.itemActive))&&i){n.classList.remove(g),i.classList.add(g);var a=e.$(C.triggerText),r=i.$(C.itemText);a.innerText=r.textContent.trim()}}function E(e){var t=e.closest(C.unfold),n=m.isTouch?"touchend":"mousedown",i=m.isTouch?"touchend":"mouseup",a=!m.isTouch&&window.innerWidth<882,r=t.getAttribute("data-name"),o=!1;r&&d.onOpen(r)(),t.classList.add(b),document.addEventListener("touchmove",_),m.default.msie_mobile?document.addEventListener(i,f,!0):document.addEventListener(n,g,!0);var s=function(){},c=function(){},l=Object(h.$)(C.popup,t);function u(){t.classList.remove(b),document.removeEventListener("touchmove",_),document.removeEventListener(n,g,!0),document.removeEventListener(i,f,!0),Object(v.onTransitionEnd)(l).then((function(){c&&c(),s&&s()}))}function _(e){e.target.closest(C.popup)||u(),o=!0}function f(){document.addEventListener(n,g,!0)}function g(e){if(o)o=!1;else{var t=e.target.closest(C.itemDisabled);if(!t){var n=e.target.closest(C.item+"[href]");if(n){if(m.default.safari&&m.default.safari_mobile&&m.default.version<9)setTimeout(u,500);else{Object(p.cancelEvent)(e);var i=Object(p.domData)(n,"prevent-navigation");if(i||nav.onBeforeGo((function(){u()})),n.classList.contains(k))j(n.closest(C.unfold),Object(p.domData)(n,"name"));i?u():nav.go(n)}return}if(n=e.target.closest(C.item+"[onclick]")||e.target.closest(C.item+"[onmousedown]"))return void setTimeout(u);if(n=e.target.closest("label"+C.item))return void(m.default.safari&&m.default.safari_mobile&&m.default.version<9?setTimeout(u,500):setTimeout(u));if(n=e.target.closest("input[onchange]"))return void(m.default.safari&&m.default.safari_mobile&&m.default.version<9?setTimeout(u,500):setTimeout(u))}(m.isTouch||a||t)&&(e.preventDefault(),e.stopImmediatePropagation()),(a||!m.isTouch&&t)&&document.addEventListener("click",A,!0),t||u()}}function A(e){e.preventDefault(),e.stopImmediatePropagation(),document.removeEventListener("click",A,!0)}l&&Object(v.onTransitionEnd)(l).then((function(){(c=Object(v.expandPopup)(e)).exitIntent=function(){return!1},(s=Object(v.setMenuNavigation)(l))&&(s.exitIntent=function(){return u(),!1})}))}t.default=d;window.Unfold=d},h8oe:function(e,t,n){"use strict";n.r(t),n.d(t,"rescan",(function(){return E})),n.d(t,"trackMarketEvent",(function(){return T})),n.d(t,"trackMarketArea",(function(){return I}));var i=n("Fkq0"),a=n("z9Td"),r=n("tGJf"),o=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),a=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,a++)i[a]=r[o];return i};function s(e,t,n,a){var s=window.MarketAnalyticsManager&&window.MarketAnalyticsManager.getHash();if(s){var l=n.slice(0,10),u=0,d=r.vkLocalStorage.getItem("market_event_count");d&&(u=parseInt(d)),u>=20&&(c(e),u=0);var _=Date.now(),f="market_event_item_"+Math.floor(1e5*Math.random())+"_"+_+"_"+t;l.unshift(_),l.unshift(t),l.push(s),r.vkLocalStorage.setItem(f,JSON.stringify(l)),r.vkLocalStorage.setItem("market_event_count",String(++u)),a&&c(e),i.marketDebug.apply(void 0,o(["debug","event",t],n))}else Object(i.marketDebug)("warn","events","Hash error")}function c(e){for(var t=[],n=0;n<r.vkLocalStorage.length();++n){var o=r.vkLocalStorage.key(n);o&&0===o.lastIndexOf("market_event_item_")&&t.push(o)}if(!(t.length<=0)){r.vkLocalStorage.setItem("market_event_count",String(0));var s=[],c="";t.forEach((function(e){var t=r.vkLocalStorage.getItem(e);if(r.vkLocalStorage.removeItem(e),t)try{var n=JSON.parse(t);c?n.pop():c=n.pop(),s.push(Object.values(n))}catch(e){Object(i.marketDebug)("error","event error","Unable to assemble events pack",e)}})),!c||s.length<1||(!window.MarketAnalyticsManager||window.MarketAnalyticsManager.isEnabled()?window.ajax.post(e===a.PLATFORM_MVK?"market.php":"al_market.php",{act:"log_events",hash:c,events:s},{onDone:function(){Object(i.marketDebug)("warn","events sent",s.length+" events sent")}}):Object(i.marketDebug)("error","event error","analytics disabled"))}}var l=function(){function e(){}return e.prototype.connectMutator=function(t){if(this.mutationObserver)throw new Error("{Observer #"+t.getObserverId()+"} MutationObserver already connected to observer");var n=document.querySelector(t.getContainerQuery());n instanceof HTMLElement&&(this.mutationObserver=new MutationObserver((function(n){n.forEach((function(n){if(n.addedNodes)for(var i=0;i<n.addedNodes.length;i++){var a=n.addedNodes[i];if(a instanceof HTMLElement){var r=e.resolveNodes(a,t).filter((function(e){return!!e}));r&&(r.forEach((function(e){t.add(e)})),t.scan())}}}))})),this.mutationObserver.observe(n,{childList:!0,subtree:!0,attributes:!1,characterData:!1}))},e.prototype.disconnectMutator=function(e){e.isRunning()&&this.mutationObserver&&this.mutationObserver.disconnect()},e.resolveNodes=function(e,t){var n=[];if(t.getSelectorQuery(!1).split(",").forEach((function(t){if(e.matches(t))return n.push(e),!1})),n.length<1){var i=e.querySelectorAll(t.getSelectorQuery(!1));n=Array.from(i)}return n},e}(),u=n("BJj/"),d={};function _(){for(var e in d){if(d[e])d[e].stop()}}function f(){var e=r.vkSessionStorage.getItem("market_stat_data");return e&&JSON.parse(e)||{}}var p=function(){return(p=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},h=function(){function e(e,t,n,i,a,r){var o;if(void 0===n&&(n=""),void 0===i&&(i=!1),void 0===a&&(a=""),this.observerId=e,this.itemSelector=t,this.container=n,this.isUnifyNodes=i,this.platform=a,this.getExtraItemParams=r,this.trackingItems={},this._debounceTimeout=20,this.uniqueNodeCounter=0,this.nodes=[],this.isWatching=!1,this.mutatorList=[],(o=this).getObserverId()in d&&(d[o.getObserverId()].stop(),delete d[o.getObserverId()]),d[o.getObserverId()]=o,!this.itemSelector.types&&!this.itemSelector.selectors)throw new Error("Empty itemSelector definition");this.container||(this.container=this.observerId)}return Object.defineProperty(e.prototype,"debounceTimeout",{set:function(e){this._debounceTimeout=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemReachedCallback",{set:function(e){this._itemReachedCallback=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preCheckReachedCallback",{set:function(e){this._preCheckReachedCallback=e},enumerable:!0,configurable:!0}),e.prototype.getObserverId=function(){return this.observerId},e.prototype.getItemSelector=function(){return this.itemSelector},e.prototype.getPlatform=function(){return this.platform},e.prototype.add=function(e){this.nodes.push(e)},e.prototype.getTrackingItems=function(){return this.trackingItems},e.prototype.addMutators=function(e){this.mutatorList=this.mutatorList.concat(e)},e.prototype.isRunning=function(){return this.isWatching},e.prototype.watch=function(){this.isWatching||(this.update(),this.startObserving(),this.connectMutators(),this.isWatching=!0)},e.prototype.stop=function(){this.isWatching&&(this.trackUntracked(),this.stopObserving(),this.disconnectMutators(),this.isWatching=!1)},e.prototype.scan=function(){this.viewportScanner()},e.prototype.trackUntracked=function(){var e=this.getTrackingItems();for(var t in e)if(e[t]){var n=e[t];!n.isTracked&&n.isReached&&(this.track(n),this.persist(n))}},e.prototype.connectMutators=function(){var e=this;this.mutatorList.forEach((function(t){t.connectMutator(e)}))},e.prototype.disconnectMutators=function(){var e=this;this.mutatorList.forEach((function(t){t.disconnectMutator(e)}))},e.prototype.getContainerQuery=function(){var e=this.container.substr(0,1);return"#"===e||"."===e?this.container:'[data-stat-container="'+(this.container?this.container:this.observerId)+'"]'},e.prototype.getSelectorQuery=function(e){void 0===e&&(e=!0);var t=this.getContainerQuery(),n=[];return this.itemSelector.selectors?n=this.itemSelector.selectors.split(",").map((function(n){return e?t+" "+n:n})):this.itemSelector.types&&(n=this.itemSelector.types.split(",").map((function(n){return e?t+' [data-stat-item^="'+n+'|"]':'[data-stat-item^="'+n+'|"]'}))),n.join(",")},e.prototype.update=function(){var e=document.querySelectorAll(this.getSelectorQuery());this.nodes=Array.from(e)},e.parseStatAttribute=function(e){var t=e.getAttribute("data-stat-item"),n=null==t?void 0:t.split("|");return n?{type:n[0],ownerId:parseInt(n[1]),itemId:n[2]}:{type:"",ownerId:0,itemId:0}},e.prototype.getNodeKey=function(e,t){var n=String(t.itemId);this.isUnifyNodes&&(this.unifyNode(e),n=n+"_"+e.getAttribute("data-stat-id"));return this.observerId+"_"+n},e.prototype.isItemReached=function(e){return!(void 0!==this._preCheckReachedCallback&&!this._preCheckReachedCallback(e))&&this.isReached(e)},e.prototype.filterItem=function(e){return!e.isTracked&&!e.isReached&&(this.isItemReached(e.node)?(this.track(e),this.persist(e),!1):(this.persist(e),!0))},e.prototype.track=function(e){e.isTracked||(e.viewEnd=Date.now(),e.duration=e.viewEnd-e.viewStart,this._itemReachedCallback(e),e.isReached=!1,e.isTracked=!0)},e.prototype.persist=function(e){this.trackingItems[e.key]=e},e.prototype.getTrackingItem=function(t){var n=e.parseStatAttribute(t);if(!n.type||!n.itemId)return null;var i=this.getNodeKey(t,n);return i?i in this.trackingItems?this.trackingItems[i]:this.createTrackingItem(t,n):null},e.prototype.createTrackingItem=function(e,t){var n=this.getNodeKey(e,t),i=this.getExtraItemParams&&this.getExtraItemParams()||{};return this.trackingItems[n]=p(p({},i),{key:n,type:t.type,observerId:this.observerId,ownerId:t.ownerId,itemId:t.itemId,isTracked:!1,isReached:!1,viewStart:0,viewEnd:0,duration:0,node:e,viewTimer:0,data:{},platform:this.getPlatform(),city:f().city,screen:f().screen}),this.trackingItems[n]},e.prototype.getNextUnifyId=function(){return++this.uniqueNodeCounter},e.prototype.unifyNode=function(e){e.getAttribute("data-stat-id")||e.setAttribute("data-stat-id",String(this.getNextUnifyId()))},e.prototype.startObserving=function(){var e=this;this.update(),this.viewportScanner=Object(u.debounce)((function(){e.nodes=e.nodes.filter((function(t){var n=e.getTrackingItem(t);return!!n&&e.filterItem(n)}))}),this._debounceTimeout),this.scrollEventListener=function(){return e.scan()},document.addEventListener("scroll",this.scrollEventListener,{passive:!0}),this.scan()},e.prototype.stopObserving=function(){document.removeEventListener("scroll",this.scrollEventListener),this.nodes=[],this.viewportScanner=function(){},this.scrollEventListener=function(){}},e}();var m,v=(m=function(e,t){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}m(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),t.prototype.filterItem=function(e){return!e.isTracked&&(e.isReached&&!this.isItemReached(e.node)?(this.track(e),this.persist(e),!1):(this.isItemReached(e.node)&&this.view(e),this.persist(e),!0))},t.prototype.view=function(e){var t=this;e.isTracked||(e.isReached=!0,e.viewStart||(e.viewStart=Date.now()),e.viewTimer&&(clearTimeout(e.viewTimer),e.viewTimer=0),e.viewTimer=window.setTimeout((function(){var n=e.node;!t.isItemReached(n)||function(e){var t=e.viewStart;return Date.now()-t>3e4}(e)?t.track(e):t.view(e)}),3e3))},t.prototype.track=function(t){t.viewTimer&&(clearTimeout(t.viewTimer),t.viewTimer=0),e.prototype.track.call(this,t)},t}(h),A=n("ZD4m"),b=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),w=function(e){function t(n,i,a,r,o,s,c){void 0===a&&(a=""),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===s&&(s="");var u=e.call(this,n,i,a,r,s,c)||this;return u.observerId=n,u.itemSelector=i,u.container=a,u.isUnifyNodes=r,u.isDynamicNodes=o,u.gap=null,o&&u.addMutators([new l]),u.gap=t.getViewportGap(u.getPlatform()),u}return b(t,e),t.prototype.isReached=function(e){if(!Object(i.isElementVisible)(e))return!1;var t,n=this.gap,a=e.closest("[data-stat-viewport]");if(a){var r=a.getBoundingClientRect();n={top:r.top,left:r.left},t={width:r.left+r.width,height:r.top+r.height}}return Object(i.isElementInViewport)(e,45,n,t)},t.create=function(e){return new t(e.observerId,e.itemSelector,null==e?void 0:e.container,null==e?void 0:e.isUnifyNodes,null==e?void 0:e.isDynamicContent,null==e?void 0:e.platform,null==e?void 0:e.getExtraItemParams)},t.getViewportGap=function(e){void 0===e&&(e="");var t={left:0,top:0},n="";return n=e===a.PLATFORM_MVK?"#vk_head":"#page_header_wrap,#market_search_input",document.querySelectorAll(n).forEach((function(e){var n=Object(A.getElementSize)(e);t.top=t.top+n.height})),t},t}(g),y=n("RJa5"),O=[],S=!1;function k(e,t){void 0===t&&(t=0);var n=C(t);return!!n&&e.includes(n.event)}function C(e){return void 0===e&&(e=0),O.length>e?O[O.length-(1+e)]:null}function j(e){S||(window.addEventListener("beforeunload",(function(){_(),c(e)})),S=!0)}function E(){!function(){for(var e in d){if(d[e])d[e].scan()}}()}function T(e){if(function(e){var t=C();if(t){if(e===y.ECommGoodsEvent.CLOSE_ITEM&&t.event===y.ECommGoodsEvent.CLOSE_ITEM)return!1;if(e===y.ECommGoodsEvent.TRANSITION_TO_ITEM){if(k([y.ECommGoodsEvent.TRANSITION_TO_ITEM_LEFT,y.ECommGoodsEvent.TRANSITION_TO_ITEM_RIGHT]))return!1;if(k([y.ECommGoodsEvent.SWITCH_ITEM_VARIANT_1,y.ECommGoodsEvent.SWITCH_ITEM_VARIANT_2]))return!1}}return!0}(e.event))if(e.event||e.table){e.table||(Object.values(y.ECommGoodsEvent).includes(e.event)?e.table=y.AnalyticsEventTable.GOODS:Object.values(y.ECommOrdersEvent).includes(e.event)?e.table=y.AnalyticsEventTable.ORDERS:Object(i.marketDebug)("error","table not specified")),e.screen=e.screen?e.screen:window.MarketAnalyticsManager&&window.MarketAnalyticsManager.getScreen(),e.platform=e.platform?e.platform:"web",e.itemType=e.itemType?e.itemType:"",j(e.platform);var t=String(e.event),n=e.table+":"+t;e.instant?function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];s(e,t,n,!0)}(e.platform,n,e.ownerId,e.itemId,e.screen,e.albumId,e.time,e.duration,e.itemType):function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];s(e,t,n,!1)}(e.platform,n,e.ownerId,e.itemId,e.screen,e.albumId,e.time,e.duration,e.itemType),O.push(e),O.length>3&&O.shift()}else Object(i.marketDebug)("error","event and table not specified",e)}function I(e,t){var n;switch(void 0===t&&(t=""),j(t),c(t),_(),Object(i.marketDebug)("warn","analytics: start tracking area",e),e){case y.AnalyticsArea.MARKET:n=function(e){var t=0;void 0!==window.cur.aid&&(t=window.cur.aid),T({event:"market_item"===e.type?y.ECommGoodsEvent.VIEW_ITEM:y.ECommGoodsEvent.VIEW_ALBUM,ownerId:e.ownerId,itemId:"market_item"===e.type?e.itemId:0,albumId:"market_item"===e.type?t:e.itemId,duration:e.duration,time:e.viewStart,platform:e.platform})};var r=w.create({observerId:"market_products",itemSelector:{types:"market_item"},isUnifyNodes:!0,isDynamicContent:!0,platform:t});r.itemReachedCallback=n;var o=w.create({observerId:"market_albums",itemSelector:{types:"market_album"},isUnifyNodes:!0,isDynamicContent:!1,platform:t});o.itemReachedCallback=n,t!==a.PLATFORM_MVK&&(o.preCheckReachedCallback=function(e){var t,n=e.offsetTop,i=null===(t=e.parentNode)||void 0===t?void 0:t.parentNode;return i&&n<i.offsetHeight}),r.watch(),o.watch();break;case y.AnalyticsArea.GROUP:n=function(e){T({event:"market_item"===e.type?y.ECommGoodsEvent.VIEW_ITEM:y.ECommGoodsEvent.VIEW_ALBUM,ownerId:e.ownerId,itemId:"market_item"===e.type?e.itemId:0,albumId:"market_item"===e.type?0:e.itemId,duration:e.duration,time:e.viewStart,platform:e.platform})};var s=w.create({observerId:"market_module",itemSelector:{types:"market_item"},isUnifyNodes:!0,platform:t});s.itemReachedCallback=n;var l=w.create({observerId:"group_wall",itemSelector:{types:"market_item,market_album"},isUnifyNodes:!0,isDynamicContent:!0,platform:t});l.itemReachedCallback=n,s.watch(),l.watch();break;case y.AnalyticsArea.USER_PROFILE:var u=w.create({observerId:"user_wall",itemSelector:{types:"market_item,market_album"},isUnifyNodes:!0,isDynamicContent:!0,platform:t});u.itemReachedCallback=function(e){T({event:"market_item"===e.type?y.ECommGoodsEvent.VIEW_ITEM:y.ECommGoodsEvent.VIEW_ALBUM,ownerId:e.ownerId,itemId:"market_item"===e.type?e.itemId:0,duration:e.duration,time:e.viewStart,albumId:"market_item"===e.type?0:e.itemId,platform:e.platform})},u.watch();break;case y.AnalyticsArea.BOOKMARKS:var d=w.create({observerId:"bookmarks",itemSelector:{types:"market_item"},isUnifyNodes:!0,isDynamicContent:!0,platform:t});d.itemReachedCallback=function(e){T({table:y.AnalyticsEventTable.GOODS,event:y.ECommGoodsEvent.VIEW_ITEM,ownerId:e.ownerId,itemId:e.itemId,duration:e.duration,time:e.viewStart,albumId:0,platform:e.platform})},d.watch();break;case y.AnalyticsArea.FEED:var f=w.create({observerId:"feed",itemSelector:{types:"market_item"},isUnifyNodes:!0,isDynamicContent:!0,container:".feed_wrap",platform:t});f.itemReachedCallback=function(e){T({event:"market_item"===e.type?y.ECommGoodsEvent.VIEW_ITEM:y.ECommGoodsEvent.VIEW_ALBUM,ownerId:e.ownerId,itemId:"market_item"===e.type?e.itemId:0,duration:e.duration,time:e.viewStart,albumId:"market_item"===e.type?0:e.itemId,platform:e.platform})},f.watch()}}},hC3G:function(e,t,n){"use strict";n.r(t),n.d(t,"PINNED_CONVERSATION_BIT_MASK",(function(){return i})),n.d(t,"MASS_MENTION_ALIASES",(function(){return a})),n.d(t,"MASS_MENTION_REGEXP",(function(){return r})),n.d(t,"VK_OFFICIAL_PEER_ID",(function(){return o}));var i=112,a={all:["all","everyone","все"],online:["online","here","здесь","тут"]},r=new RegExp(['(?!,|;|:|\\.|\\s|<br ?/?>|"|\\(|\\)|\\[|\\]|!|\\?)',"(",[].concat(a.all).concat(a.online).map((function(e){return"@"+e+"|\\*"+e})).join("|"),")",'(?=$|,|;|:|\\.(?![a-z0-9_-])|\\s|<br ?/?>|"|\\(|\\)|\\[|\\]|!|\\?)'].join(""),"gi"),o=-22822305},he4e:function(e,t,n){"use strict";n.r(t),n.d(t,"clear",(function(){return _})),n.d(t,"onClear",(function(){return l})),n.d(t,"onClearConfirm",(function(){return f})),n.d(t,"onClearDecline",(function(){return p})),n.d(t,"isCleared",(function(){return d}));var i=n("OcsD"),a=n("+cqQ"),r=n("UxAg"),o=n("r/ag"),s=n("29dZ"),c=n("zouF"),l=Object(a.default)(),u={};function d(e){var t=/([a-z]*)(-?\d+)?(?:_(-?\d+))?/.exec(e)[2];return!!u[t]||!!u[e]}function _(e,t,n,a,r,o){if(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),o){s.default.setLoading(e,!0,"white");var l="restr_"+Object(i.srand)(),u=e.closest(".PostPhotoRestriction");Object(i.domData)(u,"clear-id",l),function(e,t,n,i,a){window.photoview._toggleTouches(!1),window.clog("[PostPhotoRestriction] Show confirm to unblur "+i),Object(c.Confirm)(t,"PostPhotoRestriction.onClearConfirm('"+e+"', '"+i+"', '"+a+"')","PostPhotoRestriction.onClearDecline('"+e+"')",{id:e,ok_text:n})}(l,n,a,r,o)}else window.clog("[PostPhotoRestriction] No hash was provided")}function f(e,t,n){o.default.close(Object(i.ge)(e)),window.photoview._toggleTouches(!0),window.ajax.post(t+"?act=unblur&hash="+n,{},{onDone:function(n){var a=Object(r.$)('[data-clear-id="'+e+'"]');if(a){var o=Object(r.$)(".SplashScreen__more .Btn",a);s.default.setLoading(o,!1),a.classList.add("PostPhotoRestriction--clear")}else window.clog("[PostPhotoRestriction] Can't find restriction el with clear id "+e);var c=/([a-z]*)(-?\d+)?(?:_(-?\d+))?/.exec(t),d=c[2],_=c[3],f=[];n?(f.push.apply(f,Object(r.$$)('.thumb_map_img--blur[data-id^="'+d+'"]')),f.push.apply(f,Object(r.$$)('.thumb_map_img--blur[href^="/photo'+d+'"]'))):(f.push(Object(r.$)('.thumb_map_img--blur[data-id="'+d+"_"+_+'"]')),f.push(Object(r.$)('.thumb_map_img--blur[href^="/photo'+d+"_"+_+'"]'))),f.forEach((function(e){if(e){e.classList.remove("thumb_map_img--blur");var t=Object(r.$)(".PostPhotoRestriction--blur,.PostPhotoRestriction--blurWithText",e);Object(i.re)(t)}})),n&&(u[""+d]=!0),u[t]=!0,l(t);var p=[];n?p.push.apply(p,Object(r.$$)('.PhotosPhotoItem__photo[data-id^="'+d+'"]')):p.push(Object(r.$)('.PhotosPhotoItem__photo[data-id="'+t.replace("photo","")+'"]')),p.forEach((function(e){if(e){e.classList.remove("PhotosPhotoItem__photo--blur");var t=Object(r.$)(".PhotosPhotoItem__restriction",e);Object(i.re)(t)}}));var h=[];n?h.push.apply(h,Object(r.$$)('.AlbumItem__thumb--blur[data-thumb-id^="'+d+'"]')):h.push(Object(r.$)('.AlbumItem__thumb--blur[data-thumb-id="'+t.replace("photo","")+'"]')),h.forEach((function(e){if(e){e.classList.remove("AlbumItem__thumb--blur");var t=Object(r.$)(".AlbumItem__restriction",e);Object(i.re)(t)}})),setTimeout((function(){Object(i.remove)(a)}),500)}})}function p(e){var t=Object(r.$)('[data-clear-id="'+e+'"]'),n=Object(r.$)(".SplashScreen__more .Btn",t);window.photoview._toggleTouches(!0),o.default.close(Object(i.ge)(e)),s.default.setLoading(n,!1)}nav.onBeforeGo((function(){Object(r.$$)(".Confirm[id^=restr]").forEach((function(e){p(e.id)}))}))},hw56:function(e,t,n){"use strict";n.r(t),n.d(t,"getKeyboardState",(function(){return c})),n.d(t,"getKeyboardType",(function(){return l})),n.d(t,"setKeyboardType",(function(){return u})),n.d(t,"clearCallbackButtons",(function(){return _})),n.d(t,"stopCallbackButtonWaiting",(function(){return f})),n.d(t,"registerCallbackButtonEvent",(function(){return p})),n.d(t,"loadDrafts",(function(){return h})),n.d(t,"getPeerDraft",(function(){return m})),n.d(t,"setPeerDraft",(function(){return v})),n.d(t,"pushPeerAttachments",(function(){return g})),n.d(t,"popPeerAttachments",(function(){return A})),n.d(t,"setPeerTyping",(function(){return b})),n.d(t,"removePeerTypingUser",(function(){return w})),n.d(t,"filterPeerTypingUser",(function(){return y})),n.d(t,"replacePeer",(function(){return S})),n.d(t,"removePeer",(function(){return k})),n.d(t,"addPeer",(function(){return C})),n.d(t,"addPendingMsg",(function(){return j})),n.d(t,"getPendingMsg",(function(){return E})),n.d(t,"removePendingMsg",(function(){return T})),n.d(t,"removeFailedMsg",(function(){return I})),n.d(t,"failAllPendingMsgs",(function(){return M})),n.d(t,"queueToPresendMsgs",(function(){return P})),n.d(t,"saveFolderScroll",(function(){return D})),n.d(t,"restoreFolderScroll",(function(){return x}));var i=n("wx14"),a=(n("2IoG"),n("qHA9")),r=n("29dZ"),o=n("jE6c"),s=n("OcsD");function c(e){var t=store.mail.cur.keyboards,n=t[e];return n||(n=t[e]={}),n}function l(){return store.mail.cur&&store.mail.cur.keyboardType||""}function u(e){store.mail.cur&&(store.mail.cur.keyboardType=e)}var d={};function _(e,t){void 0===t&&(t=!1),store.mail.cur.pressedButtons&&(t?delete store.mail.cur.pressedButtons.msgs[t]:delete store.mail.cur.pressedButtons.peers[e])}function f(e){var t=d[e];if(t){var n,i=t.peerId,a=t.msgId,o=t.position,s=t.button,c=t.inline;if(c?store.mail.cur.pressedButtons.msgs[a]&&delete store.mail.cur.pressedButtons.msgs[a][o.join(",")]:store.mail.cur.pressedButtons.peers[i]&&delete store.mail.cur.pressedButtons.peers[i][o.join(",")],delete d[e],!bodyNode.contains(s))(n=c?$(".msg_id_"+a+" .BotsKeyboard__main"):$(".uMailWrite__keyboard .BotsKeyboard__main"))&&(s=$('.BotsKeyboard__button[data-position="'+o.join(",")+'"]',n));s&&r.default.setLoading(s,!1)}}function p(e,t,n,i,a){var c=(Object(s.domData)(t,"position")||"").split(",");if(!c)return r.default.setLoading(t,!1),clog("Can't find button position for callback event"),!1;if(d[n]={time:Object(o.vkNow)(),peerId:e,msgId:i,button:t,position:c,inline:!!i},store.mail.cur.pressedButtons||(store.mail.cur.pressedButtons={peers:{},msgs:{}}),c[0]&&c[1])if(i){var l="";a&&(l=a+"|"),store.mail.cur.pressedButtons.msgs[i]||(store.mail.cur.pressedButtons.msgs[i]={}),store.mail.cur.pressedButtons.msgs[i][l+c.join(",")]=n}else store.mail.cur.pressedButtons.peers[e]||(store.mail.cur.pressedButtons.peers[e]={}),store.mail.cur.pressedButtons.peers[e][c.join(",")]=n;setTimeout((function(){f(n)}),6e4)}function h(e){var t=store.mail.cur.drafts;return t||(t=lsGet("mail_drafts_"+e),t=store.mail.cur.drafts=t||{}),t}function m(e,t){var n=h(e);return n[t]||(n[t]={})}function v(e,t,n,a){var r=store.mail.cur.drafts;if(r||(r=store.mail.cur.drafts=r||{}),a){var o=r[t],s=o&&o.editing&&o.editing.id===a?o.editing:void 0;r[t]=Object(i.default)({},o,{editing:Object(i.default)({},s,{},n,{id:a})})}else r[t]=Object(i.default)({},r[t],{},n,{editing:void 0});lsSet("mail_drafts_"+e,r)}function g(e,t){var n=store.mail.peers[e];n.attachmentsStack.push(n.attachmentsHTML),n.attachmentsHTML=t}function A(e){var t=store.mail.peers[e],n=t.attachmentsStack.pop();n||(n=Brick({mix:"cp_attached_wrap",attrs:'id="attached_wrap"'})),t.attachmentsHTML=n}function b(e,t){var n=store.mail.cur.typings[e];if(n||(n=store.mail.cur.typings[e]={}),"text"!==t.type&&"audio"!==t.type||(t.count?n[t.type]=t:n[t.type]=null),n.text&&n.audio){var i=O(n.text,n.audio);n.mixed=i.count>1?i:null}else n.mixed=null}function w(e,t){var n=store.mail.cur.typings[e];if(n){var i=n.audio,a=n.text;if(i&&((i=y(i,t)).count?n.audio=i:n.audio=null),a&&((a=y(a,t)).count?n.text=a:n.text=null),n.text&&n.audio){var r=O(n.text,n.audio);n.mixed=r.count>1?r:null}else n.mixed=null}}function y(e,t){var n=e.users.filter((function(e){return e!==t}));return n.length!==e.users.length&&(e.count=e.count-(e.users.length-n.length),e.users=n),e}function O(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){return e.count+=t.count,t.users.reduce((function(e,t){return-1===e.users.indexOf(t)?e.users.push(t):e.count--,e}),e)}),{users:[],count:0,type:"mixed"})}function S(e,t){var n=store.mail,i=n.scraps.folder,a=i.indexOf(e);-1!==a&&(t?i.splice(a,1,t):i.splice(a,1)),Object.keys(n.rolls.folder).forEach((function(i){var a=n.rolls.folder[i],r=a.indexOf(e);-1!==r&&(t?a.splice(r,1,t):a.splice(r,1))})),t&&(n.rolls.peer[t]=n.rolls.peer[e],n.reached.peer.before[t]=n.reached.peer.before[e],n.reached.peer.after[t]=n.reached.peer.after[e]),e!==t&&(n.rolls.peer[e]&&n.rolls.peer[e].forEach((function(i){var a=n.msgs[i];a&&(t?(a.peerId=t,a.authorId===e&&(a.authorId=t)):delete n.msgs[i])})),delete n.rolls.peer[e],delete n.reached.peer.before[e],delete n.reached.peer.after[e],delete n.members[e],delete n.peers[e])}function k(e,t){void 0===t&&(t={});var n=store.mail;if(!1!==t.lists){var i=n.scraps.folder,a=i.indexOf(e);-1!==a&&i.splice(a,1),Object.keys(n.rolls.folder).forEach((function(t){var i=n.rolls.folder[t],a=i.indexOf(e);-1!==a&&i.splice(a,1)}))}!1!==t.msgs&&n.rolls.peer[e]&&n.rolls.peer[e].forEach((function(e){n.msgs[e]&&delete n.msgs[e]})),!1!==t.lists&&(delete n.rolls.peer[e],delete n.reached.peer.before[e],delete n.reached.peer.after[e]),!1!==t.data&&(delete n.members[e],delete n.peers[e])}function C(e,t){void 0===t&&(t={});var n=store.mail;if(t.msgs){var i=t.msgs;n.rolls.peer[e]=i,n.reached.peer.before[e]=!1,n.reached.peer.after[e]=!1}else n.rolls.peer[e]||(n.rolls.peer[e]=[],n.reached.peer.before[e]=!1,n.reached.peer.after[e]=!1);var a=n.msgs[n.rolls.peer[e][0]];n.rolls.folder.all.unshift(e),n.cur.folder&&n.scraps.folder.unshift(e),a&&(a.isUnread&&n.rolls.folder.unread.unshift(e),a.isImportant&&n.rolls.folder.important.unshift(e))}function j(e){var t=store.mail.presend;t.pending[e.peerId]||(t.pending[e.peerId]=[]),t.msgs[e.sendId]=e,t.pending[e.peerId].push(e.sendId)}function E(e,t){var n=store.mail.presend;return n.pending[t]?n.msgs[e]:null}function T(e){var t=store.mail.presend;if(t.pending[e.peerId]){var n=e.sendId;delete t.msgs[n],t.pending[e.peerId]=t.pending[e.peerId].filter((function(e){return e!==n}))}}function I(e){var t=store.mail.presend;if(t.failed[e.peerId]){var n=e.sendId;delete t.msgs[n],t.failed[e.peerId]=t.failed[e.peerId].filter((function(e){return e!==n}))}}function M(){var e=store.mail.presend,t={};Object.keys(e.msgs).forEach((function(n){var i=e.msgs[n];i.pending=!1,i.failed=!0,t[i.peerId]||(t[i.peerId]=[]),t[i.peerId].push(n)}),{}),e.pending={},e.failed=t}function P(e){var t={};Object.keys(e.items).forEach((function(n){var i=e.items[n];t[n]=Object(a.sendDataToMessage)(i.data.data,-1!==e.failed.indexOf(n))}));var n={};e.pending.forEach((function(e){var i=t[e];n[i.peerId]||(n[i.peerId]=[]),n[i.peerId].push(e)}),{});var i={};e.failed.forEach((function(e){var n=t[e];i[n.peerId]||(i[n.peerId]=[]),i[n.peerId].push(e)}),{}),store.mail.presend={msgs:t,pending:n,failed:i}}function D(e,t){var n=store.mail.cur;n&&(n.folderScroll||(n.folderScroll={}),n.folderScroll[e]=t)}function x(e){var t=store.mail.cur;if(t){t.folderScroll||(t.folderScroll={});var n=t.folderScroll[e]||0;return t.folderScroll[e]=0,n}}},iS9e:function(e,t,n){"use strict";n.r(t);var i=n("MUpH"),a=n("bZ/P");function r(){var e=Object(i.default)(['\n    <div class="','" role="dialog" id="mail-dialog">\n      <div class="mailDialog__overlay" ','></div>\n      <div class="mailDialog__wrap">\n        <div class="mailDialog__content">\n          <div class="mailDialog__close" ',"></div>\n          ",'\n          <div class="mailDialog__body">','</div>\n          <div class="mailDialog__footer">\n            ',"\n          </div>\n        </div>\n      </div>\n    </div>\n  "]);return r=function(){return e},e}var o=function(e){var t=e.onClose||a.default.onClick("MailDialog._onDialogClose"),n=a.default.class(e.class,"mailDialog",{}),i="";e.title&&(i='<div class="mailDialog__title">'+e.title+"</div>");var o="";o=e.buttons?e.buttons:'<div class="BtnStack">\n      <div class="Btn Btn_theme_regular mailDialog__button mailDialog__confirmButton" '+e.onConfirm+">"+e.confirmText+'</div>\n      <div class="Btn Btn_theme_secondary mailDialog__button mailDialog__closeButton" '+t+">"+e.cancelText+"</div>\n    </div>";return a.default.html(r(),n,t,t,i,e.body,o)};var s,c=n("UxAg"),l=n("OcsD");function u(){var e=Object(c.$)(".messenger__dialog");s=null,e.innerHTML=""}Object.assign(o,{open:function(e){s={},"function"==typeof e.onConfirm&&(s.onConfirm=e.onConfirm,e.onConfirm="");"function"==typeof e.onClose&&(s.onClose=e.onClose,e.onClose="");var t=Object(c.$)(".messenger__dialog"),n=o(e),i=Object(l.ceFromString)(n);s.onConfirm&&(Object(c.$)(".mailDialog__confirmButton",i).onclick=function(e){return s.onConfirm(e,t)});s.onClose&&Object(c.$$)(".mailDialog__overlay,.mailDialog__close,.mailDialog__closeButton",i).forEach((function(e){e.onclick=function(e){return s.onClose(e,t)}}));t.innerHTML="",t.appendChild(i)},close:u,_onDialogClose:u});t.default=o;window.MailDialog=o},iWgD:function(e,t,n){"use strict";n.r(t),n.d(t,"uTyping_getPeerTyping",(function(){return i})),n.d(t,"uTyping_getNames",(function(){return a}));n("rKUZ");function i(e){var t=store.mail.cur.typings[e];return t?t.mixed||t.audio||t.text:null}function a(e){if(!e)return[];for(var t=store.mail.members,n=e.users,i=n.length,a=[],r=0;r<i;r++){var o=t[n[r]];if(o){var s=1===i?o.name:o.shortName;a.push(s)}}return a}},iwo4:function(e,t,n){"use strict";n.r(t),n.d(t,"audioRepeat",(function(){return i}));var i={NONE:0,ALL:1,ONE:2}},izth:function(e,t,n){"use strict";function i(){var e=document.domain||"";if(!["oauth.","api.","edu_m.",".vksak."].some((function(t){return e.includes(t)}))){var t=e.match(/(m\.)?([a-zA-Z]+\.[a-zA-Z]+\.?)$/);window.locDomain="https:"===location.protocol?t[2]:t[0];var n=navigator.userAgent.toLowerCase();!/opera/i.test(n)&&/msie 6/i.test(n)&&document.domain===window.locDomain||(document.domain=window.locDomain)}}n.r(t),n.d(t,"setDocumentDomain",(function(){return i}))},j1wj:function(e,t,n){"use strict";n.r(t),n.d(t,"getTimeFromStart",(function(){return a}));var i=0;function a(){return performance?performance.now():i?Date.now()-i:0}window.onDOMReady((function(){i=Date.now()}))},j80l:function(e,t,n){"use strict";function i(e,t){var n=need("nav");if(!t)return e;var i=e.split("?"),a=i[0],r=i[1],o={},s=[];return r&&r.split("&").map((function(e){var n=e.split("="),i=n[0],a=n[1];i in t||(t[i]=a)})),Object.keys(t).forEach((function(e){var i,a=t[e];!0===a&&(a=n.getQuery(e)),("string"==typeof(i=a)&&i||function(e){return"number"==typeof e&&!isNaN(e)}(a))&&(o[e]=a)})),Object.keys(o).forEach((function(e){s.push(e+"="+encodeURIComponent(o[e]))})),0===s.length?a:a+"?"+s.join("&")}n.r(t),n.d(t,"makeUrl",(function(){return i})),n.d(t,"parseURL",(function(){return r})),t.default=window.Url={make:i};var a=["protocol","hostname","host","pathname","port","search","hash","href"];function r(e){var t=window.ce("a",{href:e}),n=a.reduce((function(e,n){return e[n]=t[n],e}),{});return n.requestUri=""+n.pathname+n.search,n}},jesr:function(e,t,n){"use strict";n.r(t),n.d(t,"getExtFromMime",(function(){return u})),n.d(t,"getFormData",(function(){return d})),n.d(t,"AudioRecorder",(function(){return _}));var i=n("vuIU");var a,r=n("dI71"),o=function(){var e=t.prototype;function t(e,t){this._ctx=t.context,this.eventTarget=document.createDocumentFragment(),this._options=t,this._stream=e,this._worker=null;var n=t.source,i=this._ctx.createScriptProcessor(0,1,1);this.onAudioProcess=this.onAudioProcess.bind(this),i.addEventListener("audioprocess",this.onAudioProcess),n.connect(i),i.connect(this._ctx.destination),this.node=i}return e.addEventListener=function(e,t,n){this.eventTarget.addEventListener(e,t,n)},e.removeEventListener=function(e,t,n){this.eventTarget.removeEventListener(e,t,n)},e.onAudioProcess=function(e){if(this._worker){for(var t=[],n=0;n<e.inputBuffer.numberOfChannels;n++)t[n]=e.inputBuffer.getChannelData(n);this._worker.postMessage({command:"encode",buffers:t})}},e._createWorker=function(){return!1},e.start=function(e){this._worker=this._createWorker(e),this.eventTarget.dispatchEvent(new Event("start"))},e.stop=function(){this.node.disconnect(),this.node.removeEventListener("audioprocess",this.onAudioProcess),this.node=null,this._worker.postMessage({command:"done"})},t}(),s=function(e){function t(){return e.apply(this,arguments)||this}return Object(r.default)(t,e),t.prototype._createWorker=function(e){var t=this,n={command:"init",numberOfChannels:1,originalSampleRate:this._ctx.sampleRate,encoderSampleRate:this._options.bitsPerSecond,maxBuffersPerPage:10,encoderApplication:2048},i=new Worker("/js/"+jsc("workers/speech_worker_opus.js"));return i.addEventListener("message",(function(e){t.eventTarget.dispatchEvent(new CustomEvent("dataavailable",{detail:e.data})),4&e.data[5]&&t.eventTarget.dispatchEvent(new Event("stop"))})),i.postMessage(n),i},t}(o),c=function(e){function t(){return e.apply(this,arguments)||this}return Object(r.default)(t,e),t.prototype._createWorker=function(){var e=this,t={command:"init",numberOfChannels:1,originalSampleRate:this._ctx.sampleRate},n=new Worker("/js/"+jsc("workers/speech_worker_mp3.js"));return n.addEventListener("message",(function(t){var n=t.data;n.buffer&&e.eventTarget.dispatchEvent(new CustomEvent("dataavailable",{detail:n.buffer})),"finish"==n.type&&e.eventTarget.dispatchEvent(new Event("stop"))})),n.postMessage(t),n},t}(o),l=n("7jDv");function u(e){var t=e.match(/.*\/(\w*).*/);switch(t[1]){case"mpeg":return"mp3";case"ogg":case"webm":case"wav":return t[1]}return""}function d(e,t,n){var i=new FormData,a=e.map((function(e){return 31*e}));return i.append("waveform",JSON.stringify(a)),i.append("file",t,"voice_message."+u(n)),i}(a=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||window.MediaDevices&&window.MediaDevices.getUserMedia)&&!navigator.mediaDevices&&(navigator.mediaDevices=navigator.mediaDevices||{}),navigator.mediaDevices&&(navigator.mediaDevices.getUserMedia||(navigator.mediaDevices.getUserMedia=function(e){return new Promise((function(t,n){a?a.call(navigator,e,t,n):n(new Error("NotSupported"))}))}),navigator.mediaDevices.enumerateDevices||(navigator.mediaDevices.enumerateDevices=function(){return new Promise((function(e,t){if(MediaStreamTrack&&MediaStreamTrack.getSources){var n={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources((function(t){e(t.map((function(e){return{label:e.label,kind:n[e.kind],deviceId:e.id,groupId:""}})))}))}t(new Error("NotSupported"))}))})),window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext&&(window.AudioContext.prototype.createScriptProcessor=window.AudioContext.prototype.createScriptProcessor||window.AudioContext.prototype.createJavaScriptNode);var _=function(){var e=t.prototype;function t(){this._ctx=new AudioContext,this.eventTarget=document.createDocumentFragment(),this._stream=void 0,this._aquireing=!1,this.buffer=null,this.duration=0,this.isRecording=!1,this._mimeType=""}return e.addEventListener=function(e,t,n){this.eventTarget.addEventListener(e,t,n)},e.removeEventListener=function(e,t,n){this.eventTarget.removeEventListener(e,t,n)},e._onCreateStream=function(e){return this._stream=e,this.source=this._ctx.createMediaStreamSource(e),this._aquireing=!1,this.source},e.aquireMicrophone=function(){var e=this;if(!this._stream){if(!this._aquireing){this._aquireing=!0;navigator.mediaDevices&&(this._aquirePromise=navigator.mediaDevices.getUserMedia({video:!1,audio:!0}).then((function(t){return e._onCreateStream(t)})))}return this._aquirePromise}return Promise.resolve(this._stream)},e.releaseMicrophone=function(){this._aquirePromise&&(this._aquirePromise=null),this._stream&&(this._stream.getTracks()[0].stop(),this._stream=null),this.source&&(this.source.disconnect(),this.source=null),this._ctx&&this._ctx.close&&this._ctx.suspend()},t.selectMimeType=function(){if(window.MediaRecorder&&window.MediaRecorder.isTypeSupported){for(var e=["audio/webm;codec=opus","audio/webm;codec=vorbis","audio/ogg;codec=opus","audio/ogg;codec=vorbis","audio/webm","audio/ogg","audio/mpeg"],t=0;t<e.length;t++)if(window.MediaRecorder.isTypeSupported(e[t]))return e[t]}else for(var n=["audio/ogg;codecs=opus","audio/mpeg"],i=document.createElement("audio"),a=0;a<n.length;a++)if(i.canPlayType(n[a]))return n[a];return!1},e._createMediaRecorder=function(){var e,n=this,i=[],a={mimeType:t.selectMimeType(),context:this._ctx,bitsPerSecond:16e3};return window.MediaRecorder&&a.mimeType?e=new MediaRecorder(this._stream,a):(a.source=this.source,a.mimeType||(a.mimeType="audio/ogg;codecs=opus"),e="audio/ogg;codecs=opus"===a.mimeType?new s(this._stream,a):new c(this._stream,a)),this._mimeType=a.mimeType,e.addEventListener("dataavailable",(function(e){n.duration=Math.floor((Date.now()-n._start)/1e3),n.eventTarget.dispatchEvent(new Event("progress")),i.push(e.detail||e.data)})),e.addEventListener("start",(function(){n._start=Date.now(),n.eventTarget.dispatchEvent(new Event("start"))})),e.addEventListener("stop",(function(){n.isRecording=!1,n.buffer=new Blob(i,{type:a.mimeType}),i.splice(0,i.length),n.wave=Object(l.fastResample)(n._waveData,256),n.eventTarget.dispatchEvent(new Event("finish"))})),e},e._createResampler=function(){var e=this;if(!this._resampler){this._resampler=new l.Resampler({srcSampleRate:this._ctx.sampleRate,dstSampleRate:1e3/60});var t=this.source.context.createScriptProcessor(0,1,1);t.onaudioprocess=function(t){if(!e._aquireing){var n=t.inputBuffer.getChannelData(0),i=e._resampler.push(n);i.length&&(e._waveData=e._waveData.concat(i))}},this._resamplerNode=t}this.source.connect(this._resamplerNode),this._resamplerNode.connect(this._ctx.destination),this.wave=[],this._waveData=[]},e.record=function(){var e=this;return this.duration=0,this.aquireMicrophone().then((function(){e.isRecording=!0,e.buffer=null,e.duration=0,e._ctx.resume().then((function(){e.mediaRecorder=e._createMediaRecorder(),e._createResampler(),e.mediaRecorder.start(50)}))}))},e.stop=function(){this.duration=0,this._resamplerNode&&this._resamplerNode.disconnect(),this.mediaRecorder&&(this.mediaRecorder.stop(),this.mediaRecorder=null,this.releaseMicrophone())},e.getFormData=function(){return d(this._waveData,this.buffer,this.mimeType)},e.getAvailableMicrophones=function(){return window.AudioContext&&navigator.mediaDevices?navigator.mediaDevices.enumerateDevices().then((function(e){return e.filter((function(e){return"audioinput"===e.kind}))})):Promise.reject(new Error("NotSupported"))},t.isSupport=function(){return!(!window.AudioContext||!navigator.mediaDevices)},Object(i.default)(t,[{key:"mimeType",get:function(){return this._mimeType}}]),t}()},"k+Df":function(e,t,n){"use strict";n.r(t);var i=n("z9sQ"),a=n("TYsd"),r=n("9y81"),o=n("29dZ"),s=n("tlMv");t.default=function(e){void 0===e&&(e={});var t=null;e.icon_raw?t=e.icon_raw:e.icon&&(t=Object(r.IconWd)({class:"SplashScreen__icon",icon:e.icon,svg:e.is_svg_icon}));var n=a.default.wrap(e.more_text);"primary"!==e.more_type&&"regular"!==e.more_type&&"outlineMono"!==e.more_type||(n=Object(o.default)({inner:[e.more_text],theme:e.more_type,url:e.more_url,onClick:e.more_onclick,attrs:{ontouchend:e.more_ontouchend},use_native_onclick:e.more_native_onclick}),e.more_url=null);var c=[e.class,i.default.class("SplashScreen",e.mix||{},"_")];e.small&&c.push("SplashScreen--small");return[e.separator?Object(s.default)({hideOnDesktop:!e.separator_desktop}):null,{inner:[e.inner||[e.before,t,e.title?{inner:[a.default.wrap(e.title)],class:"SplashScreen__title",tag:"div"}:null,e.text?{inner:[a.default.wrap(e.text)],class:[e.text_class,"SplashScreen__text"],tag:"div"}:null,e.more_text?{inner:[n],class:"SplashScreen__more",href:e.more_url,tag:"a"}:null,e.action_text?{inner:[{inner:[a.default.wrap(e.action_text)],class:"SplashScreen__actionButton",href:e.action_url,tag:"a"}],class:"SplashScreen__action",tag:"div"}:null]],class:c,tag:"div"}].filter((function(e){return e}))}},k9Tg:function(e,t,n){"use strict";n.r(t),n.d(t,"MailHat",(function(){return I})),n.d(t,"MailHat__Title",(function(){return P})),n.d(t,"MailHat__icon",(function(){return x})),n.d(t,"MailHat_main",(function(){return j})),n.d(t,"MailHat_convo",(function(){return E})),n.d(t,"MailHat_page",(function(){return T})),n.d(t,"MailHat_getOnlineText",(function(){return B})),n.d(t,"MailHat__convoDetails",(function(){return L})),n.d(t,"MailHat__unreadCount",(function(){return M})),n.d(t,"MailHat__actions",(function(){return R}));var i=n("MUpH"),a=n("TYsd"),r=n("bZ/P"),o=n("9y81"),s=n("gy8s"),c=n("KMpi"),l=n("Y6JH"),u=n("fdw3"),d=n("vwub"),_=n("oZo5"),f=n("9b/I"),p=n("WWJR"),h=n("yOyn"),m=n("gZry"),v=n("zs4F"),g=n("ScVK");function A(){var e=Object(i.default)(['\n    <div class="mailHat__convoDetails">\n      <div class="mailHat__convoDetailsText">',"</div>\n      ","\n    </div>\n  "]);return A=function(){return e},e}function b(){var e=Object(i.default)(["\n    ","\n      ",'\n      <div class="mailHat__convoBody">\n        <div class="mailHat__convoTitleWrapper">\n          <div class="','">',"</div>\n          ","\n        </div>\n        ","\n      </div>\n    ","\n  "]);return b=function(){return e},e}function w(){var e=Object(i.default)(['\n    <div class="mailHat__title">\n      ',"\n    </div>\n  "]);return w=function(){return e},e}function y(){var e=Object(i.default)(['\n    <div class="mailHat__editingTitle">\n      ',"\n    </div>\n  "]);return y=function(){return e},e}function O(){var e=Object(i.default)(['\n    <div class="mailHat__desktopTitle">\n      ',"\n    </div>\n  "]);return O=function(){return e},e}function S(){var e=Object(i.default)(['\n    <div class="mailHat__forwardTitle">\n      ',"\n    </div>\n  "]);return S=function(){return e},e}function k(){var e=Object(i.default)(['\n    <div class="mailHat__unreadCount mailHat__unreadCount_length_','">\n      ',"\n    </div>\n  "]);return k=function(){return e},e}function C(){var e=Object(i.default)(['\n    <div class="mailHat '," "," "," ",'">\n      <div class="mailHat__left">','</div>\n      <div class="mailHat__center">','</div>\n      <div class="mailHat__right">',"</div>\n    </div>\n  "]);return C=function(){return e},e}function j(e){var t=function(e,t,n,i,a){var r=window.lang;return Object(s.default)({mix:"mailHat__folder",triggerWrapperTag:"h1",items:[{name:"all",text:r.mobile_mail_tab_all,active:"all"===e,url:t.all},n?{name:"unrespond",text:r.mobile_mail_tab_unrespond,active:"unrespond"===e,url:t.unrespond}:"",{name:"unread",text:r.mobile_mail_tab_unread,active:"unread"===e,url:t.unread},{name:"important",text:r.mobile_mail_tab_important,active:"important"===e,count:i,url:t.important},a?{name:"ad_tag",text:r.mobile_mail_tab_ad_tag,active:"ad_tag"===e,url:t.adTag}:""]})}(e.folder,e.urls,e.withUnrespond,e.importantCount,e.withAdTag);return I({type:"main",left:""+a.default.html({class:"mailHat__cancelForward",inner:Object(l.default)(Object(f.getBackOutline28Icon)()),onmousedown:["MailHat_main.onCancelForwardTap"]}),center:""+t+function(){var e=window.lang;return r.default.html(S(),e.mobile_mail_choose_recipient)}()+function(){var e=window.lang;return r.default.html(O(),e.mobile_mail_tab_messages)}(),right:""+a.default.html({href:e.urls.createChatUrl,class:"mailFilter__create",inner:Object(l.default)(Object(d.getWriteOutline28Icon)())}),forwarding:e.forwarding})}function E(e){var t=D(),n=a.default.html({class:"mailHat__cancelEditing",inner:Object(l.default)(Object(p.getCancelOutline28Icon)()),onmousedown:["MailHat_convo.onCancelEditingTap"]}),i=function(e){var t=e.isContact,n=(e.peerProfile.tagsData,r.default.class("mailHat__convo",{mobile:e.mobile})),i=r.default.class("mailHat__convoTitle",{casper:e.isCasper}),o=a.default.html(Object(c.Avatar)({mix:"mailHat__convoAvatar",src:e.photos,size:36,mode:"image"})),s=L(e),d=e.isCasper?'<span title="'+Object(u.getLang)("mobile_casper_chat_title")+'" class="mailHat__convoCasperIcon">'+a.default.html(Object(l.default)(Object(h.getCasper16Icon)()))+"</span>":"",_=t?'<div class="'+n+'">':'<a class="'+n+'" href="'+e.url+'">',f=t?"</div>":"</a>";return r.default.html(b(),_,o,i,e.title,d,s,f)}(e),o=function(){var e=window.lang;return r.default.html(y(),e.mobile_mail_message_editing)}(),s=R(e.actions),d=s;Object(u.isSAKIntegration)()&&e.canCall&&(d=""+a.default.html({class:"mailHat__icon",inner:Object(l.default)(Object(_.getVideocamOutline28Icon)()),onclick:["uMessenger.onCall"]})+s);return I({type:"convo",left:""+t+n,center:""+i+o,right:d,hasPinnedMsg:e.hasPinnedMsg,editing:e.editing})}function T(e){return I({type:"page",left:""+D(),center:"",right:"",hasPinnedMsg:!1,editing:!1})}function I(e){var t=e.forwarding?"mailHat_forwarding":"",n=e.hasPinnedMsg?"mailHat_hasPinnedMsg":"",i="mailHat_type_"+e.type,a=e.editing?"mailHat_editing":"";return r.default.html(C(),i,t,n,a,e.left,e.center,e.right)}function M(e){var t;return e>999?(e="999+",t=4):t=e>99?3:e>9?2:1,r.default.html(k(),t,e)}function P(e){return r.default.html(w(),e.title)}function D(){return a.default.html({tag:"button",type:"button","aria-label":Object(u.getLang)("mobile_back"),class:"mailHat__back",inner:Object(l.default)(Object(f.getBackOutline28Icon)()),onclick:["MailHat_convo.onBackTap"]})}function x(e){return Object(o.default)({mix:r.default.class("mailHat__icon",e.mix),icon:e.icon,attrs:e.attrs,url:e.url})}function L(e){var t=window.lang,n=e.membersCount,i="",o="";if(n>0)o=e.isChannel?langNumeric(n,t.mobile_mail_channel_N_members):langNumeric(n,t.mobile_mail_N_members);else{var s=e.onlinePlatform;o=B(e.isOnline,e.offlineText),"mobile"===s&&(i=a.default.html({class:r.default.class("mailHat__onlineIcon",{platform:"mobile",isOnline:e.isOnline}),inner:e.isOnline?Object(l.default)(Object(m.getOnlineMobileComposite16Icon)()):Object(l.default)(Object(v.getOnlineMobile12Gray200Icon)())}))}return r.default.html(A(),o,i)}function B(e,t){var n=window.lang;return e?n.mobile_mail_online:t}function R(e){return Object(s.default)({mix:"mailHat__actions",trigger_attrs:{"aria-label":Object(u.getLang)("mobile_mail_actions_label")},icon_html:a.default.html(Object(l.default)(Object(g.getMoreHorizontal28Icon)())),position:"topRight",items:e,isDisabled:0===e.length})}},kYGI:function(e,t){var n={tt:!1,handlers:[],show:function(){n.shown||(n.tt=Array.prototype.slice.call(arguments))},hide:function(){n.tt&&(n.tt=!1)},addHandler:function(e){e&&n.handlers.push(e)},removeHandler:function(e){e?each(n.handlers,(function(t){if(e===this)return n.handlers.splice(t,1),!1})):n.handlers=[]},onClose:function(){each(n.handlers,(function(){this()}))},clear:function(){n.tt&&(n.hide(),n.onClose(),n.removeHandler())},closeByTap:function(e){if(!n.tt||!e.target)return!1;var t=e.target;do{for(var i=0;i<n.tt.length;i++)if(t===n.tt[i])return!1}while(t=t.parentNode);return n.hide(),n.onClose(),!0}};window.tooltip=n},kr3z:function(e,t,n){"use strict";n.r(t);var i=n("wx14"),a=n("UxAg"),r=n("+cqQ"),o=n("jk6M"),s=n("jE6c"),c=n("ZMWW"),l=n("OcsD"),u=n("j80l"),d=n("eGQV"),_=n("tgcV"),f=n("cGUQ"),p=n("izth"),h=n("Cbap"),m=function(e){void 0===e&&(e={});var t=["AudioPlaylistRoot",e.class].filter((function(e){return e})).join(" ");return{attrs:{"data-playlist-id":e.playlist_id},inner:e.inner,class:t}};var v=n("g3t9"),g=n("fdw3"),A=n("0hva"),b=n("z1UI"),w=n("GtpT"),y=n("vOib"),O=n("v+Uj");var S=function(e){void 0===e&&(e={});var t=window.lang,n=e.items||[],i=e.count||null,a=e.emptyIcon||null,r=e.href,o=e.header||t.mobile_photos_block_albums_title,s=n.map((function(e){return{inner:[Object(w.default)({album:e,emptyIcon:a})],class:"AlbumsBlock__album",tag:"div"}})),c={text:Object(g.getLang)("mobile_subheader_show_all"),class:"al_albums",url:r},l=Object(O.default)({inner:[{inner:[s],class:"AlbumsBlock__albums",tag:"div"}]});return{inner:[{name:"albums",tag:"a"},Object(y.default)({title:o,count:i,corner:c,content:l,no_border:!0,noShadow:!0})],class:"AlbumsBlock",tag:"div"}},k=n("1VZq");var C=function(e){var t=window.lang,n=e.items||[],i=e.count||null,a=e.buttons||{},r=e.href,o=e.hide_header||!1,s=e.label||t.mobile_photos_block_photos_title,c="PhotosBlock",l="PhotosBlock__photos";!!e.autoload&&(c+=" PhotosBlock--autoload",l+=" photos_page");var u={inner:[n.map((function(e){return Object(k.default)({photo:e})}))],class:l,tag:"div"},d=null;return r&&(d={text:Object(g.getLang)("mobile_subheader_show_all"),class:"al_empty",url:r}),{inner:[{name:"photos",tag:"a"},Object(y.default)({inner:[{inner:[a.prev,u,a.more],tag:"div"}],title:o?null:s,corner:d,count:i,noShadow:!0,no_border:!0})],class:c,tag:"div"}},j=n("tlMv");var E=function(e){var t=window.lang,n=e.pretag,i=e.buttons||{},a=e.is_owner,r=[],o=e.section,s=e.albums,c=e.albums_count,l=e.albums_href,u=e.photos,d=e.photos_count,_=e.new_tags_photos,f=e.new_tags_count,p=e.new_tags_href,h=e.emptyIcon||null;if("all"===o){var m=s.map((function(e){return Object(w.default)({album:e,is_owner:a,emptyIcon:h})}));m&&r.push({inner:[i.prev?i.prev:null,{inner:[m],class:"AlbumsPage__items album_items photos_page bl_cont",tag:"div"},i.more?i.more:null],tag:"div"})}else s&&s.length&&r.push(S({items:s,count:c,href:l})),_&&_.length&&r.push(C({label:t.mobile_photos_block_tags_title,items:_,count:f,href:p})),u&&u.length&&r.push(C({autoload:!0,items:u,count:d,buttons:i}));if(!r.length){var v=a?t.mobile_albums_can_store_photos:t.mobile_albums_no_albums;return Object(b.default)({separator:!0,text:v,more_type:"primary",more_text:e.add_url?t.mobile_photos_placeholder_album_action:null,more_url:e.add_url})}return{inner:["all"!==o?Object(j.default)({hideOnDesktop:!0}):null,{inner:[r],class:"upanel bl_cont",tag:"div"},n],class:"AlbumsPage PageBlock PageBlock_bottomPadding",tag:"div"}},T=n("GVTI"),I=n("W9Tc"),M=n("gF8j"),P=n("r/ag"),D=n("29dZ"),x=n("vk58");var L,B=function(e){var t=function(e){var t=e.buttons,n=Object.keys(t).map((function(n){var i=t[n],a=i.theme;a="yes"!==n||a?"secondary":"regular";var r={"data-key":n,"data-force":e.force?1:0};return Object(D.default)({inner:[i.text],theme:a,url:i.href,attrs:r,on_click:"ConfirmPopup.onButtonClick(this, event);",use_native_onclick:!0})}));return Object(x.BtnStack)({inner:[n]})}(e),n={title:e.title};return Object(P.default)({inner:[Wd.wrap(e.text),{inner:[t],class:"Popup__buttons",tag:"div"}],class:"ConfirmPopup",header:n,scrollable:!0,on_overlay_click_native:"ConfirmPopup.onOverlayClick(this, event);"})},R=n("zq7H"),N=n("j1wj"),F=(n("HLtZ"),n("Y6JH")),H=n("2LAb");if(!window.ajax){var U={onBeforeRedirect:Object(r.default)("url"),onBeforePageParse:Object(r.default)(),onPostsLoad:Object(r.default)(),onRedirect:Object(l.se)(),onNavDone:Object(r.default)(),_tStart:!1,_tAlStart:!1,RESPONSE_ARGUMENTS:0,RESPONSE_REDIRECT:1,RESPONSE_CAPTCHA:2,RESPONSE_PAGE:3,RESPONSE_FAILED_AUTH:4,RESPONSE_CONFIRM:5,RESPONSE_IGNORE:100,_getreq:function(){return new XMLHttpRequest},_al_reqs:[],_last_req:null,save_req:function(e){U._al_reqs.push(e||U._last_req)},abort_reqs:function(){Object(l.each)(U._al_reqs,(function(e,t){t.abort()})),U._al_reqs=[]},_failed_relogin:!1,_failed_reqs:[],save_failed_req:function(e,t,n,i){U._failed_reqs.push([e,t,n,i])},repeat_reqs:function(){Object(l.each)(U._failed_reqs,(function(){var e=this.shift();U._post.apply(null,this),e&&Object(l.remove)(e)})),U._failed_reqs=[]},_error_displayed:null,plainpost:function(e,t,n,a,r,o,s,c){var u="string"!=typeof t?Object(f.toQueryString)(t,!0):t,_={"Content-Type":"application/x-www-form-urlencoded"};r||c||(_["X-Requested-With"]="XMLHttpRequest"),c||(Object(d.isStandalone)()&&(_["X-View-Mode"]="pwa"),o&&o.headers&&Object.assign(_,o.headers));var p=new AbortController,h=p.signal,m=new Request(e,{credentials:"same-origin",method:"POST",headers:_,body:u,signal:h}),v=(new Error).stack,g={skip:!1,response:null,text:null,json:null},A=fetch(m).catch((function(e){var t=!1;if(a&&a(e&&e.message,null)&&(t=!0),"AbortError"===e.name)return null;if("true"===m.headers.get("X-Ajax-Nav")&&history.back(),!t&&(!U._error_displayed||U._error_displayed<=Date.now()-1e4)){var n=Object(l.getLang)("mobile_general_snackbar_error");navigator.onLine||(n=Object(l.getLang)("mobile_pwa_offline_network_lost")),Object(l.statlogsValueEvent)("mvk_ajax_error_snackbar",Number(navigator.onLine)),Snackbar.init({text:n}),U._error_displayed=Date.now()}throw e.stack=v,e})).then((function(e){return null===e?Object(i.default)({},g,{skip:!0}):e.text().then((function(t){var r=null;try{r=Object(l.parseJSON)(t)}catch(e){}if(!(e.status>=200&&e.status<300))throw a&&a(t,e),new Error("FailedRequest");return n&&n(t,e),Object(i.default)({},g,{response:e,text:t,json:r})}))}));A.catch((function(){}));var b={request:m,abort:p.abort.bind(p),promise:A};return U._last_req=b,b},post:function(e,t,n){return"/"!=e.substr(0,1)&&(e="/"+e),e=e.split("#")[0],U._post(e,t,n||{})},onPrepared:Object(l.se)(),prepare_click:function(e){var t=window.al;if(o.default.ios&&!(o.default.ios>=7)&&window.al&&t.ver){var n=[],i=!1;e&&"a"==(e.tagName||"").toLowerCase()?n.push(e):Object(l.isArray)(e)?n=e:(n=Object(l.geByTag)("a",e),i=!0);for(var a=0,r=n.length;a<r;a++){var s=n[a],c=s&&s.target||"";if(s&&s.getAttribute&&(!i||!s.getAttribute("data-href")&&Object(l.checkElementNav)(s,{skip_onclick:!0})&&"_blank"!=c)){var u=s.getAttribute("href");if(null==u||!Object(l.isHttpHref)(u))continue;Object(l.attr)(s,"data-href",Object(l.getHref)(s)),Object(l.attr)(s,"href",!1)}}}},click:function(e,t,n){var i=window.nav;t=t||{};var a,r=!1,o={_ajax:1},s=Object(l.extend)(t,{link:e});if(n=n||{},(n=Object(l.extend)({closeContextMenu:!0},n)).closeContextMenu&&ContextMenu.close(),t.onStart){var c=U.tAlGetParam();U.tAlStart=(new Date).getTime(),c&&(o._talstat=c)}if(n.use_cache){var u=Object(l.ge)(!0===n.use_cache?"preload_data":n.use_cache),d=u.innerHTML.replace(/(^<!--|-->$)/g,""),_=d.split("--\x3e\x3c!--");if(d)u.innerHTML="",t.onStart&&t.onStart.apply(s),n.nav&&i.go(r,null,{push_only:!0}),t.onDone&&t.onDone.apply(s,_),(e=Object(l.geByClass1)("show_more",Object(l.geByClass1)("pcont","mcont")))&&U.click(e,{onDone:function(){var e="";Object(l.each)(arguments,(function(t,n){e+="\x3c!--"+(n||"")+"--\x3e"})),u.innerHTML=e,Object(l.ge)("show_more_loading")&&U.click(!1,t,n),U.onPostsLoad()}},{closeContextMenu:!1});else t.onStart&&t.onStart.apply(s),n.nav&&i.go(r,null,{push_only:!0});return!1}if(!e)return!0;if(e.form){if(e.disabled)return!0;var f=e.form,p={};r=(f.action||"").replace(/^https?:\/\/[^\/]+/i,""),Object(l.each)(f,(function(t,n){return!(n.name&&!n.disabled)||("radio"===n.type&&!n.checked||("checkbox"===n.type&&!n.checked||("button"===n.type||("submit"===n.type&&n!==e||("image"===n.type&&n!==e||void(p[n.name]=n.value))))))})),"image"==e.type&&(p[e.name]=e.value,p[e.name+".x"]=1,p[e.name+".y"]=1),f.method&&"get"!=f.method?Object(l.extend)(o,p):r=r.split("?",1).shift()+Object(l.obj2qs)(p)}else e.getAttribute&&(r=e.getAttribute("data-href")||e.getAttribute("href"));if(r||(r=e.pathname?e.pathname+e.search+e.hash:e),!r)return!0;Object(l.extend)(o,n.url_params||{});var h=window.pStats,m=h.getSeenData();if(m){var v=window.cur;o._pstat=m.data,v&&v.module&&(o._pstatref=v.module)}return(a=U.post(r,o,{onDone:function(){m&&h.onSend(m.seen),n.lock&&Object(l.unlockButton)(e),t.onDone&&t.onDone.apply(s,arguments),(n.nav||n.scroll)&&Object(l.scrollToHash)()},onFail:function(){n.lock&&Object(l.unlockButton)(e),t.onFail&&t.onFail.apply(s,arguments),(n.nav||n.scroll)&&Object(l.scrollToHash)()}}))&&(t.onStart&&t.onStart.apply(s),n.nav&&i.go(r,null,{push_only:!0}),n.lock&&Object(l.lockButton)(e)),!a},nav:function(e,t){var n=window.nav,r=window.page,c=window.menu,d=window.cur,f=window.Tabbar;(t=t||{}).nav=t.nav||{};var p,h=Object(l.getHref)(e),b=r.getHash(t.nav);if(!(h=n.checkUrl(h)))return!1;"/"!=h.substr(0,1)&&(h="/"+h),c.close(null,!0),U.navStart=Object(N.getTimeFromStart)();var y=U.tGetParam();if(U.tStart=(new Date).getTime(),t.need_restore&&c&&c.closeSearch(),window.isNewMail&&(t.need_restore&&t.nav.push&&!t.need_check_updates&&U.abort_reqs(),n.onBeforeGo2(t.nav.path,Object.assign({},Object(l.qs2obj)(t.nav.params),t.params),t.nav.push,t)))return U.abort_reqs(),!0;if(t.need_restore&&t.nav.push&&(p=r.restore(b))&&(U.abort_reqs(),U._failed_relogin=!1,p.lm&&Object(l.extend)(p.lm,{tn:!1,bn:!1}),r.set(b,p,{restored:!0},t),t.zProcess&&(t.zProcess(p.st),delete t.zProcess),n.set(t),U.tModule=window.cur.module,U.tRestoreRender=(new Date).getTime(),!t.need_check_updates))return!0;var O=!1,S=!1;if(t.need_check_updates&&n.isTabHaveCache(t.tab,b));else if(t.fast)O=!0,r.set(b,!1,{before:!0,beforeAppend:t.beforeAppend,afterAppend:t.afterAppend}),S=t.onAfterFast||!1;else if(t.target&&t.target.className&&!d.ignoreFastNav){(k=/(?:^|\s)(al_([a-z_]+)(-?[0-9]+)?)(?:\s|$)/i.exec(t.target.className))&&k[1];var k,C=k&&k[2]||!1;switch(C){case"menu":O=!0,r.set(b,!1,{before:!0,beforeAppend:function(e){var n=Object(a.$)(".vk__page");if(n.className=n.className.replace("vk__page_notifications",""),window.isNewMail){var i=Object(l.geByClass1)("mcont",e)||Object(l.geByClass1)("layout__basis");Object(l.val)(i,'<div class="pcont bl_cont"><div id="al_loading"></div></div>')}else Object(l.val)(Object(l.geByClass1)("mcont",e),'<div class="pcont bl_cont"><div id="al_loading"></div></div>');r.setMhead(e,Object(l.attr)(t.target,"data-header"),"/")},afterAppend:function(){window.isNewMail&&"/mail"===b?Object(l.alLoadingFix)(Object(l.geByClass1)("layout").offsetHeight):Object(l.alLoadingFix)(),Object(l.scrollTop)(0)}});break;case"tab":O=!0,r.set(b,!1,{before:!0,beforeAppend:function(e){Object(l.val)(Object(l.geByClass1)("upanel",e),'<div id="al_loading"></div>'),Object(l.val)(Object(l.geByClass1)("basisDefault",e),'<div id="al_loading"></div>');var t=Object(l.geByClass1)("tabs_block",e)||Object(l.geByClass1)("tabs",e),n=Object(l.geByClass1)("active",t);n&&(Object(l.hasClass)("tab_item_top",n)?(Object(l.removeClass)("tab_item_cur",Object(l.geByClass1)("tab_item_cur",t)),Object(l.addClass)("tab_item_cur",Object(l.geByClass1)("tab_item",t))):(Object(l.removeClass)("tab_item_cur",Object(l.geByClass1)("tab_item_cur",t)),Object(l.addClass)("tab_item_cur",n)))},afterAppend:function(){Object(l.alLoadingFix)()}},t);break;case"post":O=!0,r.set(b,!1,{before:!0,beforeAppend:function(e){var n=window.lang,i=Object(l.clone)(Object(l.gpeByClass)("post_item",t.target)),a=Object(l.geByClass1)("pi_fronly",i),o=Object(l.geByClass1)("pi_bfronly",i),s=a&&a.getAttribute("onclick")||"",c=o&&o.getAttribute("onclick")||"",u=i.id,d=Object(l.outer)(Object(l.gpeByTag)("a",Object(l.geByClass1)("pi_img",i))).replace("pi_img","op_img"),_=Object(l.gpeByTag)("div",Object(l.geByClass1)("pi_author",i)),f=Object(l.remove)(Object(l.geByClass1)("pi_date",i)),p=Object(l.outer)(Object(l.remove)(Object(l.geByClass1)("explain",_))),h=Object(l.remove)(a),m=Object(l.remove)(o),v=Object(l.outer)(_),g=Object(l.geByClass1)("pi_body",i),A=Object(l.geByClass1)("pi_text_more",g),b=(f=Object(l.geByClass1)("pi_date",i),Object(l.geByClass1)("pi_info",g)),w=Object(l.geByClass1)("pi_links",g),y=Object(l.geByClass1)("replies_link",w),O=Object(l.val)(Object(l.remove)(Object(l.geByClass1)("pi_actions_wrap",i))),S=Object(l.val)(Object(l.remove)(Object(l.geByClass1)("item_replies",b)))?Object(l.val)(y):n.mobile_wall_post_replies_title,k=y?'<a name="comments"></a><h3 class="slim_header">'+(S||"")+'</h3><div id="al_loading"></div>':"";if(A){var C=A.nextSibling?A:A.parentNode;C.nextSibling.style.display="inline",C.style.display="none"}Object(l.val)(w,Object(l.outer)(Object(l.geByClass1)("like_wrap",g))),f&&Object(l.attr)(f,"data-date")&&Object(l.val)(f,Object(l.attr)(f,"data-date")),r.setMhead(e,Object(l.attr)(t.target,"data-header"),!0);var j=h?'<div class="pi_fronly" onclick="'+s+'">'+Object(F.default)(Object(H.getLock12Icon)())+"</div>":m?'<div class="pi_bfronly" onclick="'+c+'">'+Object(F.default)(Object(H.getLock12Icon)())+"</div>":"";Object(l.val)(Object(l.geByClass1)("mcont",e),function(e,t,n,i,a,r,o,s){return'<div class="pcont bl_cont"><div class="owner_panel">'+(t||"")+'<div class="op_cont">'+(n||"")+'<div class="op_info"><span class="item_date">'+(i||"")+'</span></div></div></div><div id="'+(e||"")+'" class="post_item single_post_item"><div class="pi_cont"><div class="pi_head">'+(a||"")+'</div><div class="pi_body">'+(r||"")+"</div></div>"+(s||"")+"</div>"+(o||"")+"</div>"}(u,d,v,Object(l.val)(f)+j,p,Object(l.val)(g),k,O))},afterAppend:function(e){var n=Object(l.geByTag1)("h3",e);n&&Object(l.alLoadingFix)(t.nav.hash?Object(l.getCh)()-n.offsetHeight:0),t.nav.hash?Object(l.scrollToHash)(t.nav.hash):Object(l.scrollTop)(0)}},t);break;case"wall":O=!0,r.set(b,!1,{before:!0,beforeAppend:function(e){var n=window.lang,i=Object(l.clone)(Object(l.hasClass)("wall_item",t.target)?t.target:Object(l.gpeByClass)("wall_item",t.target)),a=i.id,o=Object(l.geByClass1)("wi_body",i),s=Object(l.geByClass1)("wi_buttons",i),c=Object(l.geByClass1)("item_like",s),u=Object(l.geByClass1)("v_like",c),d=Object(l.geByClass1)("item_share",s),_=Object(l.geByClass1)("v_share",d),f=Object(l.remove)(Object(l.geByClass1)("item_replies",s)),p=!!f&&Object(l.geByClass1)("v_replies",f),h=+Object(l.stripTags)(Object(l.val)(p)).replace(/\D/g,""),m=Object(l.geByClass1)("pi_text_more",o),g=Object(l.geByClass1)("wi_date",i),A=h?Object(l.langNumeric)(h,n.mobile_wall_post_comments):n.mobile_wall_post_replies_title,b=f&&h<50?'<a name="comments"></a><h3 class="slim_header">'+(A||"")+'</h3><div id="al_loading"></div>':"";if(clog("item_replies",f),Object(l.remove)(Object(l.geByClass1)("wi_actions_btn",i)),Object(l.remove)(Object(l.geByClass1)("post__subscribeBtn",i)),Object(l.remove)(Object(l.geByClass1)("post__extraHeader",i)),u?Object(l.val)(u):Object(l.append)(Object(l.ce)("span",{className:"v_like"}),c),_?Object(l.val)(_):Object(l.append)(Object(l.ce)("span",{className:"v_share"}),d),m){var w=m.nextSibling?m:m.parentNode;w.nextSibling.style.display="inline",w.style.display="none"}g&&Object(l.attr)(g,"data-date")&&Object(l.val)(g,Object(l.attr)(g,"data-date")),r.setMhead(e,Object(l.attr)(t.target,"data-header"),!0);var y=Wd.html(Object(v.Separator)({hideOnDesktop:!0}));Object(l.val)(Object(l.geByClass1)("mcont",e),function(e,t,n,i){return'<div class="pcont"><div class="PageBlock">'+e+'<div class="wall_item single_wall_item" id="'+(t||"")+'">'+(n||"")+"</div>"+(i||"")+"</div></div>"}(y,a,Object(l.val)(i),b)),Object(l.addClass)("vk__page_singlePost",document.body)},afterAppend:function(e){var n=Object(l.geByTag1)("h3",e);n&&Object(l.alLoadingFix)(t.nav.hash?Object(l.getCh)()-n.offsetHeight:0),t.nav.hash?Object(l.scrollToHash)(t.nav.hash):Object(l.scrollTop)(0)}},t);break;case"pinfo":O=!0,r.set(b,!1,{before:!0,beforeAppend:function(e){var t=window.lang,n=Object(l.geByClass1)("owner_panel",e),i=Object(l.geByClass1)("pp_img",n),a=Object(l.geByClass1)("op_header",n),o=Object(l.geByClass1)("lvi",a),s=Object(l.geByClass1)("pp_last_activity",n),c=Object(l.ce)("div");Object(l.addClass)("mhi_back",Object(l.geByClass1)("mh_header",e)),Object(l.val)(n,'<img src="'+Object(l.escapeAttr)(Object(l.attr)(i,"src")||"")+'" class="op_img"><div class="op_cont"><h2 class="op_header">'+Object(l.stripTags)(Object(l.val)(a))+'</h2><div class="pp_online">'+(o?t.mobile_online:Object(l.val)(s))+"</div></div>"),Object(l.val)(Object(l.geByClass1)("ipanel",e),"<div>"+Object(l.val)(c)+'</div><div id="al_loading"></div>'),r.setMhead(e,!1,!0)},afterAppend:function(){Object(l.alLoadingFix)(),Object(l.scrollTop)(0,10)}},t);break;case"player":O=!0;var j=Object(l.qs2obj)(t.nav.params).playlist_id;r.set(b,!1,{before:!0,beforeAppend:function(e){var t=window,n=t.lang,i=t.audio,a=(i.playlist(),i.playlist_q());r.setMhead(e,n.mobile_menu_player_head_title,!0),Object(l.val)(Object(l.geByClass1)("mcont",e),'\n                <div class="pcont audioPage">\n                  <div class="PageBlock">\n                    <div class="audioPage__header">\n                      '+AudioPlaylist.tplPlayerSearch(j)+'\n                    </div>\n                    <div id="au_search_items" class="upanel bl_cont">\n                      <div class="audios_block audios_list _si_container" data-query="'+Object(l.escapeAttr)(a)+'"></div>\n                    </div>\n                  </div>\n                </div>'),Object(l.val)("m",e.innerHTML)}},t),S=function(){var e=window,n=e.qsearch,i=e.audio,a=i.playlist(),s="/audio"+Object(l.obj2qs)({act:"player",list:j}),c=[],u={},d=i.getCurrentId();Object(l.each)(a,(function(e,t){t.chartInfo=null,c.push(t.fullId),u[t.fullId]=[t.performer+" "+t.title,t]}));var _=c.indexOf(d),f=_>-1?Math.min(_+10,c.length):50,p=[];n.init({action:s,al_action:s,container:"au_search_items",field:Object(l.ge)("au_search_field"),btn:Object(l.ge)("au_search_btn"),top_items:c,_cache:u,forceRerender:!0,tpl:function(e,t,n,a){var r="";if(t){if(a)return a;r=""==a?'<div class="audios_block audios_list _si_container" data-query="'+Object(l.escapeAttr)(t)+'">'+e+"</div>":'<div class="audios_block audios_list _si_container" data-query="'+Object(l.escapeAttr)(t)+'"><div class="al_loading qs_loading">&nbsp;</div></div>'}else r='<div class="audios_block audios_list _si_container" data-query="'+Object(l.escapeAttr)(i.playlist_q())+'">'+e+"</div>";return Wd.html(m({playlist_id:j,inner:Wd.wrap(r)}))},item_tpl:function(e){var t=window.audioplayer;return p.push(e),t&&t.getDOMFromAudio(e,!0,this.q,!0)||""},null_tpl:function(e){var t=window.lang;return'<div class="service_msg_box">\n                  <div class="service_msg service_msg_null">\n                  '+(e?t.mobile_audio_search_not_found.replace("%s",Object(l.htsc)(e)):t.mobile_audio_no_audio)+"\n                  </div>\n                </div>"},soft_filter:!0,need_invalid_keys:o.default.desktop,top_len:f,global_search:!0,onRendered:function(){var e=window,t=e.audioplayer,n=e.audio;t&&t.initAudio(),n.addToPlaylist(p),Object(l.alLoadingFix)()},al_need:!0,init_offset:0});var h=window.audioplayer.getCurrentElem();if(h){var v=Object(l.getY)(h)+h.offsetHeight/2-Object(l.getCh)()/2;Object(l.scrollTop)(v,100),r.save(b,{html:null,st:Object(l.scrollTop)(),page:Object(l.ge)("m"),state:r.stash(),cur:window.cur,options:t||{}},!1)}};break;case"photo":O=!0,r.set(b,!1,{before:!0,beforeAppend:function(e){f.drawLoader(e);var n=Object(l.geByTag1)("img",t.target),i=(Object(l.attr)(n,"data-src_big")||"").split("|"),a=(i[0],i[1],i[2],n&&n.src||"/images/mobile/blank.gif"),o=n&&n.width||+i[1]||0,s=n&&n.height||+i[2]||0,c=(domData(n,"info-title"),domData(n,"info-subtitle"),function(e,t){return Wd.html(Object(T.default)({is_loading:!0,photo:e}))}({src:a,width:o,height:s}));Object(l.val)(Object(l.geByClass1)("mcont",e),c),Object(l.alLoadingFix)(),r.setMhead(e,lang.mobile_photos_photo_title)},afterAppend:function(){Object(l.alLoadingFix)(),Object(l.scrollTop)(0)}},t);break;case"album":O=!0,r.set(b,!1,{before:!0,beforeAppend:function(e){var n;f.drawLoader(e);var o,s=t.target.href,c=/((?:album|tag)(-?\d+)(?:(?:_(\d+))?))/.exec(s);c&&(o=c[1]);var d=o&&Object(g.getState)(o)||{},_=Object(a.$)(".AlbumItemInfo__title",t.target),p=!1;t.target.classList.contains("AlbumItem--empty")&&(p=!0);var h=Object(u.makeUrl)("/"+o,{act:"select_album"}),m=Object(i.default)({},d,{title:d.title||Object(l.val)(_)||lang.mobile_page_title_album,description:Wd.wrap(d.description),is_empty:p,is_owner:c&&(null==(n=window.vk)?void 0:n.id)===+c[2],add_url:h,count:parseInt(t.target.getAttribute("data-count")||0,10)}),v=function(e){return void 0===e&&(e={}),Wd.html(Object(A.default)(Object(i.default)({},e,{title:Wd.wrap(e.title),is_loading:!e.is_empty||e.count>0})))}(m);Object(l.val)(Object(l.geByClass1)("mcont",e),v),Object(l.alLoadingFix)(),r.setMhead(e,m.title,!0,!1,{movable:!0})},afterAppend:function(){Object(A.initAlbumPage)(),Object(l.alLoadingFix)(),Object(l.scrollTop)(0)}});break;case"albums":O=!0,r.set(b,!1,{before:!0,beforeAppend:function(e){f.drawLoader(e);var n=t.target.closest(".AlbumsBlock"),r=[];n&&(r=Array.from(Object(a.$$)(".AlbumItem",n)).map((function(e){return Object(w.getDataFromDOM)(e).album})));var o=function(e){return void 0===e&&(e={}),Wd.html(E(Object(i.default)({},e,{section:"all"})))}({albums:r});Object(l.val)(Object(l.geByClass1)("mcont",e),o),Object(l.alLoadingFix)()},afterAppend:function(){Object(A.initAlbumPage)(),Object(l.alLoadingFix)(),Object(l.scrollTop)(0)}});break;case"u":case"g":case"p":case"e":O=!0,r.set(b,!1,{before:!0,beforeAppend:function(e){f.drawLoader(e)},afterAppend:function(){Object(l.alLoadingFix)(),Object(l.scrollTop)(0)}},t);break;case"playlists":O=!0,r.set(b,!1,{before:!0,beforeAppend:function(e){f.drawLoader(e)},afterAppend:function(){Object(l.alLoadingFix)(),Object(l.scrollTop)(0)}});break;case"empty":case"artist":case"playlist":O=!0,r.set(b,!1,{before:!0,beforeAppend:function(e){f.drawLoader(e)},afterAppend:function(){Object(l.alLoadingFix)(),Object(l.scrollTop)(0)}},t);break;case"news_subsection":O=!0,r.set(b,!1,{before:!0,beforeAppend:function(e){var t=Object(l.geByClass1)("news_subsections",e);t&&!Object(l.hasClass)("summary_loading",t.firstChild)&&Object(l.before)(Object(l.ce)("div",{className:"summary_loading",innerHTML:'<i class="i_loading"></i>'}),t.firstChild)}});break;case"tabbar":O=!0,t.is_fast=!0;var M=!1,P={options:{is_fast:!0,tab:t.tab,prev_tab:t.prev_tab}};t.need_check_updates&&p&&(P=Object(l.extend)(P,p),M=!0),r.set(b,P,{before:!M,beforeAppend:function(e){r.setMhead(e,Object(l.attr)(t.target,"data-header"),!1),f.drawSkeletonLoader(e,t.tab),document.body.classList.contains("vk_tabbar_bottom")&&r.hideHeader(e)},afterAppend:function(){Object(l.alLoadingFix)()}});break;default:d=window.cur;var D=!!Object(l.geByClass1)("mhi_logo","mhead");if(O=!0,d.al_fast&&d.al_fast[C])r.set(b,!1,d.al_fast[C](t),t);else if(!D){var x={options:{is_fast:!0,tab:t.tab,removeAfterNextResponse:t.removeAfterNextResponse}};r.set(b,x,{before:!0,afterAppend:function(){Object(l.alLoadingFix)()}})}}}if(t.need_check_updates||U.abort_reqs(),t.local){var L=!0;r.set(b,{},{after:!0,no_scroll:!0,force:!0},!1),S&&S()}else{var B=Object(I.partConfigEnabled)("mvk_fix_nav_params")?{}:Object(l.qs2obj)(t.nav.params);Object(l.extend)(B,t.params||{}),window.al&&!window.al.inited?B[c.NEED_MENU_PARAM]=c.FORCE_NEED_MENU:window.al&&window.al.menu||(B[c.NEED_MENU_PARAM]=c.NEED_MENU),y&&(B._tstat=y);var R=window.pStats,V=R.getSeenData();V&&(B._pstat=V.data,d&&d.module&&(B._pstatref=d.module)),t.target&&Object(s.isElement)(t.target)&&(B._ref=domData(t.target,"ref")),B._ref||(B._ref=(n.path||"").substr(1));var W=h.split("#");!B._hash&&W.length>1&&(B._hash="#"+W[1]),Object(_.preloadStaticForNavigation)(h);var $=Object.assign({},t.headers,{"X-Ajax-Nav":"true"});L=U.post(h,B,{onPageDone:function(e,n,i,o,s){U.fastNav=!1,n=n.replace(/<svg-icon name="([^"]+)"><\/svg-icon>/g,(function(e,t){if(t){var n=window.svgIconsSet[t];return Wd.html(Object(F.default)(n))}return e}));var c=window.cur;if(V&&R.onSend(V.seen),U.tProcess=(new Date).getTime(),r.set(b,{title:e,html:n,js:i,lm:o,bc:s,st:t.st||0},{after:O,no_scroll:O,al_transition:!0},!O&&t),t.back){var l=Object(a.$)(".layout");r.setMhead(l,!1,t.back)}U.tModule=c.module,U.tRender=(new Date).getTime(),U.onNavDone()},redirectToLoginPage:t.redirectToLoginPage,headers:$});U.save_req()}return O&&(t.zProcess&&(t.zProcess(),delete t.zProcess),n.set(t),U.tModule=d.module,U.tFastRender=(new Date).getTime(),U.fastNav=!0),L},confirm:function(e){function t(t,n,i,a){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,n,i){return!!confirm(t)&&U.click(e,i,{url_params:{hash:n}})})),_post:function(e,t,n){var i=function(e,t){n.onFail&&n.onFail.call(window,0,e,t)},a=window.debuglogSent?window.debuglogSent(e):-1;return U.plainpost(e,t,(function(r,o){if(204===o.status&&o.headers.get("X-AppShell-Fallback")){var s=location.href;return history.replaceState(null,null,Object(u.makeUrl)(location.href,{__appshell_fallback:o.headers.get("X-AppShell-Fallback")})),void location.replace(s)}var c=!1;try{c=Object(l.parseJSON)(r)}catch(t){if(o.headers.get("Content-Type").includes("text/html")||o.getResponseHeader("Content-Type").includes("text/html"))return nav.hard_go(e,null,n);c=!1}!1===c?i():(U.parseResponse(c,e,t,n),U._debugLog(a,c.debugLog))}),i,null,{headers:n.headers})},_debugLog:function(e,t){window.debuglogGot&&window.debuglogGot(e,t)},parseResponse:function(e,t,n,i){var r,o=window.al,s=window.nav,u=window.menu,d=window.page,f=e.version,m=e.counters,v=e.notifications,g=e.type,A=e.statsMeta,b=t.indexOf("community")>=0,w=!1;if(g!==U.RESPONSE_IGNORE)switch(b?(w=!(!window.al||f===o.ver))&&Object(l.statlogsValueEvent)("mvk_version_reload",1,f,o.ver,"old_force_reload_community"):window.al&&f!==o.ver?Object(I.partConfigEnabled)("mvk_lazy_static_reload")?g===U.RESPONSE_ARGUMENTS?L||(L=new M.default({id:"mvk_static_manager",element:document,focusElement:window,triggerEvents:"mouseover mousedown keypress touchstart",idleTimeout:6e5,onIdleCb:function(){Object(l.statlogsValueEvent)("mvk_version_reload",1,f,o.ver,"new_idle_reload"),L.stop(),location.reload()}})).start():(Object(l.statlogsValueEvent)("mvk_version_reload",1,f,o.ver,"new_force_reload"),w=!0):(Object(l.statlogsValueEvent)("mvk_version_reload",1,f,o.ver,"old_force_reload"),w=!0):!window.menu||e.lm_data&&e.lm_data.lm||u.isMenuHasItems()&&((w=!u.refreshCounters(m))&&Object(l.statlogsValueEvent)("mvk_version_reload",1,f,o.ver,"old_force_reload_change_menu"),u.refreshNotifications(v)),void 0===m||!1===m||b||Object(l.setNotify)(m[R.COUNTERS_POS_MESSAGES]),e.lm_data&&e.lm_data.lm&&(m&&(e.lm_data.counters=m),v&&(e.lm_data.notifications=v)),A&&window.vk&&(window.vk.statsMeta=A),g){case U.RESPONSE_ARGUMENTS:if(w)return s.hard_go(s.cur,null,{replace:!0});var y=e.data;if(r=y&&Object(l.isObject)(y[0])&&y[0]._snackbar){if(Snackbar.init(r),2===r.type)return photoview.opened()?void photoview.close():Stories.opened?void Stories.close():zlayer.opened()?void zlayer.close():void(U.fastNav&&history.back());delete y[0]._snackbar}i&&i.onDone&&i.onDone.apply(window,y);break;case U.RESPONSE_REDIRECT:var O=e.location;U.onRedirect(!0,O);var S=e.hard,k=e.frame,C=e.clear,j=e.restore,E=e.replace;if(!k&&window.isNewMail&&U.onBeforeRedirect(O))break;if(C&&s.clear(),(r=e._snackbar)&&(Snackbar.init(r),delete e.snackbar),w||S)s.hard_go(O,null,{replace:E});else if(k){Object(p.setDocumentDomain)();var T=O+(-1==O.indexOf("?")?"?":"&")+"__extra=1",P=Object(l.createIframe)({src:T})}else E&&O===s.prev_cur?history.back():s.go(O,null,{ignore_cur_process:!0,need_restore:j,replace:E});break;case U.RESPONSE_CAPTCHA:var D=e.location,x=e.img,N=e.post,F=e.key;i&&i.onFail?i.onFail(g,D,{location:D,img:x,post:N,key:F}):s.hard_go(D);break;case U.RESPONSE_PAGE:var H=e.lm_data;if(d.need_hard_go=w,H&&H.rdr&&window.al&&o.menu&&Object(l.getW)("vk_wrap")>=614){s.go(H.rdr,null,{replace:!0});break}h.default.getRouter().deactivateAllRoutes(),cur.share&&"destroy"in cur.share&&cur.share.destroy(),(i=i||{}).onPageDone||(i.onPageDone=function(e,n,i,a,r){s.go(t,null,{push_only:!0}),d.set(d.getHash(s),{title:e,html:n,js:i,lm:a,bc:r})});var V=e.title,W=e.html,$=e.js,q=e.body_class,z=e.top_bar,Y=Object(l.ge)("vk_topbar");z&&!Y?(Y=Object(l.ce)("div",{id:"vk_topbar",innerHTML:z}),Object(l.before)(Y,Object(a.$)(".layout"))):Object(l.val)(Y,z),e.env&&e.env.pe&&(window.vk.pe=e.env.pe),Object(_.addStatic)(e.static_files).then((function(){i.onPageDone(V,W,$,H,q)}));break;case U.RESPONSE_FAILED_AUTH:if(c.SAKIntegration.isIntegrated)return U.save_failed_req(null,t,n,i),U._failed_relogin||U.SAKRelogin(),void(U._failed_relogin=!0);if(i.redirectToLoginPage)return window.location=e.location,!1;if(!U._failed_relogin){var G=e.location;Object(p.setDocumentDomain)();P=Object(l.createIframe)({src:G})}U._failed_relogin=!0,U.save_failed_req(P,t,n,i);break;case U.RESPONSE_CONFIRM:var K=e.data,Q=B(K),X=Wd.elem(Q);Popup.open(X,!0);break;case U.RESPONSE_IGNORE:return}},onReLoginDone:function(){U.repeat_reqs(),U._failed_relogin=!1},SAKRelogin:function(){return c.SAKIntegration.reauth().then((function(e){var t=(void 0===e?{}:e).accessToken;if(t){var n={_sak_embed_at:t};return U.post("/login?act=sak_relogin",n,{onDone:function(){U.onReLoginDone()},onFail:function(){}}).promise}}))},tGetParam:function(){if(U.tStart&&U.tModule){var e=U.tFastRender-U.tStart,t=U.tRestoreRender-U.tStart,n=U.tProcess-U.tStart,i=U.tRender-U.tProcess,a=["/"==U.tModule.substr(0,1)?U.tModule.substr(1):U.tModule,e,t,n,i];for(var r in a)(!a[r]||a[r]<0)&&(a[r]=0);return U.tStart=!1,a.join(",")}},tAlGetParam:function(){if(U.tAlStart&&U.tAlModule){var e=U.tAlProcess-U.tAlStart,t=U.tAlRender-U.tAlProcess,n=["al_"+("/"==U.tAlModule.substr(0,1)?U.tAlModule.substr(1):U.tAlModule),e,t];for(var i in n)(!n[i]||n[i]<0)&&(n[i]=0);return U.tAlStart=!1,n.join(",")}},refreshLinks:function(e,t){if(e){var n=Object(l.geByClass1)("mmi_fv","lm_cont"),i=n&&Object(l.geByClass1)("lfm_item",n),a=Object(l.geByClass1)("mmi_fv","mfoot"),r=a&&Object(l.geByClass1)("lfm_item",a),o=Object(l.ge)("fv_link"),s=Object(l.ge)("menu_fv_link"),c=Object(l.geBySel1)('link[rel="canonical"]');Object(l.attr)(i,"href",e),Object(l.attr)(r,"href",e),Object(l.attr)(o,"href",e),Object(l.attr)(c,"href",Object(l.attr)(Object(l.ge)("mcont"),"data-canonical")),window.nav.prev_fv_link&&Object(l.attr)(s,"href",window.nav.prev_fv_link),window.nav.fv_link=e}if(t){var u=Object(l.geByClass1)("mmi_app","lm_cont"),d=u&&Object(l.geByClass1)("lfm_item",u),_=Object(l.geByClass1)("mmi_app","mfoot"),f=_&&Object(l.geByClass1)("lfm_item",_),p=Object(l.ge)("app_link"),h=!!t&&"return nav.app_go(this, event, '"+Object(l.escapeStr)(t)+"');";Object(l.attr)(d,"onclick",h),Object(l.attr)(f,"onclick",h),Object(l.attr)(p,"onclick",h)}}};window.ajax=U}t.default=window.ajax},l51W:function(e,t){var n=function(){function e(e){var t=e.closest(".si_body");return{buttons:$(".si_links",t),message:$(".si_msg",t)}}return{sendRequest:function(t,n){t&&t.preventDefault();var i=n.getAttribute("href");ActionMenu.closeMenu();var a=e(n);ajax.post(i,{_ajax:1},{onDone:function(e){!function(e){hide(e.buttons),show(e.message)}(a),val(a.message,e)}})},cancelRequest:function(t,n){t&&t.preventDefault();var i=n.getAttribute("href"),a=e(n);ajax.post(i,{_ajax:1},{onDone:function(e){}}),function(e){hide(e.message),show(e.buttons)}(a)}}}();window.GroupsInvite=n},lPa4:function(e,t,n){"use strict";n.r(t),n.d(t,"Like",(function(){return c}));var i=n("OcsD"),a=n("Fkq0"),r=n("h8oe"),o=n("z9Td"),s=n("RJa5"),c={onDone:function(e,t,n,c){var l=Object(i.ge)(e)||Object(i.geByClass1)("like_box","z")||Object(i.geByClass1)("like_box")||Object(i.geByClass1)("wall_item_for_like_"+e);if(l&&e){var u,d,_=Object(i.geByClass1)("item_repost",l);if(Object(i.hasClass)("wall_item",l)||l.parentNode.classList.contains("MarketItem")||l.parentNode.classList.contains("PhotoviewPage")||l.parentNode.classList.contains("VideoPage")?d=Object(i.geByClass1)("wi_like_wrap",l)||(null==l.querySelector?void 0:l.querySelector("._wi_likes_bar_wrap")):Object(i.hasClass)("ReplyItem",l)?u=Object(i.geByClass1)("ReplyItem__likeWrap",l):d=Object(i.geByClass1)("item_like",l),u||(u=Object(i.geByClass1)("like_wrap",l)),d&&(d.innerHTML=t||"",Object(i.toggleClass)("is_empty",d,!t),Object(i.toggle)(d,t)),_&&(_.innerHTML=n||"",Object(i.toggle)(_,n)),u){var f=Object(i.ceFromString)(c);l.classList.contains("wall_item")||l.classList.contains("BookmarksItem_video")||!f.classList.contains("like_wrap")?Object(i.val)(u,c||""):Object(i.val)(u.parentNode,c||"");var p=Object(a.marketItemIdToObject)(e);if(p){var h=u.querySelector(".item_like");h&&Object(r.trackMarketEvent)({event:h.classList.contains("item_sel")?s.ECommGoodsEvent.LIKE_ITEM:s.ECommGoodsEvent.UNLIKE_ITEM,ownerId:p.ownerId,itemId:p.itemId,instant:!0,platform:o.PLATFORM_MVK})}}}},onFail:function(){var e=Array.prototype.slice.call(arguments),t=e.shift();switch(t){case 2:nav.hard_go(e[0])}}}},ldCb:function(e,t){window.Informer={close:function(e){hide(e)}}},lkNA:function(e,t,n){"use strict";function i(e,t){var n,i=t.timeout,a=t.onLoad,r=t.onError,o=document.createElement("script");function s(e){o.readyState&&"loaded"!=o.readyState&&"complete"!=o.readyState||(l(),a&&a())}function c(e){l(),r&&r()}function l(){clearTimeout(n),o.removeEventListener("load",s),o.removeEventListener("readystatechange",s),o.removeEventListener("error",c)}return o.addEventListener("load",s),o.addEventListener("readystatechange",s),o.addEventListener("error",c),o.src=e,document.head.appendChild(o),i&&(n=setTimeout(c,i)),{destroy:function(){l()}}}n.r(t),n.d(t,"loadScript",(function(){return i}))},mPGc:function(e,t){FeedAssistanceStats.registerTrackingCls("feedAssistance_recommendedGroups"),FeedAssistanceStats.onStartViewElement((function(e){if(FeedAssistanceStats.getElementType(e)===FeedAssistanceStats.BLOCKS.BLOCK_TYPE_RECOMMENDED_GROUPS_SLIDER){var t,n,i=e.querySelector(".Slider__scroll").dataset.code;if(i)null==(t=window.RecommendedGroupsSlider)||t.viewBlock(i),null==(n=window.RecommendedGroupsSlider)||n.onScroll();if(e._groupsSliderHandlersAdded)return;e._groupsSliderHandlersAdded=!0}}))},myok:function(e,t,n){"use strict";n.r(t),n.d(t,"setLoading",(function(){return f})),n.d(t,"setDisabled",(function(){return _}));var i=n("TYsd"),a=n("BoyB"),r={className:"Btn",setLoading:f,setDisabled:_};t.default=r,r._onClick=d;var o="Btn_loading",s="Btn_theme_secondary",c="Btn__loader",l="Btn__loader--white",u={loader:"."+c};function d(e,t,n){e.preventDefault(),i.default.handle(n,{$btn:t})}function _(e,t){void 0===t&&(t=!0),e.disabled=t}function f(e,t,n){if(void 0===n&&(n=""),e){var i=e.classList.contains(o);if(t){if(i)return;var r=e.classList.contains(s),d=e.classList.contains(l);!n&&r&&(n="white");var _=!1;"white"!==n&&(_=!0);var f=Object(a.default)({mix:c,white:"white"===n||d,large:!0,spinner:_});e.classList.add(o),e.insertAdjacentHTML("afterbegin",f)}else{if(!i)return;var p=e.$(u.loader);e.classList.remove(o),p.remove()}}}},nXjO:function(e,t){var n={OPEN_CLASS:"reply_owner_show",OPEN_BOTTOM_CLASS:"reply_owner_open_bottom",NO_LIMIT_CLASS:"reply_owner_picker_nolimit",CONTAINER_CLASS:"reply_owner_picker_container",PICKER_CLASS:"reply_owner_picker",PICKER_ITEM_CLASS:"reply_owner_option",LOADING_CLASS:"reply_owner_loading",IMAGE_CLASS:"_reply_owner_image",SELECTED_IMAGE_CLASS:"_reply_owner_selected_image",SELECTED_IMAGE_CONTAINER_CLASS:"reply_owner_selected_image",OPTION_CLASS:"reply_owner_option",PICKER_MAX_HEIGHT:null,LOADING_SHOW_TIME:300,container:null,picker:null,clickEvent:"ontouchend"in document.documentElement?"touchend":"click",clickHandler:null,requestHandler:null,request:null,loading:!1,setElements:function(e){this.container=gpeByClass(this.CONTAINER_CLASS,e),this.picker=geByClass1(this.PICKER_CLASS,this.container),this.clickHandler=this.clickHandler||bind(this.onDocumentClick,this),this.requestHandler=this.requestHandler||bind(this.onDocumentClickBeforeLoad,this)},unsetElements:function(){removeEvent(document.body,this.clickEvent,this.clickHandler),removeEvent(document.body,this.clickEvent,this.requestHandler),this.container=this.picker=null},show:function(e){this.setElements(e),addClass(this.OPEN_CLASS,this.container),this.calcPosition()},hide:function(){removeClass(this.OPEN_CLASS,this.container),removeClass(this.OPEN_BOTTOM_CLASS,this.container),this.unsetElements()},toggle:function(){toggleClass(this.OPEN_CLASS,this.container),this.calcPosition(),hasClass(this.OPEN_CLASS,this.container)?(this.scrollToSelected(),addEvent(document.body,this.clickEvent,this.clickHandler)):(this.hide(),this.unsetElements())},calcPosition:function(){var e=ge("mhead").offsetHeight,t=this.picker.getBoundingClientRect(),n=domClosestOverflowHidden(this.picker),i=!0;n&&n.getBoundingClientRect().bottom<this.container.getBoundingClientRect().bottom+this.PICKER_MAX_HEIGHT?i=!1:hasClass(this.LOADING_CLASS,this.container)?i=t.top-e-this.PICKER_MAX_HEIGHT+t.height<0:hasClass(this.OPEN_BOTTOM_CLASS,this.container)||(i=t.top-e<0),toggleClass(this.OPEN_BOTTOM_CLASS,this.container,i)},onDocumentClick:function(e){var t=e.target;t===this.container||gpeByClass(this.CONTAINER_CLASS,t)||this.hide()},onDocumentClickBeforeLoad:function(e){var t=e.target;t===this.container||gpeByClass(this.CONTAINER_CLASS,t)||this.cancelRequest()},cancelRequest:function(){this.request&&(this.request.abort(),this.unsetElements())},getList:function(){var e=this;if(!this.loading){this.PICKER_MAX_HEIGHT=parseInt(getStyle(this.picker,"maxHeight"),10);var t=geBySel1('input[name="from_oid"]',this.container).value,n=geBySel1('input[name="post_oid"]',this.container).value;this.loading=!0;var i=setTimeout((function(){addClass(e.LOADING_CLASS,e.container),e.calcPosition()}),this.LOADING_SHOW_TIME);addEvent(document.body,this.clickEvent,this.requestHandler),this.request=ajax.post("/wall.php",{act:"get_reply_clubs_list",oid:t,post_oid:n},{onDone:function(t){clearTimeout(i),e.picker.innerHTML=t,e.onLoadEnd(),e.toggle(e.picker)},onFail:function(){e.onLoadEnd()}})}},onLoadEnd:function(){this.loading=!1,removeClass(this.LOADING_CLASS,this.container),removeEvent(document.body,this.clickEvent,this.requestHandler)},onChange:function(e){var t=gpeByClass(this.OPTION_CLASS,e),n=geByClass1(this.IMAGE_CLASS,t).src;each(geByClass(this.SELECTED_IMAGE_CLASS),(function(){this.src=n})),attr(geByClass1("al"+this.SELECTED_IMAGE_CLASS),"href",attr(t,"data-href")),this.hide()},onClick:function(e){this.setElements(e),geByClass(this.PICKER_ITEM_CLASS,this.picker).length?this.toggle():this.getList()},scrollToSelected:function(){var e=gpeByClass(this.OPTION_CLASS,geBySel1(":checked",this.picker));this.PICKER_MAX_HEIGHT||(this.PICKER_MAX_HEIGHT=parseInt(getStyle(this.picker,"maxHeight"),10)),e&&(this.picker.scrollTop=e.offsetTop-this.PICKER_MAX_HEIGHT/2+e.offsetHeight/2)}};window.replyOwnerPicker=n},o5u5:function(e,t,n){"use strict";var i,a;n.r(t),n.d(t,"NetworkStatEventTypes",(function(){return i})),n.d(t,"AudioNetworkType",(function(){return a})),function(e){e.TYPE_NETWORK_AUDIO_ITEM="type_network_audio_item",e.TYPE_MODULE_NAVIGATION_STATS_ITEM="type_module_navigation_stats_item"}(i||(i={})),function(e){e.FRAGMENT_LOADED="fragment_loaded",e.FRAGMENT_STALLED="fragment_stalled"}(a||(a={}))},p5n7:function(e,t,n){"use strict";n.r(t),n.d(t,"getValue",(function(){return p})),n.d(t,"setPrefix",(function(){return h})),n.d(t,"onBlur",(function(){return b})),n.d(t,"onFocus",(function(){return g})),n.d(t,"getNative",(function(){return m})),n.d(t,"filter",(function(){return v})),n.d(t,"onChange",(function(){return w}));var i=n("z9sQ"),a=n("fdw3"),r=n("TYsd"),o=function(e){void 0===e&&(e={});var t=e.style||[],n=e.class||e.mix,o=e.prefix,s=e.postfix,c=function(e){var t=[];Object(a.isArray)(e.on_key_down)?(e.on_key_down.push("event"),t=e.on_key_down):e.on_key_down&&(t=[e.on_key_down,"event"]);var n=e.on_key_press,i="function"==typeof e.on_change,o="function"==typeof e.onblur,s="function"==typeof e.onfocus,c=Object(a.concatValues)("TextInput.onChange(event);",r.default.isAttrHandler("oninput",e.on_change)?r.default.prepareHandler(e.on_change):i?"":e.on_change),l=Object(a.concatValues)("TextInput.onBlur(event, this);",r.default.isAttrHandler("onblur",e.onblur)?r.default.prepareHandler(e.onblur):o?"":e.onblur),u=Object(a.concatValues)("TextInput.onFocus(event, this);",r.default.isAttrHandler("onfocus",e.onfocus)?r.default.prepareHandler(e.onfocus):s?"":e.onfocus);i&&(c=Object(a.preactCallback)([[c],[e.on_change]]));o&&(l=Object(a.preactCallback)([[c],[e.onblur]]));s&&(u=Object(a.preactCallback)([[c],[e.onfocus]]));return{class:"TextInput__native",id:e.id,type:e.type,name:e.name,value:e.value,spellcheck:e.spellcheck+"",placeholder:r.default.wrap(e.placeholder),autocapitalize:!1===e.autocapitalize?"off":null,autocomplete:!1===e.autocomplete?"off":e.autocomplete,tabindex:e.tabindex,readonly:e.readonly,disabled:e.disabled,oninput:c,onkeydown:t,onkeypress:n,onblur:l,onfocus:u,autofocus:e.autofocus,maxlength:e.maxlength,pattern:e.pattern,required:e.required,inputmode:e.inputmode,"aria-describedby":e["aria-describedby"],tag:"input"}}(e),l=e.error;l&&(t.error=!0);var u=!(o||s||"string"==typeof l);return{inner:[{inner:[u?c:[o?{inner:[o.text],class:i.default.class("TextInput__prefix",{rightPadding:o.with_right_padding,gray:o.gray},"_"),tag:"div"}:null,{inner:[c],class:"TextInput__nativeWrap",tag:"div"},s?{inner:[s.text],class:"TextInput__postfix",tag:"div"}:null]],class:"TextInput__content",tag:"div"},"string"==typeof l?{inner:[l],class:"TextInput__errorLabel",tag:"span"}:null],role:"presentational",class:[i.default.class("TextInput",{style_stretch:t.stretch,prefixed:!!o,hidden:"hidden"===e.type,error:t.error,native:u,disabled:!!e.disabled||!!e.readonly},"_"),n],onclick:e.on_click,tag:"label"}};var s=n("UxAg"),c=n("zvhO"),l=n("OcsD"),u=n("CQvH");Object.assign(o,{setPrefix:h,getValue:p,filter:v,onFocus:g,onBlur:b,onChange:w});var d=".TextInput",_=".TextInput__native",f=".TextInput__prefix";function p(e){return e.$(_).value}function h(e,t){e.$(f).innerText=t}function m(e){return Object(s.$)(_,e)}function v(e,t,n){switch(e){case"number":var i=Object(l.val)(n)+String.fromCharCode(t.which);Object(c.isNumber)(parseInt(i))||Object(l.cancelEvent)(t),Object(l.val)(n,Object(l.val)(n).split("").filter((function(e){return Object(c.isNumber)(+e)})).join(""))}}function g(e,t){var n=t.closest(d);setTimeout((function(){n.classList.add("TextInput--focused")}))}function A(e){var t=e.target.closest(d);Object(l.removeEvent)(e.target,"blur",A),t&&t.classList.remove("TextInput--focused")}function b(e,t){var n,i=t.closest(d),a=null==(n=e.relatedTarget)?void 0:n.closest(d),r=Object(s.$)(_,i);i!==a||Object(u.isTabbing)()?(setTimeout((function(){var e;"BUTTON"===(null==(e=document.activeElement)?void 0:e.tagName)&&i.contains(document.activeElement)&&Object(l.addEvent)(document.activeElement,"blur",A)})),a!==i&&setTimeout((function(){i.classList.remove("TextInput--focused")}))):r.focus()}function w(e){var t=e.target.value;e.target.closest(d).classList.toggle("TextInput--notEmpty",!!t)}t.default=o;window.TextInput=o},qHA9:function(e,t,n){"use strict";n.r(t),n.d(t,"MENTION_REGEXP",(function(){return u})),n.d(t,"MENTION_DOMAIN_REGEXP",(function(){return d})),n.d(t,"MENTION_CLIENTSIDE_REGEXP",(function(){return _})),n.d(t,"UNKNOWN_ERROR",(function(){return f})),n.d(t,"STICKER_HEIGHT",(function(){return p})),n.d(t,"isContactPeer",(function(){return h})),n.d(t,"isCommunityPeer",(function(){return m})),n.d(t,"isChatPeer",(function(){return v})),n.d(t,"isUser",(function(){return g})),n.d(t,"formatTime",(function(){return A})),n.d(t,"wrapMention",(function(){return w})),n.d(t,"wrapCommunityUrl",(function(){return y})),n.d(t,"sendDataToMessage",(function(){return O})),n.d(t,"getMsgSendId",(function(){return S})),n.d(t,"mailRequest",(function(){return k})),n.d(t,"getStickerSize",(function(){return C})),n.d(t,"prepareKeyboard",(function(){return j})),n.d(t,"isMessageWithoutLocalId",(function(){return E})),n.d(t,"isForwardedMessageId",(function(){return T})),n.d(t,"isNewMailPage",(function(){return I}));var i=n("wTgh");n.d(t,"wrapLinks",(function(){return i.wrapLinks}));var a,r=n("wMVj"),o=n("9M99"),s=n("OcsD"),c=n("jE6c"),l=n("hC3G"),u=/\[((id|club)\d+)\|([\S\s]+?)]/g,d=/\[((id|club)\d+)\|@([\S\s]+?)]/g,_=/\[([^\$]+?)\|([^\$]+?)\]/g,f=10,p=128;function h(e){return e>19e8&&e<=2e9}function m(e){return e>-1e9&&e<0}function v(e){return e>2e9}function g(e){return e>0&&e<=19e8}function A(e,t){void 0===t&&(t=0);var n=new Date(1e3*e),i=n.getTimezoneOffset(),a=-t/60-180;if(i!==a){var r=60*(a-i)*1e3;n.setTime(1e3*e-r)}var o=n.getHours(),s=n.getMinutes();return o+":"+(s<10?"0":"")+s}function b(e,t){return'<a href="/'+Object(c.htsc)(e)+'" mention_id="'+Object(c.htsc)(e)+'" class="mem_link">'+Object(c.htsc)(t)+"</a>"}function w(e,t){return e=e.replace(l.MASS_MENTION_REGEXP,(function(e){return"<a>"+e+"</a>"})),e=t?e.replace(_,(function(e,t,n){return b(t,n)})):e.replace(u,(function(e,t,n,i){return b(t,i)}))}function y(e){var t=r.default.getQuery("community");return t&&(e+="&community="+t),e}function O(e,t){var n,r,s=store.mail,l=s.cur,u=s.members,d=Date.now()/1e3,_=A(d,l.timeShift),f=e.message||"";"send"!==e.act&&e.id&&(n=store.mail.msgs[e.id]),a||(a=document.createElement("div")),a.textContent=f,f=Object(c.htsc)(a.innerHTML),a.textContent="";var h,m={},v="";if("audiomsg"===e.media&&"doc"===e.attach1_type)m.audiomsg=1,v=e.attachesHTML;else if(e.media&&0===e.media.indexOf("sticker")){m.sticker=1;var g=+e.media.replace("sticker","");g&&(h={id:g,url:Stickers.getStickerUrl(g,C()),height:p})}else for(var b,y=1;b=e["attach"+y+"_type"];y++)m[b]?m[b]+=1:m[b]=1;r=e.attached_messages?(e.attached_messages+"").split(";"):e.mail_edit_attach_fwd&&n?n.forwards.concat():[];var O=!!e.has_reply,S="send"===e.act?"send"+e.random_id:"edit"+e.id,k=f,j=k=k.replace(/(@|\*)(\S+)(?: +\(([^\n]+?)\))?/g,(function(e,t,n,i){i||(i=t+n);var a=0,r=/^(club|public|event)([\d]+)$/.exec(n);/^id[\d]+$/.test(n)?a=parseInt(n.substr(2)):r&&(a=parseInt(r[2]));for(var o="id",s=Object.keys(u),c=0,l=s.length;c<l;c++){var d=s[c];if(u[d]&&u[d].domain===n){a=d;break}}return"-"===a[0]&&(a=a.slice(1),o="club"),a?"["+o+a+"|"+i+"]":e}));j=w(j=Object(i.wrapLinks)(j),!0),j=Object(o.emojiToHTML)(j);var E={id:"send"===e.act?S:e.id,sendId:S,peerId:"send"===e.act?e.to:e.peerId,authorId:l.viewerId,adminId:l.groupId?l.userId:void 0,ts:d,date:_,dateShort:_,text:j,textInput:f,body:k,isUnread:!n||n.isUnread,isOut:!0,edited:"send"!==e.act,canEdit:!1,attaches:m,attachesHTML:v,forwards:O?[]:r,hasReply:O,reply:O?r[0]:void 0,pending:!t,failed:!!t,attachesLoading:!!Object.keys(m).length};return l.groupId&&(E.adminName=lang.mobile_mail_you,E.adminUrl=u[l.userId].url),h&&(E.sticker=h),E}function S(e){return e.edited?"edit"+e.id:"send"+e.randomId}function k(e,t){return new Promise((function(n,i){Object(s.ajaxRequest)(e,t,(function(e){e.error?i({type:"server",code:e.code||0,message:e.message||""}):n(e.result)}),(function(e,t,n){var a=null,r="unknown",o=0;if(n instanceof XMLHttpRequest){var s=n;0===s.status?r="network":(r="server_status",o=s.status)}else 0===e&&null==t&&null==n?r="response_parsing":e===ajax.RESPONSE_CAPTCHA?(r="captcha",a=n):r="unknown";i({type:r,code:o,message:"",data:a})}))}))}function C(){return hasClass("x2",document.body)?2*p:p}function j(e){var t=e.keyboard,n=e.authorId,i=e.msgId;if(t.buttons&&t.buttons.length){t=Object.assign(t,{author_id:n,chat_local_id:i});var a=document.createElement("div");t.buttons.forEach((function(e){e.forEach((function(e){var t=e.action.label;a.textContent=t;var n=a.innerHTML;e.action.label=Object(o.emojiToHTML)(n),e.action.rawLabel=t}))})),a=null}else t=null;return t}function E(e){return"string"==typeof e&&"~"===e[0]}function T(e){return!(isFinite(e)||E(e))}function I(e,t){if(void 0===e&&(e=""),void 0===t&&(t=""),!window.isNewMail)return!1;if(0===e.indexOf("/write"))return!0;"string"==typeof t&&(t=Object(s.qs2obj)("?"===t[0]?t.slice(1):t));var n=t,i=n.act,a=n.m;return"/mail"===e&&"add_to_chat"!==i&&"flush_history"!==i&&"info"!==i&&"unpin"!==i&&"edit_chat"!==i&&"change_chat_name"!==i&&"leave_chat"!==i&&"new_chat"!==i&&"chat_preview"!==i&&"return_to_chat"!==i&&"show_medias"!==i&&"toggle_community_block"!==i&&"community_toggle_important"!==i&&"ban_user"!==i&&"add_user"!==i&&"community_mark_answered"!==i&&"invite_link"!==i&&"reset_link"!==i&&"send"!==i&&"show_peer_profile"!==i&&"toggle_peer_profile_tags"!==i&&"edit_peer_profile_tags"!==i&&"edit_peer_profile_note"!==i&&70!=a&&71!=a&&76!=a&&784!=a&&783!=a&&786!=a&&785!=a&&787!=a}},qdnm:function(e,t,n){"use strict";n.r(t),n.d(t,"clickStat",(function(){return r}));var i=n("FbVm"),a=new i.ProductionStatCollector,r=new i.ClickStatCollector(a)},"r/ag":function(e,t,n){"use strict";n.r(t);var i=n("Po+v"),a=n("TAKr");n.d(t,"POPUP_DISAPPEAR_TIME",(function(){return a.POPUP_DISAPPEAR_TIME})),n.d(t,"POPUP_NAV_PREFIX",(function(){return a.POPUP_NAV_PREFIX})),window.Popup=i.default,t.default=i.default},r0fY:function(e,t,n){"use strict";var i,a,r,o,s,c,l,u,d,_,f,p,h,m,v,g,A,b,w;n.r(t),n.d(t,"EventScreens",(function(){return i})),n.d(t,"ProductionStatEventTypes",(function(){return a})),n.d(t,"NavigationProductionStatEventTypes",(function(){return r})),n.d(t,"YoulaEventTypes",(function(){return o})),n.d(t,"ActionProductionStatEventTypes",(function(){return s})),n.d(t,"ClickProductionStatEventTypes",(function(){return c})),n.d(t,"ViewProductionStatEventTypes",(function(){return l})),n.d(t,"MarketScreenNames",(function(){return u})),n.d(t,"MarketEventTypes",(function(){return d})),n.d(t,"WorkiEventTypes",(function(){return _})),n.d(t,"EventItemType",(function(){return f})),n.d(t,"EventItemSubType",(function(){return p})),n.d(t,"RegistrationItemEventTypes",(function(){return h})),n.d(t,"RegistrationFieldItemNames",(function(){return m})),n.d(t,"MarketingTransitionItemCampaignType",(function(){return v})),n.d(t,"MarketingTransitionItemEventType",(function(){return g})),n.d(t,"MarketingTransitionItemSourceType",(function(){return A})),n.d(t,"VkAppActionMenuActionType",(function(){return b})),n.d(t,"IEasterEggsItemEventType",(function(){return w})),function(e){e.NOWHERE="nowhere",e.OTHER="other",e.START="start",e.START_BOX="start_box",e.START_PROCEED_AS="start_proceed_as",e.REGISTRATION_COMPLETE="registration_complete",e.REGISTRATION_COUNTRY="registration_country",e.REGISTRATION_PHONE="registration_phone",e.REGISTRATION_PHONE_VERIFY="registration_phone_verify",e.REGISTRATION_PASSWORD="registration_password",e.REGISTRATION_EDUCATION="registration_education",e.REGISTRATION_EMAIL="registration_email",e.REGISTRATION_NAME="registration_name",e.REGISTRATION_INVITE_CONFIRM="registration_invite_confirm"}(i||(i={})),function(e){e.TYPE_NAVGO="type_navgo",e.TYPE_ACTION="type_action",e.TYPE_CLICK="type_click",e.TYPE_VIEW="type_view"}(a||(a={})),function(e){e.GO="go",e.BACK="back",e.TAB_OPEN="tab_open"}(r||(r={})),function(e){e.TYPE_DONUT_DESCRIPTION_NAV_ITEM="type_donut_description_nav_item",e.TYPE_MARKET_NAVGO="type_market_navgo",e.TYPE_YOULA_SNIPPET_NAVGO="type_youla_snippet_navgo"}(r||(r={})),function(e){e.TYPE_YOULA_SNIPPET_ITEM="type_youla_snippet_item"}(o||(o={})),function(e){e.TYPE_REGISTRATION_ITEM="type_registration_item",e.TYPE_MARKETING_TRANSITION_ITEM="type_marketing_transition_item",e.TYPE_DONUT_PAYMENT_ITEM="type_donut_payment_item",e.TYPE_CALL_ITEM="type_voip_call_item",e.TYPE_BRIDGE_EVENT_ITEM="type_bridge_event_item",e.TYPE_EASTER_EGGS_ITEM="type_easter_eggs_item",e.TYPE_CUSTOM_METRICS_ITEM="type_ab_custom_metrics_item"}(s||(s={})),function(e){e.TYPE_MARKET_CLICK="type_market_click",e.TYPE_WORKI_CLICK="type_worki_click",e.TYPE_CATALOG_BANNER_ITEM="type_catalog_banner_item",e.TYPE_MINI_APP_ITEM="type_mini_app_item"}(c||(c={})),function(e){e.TYPE_CATALOG_BANNER_ITEM="type_catalog_banner_item",e.TYPE_MARKET_VIEW="type_market_view"}(l||(l={})),function(e){e.MARKETPLACE="marketplace",e.MARKETPLACE_BLOCK="marketplace_block",e.MARKETPLACE_SEARCH="marketplace_search"}(u||(u={})),function(e){e.TYPE_MARKET_ORDERS_ITEM="type_market_orders_item",e.TYPE_MARKET_CARTS_ITEM="type_market_carts_item",e.TYPE_MARKET_GOODS_ITEM="type_market_item",e.TYPE_MARKET_MARKETPLACE_ITEM="type_market_marketplace_item"}(d||(d={})),function(e){e.TYPE_WORKI_SNIPPET_ITEM="type_worki_snippet_item"}(_||(_={})),function(e){e.ARTICLE="article",e.GROUP="group",e.PHOTO="photo",e.POST="post",e.STORY="story",e.USER="user",e.BROWSER="browser",e.NARRATIVE="narrative",e.MINI_APP="mini_app",e.GAME="game",e.VIDEO="video",e.MARKET_ITEM="market_item",e.MARKET_ITEM_ALBUM="market_item_album",e.MARKET_ORDER="market_order",e.CATALOG_BANNER="catalog_banner",e.WORKI_SNIPPET="worki_snippet"}(f||(f={})),function(e){e.SWITCH_ITEM_VARIANT_1="switch_item_variant_1",e.SWITCH_ITEM_VARIANT_2="switch_item_variant_2",e.OPEN_WIKI="open_wiki"}(p||(p={})),function(e){e.SCREEN_PROCEED="screen_proceed",e.SCREEN_SKIP="screen_skip",e.SCREEN_RETURN="screen_return",e.COMMON_SERVER_ERROR="common_server_error",e.RESEND_SMS_CODE="resend_sms_code",e.RESEND_SMS_CODE_FAILED="resend_sms_code_failed",e.INCORRECT_SMS_CODE="incorrect_sms_code",e.INCORRECT_PASSWORD="incorrect_password",e.INCORRECT_NAME="incorrect_name",e.INCORRECT_CAPTCHA="incorrect_captcha",e.INCORRECT_PHONE_NUMBER="incorrect_phone_number",e.INCORRECT_BDAY="incorrect_bday",e.INCORRECT_SEX="incorrect_sex",e.INCORRECT_EMAIL="incorrect_email",e.INCORRECT_EDUCATION="incorrect_education"}(h||(h={})),function(e){e.PHONE_COUNTRY="phone_country",e.PHONE_NUMBER="phone_number",e.COUNTRY="country",e.CITY="city",e.EMAIL="email",e.UNIVERSITY="university",e.FACULTY="faculty",e.SCHOOL="school",e.CHAIR="chair",e.YEAR_FROM="year_from",e.YEAR_TO="year_to",e.CLASS="class",e.EDU_FORM="edu_form",e.EDU_STATUS="edu_status",e.GRADUATION="graduation",e.SPECIALIZATION="specialization",e.RULES_ACCEPT="rules_accept",e.SMS_CODE="sms_code",e.FIRST_NAME="first_name",e.LAST_NAME="last_name",e.SEX="sex",e.BDAY="bday",e.PASSWORD="password"}(m||(m={})),function(e){e.UNAUTH_BOTTOM_BANNER="unauth_bottom_banner",e.UNAUTH_ACTION_BOX="unauth_action_box"}(v||(v={})),function(e){e.OPEN="open",e.CLOSE="close",e.CLICK_SIGN_UP="click_sign_up",e.CLICK_SIGN_IN="click_sign_in",e.CLICK_OPEN_IN_APP="click_open_in_app"}(g||(g={})),function(e){e.LIKE="like",e.SHARE="share",e.MORE="more"}(A||(A={})),function(e){e.ACTION_MENU_SHARE="action_menu_share",e.ACTION_MENU_ADD_TO_FAVOURITES="action_menu_add_to_favourites",e.ACTION_MENU_REMOVE_FROM_FAVOURITES="action_menu_remove_from_favourites",e.ACTION_MENU_ENABLE_NOTIFICATIONS="action_menu_enable_notifications",e.ACTION_MENU_DISABLE_NOTIFICATIONS="action_menu_disable_notifications",e.ACTION_MENU_ALL_APPS="action_menu_all_apps",e.ACTION_MENU_ALL_GAMES="action_menu_all_games",e.ACTION_MENU_COPY="action_menu_copy",e.ACTION_MENU_DELETE="action_menu_delete"}(b||(b={})),function(e){e.EGG_SHOW="egg_show",e.POPUP_SHOW="popup_show",e.POPUP_ACTION="popup_action"}(w||(w={}))},rEJs:function(e,t,n){"use strict";n.r(t),n.d(t,"events",(function(){return i}));var i={CURRENT_CHANGED:"curr",PLAY:"start",PLAY_REQUESTED:"request_play",PAUSE:"pause",STOP:"stop",UPDATE:"update",LOADED:"loaded",ENDED:"ended",FAILED:"failed",BUFFERED:"buffered",PROGRESS:"progress",VOLUME:"volume",PLAYLIST_CHANGED:"plchange",ADDED:"added",REMOVED:"removed",FREQ_UPDATE:"freq",SEEK:"seek",PLAY_NEXT:"play_next",AD_READY:"ad_ready",AD_DEINITED:"ad_deinit",AD_STARTED:"ad_started",AD_COMPLETED:"ad_completed",START_LOADING:"start_load",CAN_PLAY:"actual_start",SELECT:"select",DESELECT:"deselect",EMPTY_PLAYLIST:"empty_playlist",NOT_FOUND_PLAYLIST:"not_found_playlist",INIT:"init",REQUEST_EXPANDED:"request_expanded",MUSIC_AUDIOS_ADD:"music_audios_add",MUSIC_PLAYLISTS_ADD:"music_playlists_add"}},rKUZ:function(e,t,n){"use strict";n.r(t);var i=n("MUpH"),a=n("bZ/P"),r=n("z9sQ"),o=n("BoyB"),s=n("fdw3");function c(){var e=Object(i.default)(['\n    <div class="typing__dotsWrap">\n      <div class="typing__dots">...</div>\n    </div>\n  ']);return c=function(){return e},e}function l(){var e=Object(i.default)(['\n    <div class="','">\n      ','\n      <div class="typing__names">',"</div>\n      ","\n    </div>\n  "]);return l=function(){return e},e}var u=function(e){var t,n,i=e.dimmed,s=e.animation,u=!!e.compact,f=e.typingCount,p=a.default.class("typing",{dimmed:i,id:e.id,empty:d(f),animation:s}),h=_(e);"audio"===s?(t=Object(o.default)({class:r.default.class("typing__loading",{audio:!0,compact:u},"_")}),n=""):"dots"===s?(t=Object(o.default)({class:r.default.class("typing__loading",{audio:!1,compact:u},"_")}),n=""):"simple-dots"===s&&(t="",n=a.default.html(c()));return a.default.html(l(),p,t,h,n)};function d(e){return!e}function _(e){return"audio"===e.text?function(e,t){var n=window.lang;if(!Object(s.isArray)(e))return e?n.mobile_mail_recaudio_1_short:"";var i=e,a=t,r="";if(1===a&&i.length>=1){var o=i[0];r=(r=n.mobile_mail_recaudio_1).replace("{name}",o)}else if(2===a&&i.length>=2){var c=i[0],l=i[1];r=(r=(r=n.mobile_mail_recaudio_2).replace("{name1}",c)).replace("{name2}",l)}else if(a>1&&i.length>=1){var u=i[0];r=(r=(r=n.mobile_mail_recaudio_many).replace("{name}",u)).replace("{count}",a-1)}else a>=1&&!i.length&&(r=langNumeric(a,n.mobile_mail_recaudio_N_unknown));return r}(e.typing,e.typingCount):"mixed"===e.text?function(e,t){var n=window.lang;if(!Object(s.isArray)(e))return"";var i=e,a=t,r="";if(1===a&&i.length>=1)r="";else if(2===a&&i.length>=2){var o=i[0],c=i[1];r=(r=(r=n.mobile_mail_mixtyping_2).replace("{name1}",o)).replace("{name2}",c)}else if(a>1&&i.length>=1){var l=i[0];r=(r=(r=n.mobile_mail_mixtyping_many).replace("{name}",l)).replace("{count}",a-1)}else a>=1&&!i.length&&(r=langNumeric(a,n.mobile_mail_mixtyping_N_unknown));return r}(e.typing,e.typingCount):function(e,t){var n=window.lang;if(!Object(s.isArray)(e))return e?n.mobile_mail_typing_1_short:"";var i=e,a=t,r="";if(1===a&&i.length>=1){var o=i[0];r=(r=n.mobile_mail_typing_1).replace("{name}",o)}else if(2===a&&i.length>=2){var c=i[0],l=i[1];r=(r=(r=n.mobile_mail_typing_2).replace("{name1}",c)).replace("{name2}",l)}else if(a>1&&i.length>=1){var u=i[0];r=(r=(r=n.mobile_mail_typing_many).replace("{name}",u)).replace("{count}",a-1)}else a>=1&&!i.length&&(r=langNumeric(a,n.mobile_mail_typing_N_unknown));return r}(e.typing,e.typingCount)}var f=n("UxAg");Object.assign(u,{setTyping:function(e,t){var n="string"==typeof e?Object(f.$)(".typing_id_"+e):e,i=n.$(".typing__names");n.classList.toggle("typing_empty",d(t.typingCount)),i.innerHTML=_(t)},getElem:function(e){return Object(f.$)(".typing_id_"+e)}});t.default=u;window.Typing=u,Object.assign(window,{Typing_renderNames:_,Typing_isEmpty:d})},rKp0:function(e,t,n){"use strict";n.r(t);var i=n("MUpH"),a=n("bZ/P"),r=n("Mc5h"),o=n("O5lf"),s=n("V2dH"),c=n("1KAK"),l=n("eWFs"),u=n("HGMY"),d=n("TYsd"),_=n("Y6JH"),f=n("fdw3"),p=n("dLIZ");function h(){var e=Object(i.default)(['\n    <div class="mailScrap__systemMessage" ',">\n      ","\n    </div>\n  "]);return h=function(){return e},e}function m(){var e=Object(i.default)(['\n      <div class="mailScrap__empty mailScrap__empty_',' mailScrap_casper">\n        <div class="mailScrap__casperIcon" aria-hidden="true">\n          ','\n        </div>\n        <div class="mailScrap__casperText">\n          ',"\n        </div>\n      </div>\n  "]);return m=function(){return e},e}function v(){var e=Object(i.default)(['\n    <div class="mailScrap__empty mailScrap__empty_','">\n      ',"\n    </div>\n  "]);return v=function(){return e},e}function g(){var e=Object(i.default)(['\n    <div class="','">\n      ',"\n    </div>\n  "]);return g=function(){return e},e}function A(){var e=Object(i.default)(['\n    <div class="','">\n      ',"\n      ","\n      ","\n      ","\n      ","\n      ","\n      ","\n      ","\n      ","\n    </div>\n  "]);return A=function(){return e},e}var b=function(e){var t=e.scrap,n=e.isCasper,i="peer"===t,o=j(t),c=i?k("before"):"",l=k("after"),g=k("center"),b=function(e){var t,n=a.default.class("mailScrap__items",((t={})[e]=!0,t)),i=w(e);return Object(r.default)({mix:n,inner:i})}(t),y=n?"":function(e){var t=C(e);return a.default.html(v(),e,t)}(t),O=n?function(e){var t=d.default.html(Object(_.default)(Object(p.getGhostOutline56Icon)())),n=Object(f.getLang)("mobile_casper_chat_no_messages");return a.default.html(m(),e,t,n)}(t):"",S=i?Object(s.default)():"",E=i?d.default.html(Object(u.default)()):"",T=i?(I=store.mail.cur.notification||"",M=a.default.onClick("MailScrap.clearSystemMessage2"),a.default.html(h(),M,I)):"";var I,M;return a.default.html(A(),o,c,b,y,O,l,E,S,T,g)};function w(e){for(var t=store.mail,n=t.cur,i=t.msgs,r=t.scraps[e],o=r.length,s=[],c=!1,l=0;l<o;l++){if(l>0&&"peer"===e&&!c){var u=i[r[l-1]],d=i[r[l]];if(d.isUnread&&!u.isUnread&&d.authorId!==n.viewerId){c=!0,s.push(y(e,r[l],!0));continue}}s.push(y(e,r[l]))}return a.default.list(s)}function y(e,t,n){void 0===n&&(n=!1);var i=store.mail,a=i.cur,r="";if("folder"===e)r="important"===a.folder?O(t):S(t);else if("search"===e)if("peers"===a.tab){var o=t;i.peers[o].isIncomingMR||(r=function(e){return Object(l.default)(e,null,{isWithoutMessage:!0})}(o))}else{r=O(t)}else if("peer"===e){r=function(e,t){void 0===t&&(t=!1);return Object(c.default)({msgId:e,withDivider:t})}(t,n)}else if("mrs"===e){r=S(t)}return r}function O(e){var t=store.mail.msgs[e].peerId;return Object(l.default)(t,e)}function S(e){return Object(l.default)(e,"last")}function k(e){var t,n=a.default.class("mailScrap__loading",((t={})[e]=!0,t)),i=Object(o.default)({mix:""});return a.default.html(g(),n,i)}function C(e){var t=window.lang,n=store.mail.cur,i="";switch(e){case"peer":i=t.mobile_mail_history_is_empty;break;case"mrs":i=t.mobile_mail_mrs_empty_info;break;case"folder":i={all:t.mobile_mail_no_messages,important:t.mobile_mail_no_important,unread:t.mobile_mail_no_unreaded,unrespond:t.mobile_mail_sublist_empty,ad_tag:t.mobile_mail_sublist_empty}[n.folder];break;case"search":"msgs"===n.tab&&(i=t.mobile_mail_not_found),"peers"===n.tab&&(i=t.mobile_mail_no_peers)}return i}function j(e){var t,n=store.mail,i=n.cur,r=n.reached,o=!0,s=!1,c=!1,l=!1;if("peer"===e){var u=i.peerId,d=n.scraps.peer,_=d.length,f=n.rolls.peer[u]||[];o=r.peer.before[u]&&d[0]===f[0],s=last(d)===last(f)&&r.peer.after[u],0===_&&(s=!0);var p=u?n.peers[u]:null;p&&(c=!!p.systemMessageCode,p.isChannel&&(l=p.ownerId!==i.viewerId))}else if("mrs"===e)s=r.mrs;else if("folder"===e)s=r.folder[i.folder];else if("search"===e){var h=i.tab;i.query;if("peers"===h){var m=n.scraps.search.length;s=r.search[i.tab][i.query]||m>0}else s=r.search[i.tab][i.query]}return a.default.class("mailScrap",((t={})[e]=!0,t.empty=function(e){var t=store.mail,n=t.cur,i=t.scraps,a=t.reached,r=!1;switch(e){case"peer":var o=n.peerId,s=t.rolls.peer[o];0===(s?s.length:0)&&a.peer.after[o]&&a.peer.before[o]&&(r=!0);break;case"mrs":0===i.mrs.length&&a.mrs&&(r=!0);break;case"folder":0===i.folder.length&&a.folder[n.folder]&&(r=!0);break;case"search":0===i.search.length&&a.search[n.tab][n.query]&&(r=!0)}return r}(e),t.systemMessage=c,t.reachedBefore=o,t.reachedAfter=s,t.tab="search"===e&&i.tab,t.isChannel=l,t))}n("+cqQ");var E=n("3pHe"),T=n("BZzM"),I=(n("s0aB"),n("GR/G")),M=n.n(I);Object.assign(b,{updateClass:N,clearSystemMessage2:function(){remove(geByClass1("service_msg_box"))},onSystemMessageClick:function(){!function(){var e=store.mail,t=e.cur;e.peers[t.peerId].systemMessageCode=null,N("peer"),F()}()},resetPrevScraps:function(){P={folder:[],search:[],peer:[]}},redrawPeer:function(){R("peer",store.mail.scraps.peer),$$(".mailScrap_peer").forEach((function(e){return e.className=j("peer")}))},redrawFolder:function(e){var t=store.mail,n=t.cur,i=t.scraps;n.folder;R("folder",i.folder,e),$$(".mailScrap_folder").forEach((function(e){return e.className=j("folder")})),$$(".mailScrap__empty_folder").forEach((function(e){return e.innerHTML=C("folder")}))},redrawSearch:function(){$$(".mailScrap__items_search").forEach((function(e){return e.innerHTML=w("search")})),$$(".mailScrap_search").forEach((function(e){return e.className=j("search")})),$$(".mailScrap__empty_search").forEach((function(e){return e.innerHTML=C("search")}))},redrawMRs:function(e){R("mrs",store.mail.scraps.mrs,e),$$(".mailScrap_mrs").forEach((function(e){return e.className=j("mrs")})),$$(".mailScrap__empty_mrs").forEach((function(e){return e.innerHTML=C("mrs")}))},redrawSystemMessage:F,folderSetItems:function(e){$$(".mailScrap__items_folder").forEach((function(t){return t.innerHTML=B(e,!0)})),$$(".mailScrap_folder").forEach((function(e){return e.className=j("folder")})),$$(".mailScrap__empty_folder").forEach((function(e){return e.innerHTML=C("folder")}))},folderAddItems:function(e){$$(".mailScrap__items_folder").forEach((function(t){return t.insertAdjacentHTML("beforeend",B(e))}))},folderCutItems:function(e){$$(".mailScrap_folder .mailScrap__items").forEach((function(t){[].slice.call(t.children).slice(e).forEach((function(e){return t.removeChild(e)}))}))},peerAddElemAfter:function(e,t){var n=$(".mailScrap__items_peer");if(!n)return;var i=ceFromString(x([e],!0));L(t,i),n.appendChild(t),M()(t,i),N("peer")},peerAddItemsBefore:function(e,t){void 0===t&&(t=!1);N("peer"),e=e.filter(unique).filter((function(e){return!$(".msg_id_"+e)}));var n=E.Messenger.getConvoBody();n.scrollHeight,n.scrollTop,n.offsetHeight;window._preventedCheckTop=!0,setTimeout((function(){return window._preventedCheckTop=!1}));var i='\n    <div class="load_before load_before_closed">\n      '+x(e,t)+"\n    </div>\n  ";return $$(".mailScrap__items_peer").forEach((function(e){return e.insertAdjacentHTML("afterbegin",i)})),void uMessenger.expandPeerBefore()},peerAddItemsAfter:function(e,t,n){void 0===t&&(t=!1);e=e.filter(unique).filter((function(e){return!$(".msg_id_"+e)})),$$(".mailScrap__items_peer").forEach((function(n){n.insertAdjacentHTML("beforeend",x(e,t))})),N("peer"),Object(T.resizePosters)()},peerReplaceItems:function(e){e.forEach((function(e){var t=$(".msg_id_"+e),n=ceFromString(x([e],!0));L(t,n),M()(t,n),CasperTimer.init(e)})),Object(T.resizePosters)()},peerSetItems:function(e){e=e.filter(unique),$$(".mailScrap__items_peer").forEach((function(t){return t.innerHTML=x(e)}))},peerGoToBottom:function(){var e=E.Messenger.getConvoBody();e.scrollTop=e.scrollHeight},removeDivider:D,checkDivider:function(){var e=last($(".mailScrap__items_peer").children);e&&e.classList.contains("msg__newMsgsDivider")&&D()}}),uVK.onReady((function(){if(store.mail&&store.mail.scraps){var e=store.mail.scraps;P.folder=e.folder.slice(),P.search=e.search.slice(),P.peer=e.peer.slice()}}));var P={folder:[],search:[],peer:[]};function D(){remove($(".msg__newMsgsDivider"))}function x(e,t){void 0===t&&(t=!1),e=e.filter(unique);var n,i=store.mail,a=i.cur,r=i.msgs,o=!!$(".msg__newMsgsDivider");return e.map((function(e,i){var s=r[e];return i>0&&!o&&!t&&!n.isUnread&&s.isUnread&&s.authorId!==a.viewerId?(n=s,o=!0,y("peer",e,!0)):(n=s,y("peer",e))})).join("")}function L(e,t){if(e&&t){var n=$(".pi_medias",e),i=$(".pi_medias",t);n&&i&&(i.isSameNode=n.isSameNode)}}function B(e,t){return void 0===t&&(t=!1),(e=e.filter(unique)).map((function(e){return $(".mailScrap__items_folder .convo_id_"+e)&&!t?"":y("folder",e)})).join("")}function R(e,t,n){!function(e,t,n,i){void 0===i&&(i=null);var a=[];if(!e)return;i||(e.innerHTML="",i=[]);if(0===n.length)return void(e.innerHTML="");n.forEach((function(n,a){var r=i.indexOf(n);-1===r?(i.splice(a,0,n),domInsert(e,t(n),a)):r!==a&&(i.splice(r,1),i.splice(a,0,n),before(e.children[r],e.children[a]))})),i.forEach((function(t,i){-1===n.indexOf(t)&&a.push(e.children[i])})),a.forEach(remove)}($(".mailScrap__items_"+e),(function(t){return y(e,t)}),t,n)}function N(e){$$(".mailScrap_"+e).forEach((function(t){return t.className=j(e)}))}function F(){$$(".mailScrap__systemMessage").forEach((function(e){e.innerHTML=store.mail.cur.notification||""}))}t.default=b;window.MailScrap=b},rc7J:function(e,t,n){"use strict";n.r(t);var i=n("z9sQ");var a=function(e){void 0===e&&(e={});var t=i.default.class("AlbumInfoRow",{withoutBottomBorder:e.withoutBottomBorder});return{inner:[{inner:[{src:e.avatar,alt:"avatar",tag:"img"}],class:"AlbumInfoRow__avatar",href:e.author_url,onclick:"cancelEvent(event); nav.go(this);",tag:"a"},{inner:[{inner:[e.title],class:"AlbumInfoRow__title",href:e.url,tag:"a"},{inner:[e.subtitle],class:"AlbumInfoRow__subtitle",tag:"div"}],class:"AlbumInfoRow__content",tag:"div"}],class:t,onclick:"nav.go('"+e.url+"')",tag:"div"}};t.default=a},rudk:function(e,t,n){"use strict";n.r(t),n.d(t,"parseFwd",(function(){return s})),n.d(t,"convertKludgesToAttaches",(function(){return c})),n.d(t,"isReservedPeer",(function(){return l})),n.d(t,"isUserPeer",(function(){return u})),n.d(t,"isChatPeer",(function(){return d})),n.d(t,"isEmailPeer",(function(){return _})),n.d(t,"isContactPeer",(function(){return f})),n.d(t,"isCommunityPeer",(function(){return p})),n.d(t,"convertAttachesToPhpMedia",(function(){return h})),n.d(t,"isPinnedSortId",(function(){return m})),n.d(t,"isOnboardingFindFriendsLink",(function(){return v}));var i=n("jE6c"),a=n("hC3G");function r(e,t){void 0===t&&(t=[]);var n=e.split("_");return[n[0],n[1],t]}var o={};function s(e){if(o[e])return o[e];for(var t=e?e.length:0,n=[],i=[],a="",s=0;s<t;s++){var c=e[s],l=c.charCodeAt(0);l>=48&&l<=57||"_"===c||"-"===c?a+=c:"("!==c&&")"!==c&&":"!==c&&","!==c||(""!==a&&(i.push(a),n.push("id"),a=""),i.push(c),n.push(c))}a.length>0&&(i.push(a),n.push("id"));var u=function e(t,n,i,a){if(void 0===i&&(i=0),void 0===a&&(a=0),a>50)return[[],t.length];for(var o=[],s="";i<t.length;){var c=t[i];if("id"===c)s=n[i];else if(","===c&&s)o.push(r(s)),s="";else if("("===c){var l=e(t,n,i+1,a+1),u=l[0];i=l[1],o.push(r(s,u)),s=""}else if(")"===c)return""!==s&&o.push(r(s)),[o,i];i++}return s&&o.push(r(s)),[o,i]}(n,i)[0];return Object.keys(o).length>300&&(o={}),o[e]=u,u}function c(e,t){var n=[];e.fwd_count?n.push({type:"mail",id:-t,object:{fwd_count:e.fwd_count}}):e.fwd&&n.push({type:"mail",id:-t,object:{fwd_count:s(e.fwd).length}});for(var a=1;e["attach"+a+"_type"];++a)"call"===e["attach"+a+"_type"]?n.push({type:e["attach"+a+"_type"],id:e["attach"+a],initiatorId:Object(i.intval)(e["attach"+a+"_call_initiator_id"]),state:e["attach"+a+"_call_state"],duration:Object(i.intval)(e["attach"+a+"_call_duration"]),receiverId:Object(i.intval)(e["attach"+a+"_call_receiver_id"])}):n.push({type:e["attach"+a+"_type"],id:e["attach"+a],kind:e["attach"+a+"_kind"],productId:e["attach"+a+"_product_id"]});return e.geo&&n.push({type:"geo",id:e.geo}),n}function l(e){return 0==e}function u(e){return e>0&&e<2e9}function d(e){return e>2e9}function _(e){return e<-2e9}function f(e){return e>19e8&&e<2e9}function p(e){return e>-2e9&&e<0}function h(e){return e.map((function(e){var t="audiomsg"===e[2]?"audio_message":e[2];return e[0]+":"+e[1]+":"+t})).join(",")}function m(e){return e>0&&(e|a.PINNED_CONVERSATION_BIT_MASK)===a.PINNED_CONVERSATION_BIT_MASK}function v(e){return/(^(https?:\/\/)?([a-z0-9_\-.]+\.)?vk.com)?\/onboarding_find_friends/.test(decodeURIComponent(e))}},rycc:function(e,t,n){"use strict";function i(e){return e.href&&!e.tag&&(e.tag="a"),e}n.r(t),n.d(t,"MaybeLink",(function(){return i}))},s0aB:function(e,t,n){"use strict";n.r(t);var i=n("MUpH"),a=n("TYsd"),r=n("bZ/P"),o=n("Mc5h"),s=n("AXyT"),c=n("9y81"),l=n("KMpi"),u=n("Y6JH"),d=n("rKUZ"),_=n("fdw3"),f=n("gZry"),p=n("LBnd"),h=n("TjCR"),m=n("yOyn"),v=(n("ZvT/"),n("k0dR")),g=n("SDaO");function A(){var e=Object(i.default)(['\n    <div class="','" ',">\n      ","\n      ",'\n      <a class="convo__body" href="','">\n        <div class="convo__row convo__row_title ','">\n          <div class="convo__title">',"</div>\n          ","\n          ",'\n          <div class="convo__row_right">\n            ','\n            <div class="convo__date">',"</div>\n          </div>\n        </div>\n        ","\n      </a>\n    </div>\n  "]);return A=function(){return e},e}function b(){var e=Object(i.default)(['\n    <div class="convo__row convo__row_text">\n      <div class="convo__typing">','</div>\n      <div class="convo__text">','</div>\n      <div class="convo__row_right convo__unreadBox" ',">\n        ",'\n        <div class="convo__unreadOut"></div>\n        ','\n      </div>\n      <div class="convo__status">','</div>\n      <div class="convo__pin">',"</div>\n    </div>\n  "]);return b=function(){return e},e}var w=function(e){var t,n,i=e.more,o="",f="",p=0,h=!1,v="",w=Object(_.isPinnedSortId)(e.majorSortId);i&&(o=i.text,f=i.date,p=i.unreadCount,h=i.muted,v=i.typing?Object(d.default)(i.typing):"",t=i.pending,n=i.failed,(t||n)&&(f=""));var C=r.default.class("clickable","convo",{id:e.id,short:!i,last:e.isLast,typing:!!v,important:e.important,unread:e.isLast&&(p>0||e.isMarkedUnread),unreadOut:e.isLast&&p<0,pinned:i&&w}),j=a.default.html(Object(l.Avatar)({size:50,src:e.photos,mix:"convo__avatar",url:e.profileUrl,mode:"image"})),E=O({pending:t,failed:n}),T=y(e.online),I=Object(c.default)({mix:"convo__star",icon:"star",blue:!0}),M=S(e.peerProfile),P=a.default.html(Object(u.default)(Object(g.getPin16Icon)())),D=e.isLast?Object(s.default)({mix:"convo__unread",value:k(p,e.isMarkedUnread),gray:h}):"",x=e.url,L=r.default.onClick("Convo._onClick","event",x),B=e.isCasper?'<span class="convo__casper" title="'+Object(_.getLang)("mobile_casper_chat_title")+'">'+a.default.html(Object(u.default)(Object(m.getCasper16Icon)()))+"</span>":"",R=r.default.html(b(),v,o,E?"hidden":"","",D,E,P),N="";e.isWithoutMessage&&(R="",N="convo__row_centered");return r.default.html(A(),C,L,T,j,e.url,N,e.title,M,B,I,f,R)};function y(e){return"mobile"===e?a.default.html({inner:[{inner:[Object(u.default)({icon:Object(f.getOnlineMobileComposite16Icon)()})],class:"mlvi_default",tag:"div"},{inner:[Object(u.default)({icon:Object(p.getOnlineMobileCompositeMuted16Icon)()})],class:"mlvi_muted",tag:"div"}],class:"lvi mlvi convo__online convo__online_mobile",tag:"div"}):"desktop"===e?Object(o.default)({mix:r.default.class("convo__online",{desktop:!0})}):Object(o.default)({mix:"convo__online"})}function O(e){var t=window.lang;return e.pending?a.default.html({inner:[Object(u.default)({icon:Object(h.getRecent16Icon)()})],class:"convo__pending",tag:"div"}):e.failed?'<div class="convo__failed">'+t.mobile_mail_send_error+"</div>":""}function S(e){var t=e.tags,n=e.tagsData,i=[];t&&n.peerTags&&(i=t.filter((function(e){return n.peerTags.indexOf(e.id)>-1})));var r,o=i.length;if(!o&&!n.fromAd)return"";if(n.fromAd&&!o)r={class:"convo__adTag",inner:[Object(_.getLang)("mobile_mail_ad_tag_no_access_text"),Object(u.default)(Object(v.getAdTag10Icon)())]};else if(n.fromAd||1!==o){var s=window.lang,c=o+(n.fromAd?1:0);r={class:"convo__extraTag",inner:langNumeric(c,s.mobile_mail_peer_profile_extra_tags)}}else{var l=i[0];r={class:"convo__peerTag",inner:l.name,style:"background-color: "+l.color}}return a.default.html({class:"convo__peerTags",inner:r})}function k(e,t){var n=e;return t&&e<=0&&(n="empty"),n}var C=n("UxAg"),j=n("+cqQ"),E=n("OcsD");n("jk6M");function T(e,t){e.stopPropagation(),e.preventDefault(),w.onTap(t)}Object.assign(w,{onTap:Object(j.default)("url"),setOnline:function(e,t){Object(C.$$)(".convo_id_"+e+" .convo__online").forEach((function(e){e.outerHTML=y(t)}))},setLastMsg:function(e,t,n){var i=n.dateShort,a=n.pending,r=n.failed;Object(C.$$)(".convo_last.convo_id_"+e).forEach((function(e){e.$(".convo__text").innerHTML=t,e.$(".convo__status").innerHTML=O({pending:a,failed:r}),a||r?(e.$(".convo__date").innerText="",e.$(".convo__unreadBox").hidden=!0):(e.$(".convo__date").innerText=i,e.$(".convo__unreadBox").hidden=!1)}))},setTyping:function(e,t){Object(C.$$)(".convo_last.convo_id_"+e).forEach((function(e){var n=e.$(".convo__typing"),i=t.typing;if(t.typingCount&&(!0===i||Object(_.isArray)(i))){var a=n.$(".typing"),r=a&&q.parseClass("typing",a.className);a&&r.animation===t.animation?d.default.setTyping(a,t):(e.classList.add("convo_typing"),n.innerHTML=Object(d.default)(t))}else n.innerHTML="",e.classList.remove("convo_typing")}))},setUnreadCount:function(e,t,n){Object(C.$$)(".convo_last.convo_id_"+e).forEach((function(e){var i=e.$(".Oval");e.classList.toggle("convo_unread",t>0||n),e.classList.toggle("convo_unreadOut",t<0),s.default.setValue(i,k(t,n))}))},setImportant:function(e,t){Object(C.$$)(".convo_id_"+e).forEach((function(e){e.classList.toggle("convo_important",t)}))},updateAdTag:function(e,t){Object(C.$$)(".convo_id_"+e).forEach((function(e){var n=Object(C.$)("convo__peerTags",e);t.fromAd&&!n&&(n=Object(E.ceFromString)(S({tagsData:t})),after(n,Object(C.$)(".convo__title",e)))}))},updatePinned:function(e,t){Object(C.$$)(".convo_id_"+e).forEach((function(e){e.classList.toggle("convo_pinned",t)}))}}),w._onClick=T;t.default=w;window.Convo=w,window.Convo__online=y},scr1:function(e,t,n){"use strict";n.r(t),n.d(t,"NARRATIVE_MAX_STORIES_COUNT",(function(){return j})),n.d(t,"StoriesArchive",(function(){return E}));var i=n("2mXy"),a=n("UxAg"),r=n("TYsd"),o=n("V4qE"),s=n("fdw3"),c=n("OcsD"),l=n("vOib"),u=n("Y6JH"),d=n("7cYY"),_=n("z9sQ"),f=n("29dZ"),p=n("O5lf"),h=n("Wccy"),m=n("La8/"),v=n("UTGD"),g=n("NElm");function A(e){void 0===e&&(e={});var t=e.stories&&0===e.stories.length,n=e.selectedStories&&e.selectedStories.length,i=0===n,a=_.default.class("StoriesArchive",{editable:e.isEdit}),o=["StoriesArchive__stories",e.isLoading?"_si_container_loading":null];return t?Object(l.default)({inner:[{inner:[Object(u.default)({icon:Object(h.getArchiveOutline56Icon)()})],class:"StoriesArchiveEmpty__icon",tag:"div"},{inner:[Object(s.getLang)("mobile_stories_archive_empty_label")],class:"StoriesArchiveEmpty__label",tag:"div"}],mix:"StoriesArchive StoriesArchiveEmpty"}):Object(l.default)({inner:[{inner:[e.stories.map((function(t){var n=Object(s.arraySomeEqual)(e.selectedStories,"id",t.id);return Object(d.default)({isSelectable:e.isEdit,isSelected:n,story:t,onStoryThumbCheck:e.onStoryThumbCheck})}))],class:o,ref:e.storiesArchiveStoriesWrapperRef,tag:"div"},e.isLoading?r.default.wrap(Object(p.default)({mix:"StoriesArchive__spinner"})):null,e.isEdit?{inner:[{inner:[i?Object(s.getLang)("mobile_stories_archive_select_at_least_one"):Object(s.getLangNumeric)(n,Object(s.getLang)("mobile_stories_archive_selected_stories_title","raw")),i?null:{inner:[Object(u.default)({icon:Object(m.getCancel12Icon)()})],class:"StoriesArchiveActions__resetSelectedIcon",onClick:e.onResetSelectedStoriesClick,tag:"div"}],class:"StoriesArchiveActions__selected",tag:"div"},{inner:[Object(f.default)({inner:[Object(s.getLang)("mobile_stories_archive_remove")],class:"StoriesArchiveActions__btn StoriesArchiveActions__btn--delete",theme:"secondary",onClick:e.onDeleteStoriesActionClick,disabled:!e.selectedStories.length||e.isCreateNarrativeActionLoading,isLoading:e.isDeleteActionLoading,icon:Object(u.default)(Object(v.getDeleteOutline24Icon)())}),Object(f.default)({inner:[Object(s.getLang)("mobile_stories_archive_to_narrative")],class:"StoriesArchiveActions__btn StoriesArchiveActions__btn--narrative",theme:"secondary",onClick:e.onCreateNarrativeActionClick,disabled:!e.selectedStories.length||e.isDeleteActionLoading,isLoading:e.isCreateNarrativeActionLoading,icon:Object(u.default)(Object(g.getNarrativeOutline24Icon)())})],class:"StoriesArchiveActions__buttons",tag:"div"}],class:"StoriesArchiveActions",ref:e.storiesArchiveActionsRef,tag:"div"}:null],mix:a,ref:e.storiesArchiveRef})}var b,w=n("zouF"),y=n("r/ag"),O=n("1UEa"),S=(b=function(e,t){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}b(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),k=function(){return(k=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},C=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),a=0;for(t=0;t<n;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,a++)i[a]=r[o];return i},j=100,E=function(e){function t(t){var n,a,r=e.call(this,t)||this;return r.storiesArchiveRef=Object(i.createRef)(),r.storiesArchiveStoriesWrapperRef=Object(i.createRef)(),r.storiesArchiveActionsRef=Object(i.createRef)(),r.state=k(k({},t),{storiesLoadedCount:null===(n=t.stories)||void 0===n?void 0:n.length,isLoading:!1,isAllLoaded:(null===(a=t.stories)||void 0===a?void 0:a.length)>=t.storiesTotalCount,selectedStories:[]}),r.deleteSelectedStories=r.deleteSelectedStories.bind(r),r.createNarrativeFromSelectedStories=r.createNarrativeFromSelectedStories.bind(r),r.resetSelectedStories=r.resetSelectedStories.bind(r),r.onStoryThumbCheck=r.onStoryThumbCheck.bind(r),window.nav.onBeforeGo((function(e,t,n){"/narratives"===window.nav.path&&(null==n?void 0:n.need_restore)&&(null==r||r.setState({isLoading:!1,isCreateNarrativeActionLoading:!1}))})),r}return S(t,e),t.prototype.componentDidMount=function(){var e=this;Object(d.fixStoryThumbHeaders)(this.storiesArchiveStoriesWrapperRef.current),Object(c.initStickySimulator)((function(){return e.storiesArchiveRef.current}),(function(){return e.storiesArchiveActionsRef.current}),{shouldCalculateAudioPlayer:!0}),Object(c.initAutoScroll)((function(){var t=Object(a.$$)(".StoryThumb",e.storiesArchiveStoriesWrapperRef.current);return t[t.length-1]}),this.loadStories.bind(this))},t.prototype.componentDidUpdate=function(){Object(d.fixStoryThumbHeaders)(this.storiesArchiveStoriesWrapperRef.current)},t.prototype.loadStories=function(){var e=this;if(this.state.isLoading||this.state.isAllLoaded)return!1;this.setState({isLoading:!0}),window.ajax.post("stories",{act:"archive_list",offset:this.state.storiesLoadedCount,owner_id:this.state.ownerId,_ajax:!0},{onDone:function(t){var n=C(e.state.stories,t.stories||[]),i=n.length>=t.storiesTotalCount;e.setState({stories:n,storiesLoadedCount:n.length,storiesTotalCount:t.storiesTotalCount,isAllLoaded:i,isLoading:!1})}})},t.prototype.deleteSelectedStories=function(){var e,t=this,n=this;if(!(null===(e=this.state.selectedStories)||void 0===e?void 0:e.length))return!1;var i=Object(s.getLangNumeric)(this.state.selectedStories.length,Object(s.getLang)("mobile_stories_archive_confirm_stories_delete_message","raw")),a=Object(w.Confirm)(i,(function(){var e;t.setState({isDeleteActionLoading:!0}),y.default.close(a),window.ajax.post("stories.php",{_ajax:!0,act:"remove_stories",remove_stories_hash:t.state.removeStoriesHash,owner_id:t.state.ownerId,story_ids:null===(e=t.state.selectedStories)||void 0===e?void 0:e.map((function(e){return e.id})).join(",")},{onDone:function(e){var t,i,a,r=e.deletedStoryIds||[];n.setState({stories:null===(t=n.state.stories)||void 0===t?void 0:t.filter((function(e){return!r.includes(e.id)})),selectedStories:null===(i=n.state.selectedStories)||void 0===i?void 0:i.filter((function(e){return!r.includes(e.id)})),isDeleteActionLoading:!1,storiesTotalCount:n.state.storiesTotalCount-r.length,storiesLoadedCount:n.state.storiesLoadedCount-r.length}),o.init({type:o.SNACKBAR_TYPE_SUCCESS,text:Object(s.getLang)("mobile_stories_archive_stories_deleted_successful")}),null===(a=window.StoriesArchive)||void 0===a||a.sendStoryAnalytic("delete_from_archive")},onFail:function(){return n.setState({isDeleteActionLoading:!1}),!0}})}),null,{yes_label:Object(s.getLang)("mobile_stories_archive_remove")})},t.prototype.createNarrativeFromSelectedStories=function(){var e,t,n;if(!(null===(e=this.state.selectedStories)||void 0===e?void 0:e.length))return!1;if((null===(t=this.state.selectedStories)||void 0===t?void 0:t.length)>j)o.init({type:o.SNACKBAR_TYPE_ERROR,text:Object(s.getLangNumeric)(j,Object(s.getLang)("mobile_stories_archive_max_narrative_stories_count_alert","raw"))});else{var i=null===(n=this.state.selectedStories)||void 0===n?void 0:n.map((function(e){return e.id})),a=Object(s.makeUrl)("narratives",{act:"create",owner_id:this.props.ownerId,selected:(null==i?void 0:i.length)?i.join(","):null,from:Object(s.makeUrl)("stories_archive",{owner_id:this.props.ownerId})});Object(O.sendNarrativeAnalytic)(O.NarrativeAnalyticEventType.clickToAddToNarrative,this.props.ownerId,0,O.NarrativeAnalyticNavScreen.storyArchive),this.setState({isCreateNarrativeActionLoading:!0}),window.nav.go(a)}},t.prototype.resetSelectedStories=function(){this.setState({selectedStories:[]})},t.prototype.onStoryThumbCheck=function(e,t){if(e.preventDefault(),e.stopPropagation(),t){var n=C(this.state.selectedStories);n.some((function(e){return e.id===t.id}))?n=n.filter((function(e){return e.id!==t.id})):n.push(t),this.setState({selectedStories:n})}},t.prototype.render=function(){return r.default.preact(A,k(k({},this.state),{onStoryThumbCheck:this.onStoryThumbCheck,onResetSelectedStoriesClick:this.resetSelectedStories,onDeleteStoriesActionClick:this.deleteSelectedStories,onCreateNarrativeActionClick:this.createNarrativeFromSelectedStories,storiesArchiveRef:this.storiesArchiveRef,storiesArchiveStoriesWrapperRef:this.storiesArchiveStoriesWrapperRef,storiesArchiveActionsRef:this.storiesArchiveActionsRef}))},t}(i.Component)},t7Ww:function(e,t,n){"use strict";n.r(t),n.d(t,"ModalMenuBtn",(function(){return c})),n.d(t,"ModalMenuContent",(function(){return f})),n.d(t,"ModalMenuIcon",(function(){return l})),n.d(t,"ModalMenuTitle",(function(){return d})),n.d(t,"ModalMenuBody",(function(){return u})),n.d(t,"ModalMenuHeaderCloseButton",(function(){return _}));var i=n("r/ag"),a=n("29dZ"),r=n("Y6JH"),o=n("fdw3"),s=n("c9MT");function c(e){var t=e.class?" "+e.class:"";return t=e.isBtn?Object(o.concatValues)(t," ModalMenu__customBtn"):Object(o.concatValues)(t," ModalMenu__item"),Object(a.default)({icon:e.icon,url:e.url,class:"ModalMenu__btn "+t,theme:e.theme?e.theme:"none",size:e.size?e.size:"",inner:e.inner,on_click:e.onclick,use_native_onclick:!0,attrs:e.attrs,"aria-label":e["aria-label"]||""})}function l(e){return{inner:[{inner:[e.inner],class:"ModalMenu__icon",tag:"div"}],class:"ModalMenu__iconWrapper",tag:"div"}}function u(e){return{inner:[e.inner],class:"ModalMenu__customBody",tag:"div"}}function d(e){return{inner:[e.inner],class:"ModalMenu__title",tag:"div"}}function _(e){return void 0===e&&(e={}),{inner:[Object(r.default)({icon:Object(s.getDismiss24Icon)()})],class:"ModalMenu__headerCloseButton",onClick:e.onClose?e.onClose:["ModalMenu.close","this"],"aria-label":Object(o.getLang)("mobile_close"),tag:"button"}}function f(e){return e.class+=" ModalMenuContent",e}t.default=function(e){var t=e.attached?"ModalMenu--attached":"",n=window.lang,r=[];if(e.title&&r.push({class:"ModalMenu__title",inner:e.title}),e.body&&r.push({class:"ModalMenu__body",inner:e.body}),Object(o.isArray)(e.items)){var s=e.items.map((function(e){return e}));r.push(s)}e.close&&r.push(Object(a.default)({class:"ModalMenu__btn ModalMenu__cancel",theme:"secondary",size:"large",inner:e.closeText?e.closeText:n.mobile_cancel,on_click:e.onClose?e.onClose:["ModalMenu.close","this"],use_native_onclick:!0}));var c=function(e){if(e&&e[0]&&e[0].inner&&e[0].inner.inner&&e[0].inner.inner[0]&&"ModalMenuHeader"===e[0].inner.inner[0].class)return!0;return!1}(r)?" ModalMenu--hasHeader":"";return Object(i.default)({id:e.id||"",class:"ModalMenu "+e.class+" "+t+" "+c,on_overlay_click_native:e.on_overlay_click?e.on_overlay_click:["ModalMenu.close","this"],content:r})}},tgcV:function(e,t,n){"use strict";function i(e){return new Promise((function(t,n){var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.href=e,i.onload=function(){return t(i)},i.onerror=function(){return n(new Error("Stylesheet load error for "+e))},document.head.appendChild(i)}))}function a(e){var t,n=(t=e,new Promise((function(e,n){var i=new XMLHttpRequest;i.open("GET",t),i.onload=function(){200===i.status?e(i.response):n(i.response)},i.onerror=function(){n(i.response)},i.send()})));return n.then((function(e){var t=document.createElement("style");t.innerHTML=e,document.head.appendChild(t)})),n}var r;n.r(t),n.d(t,"addStatic",(function(){return f})),n.d(t,"preloadStaticForNavigation",(function(){return p})),n.d(t,"initStaticManager",(function(){return h}));var o=[];function s(e,t){var n=e;return t&&(n+="?"+t),new Promise((function(e,t){var i,a,r,o=document.getElementsByTagName("script");Array.from(o).some((function(e){return e.src===n}))?e():(i=n,a=function(n){n?t(n):e()},(r=document.createElement("script")).src=i,r.onload=function(){return a(null,r)},r.onerror=function(){return a(new Error("Script load error for "+i))},document.head.appendChild(r))}))}function c(e,t){var n=function(){if(void 0!==r)return r;try{var e=document.createElement("b");e.style.display="flex",r="flex"===e.style.display}catch(e){r=!1}return r}()?i:a,o=e;t&&(o+="?"+t);var s=document.getElementsByTagName("link"),c=Array.from(s).find((function(e){return e.href===o}));return c?Promise.resolve(c):n(o)}function l(e){window.stManager.staticFiles[d(e)]=Promise.resolve()}function u(){window.vk&&window.vk.stFiles&&window.stManager?(Object.keys(window.vk.stFiles).forEach((function(e){return l(e)})),window.vk.stFiles=[]):setTimeout(u,0)}function d(e){return e.replace(/^https:\/\/st[-\d]*\.vk\.com\//i,"static://")}function _(e){o[e]&&o[e]()}function f(e){return void 0===e&&(e={}),Promise.all(Object.keys(e).map((function(t){return n=t,i=e[t],r=d(n),window.stManager.staticFiles[r]||(n.includes(".js")?a=s(n,i):n.includes(".css")&&(a=c(n,i)),a&&(window.stManager.staticFiles[r]=a,a.catch((function(){window.stManager.staticFiles[r]=null}))),a||Promise.resolve());var n,i,a,r})))}function p(e){var t=window.vk.stNavMap||{};for(var n in t){if(t.hasOwnProperty(n))if(new RegExp(n).test(e)){f(t[n]||{});break}}}function h(){u(),window.stManager={done:_,staticFiles:[],registerLoadedScript:l}}},tlMv:function(e,t,n){"use strict";n.r(t);var i=n("g3t9");t.default=i.default},tqja:function(e,t){var n,i=(n={1:"SEND_EMAIL",2:"CALL_PHONE",6:"OPEN_GROUP_APP"},{processButton:function(e,t,i,a,r,o){if(void 0===o&&(o=!1),e.classList.contains("_locked"))return!1;var s=!0;return n[t]&&(s=!1),e.classList.add("_locked"),ajax.post("/groups",{_ajax:1,act:"proxy_cta_button",action:t,resource:i,group_id:a,hash:r},{onDone:function(){if(e.classList.remove("_locked"),o)o();else if(s){var t=attr(e,"href");nav.go(t)}}}),!s}});window.GroupActionButton=i},u33z:function(e,t,n){"use strict";n.r(t);var i=n("MUpH"),a=n("bZ/P");function r(){var e=Object(i.default)(['\n    <button type="','" class="','" ',">\n      ","\n    </button>\n  "]);return r=function(){return e},e}function o(){var e=Object(i.default)(['\n      <a class="','" href=',' target="','" ',">\n        ","\n      </a>\n    "]);return o=function(){return e},e}var s=function(e){var t=e.class?" "+e.class:"";if(t="MailButton"+t,"link"===e.type&&e.link){var n=e.link.href,i=e.link.target||"_blank";return a.default.html(o(),t,n,i,e.onClick,e.text)}var s=e.type;"button"===s&&"submit"===s||(s="button");return a.default.html(r(),s,t,e.onClick,e.text)};t.default=s;window.MailButton=s},uBUF:function(e,t,n){"use strict";function i(e){return e.tag=e.tag||"div",e}n.r(t),n.d(t,"CustomTag",(function(){return i}))},uQjJ:function(e,t,n){"use strict";n.r(t);var i=n("4O8T"),a=n.n(i);window.EventEmitter=a.a,t.default=a.a},uo4j:function(e,t){ownerPhotoUpload.onUploadedDone((function(e){var t=geByClass1("feedAssistance_profilePhoto");if(t){var i=geByClass1("feedAssistanceProfilePhotoContent__avatar",t),a=geByClass1("feedAssistanceProfilePhotoContent__desc",t),r=geByClass1("feedAssistanceProfilePhotoContent__title",t),o=geByClass1("feedAssistance__footerButton",t);(function(e,t){if(window.Image){var i=new Image;i.onload=function(){return n(e,t)},i.src=e}else n(e,t)})(e=function(e){return e.replace(/"/g,"").replace(/'/g,"").replace(/</g,"").replace(/>/g,"")}(e),i),r&&(r.textContent=getLang("mobile_assistance_profile_photo_uploaded_title")),a&&(a.textContent=getLang("mobile_assistance_profile_photo_uploaded_desc")),FeedAssistance.setFilled(t),remove(o)}})),FeedAssistanceStats.registerTrackingCls("feedAssistance_profilePhoto");function n(e,t){var n;t&&(addClass("feedAssistanceProfilePhotoContent__avatar_uploaded",t),setStyle(t,"background-image","url("+e+")")),n=e,geByClass("al_u"+vk.id).forEach((function(e){domData(e,"photo")&&domData(e,"photo",n);var t=geByClass1("_u"+vk.id,e);t&&"IMG"===t.tagName&&(t.src=n)}))}},"v+Uj":function(e,t,n){"use strict";n.r(t),n.d(t,"getCurrentElementIndex",(function(){return p})),n.d(t,"getElements",(function(){return f})),n.d(t,"scrollToElem",(function(){return _})),n.d(t,"_onWheel",(function(){return v}));var i=n("z9sQ");var a=function(e){var t=[i.default.class("Slider",{snapping:!!e.snapping}),e.class||e.mix],n=e.snapping?null:["Slider._onWheel","event","this"];return{inner:[{inner:[{inner:[e.inner],class:"Slider__line",role:"presentation",tag:"div"}],attrs:e.attrs,class:["Slider__scroll","_preventMenuOpen"],onwheel:n,onScroll:e.onScroll,tag:"div"}],class:t,id:e.id,tag:"div"}},r=n("OcsD"),o=n("UxAg"),s=n("jk6M");window.Slider={scrollToElem:_,nextElem:h,prevElem:m},Slider._onWheel=v,onDOMReady(A),onDOMReady((function(){onBodyResize(g)}));var c=".Slider",l=".Slider--snapping",u=".Slider__scroll",d=".Slider__line";function _(e,t,n){if(void 0===t&&(t=!1),void 0===n&&(n="center"),e){var i=e.closest(u),a=e.offsetLeft;"center"===n&&(a-=i.offsetWidth/2-e.offsetWidth/2);var o=0;if(window.getComputedStyle){var s=getComputedStyle(e);(s.scrollMarginLeft||s.scrollSnapMarginLeft)&&(o+=Object(r.toInt)(s.scrollMarginLeft||s.scrollSnapMarginLeft))}t&&i.scrollTo?(Object(r.domData)(i,"left",a-o),i.scrollTo({left:a-o,behavior:"smooth"})):i.scrollLeft=a-o}}function f(e){return e=Object(r.ge)(e),Object(o.$)(d,e).childNodes}function p(e,t){var n=Object(o.$)(u,e);return t||(t=f(e)),n.scrollWidth-n.offsetWidth<=n.scrollLeft?t.length-1:Array.from(t).map((function(e,t){return{index:t,scrollLeft:Math.abs(e.offsetLeft-n.scrollLeft)}})).sort((function(e,t){return e.scrollLeft-t.scrollLeft}))[0].index}function h(e,t,n){void 0===t&&(t=!1);var i=f(e=Object(r.ge)(e)),a=p(e,i),o=i[a+1];h&&(_(o,t,n),e.setAttribute("data-current",(a+1).toString()))}function m(e,t,n){void 0===t&&(t=!1);var i=f(e=Object(r.ge)(e)),a=p(e,i),o=i[a-1];o&&(_(o,t,n),e.setAttribute("data-current",(a-1).toString()))}function v(e,t){e.preventDefault();var n=e.deltaX,i=e.deltaY;Math.abs(n)>Math.abs(i)&&(t.scrollLeft+=n)}function g(){var e=Object(o.$$)(l);Array.from(e).forEach((function(e){var t=Object(o.$)(u,e);t.scrollLeft=t.scrollLeft}))}function A(){(s.default.ios||s.default.msie_edge)&&(onDOMReady(w),window.page&&window.page.onChange(w),window.MutationObserver&&onDOMReady((function(){document.body&&new MutationObserver(b).observe(document.body,{subtree:!0,childList:!0})})))}function b(e){e.forEach((function(e){e.addedNodes.forEach((function(e){e.nodeType===Node.ELEMENT_NODE&&e.$$(c).forEach(y)}))}))}function w(){Object(o.$$)(c).forEach(y)}function y(e){var t=getComputedStyle(e),n=Number(t.paddingTop.replace("px","")),i=Number(t.paddingBottom.replace("px",""));e.style.overflow="hidden",e.style.height=e.offsetHeight-n-i+"px",e.$(u).style.paddingBottom="20px"}t.default=a;window.Slider=a,Object(r.extend)(a,{scrollToElem:_,nextElem:h,prevElem:m,_onWheel:v})},vOeY:function(e,t,n){"use strict";n.r(t),n.d(t,"Form",(function(){return u})),n.d(t,"PasswordRepeatRule",(function(){return l}));var i=n("b6Sp"),a=n("UxAg"),r=n("OcsD"),o=["error"];function s(e,t){var n=Object(a.$)(".FormItem__bottom",e),i=n.innerHTML;i&&!n.getAttribute("data-initial")&&n.setAttribute("data-initial",i),n.innerHTML=t,n.classList.toggle("FormItem__bottom--hidden",!t)}var c=n("fdw3"),l={validator:function(e,t,n){var i=e.values;return!("pass_repeat"!==t||!e.wasFocused[t]&&!n||i[t]===i.pass)&&Object(r.getLang)("join_pwds_mismatch")}},u=function(){function e(e,t,n){this.errors={},this.serverErrors={},this.wasFocused={},this.name=e,this.layout=t,this.options=n,this.errors=Object(c.getState)(this.name).errors||{},this.serverErrors=this.errors}return Object.defineProperty(e.prototype,"values",{get:function(){return Object(i.getFormValues)(this.layout)},enumerable:!0,configurable:!0}),e.prototype.getSubmitButton=function(){return Object(a.$)("[type=submit]",this.layout)},e.prototype.onFocus=function(e){this.wasFocused[e]=!0},e.prototype.validate=function(e){var t=this;void 0===e&&(e=!1);var n=Object(i.getFormValues)(this.layout),r={};return Object.keys(n).forEach((function(n){t.options.rules.forEach((function(i){var a=i.validator(t,n,e);a&&(r[n]=a)}))})),this.errors=r,Object.keys(n).forEach((function(e){var n=r[e]||t.serverErrors[e]||"";"string"!=typeof n&&(n=n.__raw__);var i=Object(a.$)("[name="+e+"]");if(i){var c=i.closest(".FormItem");c&&(s(c,n||""),function(e,t){o.forEach((function(n){n!==t&&e.classList.remove("FormItem--"+n)}));var n=Object(a.$)("input",e);if(t){e.classList.add("FormItem--"+t);var i=e.getAttribute("data-name");i&&n.setAttribute("aria-describedby",i+"-bottom")}else n.removeAttribute("aria-describedby")}(c,n?"error":""))}})),!(0!==Object.keys(r).length)},e}()},vOib:function(e,t,n){"use strict";n.r(t);var i=n("UWnA"),a=n("8ZMO"),r=n("KiYr"),o=n("z9sQ"),s=n("fdw3"),c=n("rycc"),l=n("uBUF");function u(e){var t=[e];return Object(s.isArray)(e)&&(t=Object(s.wdToFlatArray)(e)),t.join("")}function d(e){var t=u(e);return!t||"<div></div>"===t}var _=function(e){if(void 0===e&&(e={}),e.content_only)return{outerHTML:u(e.content)};var t=e.title,n=e.corner||{},s=e.inner||e.content||e.children,_=e.anchor,f=e.alert,p=e.style||{},h=e.attrs||{},m=e.noShadow,v=e.theme||"gray";null!==e.count&&(v="black");var g=e.pageBlock?"PageBlock PageBlock--separate":"",A=[t];if(null!==e.count){var b={inner:[e.count],class:"Pad__count",tag:"span"};A.push(b)}return Object(l.CustomTag)({inner:[_?Object(a.default)({mix:"Pad__anchor",id:_}):null,f?Object(i.default)({inner:[Object(r.default)({inner:[f],class:"Pad__alert",theme:e.alert_theme})],style:{tiny_padding_bottom:!0}}):null,t?Object(i.default)({inner:[e.isHeaderPage?{inner:[A],class:"Pad__title",tag:"h1"}:{inner:[A],class:"Pad__title",tag:"h3"},n.url?{inner:[n.text],href:n.url,onClick:n.onclick,attrs:n.attrs,class:["Pad__corner",n.class],tag:"a"}:Object(c.MaybeLink)({inner:[n.text],href:n.url,onClick:n.onclick,attrs:n.attrs,class:["Pad__corner",n.class]})],class:"Pad__header"}):null,t?{inner:[s],class:["Pad__content",e.content_mix],tag:"div"}:s],tag:e.tag,attrs:h,class:[e.class||e.mix,o.default.class("Pad",{empty:d(s),noBorder:e.no_border,noCapsTitle:e.no_caps_for_title,style_extraTopPadding:p.extra_top_padding,theme:v,noShadow:m},"_"),g],ref:e.ref,"data-id":e.name||e.id})};t.default=_},vOyG:function(e,t){e.exports=["onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmousemove","onmouseout","onmouseenter","onmouseleave","ontouchcancel","ontouchend","ontouchmove","ontouchstart","ondragstart","ondrag","ondragenter","ondragleave","ondragover","ondrop","ondragend","onkeydown","onkeypress","onkeyup","onunload","onabort","onerror","onresize","onscroll","onselect","onchange","onsubmit","onreset","onfocus","onblur","oninput","oncontextmenu","onfocusin","onfocusout"]},vWwi:function(e,t,n){"use strict";n.r(t),n.d(t,"disableBodyScroll",(function(){return u})),n.d(t,"enableBodyScroll",(function(){return d}));var i,a=n("OcsD"),r=n("jk6M"),o=n("zvhO"),s=!1,c=null,l=null;function u(e,t){if(void 0===t&&(t={}),window.MutationObserver&&!s){window.storybook||window.nav.saveScrollPosition();var n,u=document.body,_=Object(a.scrollTop)(),f=u;if(c=f.style.overflow,s=!0,r.default.ios||r.default.ipad||(f.style.overflow="hidden"),t.forceScrollDisable&&(f.style.height="100%",document.documentElement.style.overflow="hidden"),l=new MutationObserver((function(){f.contains(e)||d()})),i=_,u){var p=!u.classList.contains("fixed");u.classList.add("fixed"),p&&Object(a.setStyle)(u,{top:"-"+_+"px"}),n=Object(o.isNumber)(_)?_:void 0,r.default.safari&&Object(a.getCw)()<882&&document.scrollingElement&&(document.scrollingElement.scrollTop=_||0,setTimeout((function(){document.scrollingElement&&(document.scrollingElement.scrollTop=_||0)}),100),setTimeout((function(){document.scrollingElement&&(document.scrollingElement.scrollTop=_||0)}),300))}return l.observe(u,{attributes:!0,childList:!0,subtree:!0}),{bodyScrollTopBeforeOpen:n}}}function d(e,t){var n;if(void 0===t&&(t={}),window.MutationObserver){var r=null!==(n=null==t?void 0:t.bodyScrollTopBeforeOpen)&&void 0!==n?n:i,o=void 0===(null==t?void 0:t.bodyScrollTopBeforeOpen),u=document.body;if(s){if(u.style.overflow=c,(null==t?void 0:t.forceScrollDisable)&&(document.documentElement.style.overflow="initial"),null==l||l.disconnect(),u){var d=u.classList.contains("fixed");u.classList.remove("fixed"),d&&void 0!==r&&(Object(a.setStyle)(u,{top:""}),Object(a.scrollTop)(r))}s=!1,o&&(i=void 0)}}}},vhZE:function(e,t,n){"use strict";n.r(t);var i=n("z9sQ"),a=n("z1UI"),r=n("Y6JH"),o=n("+7CI"),s=n("xTMR"),c=n("1W7h"),l=n("HaOv");var u=function(e){void 0===e&&(e={});var t={},n=e.raw||"",u=e.hash||"",d=e.text||"";"album"===(e.attachment_type||"")&&(e.height-=60),e.type&&"blur"!==e.type||(e.width>=250&&e.height>=250?e.type="blurWithText":e.type="blur"),("blur"===e.type||e.only_icon)&&(delete e.button,delete e.title),e.type&&(t[e.type]=!0);var _,f=i.default.class("PostPhotoRestriction",t);"blur"!==e.type&&"blurWithText"!==e.type||(_=e.width<100||e.height<100?Object(r.default)({icon:Object(o.getHideOutline28Icon)()}):Object(r.default)({icon:Object(s.getHideOutline56Icon)()})),"block"===e.type&&(!e.forceText&&(e.width<300||e.height<250)&&(delete e.title,delete e.text),_=e.width<100||e.height<100?Object(r.default)({icon:Object(c.getBlockOutline28Icon)()}):Object(r.default)({icon:Object(l.getDoNotDisturbOutline56Icon)()})),_={inner:[_],class:"SplashScreen__icon",tag:"div"},"block"!==e.type||e.title||(e.title=e.text);var p="PostPhotoRestriction.clear(this, event, '"+d+"', '"+e.button+"', '"+n+"', '"+u+"')";return{inner:[{inner:[Object(a.default)({title:e.title,icon_raw:_,more_text:e.button,more_type:"outlineMono",more_onclick:p,more_ontouchend:p,more_native_onclick:!0})],class:"PostPhotoRestriction__splash",tag:"div"}],class:f,tag:"div"}},d=n("he4e"),_=n("OcsD");window.PostPhotoRestriction={clear:d.clear,onClearConfirm:d.onClearConfirm,onClearDecline:d.onClearDecline};t.default=Object(_.extend)(u,{onClear:d.onClear,isCleared:d.isCleared})},vk58:function(e,t,n){"use strict";n.r(t),n.d(t,"BtnStack",(function(){return o}));var i=n("29dZ"),a=n("fdw3"),r=n("z9sQ");function o(e){var t=e.btns||e.inner||[],n=e.mode||"horizontal",o=e.align||"start";Object(a.isArray)(e.inner)&&1===e.inner.length&&e.inner[0].length>1&&(t=e.inner[0]),e.nowrap&&(t=t.map((function(e){return e.nowrap=!0,e})));var s,c=r.default.class("BtnStack",{stretchOnSmallScreens:e.stretch_on_small_screens,table:e.nowrap,stretch:e.stretch,mode:n,align:o},"_"),l=t.map((function(e){if(!e)return null;var t=["BtnStack__btn"];if(e.class&&t.push(e.class),e.mix&&t.push(e.mix),e.class=Object(a.arrayUnique)(Object(a.arrayFlat)(t)),!!e._&&e._.__is_wd_internal_data||Object(a.arrayIncludes)(t,"CellButton")||(e=Object(a.extend)(Object(i.default)(e),{nowrap:e.nowrap,is_icon:e.is_icon})),e.nowrap){var n=r.default.class("BtnStack__cell",{icon:e.is_icon},"_");return delete e.nowrap,{inner:[e],class:n,tag:"div"}}return e}));return e.after&&(s={inner:[e.after],class:r.default.class("BtnStack__cell",e.after_mix,"_"),tag:"div"}),{inner:[l[0]?l:null,s],class:c,tag:"div"}}},vkmG:function(e,t,n){"use strict";n.r(t),n.d(t,"symbols",(function(){return i})),n.d(t,"escape",(function(){return a})),n.d(t,"encodeHTMLEntities",(function(){return r})),n.d(t,"decodeHTMLEntities",(function(){return o}));var i=[["&amp;","&"],["&lt;","<"],["&gt;",">"],["&quot;",'"']];function a(e){return i.reduce((function(e,t){var n=t[0],i=t[1];return e.replace(new RegExp(i,"ig"),n)}),e)}function r(e){return a(e).replace(/[\u00A0-\u9999<>\&]/gim,(function(e){return"&#"+e.charCodeAt(0)+";"}))}function o(e){return i.reduce((function(e,t){var n=t[0],i=t[1];return e.replace(new RegExp(n,"ig"),i)}),e).replace(/&#(\d+);/g,(function(e,t){return String.fromCodePoint(t)}))}},vy0q:function(e,t,n){"use strict";n.r(t),n.d(t,"handleElementAction",(function(){return d})),n.d(t,"onScroll",(function(){return _})),n.d(t,"moveSlider",(function(){return f}));var i=n("B+U2"),a=n("v+Uj"),r=n("fdw3"),o=n("Y6JH"),s=n("3ai+");var c=function(e){void 0===e&&(e={});for(var t=e.elements,n=e.msgId,c={inline:!0,author_id:e.authorId||100},l=[],u=function(e){var a=t[e],o=a.pressed,s=a.buttons?a.buttons.map((function(t){return Object(i.BotsKeyboardRow)([t],c,n,o,"carousel"+e,e)})):null,u=a.title||a.description||s,d=Object(r.classNames)("MsgTemplateCard",{"MsgTemplateCard--full":!!u,"MsgTemplateCard--photo":!u}),_=a.action;_&&"open_photo"===_.type&&(_.photo_id=a.photo_id+"/mail"+n),l.push({inner:[a.photo_src?{inner:[{src:a.photo_src,alt:"",tag:"img"},{class:"MsgTemplateCard__imageShadow",tag:"div"}],class:"MsgTemplateCard__image",tag:"div"}:null,u?{inner:[a.title||a.description?{inner:[a.title?{inner:[Wd.wrap(a.title)],class:"MsgTemplateCard__title",tag:"span"}:null,a.description?{inner:[Wd.wrap(a.description)],class:"MsgTemplateCard__subtitle",tag:"span"}:null],class:"MsgTemplateCardContent__text",tag:"div"}:null,s?{inner:[s],class:"MsgTemplateCardContent__buttons",tag:"div"}:null],class:"MsgTemplateCardContent",tag:"div"}:null],class:d,onclick:_?"MsgTemplates.Carousel.handleElementAction(event, "+JSON.stringify(_)+")":"",tag:"div"})},d=0;d<t.length;d++)u(d);var _=Object(r.arrayLength)(t)>1;return{inner:[Object(a.default)({inner:[l],class:"Slider--right",onScroll:["MsgTemplates.Carousel.onScroll","event"],snapping:!0}),_?{inner:[{inner:[Object(o.default)({icon:Object(s.getChevronRight24Icon)()})],class:"MsgTemplate__button MsgTemplate__button--prev",onClick:["MsgTemplates.Carousel.moveSlider","this","prev"],tag:"button"},{inner:[Object(o.default)({icon:Object(s.getChevronRight24Icon)()})],class:"MsgTemplate__button MsgTemplate__button--next",onClick:["MsgTemplates.Carousel.moveSlider","this","next"],tag:"button"}],class:"MsgTemplate__buttons",tag:"div"}:null],class:"MsgTemplate MsgTemplate--carousel",tag:"div"}},l=n("N4ZS"),u=n("UxAg");function d(e,t){if("open_link"===t.type){if("BUTTON"===e.target.tagName||e.target.closest(".MsgTemplateCardContent__buttons"))return;var n=Object(l.wrapAwayIfExternal)(t.link,!0);window.open(n)}else if("open_photo"===t.type){var i=(t.photo_id||"").split("/"),a=i[0],r=i[1];return photo.zopen(null,null,a,r,{})}}function _(e){var t=e.target.closest(".Slider"),n=Object(a.getElements)(t),i=Object(a.getCurrentElementIndex)(t,n);t.classList.toggle("Slider--left",0!==i),t.classList.toggle("Slider--right",i<n.length-1)}function f(e,t){var n=e.closest(".MsgTemplate--carousel"),i=Object(u.$)(".Slider",n);"next"===t?Slider.nextElem(i,!0,"left"):Slider.prevElem(i,!0,"left")}t.default=c},w1QQ:function(e,t){window.FeedAssistance={hide:function(e,t,n){var i=domCA(e,".feedAssistance"),a=hasClass(i,"feedAssistance_filled");remove(i),a||function(e,t,n){var i=FeedAssistanceStats.getFromRef(e);ajax.post("/feed",{_ajax:1,type:t,hash:n,act:"hide_assistance",from:i})}(e,t,n);return!1},setFilled:function(e){var t=hasClass(e,"feedAssistance")?e:domCA(e,".feedAssistance");addClass("feedAssistance_filled",t)}}},wCFN:function(e,t,n){"use strict";n.r(t),n.d(t,"AlertBox",(function(){return s}));var i=n("OcsD"),a=n("TYsd"),r=n("Po+v"),o=n("29dZ");function s(e,t,n,s){void 0===s&&(s={});var c=Object(i.ceFromString)(a.default.html(Object(r.default)({id:s.id,class:"AlertBox",scrollable:!0,header:{title:t||getLang("mobile_warning_header")},content:[e,{class:"Popup__buttons",inner:[Object(o.default)({onClick:n||"Popup.close(this)",use_native_onclick:!0,class:"Popup__button",theme:"regular",inner:a.default.wrap(getLang("mobile_close"))})]}]})));domInsert(document.body,c),r.default.open(c,!0)}window.page&&page.onChange((function(){$$(".AlertBox").forEach((function(e){return r.default.close(e)}))})),window.AlertBox=s},wMVj:function(e,t,n){"use strict";n.r(t);var i=n("UxAg"),a=n("+cqQ"),r=n("jk6M"),o=n("OcsD"),s=n("a0wW"),c=(n("eGQV"),n("izth")),l=n("wkhI"),u=n("VzJG"),d=n("W9Tc"),_=n("XHVZ"),f=function(){if(!window.storybook){var e=!(!window.history||!history.pushState),t=se((function(){return p}));onDOMReady((function(){s.default.setFlag(s.FLAG_SUPPORTS_HISTORY_API,e)}));var n={},p=null,h=[],m=!1;if(e)addEvent(window,"popstate",(function(e){if(window.isNewMail&&f.onPopState())return preventEvent(e),void stopEvent(e);var t=extend({no_push:!0,need_restore:!0});if(e.state&&e.state.nav){var n=e.state.nav,a=n.tab,r=n.prev_tab;t=extend(t,{tab:a,prev_tab:r})}cur.share&&cur.share.destroy&&cur.share.destroy();var o=Object(i.$)(".Popup_open");location.href.includes("#pop_")||Popup.close(o),D(location,null,t)}));else{var v=location.hash||"";"#/"==v.substr(0,2)&&M(v.substr(1),null,{replace:!0});var g=function(e){(e=(e||"").substr(1))&&"/"==e.substr(0,1)||(e=location),D(e,null,{no_push:!0,need_restore:!0})};"onhashchange"in window?addEvent(window,"hashchange",(function(){g(location.hash||"")})):(!function e(){var n=location.hash||"";p!==n&&(p=n,t(!0)),setTimeout(e,100)}(),t((function(e){g(e)})))}var A=(location.pathname||"").replace(/^\/+/,"/"),b=location.search||"",w=location.hash||"";return{onBeforeGo:Object(a.default)(),onBeforeGo2:Object(a.default)(),onPopState:Object(a.default)(),go:D,al_go:P,app_go:function(e,t,n){if(!n)return!0;if(checkEvent(t))return!0;remove("app_go_frame");var i=getHref(e),a=ce("iframe",{id:"app_go_frame",src:n,onload:function(){remove("app_go_frame"),i&&f.hard_go(i)}},{display:"none"});return window.bodyNode.appendChild(a),!1},hard_go:M,go_after:function(e,t){return!Object(o.ajaxLayoutEnabled)()||(!!checkNav(t.target,{skip_onclick:!0,skip_clicable:!0})||(!1===e||f.go(e,t)||cancelEvent(t),!1))},page_set:function(e,t,n){T(e,t,n)},page_get:function(e,t){return void 0===t&&(t=Tabbar.getCurrentId()),function(e,t){for(var n=k(t),i=n.length-1;i>=0;--i){var a=n[i];if(a.h===e||a.a===e)return a.d}return!1}(e,t)},saveScrollPosition:function(){var e=E();e&&e.d&&(e.d.st=scrollTop())},set:B,checkUrl:I,tryHistoryBack:function(){var e=m;return e&&history.go(-e),m=!1,!!e},zInit:function(){var e=qs2obj(f.params);e.z&&x(e.z)},getPostParams:R,cur:A+b+w,path:A,params:b.substr(1),hash:w,clear:function(){n={},f.initStore(),h=[],Tabbar.setHistory(n)},hasUpdate:function(e,t,n){if(!e||!e.need_check_updates)return!1;var i=t,a=j(k(e.tab),i);if(!a||!n.html)return!1;var r=a.d.lm.check_updates,o=n.lm.check_updates;return!(!r&&!o)&&(o!==r&&{currentCache:a})},needUpdate:function(e,t,n){if(!e||!e.need_check_updates)return!0;var i=t,a=j(k(e.tab),i);if(!a||!n.html)return!0;var r=a.d.lm.check_updates,o=n.lm.check_updates;return!r&&!o||o!==r},updateCurrentPage:function(){var e=E();page.set(e.h,e.d,{forceUpdate:!0})},isTabHaveCache:function(e,t){var n=k(e);return!!n&&!!j(n,t)},getQuery:function(e){var t=qs2obj(f.params);return e?t[e]||null:t},getNotifierScrollTop:function(){var e=h.find((function(e){return"/settings?act=notifier"===e.h}));return e?e.d.st:null},reload:function(){return f.go(f.cur)},tryBack:function(){var e=h.slice(-2)[0];return!!e&&(f.go(e.h,null,{need_restore:!0}),!0)},backToTabHistory:function(e){var t=C(),n=t.findIndex((function(e){return!0===e.current})),i=e&&hasClass("al_back",e),a=e&&e.classList.contains("mh_back_replace"),r=attr(e,"href"),o=t[n-1];if(o)return t.splice(n,t.length),f.go(o.h,null,{need_restore:i});if(r)return S(Tabbar.getCurrentId()),f.go(r,null,{replace:a});var s=Tabbar.getCurrentId(),c=Tabbar.getDefaultURL(s);return S(s),f.go(c,null,{replace:a})},openInNativeApp:function(e,t,n,i,a){var o=this;if(void 0===i&&(i=!1),void 0===a&&(a=!1),this._openAppInProgress)return!1;cancelEvent(t);var s={android:"https://vk.cc/android",iphone:"https://vk.cc/iphone"},c=i?n.href:"vk://vk.com"+(ge("vk_wrap").offsetWidth<882&&f.prev_cur?f.prev_cur:f.cur),l=r.default.mi?1500:300;r.default.safari&&(l=10===r.default.ios?1100:r.default.ios>10&&r.default.ios<12?0:r.default.ios>=12&&r.default.ios<13?2800:r.default.ios>=13?1800:300);var u=Date.now(),d=setTimeout((function(){o._openAppInProgress=!1,Date.now()-u>l+200||!document.hasFocus()||(!a&&n&&n.href?f.hard_go(n.href):f.hard_go(s[e]))}),l);if(addEvent(window,"blur",(function e(){clearTimeout(d),o._openAppInProgress=!1,removeEvent(window,"blur",e)})),r.default.ios){addEvent(window,"focus",(function e(){window.menu&&window.menu.close(),removeEvent(window,"focus",e)}))}else window.menu&&window.menu.close();return this._openAppInProgress=!0,f.hard_go(c),statlogsValueEvent("mvk_open_in_native_link",1,e),!1},initOpenInNativeAppBtn:function(){if(!isVkWebView()){var e=geByClass1("mmi_open_in_app");e&&addClass("supported",e)}},initStore:function(){window.store&&(window.store.tabs=n)},getPageJs:function(){var e=Object(i.$)("#page_script");return e?e.innerText:h.length&&h[h.length-1].d.js||""},onMenuItemClick:function(e,t){var n=getW("vk_wrap")>=882?"full_version":"mobile";if(t&&Object(u.recordClick)(t),statlogsValueEvent("mvk_navigation_pages","click","tabbar",e,n),"/wall"===f.cur.substr(0,5)&&"add"===f.getQuery("act")){var a=Object(i.$)("#feed_add_form"),r=qs2obj(a.action.split("?")[1]),o=a.getAttribute("data-hash")||r.hash;o&&post.saveDraft(null,o)}},setFvLink:function(e){f.fv_link=e}}}function y(){Tabbar.setHistory(n)}function O(e){var t=window.Tabbar;if(!t)throw new Error("Tabbar is not defined: "+JSON.stringify(e));if(e.lm&&e.lm.tab&&e.lm.is_tab_page||e.options&&e.options.forceSetCurrent){var n=t.getCurrentId(),i=e.lm&&e.lm.tab||e.options.tab;t.setCurrentId(i),n!==i&&y()}else e.lm&&!e.lm.tab&&(e.lm.tab=t.getCurrentId())}function S(e){n[e]=[]}function k(e){return!!n[e]&&n[e]}function C(){return k(Tabbar.getCurrentId())}function j(e,t){var n=(e||[]).filter((function(e){return e.d===t||e.h===t}));return!(!n||!n[0])&&n[0]}function E(){var e=(C()||[]).filter((function(e){return!0===e.current}));return!(!e||!e[0])&&e[0]}function T(e,t,i){var a;t.options&&t.options.is_fast&&t.options.prev_tab?a=k(t.options.prev_tab):(O(t),a=C(),t.lm&&t.lm.is_tab_page&&(a=!1));var r=function(){var e=E();return e&&e.d&&e.d.options&&e.d.options.replaceState}()||function(e){return e&&e.options&&e.options.replacePrevPage}(t),o=!1;if(a){for(var s=-1,c=a.length-1;c>=0;c--)if(a[c].h===e||a[c].a===e){s=c;break}s>-1&&a.splice(s+1,a.length);for(var l=a.length-1;l>=0;l--){var u=a[l];u.h===e||u.a===e?(a[l]={h:e,d:t,a:i,current:!0},o=!0):a[l].current=!1}}if(!o){var d={h:e,d:t,a:i,current:!0};if(a){var _=a[a.length-1],f=_&&_.d&&_.d.options&&_.d.options.removeAfterNextResponse;(r||f)&&a.pop(),a.push(d),a.length>20&&a.shift()}else{var p=Tabbar.getCurrentId(),h=E();if(h&&h.d&&h.d.options&&h.d.options.need_check_updates&&d.d.lm.check_updates){var m=d.d.html,v=h.d.page;d.d.page=v,d.d.newHTML=m}n[p]=[d]}}if(isArray(a)){for(var g=-1,A=a.length-1;A>=0;A--)if(!0===a[A].current){g=A;break}if(g>0){var b=g-1;a[b].h.includes("/like?act=publish")&&function(e,t){e.splice(t,1)}(a,b)}}}function I(e){var t;if(t=/^(https?:)\/\/([^:\/]+)?(?::(\d+))??(\/+\\+)?(.*)$/i.exec(e)){if(t[1]!==location.protocol)return!1;if(t[2]&&t[2]!==location.hostname)return!1;if(t[3]&&t[3]!==location.port)return!1;e=t[5]||""}var n=e.match(/[^\/|\\|\s+]+\/\S+/g);return e=n?n[n.length-1].trim():e}function M(e,t,n){if(checkEvent(t))return!0;if(n&&n.push_only)return!0;if(n&&n.replace)location.replace(e);else if(e){var i=getHref(e);i===location.href.replace(location.origin,"")?location.reload():location.href=i}return!0}function P(e,t,n){cancelEvent(t);var i=getHref(e);if(Object(o.ajaxLayoutEnabled)()){if(n&&n.push_only)return!0;if(ajax.nav(i,n))return document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),!0}M(i,t,n)}function D(t,n,i){var a,r,o,s,u=window.Tabbar;if(t&&t.href){if(/vk\.com\/vkui\/([a-zA-Z_]+)/.test(t.href))return M(t.href,n,i),!1;if(s=t.href,t.getAttribute&&t.getAttribute("data-change-location-with-post-away")){var p={};return(o=R(t)).post_id&&(p.post=o.post_id,o.ad_data&&(p.post_ad_data=o.ad_data),o.post_click_cc_key&&(p.cc_key=o.post_click_cc_key),s="/away.php?to="+encodeURIComponent(s)+"&"+obj2qs(p).substr(1)),M(s,n,i),!1}}if(t&&t.href&&t.dataset&&t.dataset.setFrom&&(t.href=Url.make(t.href,{from:f.cur})),f.onBeforeGo(t,n,i))return!1;Object(d.partConfigEnabled)("measure_module_navigation_stats_mvk")&&"performance"in window&&window.performance.mark&&window.performance.mark(_.ModuleNavigationStatMarks.mvk.PERF_MARK);var h=i;if(i=extend({no_push:!1,push_only:!1,replace:!1},i),checkEvent(n))return!stopEvent(n);if(!t)return!0;e&&(i.no_push||i.need_restore)&&(m=!1);var v=t,g="",A="",b="";function w(e){return"a"===tag(e)?e:gpeByTag("a",e)}!t.href&&t.getAttribute&&(v=t.getAttribute("data-href"));var y=n&&w(n.target)||t&&t.tagName&&w(t);if(("input"==tag(t)||"button"==tag(t))&&("submit"==t.type||"image"==t.type)&&t.form){if(t.disabled)return!0;var S=t.form,k={},C=S.action||"",j=!1;if(each(S,(function(e,n){return!(n.name&&!n.disabled&&!Object(l.isFieldIgnored)(n))||("radio"===n.type&&!n.checked||("button"===n.type||("submit"===n.type&&n!==t||("image"===n.type&&n!==t||("file"===n.type?(j=!0,!1):"checkbox"===n.type?(k[n.name]=n.checked?1:0,!0):void(k[n.name]=n.value))))))})),"image"==t.type&&(k[t.name]=t.value,k[t.name+".x"]=1,k[t.name+".y"]=1),j||"multipart/form-data"==attr(S,"enctype"))return function(e){var t=ce("iframe");attr(t,"id","upload_iframe"),attr(t,"name","upload_iframe"),attr(t,"width","0"),attr(t,"height","0"),attr(t,"border","0"),attr(t,"style","width:0;height:0;border:none;position:absolute;left:-1000px;"),append(t,e.parentNode),window.frames.upload_iframe.name="upload_iframe",t=ge("upload_iframe");var n=!1;return each(e,(function(e,t){if("submit"===t.type)return n=t,!1})),addEvent(t,"load",(function e(){removeEvent(t,"load",e),setTimeout((function(){remove(t),unlockButton(n)}),2e3)})),Object(c.setDocumentDomain)(),attr(e,"target","upload_iframe"),attr(e,"method","post"),attr(e,"enctype","multipart/form-data"),attr(e,"encoding","multipart/form-data"),append(ce("input",{type:"hidden",id:"__extra",name:"__extra",value:1}),e),e.submit(),setTimeout((function(){lockButton(n),remove("__extra")})),!1}(S);if(!(v=I(C)))return!0;S.method&&"get"!=S.method?i.params=k:v=v.split("?",1).shift()+obj2qs(k)}if(hasClass("al_need_login",t)&&(i.redirectToLoginPage=!0),"string"!=typeof v){if(!v)return!0;"/"!==(g=(v.pathname||"").replace(/^\/+/,"/")).substr(0,1)&&(g="/"+g),A=v.search.substr(1),b=v.hash,v=g+v.search+b;if(/^(?:%40|@)-?[.a-z0-9_]+-[a-z0-9-]+(?:[\?&]\w+\=[a-z0-9-_]+)*$/.test(g.substr(1))&&window.cur&&window.cur.module){var E=window.cur.module;if("feed"===E)"search"===qs2obj(f.params).section&&(E="feed_search");A+="&ref="+E}}else{var T=v.split("#"),D=T.shift();b=T.length?"#"+T.join("#"):"",g=(D=D.split("?")).shift(),A=D.join("?"),!b&&!A||g||(g=f.path,D||(A=f.params),v=g+(A?"?"+A:"")+b)}var L=qs2obj(A);function N(e,t,n){var i=n&&L[t];return!(!e||i)&&(L[t]=e,!0)}if(N((o=R(y,!!L._post_click_type)).post_id,"_post",!0),N(o.post_click_type,"_post_click_type",!0),L._post_click_type&&(N(o.post_click_mention_id,"_post_click_mention_id",!0),N(o.post_click_cc_key,"_post_click_cc_key",!0),N(o.post_click_url,"_post_click_url",!0),N(o.ad_data,"_post_ad_data",!0)&&N(o.ad_block_unique_id,"_post_ad_block_unique_id")),-1!==location.pathname.indexOf("/groups_catalog")&&0!==v.indexOf("/")&&(v="/"+v),0!==location.pathname.indexOf("/app")&&0===g.indexOf("/app")&&L&&L.act&&"app_r"===L.act)return!!n||(M(t,n,i),!1);if(A=obj2qs(L).substr(1),n&&v&&f.cur&&v.split("#").shift()==f.cur.split("#").shift()&&b&&!i.force&&(scrollToHash(b),i.push_only=!0),i.no_push&&f.cur==v&&!i.force)return!1;if(i.push_only)return B(extend(i,{nav:{push:v,path:g,params:A,hash:b}})),!1;if(addClass("active",i.link||t),hasClass("al_back_history",t))return addClass("al_back",i.link||t),removeClass("al_back_history",i.link||t),f.backToTabHistory(i.link||t);if((C||i.isForm)&&(i.removeAfterNextResponse=null==i.removeAfterNextResponse||i.removeAfterNextResponse),t.classList&&(t.classList.contains("al_tab")||t.classList.contains("SliderTabs__tab")||t.classList.contains("Unfold__item_replaceState"))&&(i.replaceState=!0),void 0===(null==h?void 0:h.replace)&&((null==t||null==(a=t.classList)?void 0:a.contains("al_replace"))||(null==t||null==(r=t.dataset)?void 0:r.alReplace))&&(i.replace=!0),hasClass("al_back",t)){var F=L.act;window.isNewMail&&"/mail"===location.pathname&&!F||"show"===F&&!geByClass1("messenger")?i.need_restore=!1:i.need_restore=!0}var H=attr(t,"data-tabbar");if(H){var U=u.getCurrentId();U!==H?(H!==u.TAB_ID_MESSAGES&&0===u.getTabCounter(H)&&(i.need_restore=!0),H===u.TAB_ID_FEED&&"/feed"===v&&(i.need_check_updates=!0),i.tab=H,i.prev_tab=U,i.forceSetCurrent=!0):(i.tab=H,i.prev_tab=H,i.replace=!0),O({lm:{tab:H,is_tab_page:!0}})}else if(i.tab)i.native_prev=u.getCurrentId(),i.is_native_back=!0,i.forceSetCurrent=!0,O({lm:{tab:i.tab,is_tab_page:!0}});else{var V=u.getCurrentId();i.tab=V;var W=!(!this||!isString(this.cur))&&this.cur.substr(1);u.TAB_IDS.includes(W)?i.prev_tab=W:i.prev_tab=V}var $=function(e){var t=window.cur,n=window.menu,i=qs2obj(e.nav.params),a=qs2obj(f.params);if((a.z||i.z)&&a.z!=i.z){if(f.path==e.nav.path){var r=copy(i),o=copy(a);if(delete r.z,delete o.z,r=obj2qs(r),o=obj2qs(o),r==o)return x(i.z,!1,e),B(e),n.close(null,!0),!1}e.zProcess=function(t,n){x(i.z,t,extend({},e,{no_push:!0}),n)}}if(e.onPreNav=function(){e.zProcess&&(e.zProcess(),delete e.zProcess)},!e.ignore_cur_process&&t.processNav&&t.processNav(e))return B(e),n.close(null,!0),!1;return P(e.nav.push,null,e),!1}(extend(i,t.tagName?{target:t}:{},{nav:{push:v,path:g,params:A,hash:b}}));return $||cancelEvent(n),$}function x(e,t,n,i){var a,r=window.photo,o=window.zlayer;if(e){if(a=/^photo(-?\d+_\d+)(?:\/([a-z0-9_-]+(\/rev)?)?)?$/i.exec(e)){if(!0===i)return!1;var s=a[1]||"",c=a[2]||"";return r.zopen(!1,null,s,c,{no_push:(n||{}).no_push}),o&&!1!==t&&void 0!==t&&(o._st=t),QRPhotoPosting&&QRPhotoPosting.close(),!0}if(a=/^story(-?\d+_\d+)(\/([a-z0-9_-]+))?(\/?[a-z0-9_:]+)?$/i.exec(e)){var l=window.Stories;if(!0===i)return!1;if(!l.opened){var u=a[1]+(a[2]?a[2]:"/"+a[1])+(a[4]?a[4]:"");l.init(u)}return!0}if(a=/^narrative([0-9\-]+)_(\d+)(?:_(\d+))?$/i.exec(e)){window.Stories;if(!0===i)return!1;var d=a,_=d[1],f=d[2],p=d[3];return window.showNarrative(_,f,p,"",{source:"narrative_link"}),!0}if(a=/^\/?doc(-?\d+)_(\d+)(\/?([a-z0-9_-]+))?$/i.exec(e))return!0!==i&&(r.zopen(null,null,a[1]+"_"+a[2],"",{no_push:(n||{}).no_push,isDoc:!0,hasVideo:!1,hash:a[4]}),o&&!1!==t&&void 0!==t&&(o._st=t),!0);if(a=/^\/?publish_photo(-?\d+)?$/i.exec(e)){if(!0===i)return!1;QRPhotoPosting&&QRPhotoPosting.show()}}return!1!==i&&(o&&o.close(),Stories&&Stories.opened&&Stories.close({isPopState:!0,closeAll:!0}),QRPhotoPosting&&QRPhotoPosting.close(),!0)}function L(t,n,i){if(void 0===i&&(i=null),e)!function(e,t,n){var i=window.Tabbar.getCurrentId(),a={nav:{tab:t.tab||i,prev_tab:t.prev_tab}};window.isNewMail?t.replace?history.replaceState(extend({},n,a),null,e):history.pushState(extend({},n,a),null,e):t.replace?history.replaceState(a,null,e):history.pushState(a,null,e)}(t,n,i);else{var a="/"==t.substr(0,1)?t:"/"+t,r="#"+a,o=location.pathname+location.search+r;ge("base").href=a,n.replace?location.replace(o):(p=r,location.href=o)}}function B(t){if(!t.no_push&&f.cur!=t.nav.push)try{window.isNewMail?L(t.nav.push,t,t.historyState):L(t.nav.push,t),e&&!t.no_push&&(t.nav_init||t.nav_incr)?(t.nav_init&&(m=0),t.nav_incr&&!1!==m&&m++,m>30&&(m=!1)):m=!1}catch(e){return M(t.nav.push,null,t)}f.cur!==t.nav.push&&(f.prev_cur=f.cur,f.prev_fv_link=f.fv_link),f.cur=t.nav.push,f.path=t.nav.path,f.params=t.nav.params,f.hash=t.nav.hash,f.path&&0!==f.path.indexOf("/")&&(f.path="/"+f.path)}function R(e,t){var n=!(!e||!e.getAttribute),i={};if(!n)return i;var a=e.getAttribute("data-post-id");a&&(i.post_id=a);var r=e.getAttribute("data-post-click-type");r&&(i.post_click_type=r);var o=e.getAttribute("mention_id");o&&(i.post_click_mention_id=o);var s=e.getAttribute("data-post-click-cc-key");s&&(i.post_click_cc_key=s);var c=[e.getAttribute("href"),e.getAttribute("data-href")];if(each(c,(function(e,t){if(t&&"#"!==t)return i.post_click_url=t,!1})),!!r||t){var l=gpeByClass("_ads_block_data_w",e),u=(l=l||gpeByClass("_ads_promoted_post_data_w",e))&&l.getAttribute("data-ad"),d=l&&l.getAttribute("data-ad-block-uid");u&&(i.ad_data=u),d&&(i.ad_block_unique_id=d)}return i}}();onDOMReady((function(){window.storybook||(f.initOpenInNativeAppBtn(),f.initStore())})),window.nav=f,t.default=f},wTbK:function(e,t,n){"use strict";n.r(t),n.d(t,"open",(function(){return k})),n.d(t,"close",(function(){return E})),n.d(t,"ModalMenuBtn",(function(){return s.ModalMenuBtn})),n.d(t,"ModalMenuIcon",(function(){return s.ModalMenuIcon})),n.d(t,"ModalMenuTitle",(function(){return s.ModalMenuTitle})),n.d(t,"ModalMenuBody",(function(){return s.ModalMenuBody})),n.d(t,"ModalMenuHeaderCloseButton",(function(){return s.ModalMenuHeaderCloseButton}));var i,a,r,o=n("OcsD"),s=n("t7Ww"),c=n("r/ag"),l=n("UxAg"),u=function(){function e(e){this.lastTime=0,this.lastRegisteredTime=0,this.lastCoordinates=[0,0],this.velocity={x:0,y:0},this.lastTime=e.time,this.lastCoordinates=[e.x,e.y],this.velocity={x:0,y:0}}return e.getVelocity=function(e,t,n){return{x:t/e||0,y:n/e||0}},e.prototype.registerEvent=function(t){if("touchmove"===t.type){var n=+t.touches[0].clientX,i=+t.touches[0].clientY,a=t.timeStamp-this.lastTime;if(t.timeStamp-this.lastRegisteredTime<=16.67)this.lastCoordinates=[n,i],this.lastTime=t.timeStamp;else{var r=n-this.lastCoordinates[0],o=i-this.lastCoordinates[1];this.velocity=e.getVelocity(a,r,o),this.lastTime=t.timeStamp,this.lastRegisteredTime=this.lastTime,this.lastCoordinates=[n,i]}}else window.clog&&window.clog("[Gestures.js] unhandled event "+t.type)},e}(),d=n("CQvH"),_=n("xt6h"),f="horizontal",p="vertical",h=!1,m=null,v=null,g=0,A=0,b=0,w={},y=null,O=Object(l.$)(".Popup__wrap",i),S=!1;function k(e,t,n,s){void 0===t&&(t=!0),void 0===n&&(n=""),void 0===s&&(s={});var u=s,_=u.settling,f=void 0===_?75:_,p=u.expandable,h=void 0!==p&&p;if(s.settling=f,s.expandable=h,i=c.default.open(e,t,{hash:n,withoutCloning:s.withoutPopupCloning}),w=s,O=Object(l.$)(".Popup__wrap",i),r=Object(l.$)(".Popup__content",O),void 0===s.swipeDown&&(s.swipeDown=!0),h&&j(i)){i.classList.add("ModalMenu--expandable");var m=(100-w.settling)/100*window.innerHeight;M=m,o.setStyle.animate(O,"transform",{duration:200,func:"ease"}),o.setStyle.transform(O,1,[0,m])}return L(),Object(o.onBodyResize)(L),s.swipeDown&&window.innerWidth<882&&(scrollTop(0),Object(o.addEvent)(r,"touchstart",T,{passive:!0}),Object(o.addEvent)(r,"touchmove",P,{capture:!0}),Object(o.addEvent)(r,"touchcancel touchend",D,{passive:!0}),Object(o.addEvent)(O,"click",C,{passive:!0}),Object(o.addEvent)(O,"click",C,{passive:!0})),(a=Object(d.setFocusTrap)(i))&&(a.exitIntent=function(){return!1}),i}function C(e){if(O&&e.target===O)return(a=Object(d.setFocusTrap)(i))&&(a.exitIntent=function(){return!1}),i}function j(e){var t=Object(l.$)(".ModalMenu__body",e)||Object(l.$)(".ModalMenuContent",e)||Object(l.$)(".Popup__content",e);return!(Object(o.getCw)()>=882)&&(t.scrollHeight||Object(o.getH)(t))>=window.innerHeight}function E(e,t){if(void 0===t&&(t={}),e||(e=document.activeElement),e){var n=e.closest(".ModalMenu.Popup_open")||e;n&&n.classList.contains("ModalMenu")&&(e.classList.contains("Popup__overlay")&&Object(_.isFunction)(w.onOverlayClick)&&w.onOverlayClick(),window.innerWidth<882?c.default.close(n,{smooth:!0,velocity:!(!y||!y.velocity)&&y.velocity,lastY:b,onClose:t.onClose}):setTimeout((function(){c.default.close(n),t.onClose&&t.onClose()})),Object(o.removeEvent)(r,"touchstart",T,{passive:!0}),Object(o.removeEvent)(r,"touchmove",P,{capture:!0}),Object(o.removeEvent)(r,"touchcancel touchend",D,{passive:!0}),Object(o.removeEvent)(O,"click",C,{passive:!0}),Object(o.removeEvent)(O,"click",C,{passive:!0}),v=null,g=0,A=0,m=null,I=!1,b=0,M=0,i=null,O=null,r=null,y=null,w={},Object(o.onBodyResize)("__clear",L),a&&(a(),a=null))}}function T(e){if(e.touches&&e.touches.length>1)h=!1;else{var t=e.target.closest(".ScrollView")||Object(l.$)(".ScrollView",e.target);if(!Object(l.$)(".ModalMenu").classList.contains("ModalMenu--blocked")){var n=w.expandable&&j(i);S=n,v=e.touches[0],A=e.touches[0].clientX,g=e.touches[0].clientY,t&&t.scrollTop>1?h=!1:(y=new u({time:e.timeStamp,x:e.touches[0].clientX,y:e.touches[0].clientY}),h=!0)}}}var I=!1,M=0;function P(e){if(e.touches&&e.touches.length>1)h=!1;else if(v&&h){var t=e.touches[0];if(m||(m=Math.abs(A-t.clientX)>Math.abs(g-t.clientY)?f:p),m!==f){y.registerEvent(e);var n=-Math.min(0,g-t.clientY-M);0!==n&&(Object(o.cancelEvent)(e),b=n,I||(i.classList.add("ModalMenu--dragging"),browser.ios&&o.setStyle.animate(O,"transform",{duration:50,func:"linear"}),I=!0),x(n),o.setStyle.transform(O,1,[0,n]))}}}function D(e){if(h)if(h=!1,i.classList.remove("ModalMenu--dragging"),I=!1,m!==f){m=null,x(b);var t=w.expandable&&j(i);S=t;var n=i.classList.contains("ModalMenu--expanded"),a=!n,r=function(e){void 0===e&&(e=[]);return e.find((function(e){return 0!==e.scrollTop||e.scrollHeight>e.offsetHeight}))}(e.path),s=!1;r&&(s=0!==r.scrollTop);var c=!1,l=!1;y&&(c=!s&&y.velocity.y>=.6,l=!s&&y.velocity.y<=-.15);var u=b/window.innerHeight*100,d="";n?d="expand":a&&(d="collapse");var _=d;c&&u<8?u=8:l&&(u=0),!t&&u>=8||u>=100-w.settling+8?_="close":n?u>=8&&!s&&(_="collapse"):a&&j(i)&&u<=100-w.settling&&(_="expand"),function(e){if(!e)return;i.classList.toggle("ModalMenu--expanded","expand"===e),"close"!==e&&O.style.removeProperty("transition");switch(e){case"collapse":i.classList.add("ModalMenu--restore");var t=0;j(i)&&(t=(100-w.settling)/100*window.innerHeight),M=t,o.setStyle.transform(O,1,[0,t]),x(M=t,!0),setTimeout((function(){i&&i.classList.remove("ModalMenu--restore"),0===t&&Object(o.setStyle)(O,{transform:""})}),200);break;case"expand":i.classList.add("ModalMenu--restore"),i.classList.add("ModalMenu--expanded"),o.setStyle.transform(O,1,[0,0]),x(M=0,!0),setTimeout((function(){i&&(L(),i.classList.remove("ModalMenu--restore"))}),200);break;case"close":M=0,E(i,w)}}(_),y=null}else m=null}function x(e,t){if(void 0===e&&(e=null),void 0===t&&(t=!1),S){var n=Object(l.$)(".ModalMenuHeader__title",O),i=Object(l.$)(".ModalMenuHeader__close",O);if(n&&i){var a=(100-w.settling)/100*window.innerHeight,r=1-Math.max(0,Math.min(1,(null===e?M:e)/a));t&&(o.setStyle.animate(n,"transform",{duration:250}),o.setStyle.animate(i,"transform, opacity",{duration:250})),o.setStyle.transform(n,1,[44*r,0]),o.setStyle.transform(i,r),Object(o.setStyle)(i,{opacity:r})}}}function L(){var e=Object(l.$)(".ModalMenuContent",i),t=Object(l.$)(".ModalMenuHeader",i);if(e&&t){var n=Object(o.getH)(t),a=Object(o.getH)(e),r=Math.min(Object(o.getCh)(),a+n+"px");Object(o.getCw)()>=882&&(r=null),Object(o.setStyle)(e,"height",r)}}Object(o.addEvent)(window,"keydown",(function(e){var t=e.target&&e.target.closest(".ModalMenu")||document.activeElement&&document.activeElement.closest(".ModalMenu")||Object(l.$)(".ModalMenu.Popup_open");if(t)switch(e.keyCode){case 27:E(t,w)}})),Object(o.addEvent)(window,"click",(function(e){if(e.isTrusted){var t=e.target&&e.target.closest(".ModalMenu")||document.activeElement&&document.activeElement.closest(".ModalMenu")||Object(l.$)(".ModalMenu.Popup_open"),n=!!e.target.closest(".ModalMenu");if(t&&n&&!e.target.closest(".Popup__content")){var i=Object(l.$)(".Popup__overlay",t);window.clog("Simulate modal overlay click"),i.click()}}}),{passive:!0});t.default=s.default;Object(o.extend)(s.default,{open:k,close:E}),window.ModalMenu=s.default},wTgh:function(e,t,n){"use strict";function i(e,t){void 0===t&&(t=0);var n=32768&t;return e=(e=e.replace(/([a-zA-Z\-_\.0-9]+@[a-zA-Z\-_0-9]+\.[a-zA-Z\-_\.0-9]+[a-zA-Z\-_0-9]+)/g,(function(e){return'<a href="mailto:'+e+'">'+e+"</a>"}))).replace(/(https?:\/\/)?(([A-Za-zА-Яа-яЁё0-9@][A-Za-zА-Яа-яЁё0-9@\-\_\.]*[A-Za-zА-Яа-яЁё0-9@])(\/([A-Za-zА-Яа-я0-9@\-\_#%&?+\/\.=;:~]*[^\.\,;\(\)\?<\&\s:])?)?)/gi,(function(){var e=arguments[3],t=arguments[2],i=arguments[0],a=arguments[1]||"http://";if(-1==e.indexOf(".")||-1!=e.indexOf(".."))return i;var r=e.split(".").pop();if(r.length>7||-1==indexOf("place,camera,info,name,academy,aero,arpa,coop,media,museum,mobi,travel,xxx,asia,biz,com,net,org,gov,mil,edu,int,tel,ac,ad,ae,af,ag,ai,al,am,an,ao,aq,ar,as,at,au,aw,ax,az,ba,bb,bd,be,bf,bg,bh,bi,bj,bm,bn,bo,br,bs,bt,bv,bw,by,bz,ca,cc,cd,cf,cg,ch,ci,ck,cl,cm,cn,co,cr,cu,cv,cx,cy,cz,de,dj,dk,dm,do,dz,ec,ee,eg,eh,er,es,et,eu,fi,fj,fk,fm,fo,fr,ga,gd,ge,gf,gg,gh,gi,gl,gm,gn,gp,gq,gr,gs,gt,gu,gw,gy,hk,hm,hn,hr,ht,hu,id,ie,il,im,in,io,iq,ir,is,it,je,jm,jo,jp,ke,kg,kh,ki,km,kn,kp,kr,kw,ky,kz,la,lb,lc,li,lk,lr,ls,lt,lu,lv,ly,ma,mc,md,me,mg,mh,mk,ml,mm,mn,mo,mp,mq,mr,ms,mt,mu,mv,mw,mx,my,mz,na,nc,ne,nf,ng,ni,nl,no,np,nr,nu,nz,om,pa,pe,pf,pg,ph,pk,pl,pm,pn,pr,ps,pt,pw,py,qa,re,ro,ru,rs,rw,sa,sb,sc,sd,se,sg,sh,si,sj,sk,sl,sm,sn,so,sr,st,su,sv,sy,sz,tc,td,tf,tg,th,tj,tk,tl,tm,tn,to,tp,tr,tt,tv,tw,tz,ua,ug,uk,um,us,uy,uz,va,vc,ve,vg,vi,vn,vu,wf,ws,ye,yt,yu,za,zm,zw,рф,укр,сайт,онлайн,срб,cat,pro,local".split(","),r))return i;if(-1!=i.indexOf("@"))return i;try{i=decodeURIComponent(i)}catch(e){}return i.length>55&&(i=i.substr(0,53)+".."),i=htsc(i),!n&&e.match(/^([a-zA-Z0-9\.\_\-]+\.)?(vkontakte\.ru|vk\.com|vkadre\.ru|vshtate\.ru|userapi\.com|vk\.me)$/)?'<a href="'+(a+(t=replaceEntities(t).replace(/([^a-zA-Z0-9#%;_\-.\/?&=\[\]])/g,encodeURIComponent))).replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")+'">'+i+"</a>":'<a href="/away?to='+encodeURIComponent(a+replaceEntities(t))+'" target="_blank">'+i+"</a>"}))}n.r(t),n.d(t,"wrapLinks",(function(){return i}))},wcVR:function(e,t,n){"use strict";n.r(t);var i={_def_opts:{enableHighAccuracy:!0,maximumAge:3e5,timeout:6e4},_provider:null,initW3C:function(){i._provider=navigator.geolocation,i.getCurrentPosition=function(e,t,n){i._provider.getCurrentPosition((function(t){void 0!==t.latitude?e(extend(t,{coords:extend(t.coords||{},{latitude:t.latitude,longitude:t.longitude})})):e(t)}),t,n)}},initGears:function(){var e=window.google;i._provider=e.gears.factory.create("beta.geolocation")},initSymbian:function(){var e=window.device;i._provider=e.getServiceObject("Service.Location","ILocation"),i.getCurrentPosition=function(e,t){i._provider.ILocation.GetLocation({LocationInformationClass:"BasicLocationInformation"},(function(n,i,a){4==i?t({code:2,message:"Position unavailable"}):e({timestamp:null,coords:{latitude:a.ReturnValue.Latitude,longitude:a.ReturnValue.Longitude,altitude:a.ReturnValue.Altitude,heading:a.ReturnValue.Heading}})}))}},initPalm:function(){i.getCurrentPosition=function(e,t,n){var i={};n&&(n.enableHighAccuracy&&1==n.enableHighAccuracy&&(i.accuracy=1),n.maximumAge&&(i.maximumAge=n.maximumAge),n.responseTime&&(n.responseTime<5?i.responseTime=1:n.responseTime<20?i.responseTime=2:i.timeout=3)),new window.Mojo.Service.Request("palm://com.palm.location",{method:"getCurrentPosition",parameters:i,onSuccess:function(t){e({timestamp:t.timestamp,coords:{latitude:t.latitude,longitude:t.longitude,heading:t.heading}})},onFailure:function(e){1==e.errorCode?t({code:3,message:"Timeout"}):2==e.errorCode?t({code:2,message:"Position unavailable"}):t({code:0,message:"Unknown Error: webOS-code"+e.errorCode})}})}},getCurrentPosition:function(e,t,n){i._provider.getCurrentPosition(e,t,extend(i._def_opts,n||{}))},init:function(){var e=window,t=e.google,n=e.device,a=e.Mojo;try{var r="undefined";if(typeof navigator.geolocation!==r)i.initW3C();else if(typeof window.google!==r&&typeof t.gears!==r)i.initGears();else if(typeof n!==r&&typeof n.getServiceObject!==r)i.initSymbian();else{if(typeof a===r||"Mojo.Service.Request"==typeof a.Service.Request)return!1;i.initPalm()}}catch(e){return!1}return!0}};window.geo=i,t.default=i},wkhI:function(e,t,n){"use strict";n.r(t),n.d(t,"setFieldIgnored",(function(){return a})),n.d(t,"isFieldIgnored",(function(){return r}));var i=n("OcsD"),a=function(e,t){void 0===t&&(t=!0),Object(i.attr)(e,"data-ignore-field",!!t&&"true")},r=function(e){return"true"===Object(i.attr)(e,"data-ignore-field")}},wyHI:function(e,t){var n=window,i=n.gpeByClass,a=n.hasClass,r=n.addClass,o=n.removeClass,s=n.geByClass1,c=n.setStyle,l=n.tooltip,u=n.ajax;window.Fave={showActionsTT:function(e,t){cancelEvent(t);var n=i("FaveArticles__row",e);if(a(n,"wi_actions_opened"))Fave.hideActionsTT();else{var o=s("wi_actions_wrap",n),u=s("FaveArticles__row_actions",n);c(o,"top",e.offsetTop+e.offsetHeight+"px"),r(n,"wi_actions_opened"),l.addHandler(Fave.hideActionsTT),l.show(o,u)}},hideActionsTT:function(){o("wi_actions_opened",s("wi_actions_opened")),l.hide()},removeArticle:function(e,t,n){Fave.hideActionsTT();var a=i("FaveArticles__row",e);r(a,"removed"),u.post("fave.php",{act:"defave_article",link:t,hash:n},{onFail:function(){return o(a,"removed")}})},restoreArticle:function(e,t,n){var a=i("FaveArticles__row",e);o(a,"removed"),u.post("fave.php",{act:"enfave_article",link:t,hash:n},{onFail:function(){return r(a,"removed")}})}}},xU72:function(e,t,n){"use strict";n.r(t);var i=n("29dZ"),a=n("Y6JH"),r=n("9b/I"),o=n("WWJR"),s=n("PdAw");t.default=function(e){return void 0===e&&(e={}),{inner:[{inner:[{inner:[Object(i.default)({inner:[Object(a.default)({icon:e.isLeftActionBack?Object(r.getBackOutline28Icon)():Object(o.getCancelOutline28Icon)()})],theme:"header",class:"ModalPage__headerButton ModalPage__headerButton--close",onClick:e.onLeftActionClick,use_native_onclick:!0,is_icon:!0}),{inner:[e.title],class:"ModalPage__headerTitle",tag:"div"},e.isConfirmActionAvailable?Object(i.default)({inner:[Object(a.default)({icon:Object(s.getDoneOutline28Icon)()})],theme:"header",class:"ModalPage__headerButton ModalPage__headerButton--confirm",onClick:e.onConfirmClick,use_native_onclick:!0,is_icon:!0}):null],class:"ModalPage__header",tag:"div"},{inner:[e.content],class:"ModalPage__content",id:e.contentId,tag:"div"}],class:"ModalPage__wrapper",tag:"div"}],class:"Popup ModalPage",tag:"div"}}},xk4V:function(e,t,n){var i=n("4fRq"),a=n("I2ZF");e.exports=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||i)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var s=0;s<16;++s)t[r+s]=o[s];return t||a(o)}},"y/eL":function(e,t,n){"use strict";n.r(t),n.d(t,"updateCounters",(function(){return s}));var i=n("W9Tc");var a=n("jE6c");var r=n("JlTo"),o=n("DM2o");function s(e,t){if(!(window.__dev||window.vk&&(window.vk.zero||window.vk.__dev))){t=t||document.referrer||"";[[/(hash|dl)=\w+/g,"$1="],[/(\/(?:write|mail|im|al_im.php))(?:\?[a-z0-9&=_-]*)?$/,"$1"],[/(\/write)\d*(?:\?[a-zA-Z0-9&=_-]*)?$/,"$1"]].forEach((function(n){var i=n[0],a=n[1];e=e.replace(i,a),t=t.replace(i,a)})),Object(r.tmrTrackPage)(e,t);var n=[/\/login\?.*$/];n.some((function(t){return t.test(e)}))||n.some((function(e){return e.test(t)}))||(!function(e,t){var n=location.protocol,i=window._tns&&(window._tns.tnsPixelSocdem||"83"),r=t.replace(/\*/g,"%2a").split("#")[0],o=window._tns&&window._tns.tnsPixelType;Object(a.vkImage)().src=n+"//www.tns-counter.ru/V13a**clid:"+i+"*"+r+"*vk_com/ru/UTF-8/tmsec=vksite_total/"+Math.round(1e9*Math.random()),"unauth"===o?Object(a.vkImage)().src=n+"//www.tns-counter.ru/V13a****vk_ad/ru/UTF-8/tmsec=vkad_cid1015708-posid1184674/"+Math.round(1e9*Math.random()):"has_rough"===o?Object(a.vkImage)().src=n+"//www.tns-counter.ru/V13a****vk_ad/ru/UTF-8/tmsec=vkad_cid1015708-posid1184675/"+Math.round(1e9*Math.random()):"not_has_rough"===o&&(Object(a.vkImage)().src=n+"//www.tns-counter.ru/V13a****vk_ad/ru/UTF-8/tmsec=vkad_cid1015708-posid1184677/"+Math.round(1e9*Math.random()))}(0,t),function(){if(Object(i.partConfigEnabled)("geminus_counter")){var e="pzBAVLtpzyiyDVIwmwjmX5a2zSVdA6eUI7mpf0ufDFf.57";if(window.pp_gemius_identifier)window.pp_gemius_hit(e);else{window.pp_gemius_identifier=e;var t=function(e){window[e]=window[e]||function(){var t=window[e+"_pdata"]=window[e+"_pdata"]||[];t[t.length]=arguments}};t("gemius_hit"),t("gemius_event"),t("pp_gemius_hit"),t("pp_gemius_event"),function(e,t){try{var n=e.createElement(t),i=e.getElementsByTagName(t)[0],a="http"+("https:"==location.protocol?"s":""),r="vkgalv";if(window.vk&&window.vk.countryISO)switch(window.vk.countryISO){case"BY":r="vkgaby";break;case"MD":r="vkgamd";break;case"EE":r="vkgaee"}n.setAttribute("async","async"),n.setAttribute("defer","defer"),n.src=a+"://"+r+".hit.gemius.pl/xgemius.js",i.parentNode.insertBefore(n,i)}catch(e){}}(document,"script")}}}(),Object(o.statlogsValueEvent)("counters_check",1))}}},yVza:function(e,t){window.FaceRecognitionSwitch={onChange:function(e,t){window.ajax.post(e,{checked:t.checked,_ajax:1})}}},yuVR:function(e,t){var n="friendsStat.events",i=null;function a(){clearTimeout(i);var e=lsGet(n)||[];if(e.length){lsSet(n);var t,a={act:"stats"};a=extend(a,(t={},each(e,(function(){t[this.type]?t[this.type].push(this.data):t[this.type]=[this.data]})),t)),ajax.post("/friends",a)}}window.FriendsStats={log:function(e,t){var r=function(e,t){var n=[],i=(new Date).getTime();switch(e){case FriendsStats.EVENTS.EVENT_VIEW_USER:n=[t.uid,i,t.pos,t.ref,t.blockType,t.trackCode];break;case FriendsStats.EVENTS.EVENT_HIDE_BLOCK:n=[i,t.ref,t.trackCode];break;case FriendsStats.EVENTS.EVENT_OPEN_USER:n=[t.uid,i,t.ref,t.trackCode]}return n.join("|")}(e,t);if(!r)return;var o=lsGet(n)||[];o.push({type:e,data:r}),lsSet(n,o),clearTimeout(i),i=setTimeout(a,1e4)},EVENTS:{EVENT_VIEW_USER:"show_user_rec",EVENT_HIDE_BLOCK:"hide_block",EVENT_OPEN_USER:"open_user"}},i=setTimeout(a,1e4)},z1UI:function(e,t,n){"use strict";n.r(t);var i=n("k+Df");t.default=i.default},z9Td:function(e,t,n){"use strict";n.r(t),n.d(t,"PLATFORM_MVK",(function(){return i}));var i="mvk"},z9sQ:function(e,t,n){"use strict";n.r(t);n("OcsD");var i={class:function(e,t,n){void 0===t&&(t={});void 0===n&&(n="--");var i=[e];return Object.keys(t).forEach((function(r){if(a(r)){var o=t[r];!0===o?i.push(""+e+n+r):a(o)&&i.push(""+e+n+r+n+o)}})),i.join(" ")},setMod:function(e,t,n){var i,r=new RegExp("\\s*"+t+"(_[-a-zA-Z]+)?");i=!0===n?" "+t:a(n)?" "+t+"_"+n:"";r.test(e.className)?e.className=e.className.replace(r,i):e.className+=i}};function a(e){return"number"==typeof e||"string"==typeof e&&e}t.default=i;window.Bem=i},zHNa:function(e,t){var n=need("Control"),i=need("Popup"),a={init:function(){var e=geByClass1("_adultConfirm"),t=geByClass1("_adultConfirm__submit",e),i=geByClass1("adultConfirm__checkbox",e);toggleClass("adultConfirm__submit_disabled",t,!n.isChecked(i))},toggle:function(e){var t=gpeByClass("_adultConfirm",e.$control),n=geByClass1("_adultConfirm__submit",t);toggleClass("adultConfirm__submit_disabled",n,!e.checked)},submit:function(e,t){if(cancelEvent(e),!hasClass("adultConfirm__submit_disabled",t)){var n=gpeByClass("_adultConfirm",t),a=geByClass1("_adultConfirm__form",n),r={_ajax:1};each(geByTag("input",a),(function(e,t){var n=t.type.toLowerCase(),i=t.name.toLowerCase();"hidden"!==n&&"checkbox"!==n&&"radio"!==n||(r[i]=t.value)}));var o=attr(a,"action");ajax.post(o,r),i.close()}},back:function(e){cancelEvent(e),window.history?window.history.back():window.location="/"}};window.AdultConfirm=a},zRDV:function(e,t){var n="";window.DonutDuration={init:function(e){n=e.select_url||""},selectDuration:function(e){var t=document.querySelector("#value_link");if(t){var i=n.replace("{value}",e);t.setAttribute("href",i)}}}},zouF:function(e,t,n){"use strict";n.r(t),n.d(t,"Confirm",(function(){return c}));var i=n("TYsd"),a=n("Po+v"),r=n("fdw3"),o=n("29dZ"),s=n("UxAg");function c(e,t,n,s){void 0===s&&(s={});var c=i.default.preactElemFromTemplate(Object(a.default)({id:s.id,class:"Confirm",scrollable:!0,header:{title:s.title||Object(r.getLang)("mobile_warning_header")},on_overlay_click_native:n,content:[e,{class:"Popup__buttons",inner:[Object(o.default)({onClick:t,use_native_onclick:!0,class:"Popup__button",theme:s.theme_accept_btn||"regular",url:s.yes_href,inner:s.yes_label||Object(r.getLang)("mobile_continue")}),Object(o.default)({onClick:n||"Popup.close(this, event)",use_native_onclick:!0,class:"Popup__button",theme:s.theme_close_btn||"secondary",url:s.no_href,inner:s.no_label||Object(r.getLang)("mobile_cancel")})]}]}));return a.default.open(c,!0,{withoutCloning:!0})}window.page&&window.page.onChange((function(){Object(s.$$)(".Confirm").forEach((function(e){return a.default.close(e)}))})),window.Confirm=c},zq7H:function(e,t,n){"use strict";n.r(t),n.d(t,"COUNTERS_POS_NOTIFICATIONS",(function(){return i})),n.d(t,"COUNTERS_POS_MESSAGES",(function(){return a})),n.d(t,"COUNTERS_POS_APPS",(function(){return r})),n.d(t,"DESKTOP_WIDTH",(function(){return o}));var i=2,a=3,r=10,o=882},zvhO:function(e,t,n){"use strict";function i(e){return"number"==typeof e&&!isNaN(e)}n.r(t),n.d(t,"isNumber",(function(){return i}))}},[[9,"runtime","vendor","icons","b-40008b040be6e48e0972285ddffbefb6","b-bcc87cd429a5b075c1981971084df9a2"]]]);